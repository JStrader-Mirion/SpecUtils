<!DOCTYPE html><html>
<head>
<title>Interactive Spectrum Development</title>
<script>!function(){function n(n){return n&&(n.ownerDocument||n.document||n).documentElement}function t(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function e(n,t){return t>n?-1:n>t?1:n>=t?0:NaN}function r(n){return null===n?NaN:+n}function u(n){return!isNaN(n)}function i(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)<0?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)>0?u=i:r=i+1}return r}}}function a(n){return n.length}function o(n){for(var t=1;n*t%1;)t*=10;return t}function l(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function c(){this._=Object.create(null)}function s(n){return(n+="")===xa||n[0]===ba?ba+n:n}function f(n){return(n+="")[0]===ba?n.slice(1):n}function h(n){return s(n)in this._}function g(n){return(n=s(n))in this._&&delete this._[n]}function p(){var n=[];for(var t in this._)n.push(f(t));return n}function v(){var n=0;for(var t in this._)++n;return n}function d(){for(var n in this._)return!1;return!0}function m(){this._=Object.create(null)}function y(n){return n}function M(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function x(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=_a.length;r>e;++e){var u=_a[e]+t;if(u in n)return u}}function b(){}function _(){}function w(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;)(t=r[u].on)&&t.apply(this,arguments);return n}var e=[],r=new c;return t.on=function(t,u){var i,a=r.get(t);return arguments.length<2?a&&a.on:(a&&(a.on=null,e=e.slice(0,i=e.indexOf(a)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function S(){oa.event.preventDefault()}function k(){for(var n,t=oa.event;n=t.sourceEvent;)t=n;return t}function N(n){for(var t=new _,e=0,r=arguments.length;++e<r;)t[arguments[e]]=w(t);return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=oa.event;u.target=n,oa.event=u,t[u.type].apply(e,r)}finally{oa.event=i}}},t}function E(n){return Sa(n,Aa),n}function A(n){return"function"==typeof n?n:function(){return ka(n,this)}}function C(n){return"function"==typeof n?n:function(){return Na(n,this)}}function z(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=oa.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?o:a:n.local?i:u}function L(n){return n.trim().replace(/\s+/g," ")}function q(n){return new RegExp("(?:^|\\s+)"+oa.requote(n)+"(?:\\s+|$)","g")}function T(n){return(n+"").trim().split(/^|\s+/)}function R(n,t){function e(){for(var e=-1;++e<u;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;)n[e](this,r)}n=T(n).map(D);var u=n.length;return"function"==typeof t?r:e}function D(n){var t=q(n);return function(e,r){if(u=e.classList)return r?u.add(n):u.remove(n);var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",L(u+" "+n))):e.setAttribute("class",L(u.replace(t," ")))}}function P(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function U(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function j(n){function t(){var t=this.ownerDocument,e=this.namespaceURI;return e&&e!==t.documentElement.namespaceURI?t.createElementNS(e,n):t.createElement(n)}function e(){return this.ownerDocument.createElementNS(n.space,n.local)}return"function"==typeof n?n:(n=oa.ns.qualify(n)).local?e:t}function F(){var n=this.parentNode;n&&n.removeChild(this)}function H(n){return{__data__:n}}function O(n){return function(){return Ea(this,n)}}function I(n){return arguments.length||(n=e),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function Y(n,t){for(var e=0,r=n.length;r>e;e++)for(var u,i=n[e],a=0,o=i.length;o>a;a++)(u=i[a])&&t(u,a,e);return n}function Z(n){return Sa(n,za),n}function V(n){var t,e;return function(r,u,i){var a,o=n[i].update,l=o.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(a=o[t])&&++t<l;);return a}}function X(n,t,e){function r(){var t=this[a];t&&(this.removeEventListener(n,t,t.$),delete this[a])}function u(){var u=l(t,ca(arguments));r.call(this),this.addEventListener(n,this[a]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+oa.requote(n)+"$");for(var r in this)if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}var a="__on"+n,o=n.indexOf("."),l=$;o>0&&(n=n.slice(0,o));var c=La.get(n);return c&&(n=c,l=B),o?t?u:r:t?b:i}function $(n,t){return function(e){var r=oa.event;oa.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{oa.event=r}}}function B(n,t){var e=$(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function W(e){var r=".dragsuppress-"+ ++Ta,u="click"+r,i=oa.select(t(e)).on("touchmove"+r,S).on("dragstart"+r,S).on("selectstart"+r,S);if(null==qa&&(qa="onselectstart"in e?!1:x(e.style,"userSelect")),qa){var a=n(e).style,o=a[qa];a[qa]="none"}return function(n){if(i.on(r,null),qa&&(a[qa]=o),n){var t=function(){i.on(u,null)};i.on(u,function(){S(),t()},!0),setTimeout(t,0)}}}function J(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var u=r.createSVGPoint();if(0>Ra){var i=t(n);if(i.scrollX||i.scrollY){r=oa.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=r[0][0].getScreenCTM();Ra=!(a.f||a.e),r.remove()}}return Ra?(u.x=e.pageX,u.y=e.pageY):(u.x=e.clientX,u.y=e.clientY),u=u.matrixTransform(n.getScreenCTM().inverse()),[u.x,u.y]}var o=n.getBoundingClientRect();return[e.clientX-o.left-n.clientLeft,e.clientY-o.top-n.clientTop]}function G(){return oa.event.changedTouches[0].identifier}function K(n){return n>0?1:0>n?-1:0}function Q(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function nn(n){return n>1?0:-1>n?Ua:Math.acos(n)}function tn(n){return n>1?Ha:-1>n?-Ha:Math.asin(n)}function en(n){return((n=Math.exp(n))-1/n)/2}function rn(n){return((n=Math.exp(n))+1/n)/2}function un(n){return((n=Math.exp(2*n))-1)/(n+1)}function an(n){return(n=Math.sin(n/2))*n}function on(){}function ln(n,t,e){return this instanceof ln?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof ln?new ln(n.h,n.s,n.l):_n(""+n,wn,ln):new ln(n,t,e)}function cn(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(a-i)*n/60:180>n?a:240>n?i+(a-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,a;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,a=.5>=e?e*(1+t):e+t-e*t,i=2*e-a,new yn(u(n+120),u(n),u(n-120))}function sn(n,t,e){return this instanceof sn?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof sn?new sn(n.h,n.c,n.l):n instanceof hn?pn(n.l,n.a,n.b):pn((n=Sn((n=oa.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new sn(n,t,e)}function fn(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new hn(e,Math.cos(n*=Oa)*t,Math.sin(n)*t)}function hn(n,t,e){return this instanceof hn?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof hn?new hn(n.l,n.a,n.b):n instanceof sn?fn(n.h,n.c,n.l):Sn((n=yn(n)).r,n.g,n.b):new hn(n,t,e)}function gn(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=vn(u)*Ka,r=vn(r)*Qa,i=vn(i)*no,new yn(mn(3.2404542*u-1.5371385*r-.4985314*i),mn(-.969266*u+1.8760108*r+.041556*i),mn(.0556434*u-.2040259*r+1.0572252*i))}function pn(n,t,e){return n>0?new sn(Math.atan2(e,t)*Ia,Math.sqrt(t*t+e*e),n):new sn(NaN,NaN,n)}function vn(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function dn(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function mn(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function yn(n,t,e){return this instanceof yn?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof yn?new yn(n.r,n.g,n.b):_n(""+n,yn,cn):new yn(n,t,e)}function Mn(n){return new yn(n>>16,n>>8&255,255&n)}function xn(n){return Mn(n)+""}function bn(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function _n(n,t,e){var r,u,i,a=0,o=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase()))switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(Nn(u[0]),Nn(u[1]),Nn(u[2]))}return(i=ro.get(n))?t(i.r,i.g,i.b):(null==n||"#"!==n.charAt(0)||isNaN(i=parseInt(n.slice(1),16))||(4===n.length?(a=(3840&i)>>4,a=a>>4|a,o=240&i,o=o>>4|o,l=15&i,l=l<<4|l):7===n.length&&(a=(16711680&i)>>16,o=(65280&i)>>8,l=255&i)),t(a,o,l))}function wn(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),a=Math.max(n,t,e),o=a-i,l=(a+i)/2;return o?(u=.5>l?o/(a+i):o/(2-a-i),r=n==a?(t-e)/o+(e>t?6:0):t==a?(e-n)/o+2:(n-t)/o+4,r*=60):(r=NaN,u=l>0&&1>l?0:r),new ln(r,u,l)}function Sn(n,t,e){n=kn(n),t=kn(t),e=kn(e);var r=dn((.4124564*n+.3575761*t+.1804375*e)/Ka),u=dn((.2126729*n+.7151522*t+.072175*e)/Qa),i=dn((.0193339*n+.119192*t+.9503041*e)/no);return hn(116*u-16,500*(r-u),200*(u-i))}function kn(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Nn(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function En(n){return"function"==typeof n?n:function(){return n}}function An(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),Cn(t,e,n,r)}}function Cn(n,t,e,r){function u(){var n,t=l.status;if(!t&&Ln(l)||t>=200&&300>t||304===t){try{n=e.call(i,l)}catch(r){return void a.error.call(i,r)}a.load.call(i,n)}else a.error.call(i,l)}var i={},a=oa.dispatch("beforesend","progress","load","error"),o={},l=new XMLHttpRequest,c=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(n)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=u:l.onreadystatechange=function(){l.readyState>3&&u()},l.onprogress=function(n){var t=oa.event;oa.event=n;try{a.progress.call(i,l)}finally{oa.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?o[n]:(null==t?delete o[n]:o[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(c=n,i):c},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(ca(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),l.open(e,n,!0),null==t||"accept"in o||(o.accept=t+",*/*"),l.setRequestHeader)for(var s in o)l.setRequestHeader(s,o[s]);return null!=t&&l.overrideMimeType&&l.overrideMimeType(t),null!=c&&(l.responseType=c),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),a.beforesend.call(i,l),l.send(null==r?null:r),i},i.abort=function(){return l.abort(),i},oa.rebind(i,a,"on"),null==r?i:i.get(zn(r))}function zn(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function Ln(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function qn(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={c:n,t:u,n:null};return io?io.n=i:uo=i,io=i,ao||(oo=clearTimeout(oo),ao=1,lo(Tn)),i}function Tn(){var n=Rn(),t=Dn()-n;t>24?(isFinite(t)&&(clearTimeout(oo),oo=setTimeout(Tn,t)),ao=0):(ao=1,lo(Tn))}function Rn(){for(var n=Date.now(),t=uo;t;)n>=t.t&&t.c(n-t.t)&&(t.c=null),t=t.n;return n}function Dn(){for(var n,t=uo,e=1/0;t;)t.c?(t.t<e&&(e=t.t),t=(n=t).n):t=n?n.n=t.n:uo=t.n;return io=n,e}function Pn(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Un(n,t){var e=Math.pow(10,3*Ma(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function jn(n){var t=n.decimal,e=n.thousands,r=n.grouping,u=n.currency,i=r&&e?function(n,t){for(var u=n.length,i=[],a=0,o=r[0],l=0;u>0&&o>0&&(l+o+1>t&&(o=Math.max(1,t-l)),i.push(n.substring(u-=o,u+o)),!((l+=o+1)>t));)o=r[a=(a+1)%r.length];return i.reverse().join(e)}:y;return function(n){var e=so.exec(n),r=e[1]||" ",a=e[2]||">",o=e[3]||"-",l=e[4]||"",c=e[5],s=+e[6],f=e[7],h=e[8],g=e[9],p=1,v="",d="",m=!1,y=!0;switch(h&&(h=+h.substring(1)),(c||"0"===r&&"="===a)&&(c=r="0",a="="),g){case"n":f=!0,g="g";break;case"%":p=100,d="%",g="f";break;case"p":p=100,d="%",g="r";break;case"b":case"o":case"x":case"X":"#"===l&&(v="0"+g.toLowerCase());case"c":y=!1;case"d":m=!0,h=0;break;case"s":p=-1,g="r"}"$"===l&&(v=u[0],d=u[1]),"r"!=g||h||(g="g"),null!=h&&("g"==g?h=Math.max(1,Math.min(21,h)):("e"==g||"f"==g)&&(h=Math.max(0,Math.min(20,h)))),g=fo.get(g)||Fn;var M=c&&f;return function(n){var e=d;if(m&&n%1)return"";var u=0>n||0===n&&0>1/n?(n=-n,"-"):"-"===o?"":o;if(0>p){var l=oa.formatPrefix(n,h);n=l.scale(n),e=l.symbol+d}else n*=p;n=g(n,h);var x,b,_=n.lastIndexOf(".");if(0>_){var w=y?n.lastIndexOf("e"):-1;0>w?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!c&&f&&(x=i(x,1/0));var S=v.length+x.length+b.length+(M?0:u.length),k=s>S?new Array(S=s-S+1).join(r):"";return M&&(x=i(k+x,k.length?s-b.length:1/0)),u+=v,n=x+b,("<"===a?u+n+k:">"===a?k+u+n:"^"===a?k.substring(0,S>>=1)+u+n+k.substring(S):u+(M?n:k+n))+e}}}function Fn(n){return n+""}function Hn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function On(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new go(e-1)),1),e}function i(n,e){return t(n=new go(+n),e),n}function a(n,r,i){var a=u(n),o=[];if(i>1)for(;r>a;)e(a)%i||o.push(new Date(+a)),t(a,1);else for(;r>a;)o.push(new Date(+a)),t(a,1);return o}function o(n,t,e){try{go=Hn;var r=new Hn;return r._=n,a(r,t,e)}finally{go=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=a;var l=n.utc=In(n);return l.floor=l,l.round=In(r),l.ceil=In(u),l.offset=In(i),l.range=o,n}function In(n){return function(t,e){try{go=Hn;var r=new Hn;return r._=t,n(r,e)._}finally{go=Date}}}function Yn(n){function t(n){function t(t){for(var e,u,i,a=[],o=-1,l=0;++o<r;)37===n.charCodeAt(o)&&(a.push(n.slice(l,o)),null!=(u=vo[e=n.charAt(++o)])&&(e=n.charAt(++o)),(i=A[e])&&(e=i(t,null==u?"e"===e?" ":"0":u)),a.push(e),l=o+1);return a.push(n.slice(l,o)),a.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},u=e(r,n,t,0);if(u!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&go!==Hn,a=new(i?Hn:go);return"j"in r?a.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),a.setFullYear(r.y,0,1),a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(a.getDay()+5)%7:r.w+7*r.U-(a.getDay()+6)%7)):a.setFullYear(r.y,r.m,r.d),a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),i?a._:a},t.toString=function(){return n},t}function e(n,t,e,r){for(var u,i,a,o=0,l=t.length,c=e.length;l>o;){if(r>=c)return-1;if(u=t.charCodeAt(o++),37===u){if(a=t.charAt(o++),i=C[a in vo?t.charAt(o++):a],!i||(r=i(n,e,r))<0)return-1}else if(u!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){_.lastIndex=0;var r=_.exec(t.slice(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){x.lastIndex=0;var r=x.exec(t.slice(e));return r?(n.w=b.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){N.lastIndex=0;var r=N.exec(t.slice(e));return r?(n.m=E.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,e){S.lastIndex=0;var r=S.exec(t.slice(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,r){return e(n,A.c.toString(),t,r)}function l(n,t,r){return e(n,A.x.toString(),t,r)}function c(n,t,r){return e(n,A.X.toString(),t,r)}function s(n,t,e){var r=M.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var f=n.dateTime,h=n.date,g=n.time,p=n.periods,v=n.days,d=n.shortDays,m=n.months,y=n.shortMonths;t.utc=function(n){function e(n){try{go=Hn;var t=new go;return t._=n,r(t)}finally{go=Date}}var r=t(n);return e.parse=function(n){try{go=Hn;var t=r.parse(n);return t&&t._}finally{go=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=ct;var M=oa.map(),x=Vn(v),b=Xn(v),_=Vn(d),w=Xn(d),S=Vn(m),k=Xn(m),N=Vn(y),E=Xn(y);p.forEach(function(n,t){M.set(n.toLowerCase(),t)});var A={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return y[n.getMonth()]},B:function(n){return m[n.getMonth()]},c:t(f),d:function(n,t){return Zn(n.getDate(),t,2)},e:function(n,t){return Zn(n.getDate(),t,2)},H:function(n,t){return Zn(n.getHours(),t,2)},I:function(n,t){return Zn(n.getHours()%12||12,t,2)},j:function(n,t){return Zn(1+ho.dayOfYear(n),t,3)},L:function(n,t){return Zn(n.getMilliseconds(),t,3)},m:function(n,t){return Zn(n.getMonth()+1,t,2)},M:function(n,t){return Zn(n.getMinutes(),t,2)},p:function(n){return p[+(n.getHours()>=12)]},S:function(n,t){return Zn(n.getSeconds(),t,2)},U:function(n,t){return Zn(ho.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return Zn(ho.mondayOfYear(n),t,2)},x:t(h),X:t(g),y:function(n,t){return Zn(n.getFullYear()%100,t,2)},Y:function(n,t){return Zn(n.getFullYear()%1e4,t,4)},Z:ot,"%":function(){return"%"}},C={a:r,A:u,b:i,B:a,c:o,d:tt,e:tt,H:rt,I:rt,j:et,L:at,m:nt,M:ut,p:s,S:it,U:Bn,w:$n,W:Wn,x:l,X:c,y:Gn,Y:Jn,Z:Kn,"%":lt};return t}function Zn(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function Vn(n){return new RegExp("^(?:"+n.map(oa.requote).join("|")+")","i")}function Xn(n){for(var t=new c,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function $n(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Bn(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function Wn(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Jn(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Gn(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+2));return r?(n.y=Qn(+r[0]),e+r[0].length):-1}function Kn(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Qn(n){return n+(n>68?1900:2e3)}function nt(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function tt(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function et(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function rt(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function ut(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function it(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function at(n,t,e){mo.lastIndex=0;var r=mo.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function ot(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=Ma(t)/60|0,u=Ma(t)%60;return e+Zn(r,"0",2)+Zn(u,"0",2)}function lt(n,t,e){yo.lastIndex=0;var r=yo.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function ct(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function st(){}function ft(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function ht(n,t){n&&_o.hasOwnProperty(n.type)&&_o[n.type](n,t)}function gt(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function pt(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)gt(n[e],t,1);t.polygonEnd()}function vt(){function n(n,t){n*=Oa,t=t*Oa/2+Ua/4;var e=n-r,a=e>=0?1:-1,o=a*e,l=Math.cos(t),c=Math.sin(t),s=i*c,f=u*l+s*Math.cos(o),h=s*a*Math.sin(o);So.add(Math.atan2(h,f)),r=n,u=l,i=c}var t,e,r,u,i;ko.point=function(a,o){ko.point=n,r=(t=a)*Oa,u=Math.cos(o=(e=o)*Oa/2+Ua/4),i=Math.sin(o)},ko.lineEnd=function(){n(t,e)}}function dt(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function mt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function yt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Mt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function xt(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function bt(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function _t(n){return[Math.atan2(n[1],n[0]),tn(n[2])]}function wt(n,t){return Ma(n[0]-t[0])<Da&&Ma(n[1]-t[1])<Da}function St(n,t){n*=Oa;var e=Math.cos(t*=Oa);kt(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function kt(n,t,e){++No,Ao+=(n-Ao)/No,Co+=(t-Co)/No,zo+=(e-zo)/No}function Nt(){function n(n,u){n*=Oa;var i=Math.cos(u*=Oa),a=i*Math.cos(n),o=i*Math.sin(n),l=Math.sin(u),c=Math.atan2(Math.sqrt((c=e*l-r*o)*c+(c=r*a-t*l)*c+(c=t*o-e*a)*c),t*a+e*o+r*l);Eo+=c,Lo+=c*(t+(t=a)),qo+=c*(e+(e=o)),To+=c*(r+(r=l)),kt(t,e,r)}var t,e,r;Uo.point=function(u,i){u*=Oa;var a=Math.cos(i*=Oa);t=a*Math.cos(u),e=a*Math.sin(u),r=Math.sin(i),Uo.point=n,kt(t,e,r)}}function Et(){Uo.point=St}function At(){function n(n,t){n*=Oa;var e=Math.cos(t*=Oa),a=e*Math.cos(n),o=e*Math.sin(n),l=Math.sin(t),c=u*l-i*o,s=i*a-r*l,f=r*o-u*a,h=Math.sqrt(c*c+s*s+f*f),g=r*a+u*o+i*l,p=h&&-nn(g)/h,v=Math.atan2(h,g);Ro+=p*c,Do+=p*s,Po+=p*f,Eo+=v,Lo+=v*(r+(r=a)),qo+=v*(u+(u=o)),To+=v*(i+(i=l)),kt(r,u,i)}var t,e,r,u,i;Uo.point=function(a,o){t=a,e=o,Uo.point=n,a*=Oa;var l=Math.cos(o*=Oa);r=l*Math.cos(a),u=l*Math.sin(a),i=Math.sin(o),kt(r,u,i)},Uo.lineEnd=function(){n(t,e),Uo.lineEnd=Et,Uo.point=St}}function Ct(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function zt(){return!0}function Lt(n,t,e,r,u){var i=[],a=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(wt(e,r)){u.lineStart();for(var o=0;t>o;++o)u.point((e=n[o])[0],e[1]);return void u.lineEnd()}var l=new Tt(e,n,null,!0),c=new Tt(e,null,l,!1);l.o=c,i.push(l),a.push(c),l=new Tt(r,n,null,!1),c=new Tt(r,null,l,!0),l.o=c,i.push(l),a.push(c)}}),a.sort(t),qt(i),qt(a),i.length){for(var o=0,l=e,c=a.length;c>o;++o)a[o].e=l=!l;for(var s,f,h=i[0];;){for(var g=h,p=!0;g.v;)if((g=g.n)===h)return;s=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(p)for(var o=0,c=s.length;c>o;++o)u.point((f=s[o])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(p){s=g.p.z;for(var o=s.length-1;o>=0;--o)u.point((f=s[o])[0],f[1])}else r(g.x,g.p.x,-1,u);g=g.p}g=g.o,s=g.z,p=!p}while(!g.v);u.lineEnd()}}}function qt(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;)u.n=e=n[r],e.p=u,u=e;u.n=e=n[0],e.p=u}}function Tt(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Rt(n,t,e,r){return function(u,i){function a(t,e){var r=u(t,e);n(t=r[0],e=r[1])&&i.point(t,e)}function o(n,t){var e=u(n,t);d.point(e[0],e[1])}function l(){y.point=o,d.lineStart()}function c(){y.point=a,d.lineEnd()}function s(n,t){v.push([n,t]);var e=u(n,t);x.point(e[0],e[1])}function f(){x.lineStart(),v=[]}function h(){s(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),p.push(v),v=null,r)if(1&t){n=e[0];var u,r=n.length-1,a=-1;if(r>0){for(b||(i.polygonStart(),b=!0),i.lineStart();++a<r;)i.point((u=n[a])[0],u[1]);i.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),g.push(e.filter(Dt))}var g,p,v,d=t(i),m=u.invert(r[0],r[1]),y={point:a,lineStart:l,lineEnd:c,polygonStart:function(){y.point=s,y.lineStart=f,y.lineEnd=h,g=[],p=[]},polygonEnd:function(){y.point=a,y.lineStart=l,y.lineEnd=c,g=oa.merge(g);var n=Ot(m,p);g.length?(b||(i.polygonStart(),b=!0),Lt(g,Ut,n,e,i)):n&&(b||(i.polygonStart(),b=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),b&&(i.polygonEnd(),b=!1),g=p=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}},M=Pt(),x=t(M),b=!1;return y}}function Dt(n){return n.length>1}function Pt(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:b,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Ut(n,t){return((n=n.x)[0]<0?n[1]-Ha-Da:Ha-n[1])-((t=t.x)[0]<0?t[1]-Ha-Da:Ha-t[1])}function jt(n){var t,e=NaN,r=NaN,u=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(i,a){var o=i>0?Ua:-Ua,l=Ma(i-e);Ma(l-Ua)<Da?(n.point(e,r=(r+a)/2>0?Ha:-Ha),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(o,r),n.point(i,r),t=0):u!==o&&l>=Ua&&(Ma(e-u)<Da&&(e-=u*Da),Ma(i-o)<Da&&(i-=o*Da),r=Ft(e,r,i,a),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(o,r),t=0),n.point(e=i,r=a),u=o},lineEnd:function(){n.lineEnd(),e=r=NaN},clean:function(){return 2-t}}}function Ft(n,t,e,r){var u,i,a=Math.sin(n-e);return Ma(a)>Da?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*a)):(t+r)/2}function Ht(n,t,e,r){var u;if(null==n)u=e*Ha,r.point(-Ua,u),r.point(0,u),r.point(Ua,u),r.point(Ua,0),r.point(Ua,-u),r.point(0,-u),r.point(-Ua,-u),r.point(-Ua,0),r.point(-Ua,u);else if(Ma(n[0]-t[0])>Da){var i=n[0]<t[0]?Ua:-Ua;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else r.point(t[0],t[1])}function Ot(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,a=0;So.reset();for(var o=0,l=t.length;l>o;++o){var c=t[o],s=c.length;if(s)for(var f=c[0],h=f[0],g=f[1]/2+Ua/4,p=Math.sin(g),v=Math.cos(g),d=1;;){d===s&&(d=0),n=c[d];var m=n[0],y=n[1]/2+Ua/4,M=Math.sin(y),x=Math.cos(y),b=m-h,_=b>=0?1:-1,w=_*b,S=w>Ua,k=p*M;if(So.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),i+=S?b+_*ja:b,S^h>=e^m>=e){var N=yt(dt(f),dt(n));bt(N);var E=yt(u,N);bt(E);var A=(S^b>=0?-1:1)*tn(E[2]);(r>A||r===A&&(N[0]||N[1]))&&(a+=S^b>=0?1:-1)}if(!d++)break;h=m,p=M,v=x,f=n}}return(-Da>i||Da>i&&0>So)^1&a}function It(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n){var e,i,l,c,s;return{lineStart:function(){c=l=!1,s=1},point:function(f,h){var g,p=[f,h],v=t(f,h),d=a?v?0:u(f,h):v?u(f+(0>f?Ua:-Ua),h):0;if(!e&&(c=l=v)&&n.lineStart(),v!==l&&(g=r(e,p),(wt(e,g)||wt(p,g))&&(p[0]+=Da,p[1]+=Da,v=t(p[0],p[1]))),v!==l)s=0,v?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g;else if(o&&e&&a^v){var m;d&i||!(m=r(p,e,!0))||(s=0,a?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}!v||e&&wt(e,p)||n.point(p[0],p[1]),e=p,l=v,i=d},lineEnd:function(){l&&n.lineEnd(),e=null},clean:function(){return s|(c&&l)<<1}}}function r(n,t,e){var r=dt(n),u=dt(t),a=[1,0,0],o=yt(r,u),l=mt(o,o),c=o[0],s=l-c*c;if(!s)return!e&&n;var f=i*l/s,h=-i*c/s,g=yt(a,o),p=xt(a,f),v=xt(o,h);Mt(p,v);var d=g,m=mt(p,d),y=mt(d,d),M=m*m-y*(mt(p,p)-1);if(!(0>M)){var x=Math.sqrt(M),b=xt(d,(-m-x)/y);if(Mt(b,p),b=_t(b),!e)return b;var _,w=n[0],S=t[0],k=n[1],N=t[1];w>S&&(_=w,w=S,S=_);var E=S-w,A=Ma(E-Ua)<Da,C=A||Da>E;if(!A&&k>N&&(_=k,k=N,N=_),C?A?k+N>0^b[1]<(Ma(b[0]-w)<Da?k:N):k<=b[1]&&b[1]<=N:E>Ua^(w<=b[0]&&b[0]<=S)){var z=xt(d,(-m+x)/y);return Mt(z,p),[b,_t(z)]}}}function u(t,e){var r=a?n:Ua-n,u=0;return-r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}var i=Math.cos(n),a=i>0,o=Ma(i)>Da,l=ve(n,6*Oa);return Rt(t,e,l,a?[0,-n]:[-Ua,n-Ua])}function Yt(n,t,e,r){return function(u){var i,a=u.a,o=u.b,l=a.x,c=a.y,s=o.x,f=o.y,h=0,g=1,p=s-l,v=f-c;if(i=n-l,p||!(i>0)){if(i/=p,0>p){if(h>i)return;g>i&&(g=i)}else if(p>0){if(i>g)return;i>h&&(h=i)}if(i=e-l,p||!(0>i)){if(i/=p,0>p){if(i>g)return;i>h&&(h=i)}else if(p>0){if(h>i)return;g>i&&(g=i)}if(i=t-c,v||!(i>0)){if(i/=v,0>v){if(h>i)return;g>i&&(g=i)}else if(v>0){if(i>g)return;i>h&&(h=i)}if(i=r-c,v||!(0>i)){if(i/=v,0>v){if(i>g)return;i>h&&(h=i)}else if(v>0){if(h>i)return;g>i&&(g=i)}return h>0&&(u.a={x:l+h*p,y:c+h*v}),1>g&&(u.b={x:l+g*p,y:c+g*v}),u}}}}}}function Zt(n,t,e,r){function u(r,u){return Ma(r[0]-n)<Da?u>0?0:3:Ma(r[0]-e)<Da?u>0?2:1:Ma(r[1]-t)<Da?u>0?1:0:u>0?3:2}function i(n,t){return a(n.x,t.x)}function a(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(o){function l(n){for(var t=0,e=d.length,r=n[1],u=0;e>u;++u)for(var i,a=1,o=d[u],l=o.length,c=o[0];l>a;++a)i=o[a],c[1]<=r?i[1]>r&&Q(c,i,n)>0&&++t:i[1]<=r&&Q(c,i,n)<0&&--t,c=i;return 0!==t}function c(i,o,l,c){var s=0,f=0;if(null==i||(s=u(i,l))!==(f=u(o,l))||a(i,o)<0^l>0){do c.point(0===s||3===s?n:e,s>1?r:t);while((s=(s+l+4)%4)!==f)}else c.point(o[0],o[1])}function s(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function f(n,t){s(n,t)&&o.point(n,t)}function h(){C.point=p,d&&d.push(m=[]),S=!0,w=!1,b=_=NaN}function g(){v&&(p(y,M),x&&w&&E.rejoin(),v.push(E.buffer())),C.point=f,w&&o.lineEnd()}function p(n,t){n=Math.max(-Fo,Math.min(Fo,n)),t=Math.max(-Fo,Math.min(Fo,t));var e=s(n,t);if(d&&m.push([n,t]),S)y=n,M=t,x=e,S=!1,e&&(o.lineStart(),o.point(n,t));else if(e&&w)o.point(n,t);else{var r={a:{x:b,y:_},b:{x:n,y:t}};A(r)?(w||(o.lineStart(),o.point(r.a.x,r.a.y)),o.point(r.b.x,r.b.y),e||o.lineEnd(),k=!1):e&&(o.lineStart(),o.point(n,t),k=!1)}b=n,_=t,w=e}var v,d,m,y,M,x,b,_,w,S,k,N=o,E=Pt(),A=Yt(n,t,e,r),C={point:f,lineStart:h,lineEnd:g,polygonStart:function(){o=E,v=[],d=[],k=!0},polygonEnd:function(){o=N,v=oa.merge(v);var t=l([n,r]),e=k&&t,u=v.length;(e||u)&&(o.polygonStart(),e&&(o.lineStart(),c(null,null,1,o),o.lineEnd()),u&&Lt(v,i,t,c,o),o.polygonEnd()),v=d=m=null}};return C}}function Vt(n){var t=0,e=Ua/3,r=oe(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*Ua/180,e=n[1]*Ua/180):[t/Ua*180,e/Ua*180]},u}function Xt(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),a-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),a=Math.sqrt(i)/u;return e.invert=function(n,t){var e=a-t;return[Math.atan2(n,e)/u,tn((i-(n*n+e*e)*u*u)/(2*u))]},e}function $t(){function n(n,t){Oo+=u*n-r*t,r=n,u=t}var t,e,r,u;Xo.point=function(i,a){Xo.point=n,t=r=i,e=u=a},Xo.lineEnd=function(){n(t,e)}}function Bt(n,t){Io>n&&(Io=n),n>Zo&&(Zo=n),Yo>t&&(Yo=t),t>Vo&&(Vo=t)}function Wt(){function n(n,t){a.push("M",n,",",t,i)}function t(n,t){a.push("M",n,",",t),o.point=e}function e(n,t){a.push("L",n,",",t)}function r(){o.point=n}function u(){a.push("Z")}var i=Jt(4.5),a=[],o={point:n,lineStart:function(){o.point=t},lineEnd:r,polygonStart:function(){o.lineEnd=u},polygonEnd:function(){o.lineEnd=r,o.point=n},pointRadius:function(n){return i=Jt(n),o},result:function(){if(a.length){var n=a.join("");return a=[],n}}};return o}function Jt(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Gt(n,t){Ao+=n,Co+=t,++zo}function Kt(){function n(n,r){var u=n-t,i=r-e,a=Math.sqrt(u*u+i*i);Lo+=a*(t+n)/2,qo+=a*(e+r)/2,To+=a,Gt(t=n,e=r)}var t,e;Bo.point=function(r,u){Bo.point=n,Gt(t=r,e=u)}}function Qt(){Bo.point=Gt}function ne(){function n(n,t){var e=n-r,i=t-u,a=Math.sqrt(e*e+i*i);Lo+=a*(r+n)/2,qo+=a*(u+t)/2,To+=a,a=u*n-r*t,Ro+=a*(r+n),Do+=a*(u+t),Po+=3*a,Gt(r=n,u=t)}var t,e,r,u;Bo.point=function(i,a){Bo.point=n,Gt(t=r=i,e=u=a)},Bo.lineEnd=function(){n(t,e)}}function te(n){function t(t,e){n.moveTo(t+a,e),n.arc(t,e,a,0,ja)}function e(t,e){n.moveTo(t,e),o.point=r}function r(t,e){n.lineTo(t,e)}function u(){o.point=t}function i(){n.closePath()}var a=4.5,o={point:t,lineStart:function(){o.point=e},lineEnd:u,polygonStart:function(){o.lineEnd=i},polygonEnd:function(){o.lineEnd=u,o.point=t},pointRadius:function(n){return a=n,o},result:b};return o}function ee(n){function t(n){return(o?r:e)(n)}function e(t){return ie(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){M=NaN,S.point=i,t.lineStart()}function i(e,r){var i=dt([e,r]),a=n(e,r);u(M,x,y,b,_,w,M=a[0],x=a[1],y=e,b=i[0],_=i[1],w=i[2],o,t),t.point(M,x)}function a(){S.point=e,t.lineEnd()}function l(){
r(),S.point=c,S.lineEnd=s}function c(n,t){i(f=n,h=t),g=M,p=x,v=b,d=_,m=w,S.point=i}function s(){u(M,x,y,b,_,w,g,p,f,v,d,m,o,t),S.lineEnd=a,a()}var f,h,g,p,v,d,m,y,M,x,b,_,w,S={point:e,lineStart:r,lineEnd:a,polygonStart:function(){t.polygonStart(),S.lineStart=l},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function u(t,e,r,o,l,c,s,f,h,g,p,v,d,m){var y=s-t,M=f-e,x=y*y+M*M;if(x>4*i&&d--){var b=o+g,_=l+p,w=c+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),N=Ma(Ma(w)-1)<Da||Ma(r-h)<Da?(r+h)/2:Math.atan2(_,b),E=n(N,k),A=E[0],C=E[1],z=A-t,L=C-e,q=M*z-y*L;(q*q/x>i||Ma((y*z+M*L)/x-.5)>.3||a>o*g+l*p+c*v)&&(u(t,e,r,o,l,c,A,C,N,b/=S,_/=S,w,d,m),m.point(A,C),u(A,C,N,b,_,w,s,f,h,g,p,v,d,m))}}var i=.5,a=Math.cos(30*Oa),o=16;return t.precision=function(n){return arguments.length?(o=(i=n*n)>0&&16,t):Math.sqrt(i)},t}function re(n){var t=ee(function(t,e){return n([t*Ia,e*Ia])});return function(n){return le(t(n))}}function ue(n){this.stream=n}function ie(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function ae(n){return oe(function(){return n})()}function oe(n){function t(n){return n=o(n[0]*Oa,n[1]*Oa),[n[0]*h+l,c-n[1]*h]}function e(n){return n=o.invert((n[0]-l)/h,(c-n[1])/h),n&&[n[0]*Ia,n[1]*Ia]}function r(){o=Ct(a=fe(m,M,x),i);var n=i(v,d);return l=g-n[0]*h,c=p+n[1]*h,u()}function u(){return s&&(s.valid=!1,s=null),t}var i,a,o,l,c,s,f=ee(function(n,t){return n=i(n,t),[n[0]*h+l,c-n[1]*h]}),h=150,g=480,p=250,v=0,d=0,m=0,M=0,x=0,b=jo,_=y,w=null,S=null;return t.stream=function(n){return s&&(s.valid=!1),s=le(b(a,f(_(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(b=null==n?(w=n,jo):It((w=+n)*Oa),u()):w},t.clipExtent=function(n){return arguments.length?(S=n,_=n?Zt(n[0][0],n[0][1],n[1][0],n[1][1]):y,u()):S},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(v=n[0]%360*Oa,d=n[1]%360*Oa,r()):[v*Ia,d*Ia]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Oa,M=n[1]%360*Oa,x=n.length>2?n[2]%360*Oa:0,r()):[m*Ia,M*Ia,x*Ia]},oa.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function le(n){return ie(n,function(t,e){n.point(t*Oa,e*Oa)})}function ce(n,t){return[n,t]}function se(n,t){return[n>Ua?n-ja:-Ua>n?n+ja:n,t]}function fe(n,t,e){return n?t||e?Ct(ge(n),pe(t,e)):ge(n):t||e?pe(t,e):se}function he(n){return function(t,e){return t+=n,[t>Ua?t-ja:-Ua>t?t+ja:t,e]}}function ge(n){var t=he(n);return t.invert=he(-n),t}function pe(n,t){function e(n,t){var e=Math.cos(t),o=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),s=c*r+o*u;return[Math.atan2(l*i-s*a,o*r-c*u),tn(s*i+l*a)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),a=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),o=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),s=c*i-l*a;return[Math.atan2(l*i+c*a,o*r+s*u),tn(s*r-o*u)]},e}function ve(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,a,o){var l=a*t;null!=u?(u=de(e,u),i=de(e,i),(a>0?i>u:u>i)&&(u+=a*ja)):(u=n+a*ja,i=n-.5*l);for(var c,s=u;a>0?s>i:i>s;s-=l)o.point((c=_t([e,-r*Math.cos(s),-r*Math.sin(s)]))[0],c[1])}}function de(n,t){var e=dt(t);e[0]-=n,bt(e);var r=nn(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Da)%(2*Math.PI)}function me(n,t,e){var r=oa.range(n,t-Da,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function ye(n,t,e){var r=oa.range(n,t-Da,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function Me(n){return n.source}function xe(n){return n.target}function be(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),a=Math.cos(r),o=Math.sin(r),l=u*Math.cos(n),c=u*Math.sin(n),s=a*Math.cos(e),f=a*Math.sin(e),h=2*Math.asin(Math.sqrt(an(r-t)+u*a*an(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*l+t*s,u=e*c+t*f,a=e*i+t*o;return[Math.atan2(u,r)*Ia,Math.atan2(a,Math.sqrt(r*r+u*u))*Ia]}:function(){return[n*Ia,t*Ia]};return p.distance=h,p}function _e(){function n(n,u){var i=Math.sin(u*=Oa),a=Math.cos(u),o=Ma((n*=Oa)-t),l=Math.cos(o);Wo+=Math.atan2(Math.sqrt((o=a*Math.sin(o))*o+(o=r*i-e*a*l)*o),e*i+r*a*l),t=n,e=i,r=a}var t,e,r;Jo.point=function(u,i){t=u*Oa,e=Math.sin(i*=Oa),r=Math.cos(i),Jo.point=n},Jo.lineEnd=function(){Jo.point=Jo.lineEnd=b}}function we(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),a=Math.cos(u);return[Math.atan2(n*i,r*a),Math.asin(r&&e*i/r)]},e}function Se(n,t){function e(n,t){a>0?-Ha+Da>t&&(t=-Ha+Da):t>Ha-Da&&(t=Ha-Da);var e=a/Math.pow(u(t),i);return[e*Math.sin(i*n),a-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(Ua/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),a=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=a-t,r=K(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(a/r,1/i))-Ha]},e):Ne}function ke(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return Ma(u)<Da?ce:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-K(u)*Math.sqrt(n*n+e*e)]},e)}function Ne(n,t){return[n,Math.log(Math.tan(Ua/4+t/2))]}function Ee(n){var t,e=ae(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var a=i.apply(e,arguments);if(a===e){if(t=null==n){var o=Ua*r(),l=u();i([[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]])}}else t&&(a=null);return a},e.clipExtent(null)}function Ae(n,t){return[Math.log(Math.tan(Ua/4+t/2)),-n]}function Ce(n){return n[0]}function ze(n){return n[1]}function Le(n){for(var t=n.length,e=[0,1],r=2,u=2;t>u;u++){for(;r>1&&Q(n[e[r-2]],n[e[r-1]],n[u])<=0;)--r;e[r++]=u}return e.slice(0,r)}function qe(n,t){return n[0]-t[0]||n[1]-t[1]}function Te(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Re(n,t,e,r){var u=n[0],i=e[0],a=t[0]-u,o=r[0]-i,l=n[1],c=e[1],s=t[1]-l,f=r[1]-c,h=(o*(l-c)-f*(u-i))/(f*a-o*s);return[u+h*a,l+h*s]}function De(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function Pe(){rr(this),this.edge=this.site=this.circle=null}function Ue(n){var t=ll.pop()||new Pe;return t.site=n,t}function je(n){Be(n),il.remove(n),ll.push(n),rr(n)}function Fe(n){var t=n.circle,e=t.x,r=t.cy,u={x:e,y:r},i=n.P,a=n.N,o=[n];je(n);for(var l=i;l.circle&&Ma(e-l.circle.x)<Da&&Ma(r-l.circle.cy)<Da;)i=l.P,o.unshift(l),je(l),l=i;o.unshift(l),Be(l);for(var c=a;c.circle&&Ma(e-c.circle.x)<Da&&Ma(r-c.circle.cy)<Da;)a=c.N,o.push(c),je(c),c=a;o.push(c),Be(c);var s,f=o.length;for(s=1;f>s;++s)c=o[s],l=o[s-1],nr(c.edge,l.site,c.site,u);l=o[0],c=o[f-1],c.edge=Ke(l.site,c.site,null,u),$e(l),$e(c)}function He(n){for(var t,e,r,u,i=n.x,a=n.y,o=il._;o;)if(r=Oe(o,a)-i,r>Da)o=o.L;else{if(u=i-Ie(o,a),!(u>Da)){r>-Da?(t=o.P,e=o):u>-Da?(t=o,e=o.N):t=e=o;break}if(!o.R){t=o;break}o=o.R}var l=Ue(n);if(il.insert(t,l),t||e){if(t===e)return Be(t),e=Ue(t.site),il.insert(l,e),l.edge=e.edge=Ke(t.site,l.site),$e(t),void $e(e);if(!e)return void(l.edge=Ke(t.site,l.site));Be(t),Be(e);var c=t.site,s=c.x,f=c.y,h=n.x-s,g=n.y-f,p=e.site,v=p.x-s,d=p.y-f,m=2*(h*d-g*v),y=h*h+g*g,M=v*v+d*d,x={x:(d*y-g*M)/m+s,y:(h*M-v*y)/m+f};nr(e.edge,c,p,x),l.edge=Ke(c,n,null,x),e.edge=Ke(n,p,null,x),$e(t),$e(e)}}function Oe(n,t){var e=n.site,r=e.x,u=e.y,i=u-t;if(!i)return r;var a=n.P;if(!a)return-(1/0);e=a.site;var o=e.x,l=e.y,c=l-t;if(!c)return o;var s=o-r,f=1/i-1/c,h=s/c;return f?(-h+Math.sqrt(h*h-2*f*(s*s/(-2*c)-l+c/2+u-i/2)))/f+r:(r+o)/2}function Ie(n,t){var e=n.N;if(e)return Oe(e,t);var r=n.site;return r.y===t?r.x:1/0}function Ye(n){this.site=n,this.edges=[]}function Ze(n){for(var t,e,r,u,i,a,o,l,c,s,f=n[0][0],h=n[1][0],g=n[0][1],p=n[1][1],v=ul,d=v.length;d--;)if(i=v[d],i&&i.prepare())for(o=i.edges,l=o.length,a=0;l>a;)s=o[a].end(),r=s.x,u=s.y,c=o[++a%l].start(),t=c.x,e=c.y,(Ma(r-t)>Da||Ma(u-e)>Da)&&(o.splice(a,0,new tr(Qe(i.site,s,Ma(r-f)<Da&&p-u>Da?{x:f,y:Ma(t-f)<Da?e:p}:Ma(u-p)<Da&&h-r>Da?{x:Ma(e-p)<Da?t:h,y:p}:Ma(r-h)<Da&&u-g>Da?{x:h,y:Ma(t-h)<Da?e:g}:Ma(u-g)<Da&&r-f>Da?{x:Ma(e-g)<Da?t:f,y:g}:null),i.site,null)),++l)}function Ve(n,t){return t.angle-n.angle}function Xe(){rr(this),this.x=this.y=this.arc=this.site=this.cy=null}function $e(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,u=n.site,i=e.site;if(r!==i){var a=u.x,o=u.y,l=r.x-a,c=r.y-o,s=i.x-a,f=i.y-o,h=2*(l*f-c*s);if(!(h>=-Pa)){var g=l*l+c*c,p=s*s+f*f,v=(f*g-c*p)/h,d=(l*p-s*g)/h,f=d+o,m=cl.pop()||new Xe;m.arc=n,m.site=u,m.x=v+a,m.y=f+Math.sqrt(v*v+d*d),m.cy=f,n.circle=m;for(var y=null,M=ol._;M;)if(m.y<M.y||m.y===M.y&&m.x<=M.x){if(!M.L){y=M.P;break}M=M.L}else{if(!M.R){y=M;break}M=M.R}ol.insert(y,m),y||(al=m)}}}}function Be(n){var t=n.circle;t&&(t.P||(al=t.N),ol.remove(t),cl.push(t),rr(t),n.circle=null)}function We(n){for(var t,e=rl,r=Yt(n[0][0],n[0][1],n[1][0],n[1][1]),u=e.length;u--;)t=e[u],(!Je(t,n)||!r(t)||Ma(t.a.x-t.b.x)<Da&&Ma(t.a.y-t.b.y)<Da)&&(t.a=t.b=null,e.splice(u,1))}function Je(n,t){var e=n.b;if(e)return!0;var r,u,i=n.a,a=t[0][0],o=t[1][0],l=t[0][1],c=t[1][1],s=n.l,f=n.r,h=s.x,g=s.y,p=f.x,v=f.y,d=(h+p)/2,m=(g+v)/2;if(v===g){if(a>d||d>=o)return;if(h>p){if(i){if(i.y>=c)return}else i={x:d,y:l};e={x:d,y:c}}else{if(i){if(i.y<l)return}else i={x:d,y:c};e={x:d,y:l}}}else if(r=(h-p)/(v-g),u=m-r*d,-1>r||r>1)if(h>p){if(i){if(i.y>=c)return}else i={x:(l-u)/r,y:l};e={x:(c-u)/r,y:c}}else{if(i){if(i.y<l)return}else i={x:(c-u)/r,y:c};e={x:(l-u)/r,y:l}}else if(v>g){if(i){if(i.x>=o)return}else i={x:a,y:r*a+u};e={x:o,y:r*o+u}}else{if(i){if(i.x<a)return}else i={x:o,y:r*o+u};e={x:a,y:r*a+u}}return n.a=i,n.b=e,!0}function Ge(n,t){this.l=n,this.r=t,this.a=this.b=null}function Ke(n,t,e,r){var u=new Ge(n,t);return rl.push(u),e&&nr(u,n,t,e),r&&nr(u,t,n,r),ul[n.i].edges.push(new tr(u,n,t)),ul[t.i].edges.push(new tr(u,t,n)),u}function Qe(n,t,e){var r=new Ge(n,null);return r.a=t,r.b=e,rl.push(r),r}function nr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function tr(n,t,e){var r=n.a,u=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function er(){this._=null}function rr(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function ur(n,t){var e=t,r=t.R,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function ir(n,t){var e=t,r=t.L,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function ar(n){for(;n.L;)n=n.L;return n}function or(n,t){var e,r,u,i=n.sort(lr).pop();for(rl=[],ul=new Array(n.length),il=new er,ol=new er;;)if(u=al,i&&(!u||i.y<u.y||i.y===u.y&&i.x<u.x))(i.x!==e||i.y!==r)&&(ul[i.i]=new Ye(i),He(i),e=i.x,r=i.y),i=n.pop();else{if(!u)break;Fe(u.arc)}t&&(We(t),Ze(t));var a={cells:ul,edges:rl};return il=ol=rl=ul=null,a}function lr(n,t){return t.y-n.y||t.x-n.x}function cr(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function sr(n){return n.x}function fr(n){return n.y}function hr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function gr(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var a=.5*(e+u),o=.5*(r+i),l=t.nodes;l[0]&&gr(n,l[0],e,r,a,o),l[1]&&gr(n,l[1],a,r,u,o),l[2]&&gr(n,l[2],e,o,a,i),l[3]&&gr(n,l[3],a,o,u,i)}}function pr(n,t,e,r,u,i,a){var o,l=1/0;return function c(n,s,f,h,g){if(!(s>i||f>a||r>h||u>g)){if(p=n.point){var p,v=t-n.x,d=e-n.y,m=v*v+d*d;if(l>m){var y=Math.sqrt(l=m);r=t-y,u=e-y,i=t+y,a=e+y,o=p}}for(var M=n.nodes,x=.5*(s+h),b=.5*(f+g),_=t>=x,w=e>=b,S=w<<1|_,k=S+4;k>S;++S)if(n=M[3&S])switch(3&S){case 0:c(n,s,f,x,b);break;case 1:c(n,x,f,h,b);break;case 2:c(n,s,b,x,g);break;case 3:c(n,x,b,h,g)}}}(n,r,u,i,a),o}function vr(n,t){n=oa.rgb(n),t=oa.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,a=t.g-r,o=t.b-u;return function(n){return"#"+bn(Math.round(e+i*n))+bn(Math.round(r+a*n))+bn(Math.round(u+o*n))}}function dr(n,t){var e,r={},u={};for(e in n)e in t?r[e]=Mr(n[e],t[e]):u[e]=n[e];for(e in t)e in n||(u[e]=t[e]);return function(n){for(e in r)u[e]=r[e](n);return u}}function mr(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function yr(n,t){var e,r,u,i=fl.lastIndex=hl.lastIndex=0,a=-1,o=[],l=[];for(n+="",t+="";(e=fl.exec(n))&&(r=hl.exec(t));)(u=r.index)>i&&(u=t.slice(i,u),o[a]?o[a]+=u:o[++a]=u),(e=e[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:mr(e,r)})),i=hl.lastIndex;return i<t.length&&(u=t.slice(i),o[a]?o[a]+=u:o[++a]=u),o.length<2?l[0]?(t=l[0].x,function(n){return t(n)+""}):function(){return t}:(t=l.length,function(n){for(var e,r=0;t>r;++r)o[(e=l[r]).i]=e.x(n);return o.join("")})}function Mr(n,t){for(var e,r=oa.interpolators.length;--r>=0&&!(e=oa.interpolators[r](n,t)););return e}function xr(n,t){var e,r=[],u=[],i=n.length,a=t.length,o=Math.min(n.length,t.length);for(e=0;o>e;++e)r.push(Mr(n[e],t[e]));for(;i>e;++e)u[e]=n[e];for(;a>e;++e)u[e]=t[e];return function(n){for(e=0;o>e;++e)u[e]=r[e](n);return u}}function br(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function _r(n){return function(t){return 1-n(1-t)}}function wr(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function Sr(n){return n*n}function kr(n){return n*n*n}function Nr(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function Er(n){return function(t){return Math.pow(t,n)}}function Ar(n){return 1-Math.cos(n*Ha)}function Cr(n){return Math.pow(2,10*(n-1))}function zr(n){return 1-Math.sqrt(1-n*n)}function Lr(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/ja*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*ja/t)}}function qr(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Tr(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Rr(n,t){n=oa.hcl(n),t=oa.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,a=t.c-r,o=t.l-u;return isNaN(a)&&(a=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return fn(e+i*n,r+a*n,u+o*n)+""}}function Dr(n,t){n=oa.hsl(n),t=oa.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,a=t.s-r,o=t.l-u;return isNaN(a)&&(a=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return cn(e+i*n,r+a*n,u+o*n)+""}}function Pr(n,t){n=oa.lab(n),t=oa.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,a=t.a-r,o=t.b-u;return function(n){return gn(e+i*n,r+a*n,u+o*n)+""}}function Ur(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function jr(n){var t=[n.a,n.b],e=[n.c,n.d],r=Hr(t),u=Fr(t,e),i=Hr(Or(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Ia,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Ia:0}function Fr(n,t){return n[0]*t[0]+n[1]*t[1]}function Hr(n){var t=Math.sqrt(Fr(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Or(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Ir(n){return n.length?n.pop()+",":""}function Yr(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var u=e.push("translate(",null,",",null,")");r.push({i:u-4,x:mr(n[0],t[0])},{i:u-2,x:mr(n[1],t[1])})}else(t[0]||t[1])&&e.push("translate("+t+")")}function Zr(n,t,e,r){n!==t?(n-t>180?t+=360:t-n>180&&(n+=360),r.push({i:e.push(Ir(e)+"rotate(",null,")")-2,x:mr(n,t)})):t&&e.push(Ir(e)+"rotate("+t+")")}function Vr(n,t,e,r){n!==t?r.push({i:e.push(Ir(e)+"skewX(",null,")")-2,x:mr(n,t)}):t&&e.push(Ir(e)+"skewX("+t+")")}function Xr(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var u=e.push(Ir(e)+"scale(",null,",",null,")");r.push({i:u-4,x:mr(n[0],t[0])},{i:u-2,x:mr(n[1],t[1])})}else(1!==t[0]||1!==t[1])&&e.push(Ir(e)+"scale("+t+")")}function $r(n,t){var e=[],r=[];return n=oa.transform(n),t=oa.transform(t),Yr(n.translate,t.translate,e,r),Zr(n.rotate,t.rotate,e,r),Vr(n.skew,t.skew,e,r),Xr(n.scale,t.scale,e,r),n=t=null,function(n){for(var t,u=-1,i=r.length;++u<i;)e[(t=r[u]).i]=t.x(n);return e.join("")}}function Br(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}}function Wr(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}function Jr(n){for(var t=n.source,e=n.target,r=Kr(t,e),u=[t];t!==r;)t=t.parent,u.push(t);for(var i=u.length;e!==r;)u.splice(i,0,e),e=e.parent;return u}function Gr(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Kr(n,t){if(n===t)return n;for(var e=Gr(n),r=Gr(t),u=e.pop(),i=r.pop(),a=null;u===i;)a=u,u=e.pop(),i=r.pop();return a}function Qr(n){n.fixed|=2}function nu(n){n.fixed&=-7}function tu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function eu(n){n.fixed&=-5}function ru(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf)for(var i,a=n.nodes,o=a.length,l=-1;++l<o;)i=a[l],null!=i&&(ru(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var c=t*e[n.point.index];n.charge+=n.pointCharge=c,r+=c*n.point.x,u+=c*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function uu(n,t){return oa.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=su,n}function iu(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(u=n.children)&&(r=u.length))for(var r,u;--r>=0;)e.push(u[r])}function au(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(i=n.children)&&(u=i.length))for(var u,i,a=-1;++a<u;)e.push(i[a]);for(;null!=(n=r.pop());)t(n)}function ou(n){return n.children}function lu(n){return n.value}function cu(n,t){return t.value-n.value}function su(n){return oa.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function fu(n){return n.x}function hu(n){return n.y}function gu(n,t,e){n.y0=t,n.y=e}function pu(n){return oa.range(n.length)}function vu(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function du(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e)(t=n[e][1])>u&&(r=e,u=t);return r}function mu(n){return n.reduce(yu,0)}function yu(n,t){return n+t[1]}function Mu(n,t){return xu(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function xu(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;)i[e]=u*e+r;return i}function bu(n){return[oa.min(n),oa.max(n)]}function _u(n,t){return n.value-t.value}function wu(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function Su(n,t){n._pack_next=t,t._pack_prev=n}function ku(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>e*e+r*r}function Nu(n){function t(n){s=Math.min(n.x-n.r,s),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(c=e.length)){var e,r,u,i,a,o,l,c,s=1/0,f=-(1/0),h=1/0,g=-(1/0);if(e.forEach(Eu),r=e[0],r.x=-r.r,r.y=0,t(r),c>1&&(u=e[1],u.x=u.r,u.y=0,t(u),c>2))for(i=e[2],zu(r,u,i),t(i),wu(r,i),r._pack_prev=i,wu(i,u),u=r._pack_next,a=3;c>a;a++){zu(r,u,i=e[a]);var p=0,v=1,d=1;for(o=u._pack_next;o!==u;o=o._pack_next,v++)if(ku(o,i)){p=1;break}if(1==p)for(l=r._pack_prev;l!==o._pack_prev&&!ku(l,i);l=l._pack_prev,d++);p?(d>v||v==d&&u.r<r.r?Su(r,u=o):Su(r=l,u),a--):(wu(r,i),u=i,t(i))}var m=(s+f)/2,y=(h+g)/2,M=0;for(a=0;c>a;a++)i=e[a],i.x-=m,i.y-=y,M=Math.max(M,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=M,e.forEach(Au)}}function Eu(n){n._pack_next=n._pack_prev=n}function Au(n){delete n._pack_next,delete n._pack_prev}function Cu(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u)for(var i=-1,a=u.length;++i<a;)Cu(u[i],t,e,r)}function zu(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var a=t.r+e.r,o=u*u+i*i;a*=a,r*=r;var l=.5+(r-a)/(2*o),c=Math.sqrt(Math.max(0,2*a*(r+o)-(r-=o)*r-a*a))/(2*o);e.x=n.x+l*u+c*i,e.y=n.y+l*i-c*u}else e.x=n.x+r,e.y=n.y}function Lu(n,t){return n.parent==t.parent?1:2}function qu(n){var t=n.children;return t.length?t[0]:n.t}function Tu(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Ru(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Du(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;)t=u[i],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Pu(n,t,e){return n.a.parent===t.parent?n.a:e}function Uu(n){return 1+oa.max(n,function(n){return n.y})}function ju(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Fu(n){var t=n.children;return t&&t.length?Fu(t[0]):n}function Hu(n){var t,e=n.children;return e&&(t=e.length)?Hu(e[t-1]):n}function Ou(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Iu(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function Yu(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Zu(n){return n.rangeExtent?n.rangeExtent():Yu(n.range())}function Vu(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function Xu(n,t){var e,r=0,u=n.length-1,i=n[r],a=n[u];return i>a&&(e=r,r=u,u=e,e=i,i=a,a=e),n[r]=t.floor(i),n[u]=t.ceil(a),n}function $u(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:wl}function Bu(n,t,e,r){var u=[],i=[],a=0,o=Math.min(n.length,t.length)-1;for(n[o]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++a<=o;)u.push(e(n[a-1],n[a])),i.push(r(t[a-1],t[a]));return function(t){var e=oa.bisect(n,t,1,o)-1;return i[e](u[e](t))}}function Wu(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?Bu:Vu,l=r?Wr:Br;return a=u(n,t,l,e),o=u(t,n,l,Mr),i}function i(n){return a(n)}var a,o;return i.invert=function(n){return o(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(Ur)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return Qu(n,t)},i.tickFormat=function(t,e){return ni(n,t,e)},i.nice=function(t){return Gu(n,t),u()},i.copy=function(){return Wu(n,t,e,r)},u()}function Ju(n,t){return oa.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Gu(n,t){return Xu(n,$u(Ku(n,t)[2])),Xu(n,$u(Ku(n,t)[2])),n}function Ku(n,t){null==t&&(t=10);var e=Yu(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return.15>=i?u*=10:.35>=i?u*=5:.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+.5*u,e[2]=u,e}function Qu(n,t){return oa.range.apply(oa,Ku(n,t))}function ni(n,t,e){var r=Ku(n,t);if(e){var u=so.exec(e);if(u.shift(),"s"===u[8]){var i=oa.formatPrefix(Math.max(Ma(r[0]),Ma(r[1])));return u[7]||(u[7]="."+ti(i.scale(r[2]))),u[8]="f",e=oa.format(u.join("")),function(n){return e(i.scale(n))+i.symbol}}u[7]||(u[7]="."+ei(u[8],r)),e=u.join("")}else e=",."+ti(r[2])+"f";return oa.format(e)}function ti(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function ei(n,t){var e=ti(t[2]);return n in Sl?Math.abs(e-ti(Math.max(Ma(t[0]),Ma(t[1]))))+ +("e"!==n):e-2*("%"===n)}function ri(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function a(t){return n(u(t))}return a.invert=function(t){return i(n.invert(t))},a.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),a):r},a.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),a):t},a.nice=function(){var t=Xu(r.map(u),e?Math:Nl);return n.domain(t),r=t.map(i),a},a.ticks=function(){var n=Yu(r),a=[],o=n[0],l=n[1],c=Math.floor(u(o)),s=Math.ceil(u(l)),f=t%1?2:t;if(isFinite(s-c)){if(e){for(;s>c;c++)for(var h=1;f>h;h++)a.push(i(c)*h);a.push(i(c))}else for(a.push(i(c));c++<s;)for(var h=f-1;h>0;h--)a.push(i(c)*h);for(c=0;a[c]<o;c++);for(s=a.length;a[s-1]>l;s--);a=a.slice(c,s)}return a},a.tickFormat=function(n,e){if(!arguments.length)return kl;arguments.length<2?e=kl:"function"!=typeof e&&(e=oa.format(e));var r=Math.max(1,t*n/a.ticks().length);return function(n){var a=n/i(Math.round(u(n)));return t-.5>a*t&&(a*=t),r>=a?e(n):""}},a.copy=function(){return ri(n.copy(),t,e,r)},Ju(a,n)}function ui(n,t,e){function r(t){return n(u(t))}var u=ii(t),i=ii(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return Qu(e,n)},r.tickFormat=function(n,t){return ni(e,n,t)},r.nice=function(n){return r.domain(Gu(e,n))},r.exponent=function(a){return arguments.length?(u=ii(t=a),i=ii(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return ui(n.copy(),t,e)},Ju(r,n)}function ii(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function ai(n,t){function e(e){return i[((u.get(e)||("range"===t.t?u.set(e,n.push(e)):NaN))-1)%i.length]}function r(t,e){return oa.range(n.length).map(function(n){return t+e*n})}var u,i,a;return e.domain=function(r){if(!arguments.length)return n;n=[],u=new c;for(var i,a=-1,o=r.length;++a<o;)u.has(i=r[a])||u.set(i,n.push(i));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(i=n,a=0,t={t:"range",a:arguments},e):i},e.rangePoints=function(u,o){arguments.length<2&&(o=0);var l=u[0],c=u[1],s=n.length<2?(l=(l+c)/2,0):(c-l)/(n.length-1+o);return i=r(l+s*o/2,s),a=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(u,o){arguments.length<2&&(o=0);var l=u[0],c=u[1],s=n.length<2?(l=c=Math.round((l+c)/2),0):(c-l)/(n.length-1+o)|0;return i=r(l+Math.round(s*o/2+(c-l-(n.length-1+o)*s)/2),s),a=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(u,o,l){arguments.length<2&&(o=0),arguments.length<3&&(l=o);var c=u[1]<u[0],s=u[c-0],f=u[1-c],h=(f-s)/(n.length-o+2*l);return i=r(s+h*l,h),c&&i.reverse(),a=h*(1-o),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,o,l){arguments.length<2&&(o=0),arguments.length<3&&(l=o);var c=u[1]<u[0],s=u[c-0],f=u[1-c],h=Math.floor((f-s)/(n.length-o+2*l));return i=r(s+Math.round((f-s-(n.length-o)*h)/2),h),c&&i.reverse(),a=Math.round(h*(1-o)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return a},e.rangeExtent=function(){return Yu(t.a[0])},e.copy=function(){return ai(n,t)},e.domain(n)}function oi(n,t){function i(){var e=0,r=t.length;for(o=[];++e<r;)o[e-1]=oa.quantile(n,e/r);return a}function a(n){return isNaN(n=+n)?void 0:t[oa.bisect(o,n)]}var o;return a.domain=function(t){return arguments.length?(n=t.map(r).filter(u).sort(e),i()):n},a.range=function(n){return arguments.length?(t=n,i()):t},a.quantiles=function(){return o},a.invertExtent=function(e){return e=t.indexOf(e),0>e?[NaN,NaN]:[e>0?o[e-1]:n[0],e<o.length?o[e]:n[n.length-1]]},a.copy=function(){return oi(n,t)},i()}function li(n,t,e){function r(t){return e[Math.max(0,Math.min(a,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),a=e.length-1,r}var i,a;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?NaN:t/i+n,[t,t+1/i]},r.copy=function(){return li(n,t,e)},u()}function ci(n,t){function e(e){return e>=e?t[oa.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return ci(n,t)},e}function si(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Qu(n,t)},t.tickFormat=function(t,e){return ni(n,t,e)},t.copy=function(){return si(n)},t}function fi(){return 0}function hi(n){return n.innerRadius}function gi(n){return n.outerRadius}function pi(n){return n.startAngle}function vi(n){return n.endAngle}function di(n){return n&&n.padAngle}function mi(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function yi(n,t,e,r,u){var i=n[0]-t[0],a=n[1]-t[1],o=(u?r:-r)/Math.sqrt(i*i+a*a),l=o*a,c=-o*i,s=n[0]+l,f=n[1]+c,h=t[0]+l,g=t[1]+c,p=(s+h)/2,v=(f+g)/2,d=h-s,m=g-f,y=d*d+m*m,M=e-r,x=s*g-h*f,b=(0>m?-1:1)*Math.sqrt(Math.max(0,M*M*y-x*x)),_=(x*m-d*b)/y,w=(-x*d-m*b)/y,S=(x*m+d*b)/y,k=(-x*d+m*b)/y,N=_-p,E=w-v,A=S-p,C=k-v;return N*N+E*E>A*A+C*C&&(_=S,w=k),[[_-l,w-c],[_*e/M,w*e/M]]}function Mi(n){function t(t){function a(){c.push("M",i(n(s),o))}for(var l,c=[],s=[],f=-1,h=t.length,g=En(e),p=En(r);++f<h;)u.call(this,l=t[f],f)?s.push([+g.call(this,l,f),+p.call(this,l,f)]):s.length&&(a(),s=[]);return s.length&&a(),c.length?c.join(""):null}var e=Ce,r=ze,u=zt,i=xi,a=i.key,o=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(a="function"==typeof n?i=n:(i=ql.get(n)||xi).key,t):a},t.tension=function(n){return arguments.length?(o=n,t):o},t}function xi(n){return n.length>1?n.join("L"):n+"Z"}function bi(n){return n.join("L")+"Z"}function _i(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&u.push("H",r[0]),u.join("")}function wi(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("V",(r=n[t])[1],"H",r[0]);return u.join("")}function Si(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r=n[t])[0],"V",r[1]);return u.join("")}function ki(n,t){return n.length<4?xi(n):n[1]+Ai(n.slice(1,-1),Ci(n,t))}function Ni(n,t){return n.length<3?bi(n):n[0]+Ai((n.push(n[0]),n),Ci([n[n.length-2]].concat(n,[n[1]]),t))}function Ei(n,t){return n.length<3?xi(n):n[0]+Ai(n,Ci(n,t))}function Ai(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return xi(n);var e=n.length!=t.length,r="",u=n[0],i=n[1],a=t[0],o=a,l=1;if(e&&(r+="Q"+(i[0]-2*a[0]/3)+","+(i[1]-2*a[1]/3)+","+i[0]+","+i[1],u=n[1],l=2),t.length>1){o=t[1],i=n[l],l++,r+="C"+(u[0]+a[0])+","+(u[1]+a[1])+","+(i[0]-o[0])+","+(i[1]-o[1])+","+i[0]+","+i[1];for(var c=2;c<t.length;c++,l++)i=n[l],o=t[c],r+="S"+(i[0]-o[0])+","+(i[1]-o[1])+","+i[0]+","+i[1]}if(e){var s=n[l];r+="Q"+(i[0]+2*o[0]/3)+","+(i[1]+2*o[1]/3)+","+s[0]+","+s[1]}return r}function Ci(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],a=n[1],o=1,l=n.length;++o<l;)e=i,i=a,a=n[o],r.push([u*(a[0]-e[0]),u*(a[1]-e[1])]);return r}function zi(n){if(n.length<3)return xi(n);var t=1,e=n.length,r=n[0],u=r[0],i=r[1],a=[u,u,u,(r=n[1])[0]],o=[i,i,i,r[1]],l=[u,",",i,"L",Ri(Dl,a),",",Ri(Dl,o)];for(n.push(n[e-1]);++t<=e;)r=n[t],a.shift(),a.push(r[0]),o.shift(),o.push(r[1]),Di(l,a,o);return n.pop(),l.push("L",r),l.join("")}function Li(n){if(n.length<4)return xi(n);for(var t,e=[],r=-1,u=n.length,i=[0],a=[0];++r<3;)t=n[r],i.push(t[0]),a.push(t[1]);for(e.push(Ri(Dl,i)+","+Ri(Dl,a)),--r;++r<u;)t=n[r],i.shift(),i.push(t[0]),a.shift(),a.push(t[1]),Di(e,i,a);return e.join("")}function qi(n){for(var t,e,r=-1,u=n.length,i=u+4,a=[],o=[];++r<4;)e=n[r%u],a.push(e[0]),o.push(e[1]);for(t=[Ri(Dl,a),",",Ri(Dl,o)],--r;++r<i;)e=n[r%u],a.shift(),a.push(e[0]),o.shift(),o.push(e[1]),Di(t,a,o);return t.join("")}function Ti(n,t){var e=n.length-1;if(e)for(var r,u,i=n[0][0],a=n[0][1],o=n[e][0]-i,l=n[e][1]-a,c=-1;++c<=e;)r=n[c],u=c/e,r[0]=t*r[0]+(1-t)*(i+u*o),r[1]=t*r[1]+(1-t)*(a+u*l);return zi(n)}function Ri(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Di(n,t,e){n.push("C",Ri(Tl,t),",",Ri(Tl,e),",",Ri(Rl,t),",",Ri(Rl,e),",",Ri(Dl,t),",",Ri(Dl,e))}function Pi(n,t){return(t[1]-n[1])/(t[0]-n[0])}function Ui(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],a=r[0]=Pi(u,i);++t<e;)r[t]=(a+(a=Pi(u=i,i=n[t+1])))/2;return r[t]=a,r}function ji(n){for(var t,e,r,u,i=[],a=Ui(n),o=-1,l=n.length-1;++o<l;)t=Pi(n[o],n[o+1]),Ma(t)<Da?a[o]=a[o+1]=0:(e=a[o]/t,r=a[o+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),a[o]=u*e,a[o+1]=u*r));for(o=-1;++o<=l;)u=(n[Math.min(l,o+1)][0]-n[Math.max(0,o-1)][0])/(6*(1+a[o]*a[o])),i.push([u||0,a[o]*u||0]);return i}function Fi(n){return n.length<3?xi(n):n[0]+Ai(n,ji(n))}function Hi(n){for(var t,e,r,u=-1,i=n.length;++u<i;)t=n[u],e=t[0],r=t[1]-Ha,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Oi(n){function t(t){function l(){v.push("M",o(n(m),f),s,c(n(d.reverse()),f),"Z")}for(var h,g,p,v=[],d=[],m=[],y=-1,M=t.length,x=En(e),b=En(u),_=e===r?function(){
return g}:En(r),w=u===i?function(){return p}:En(i);++y<M;)a.call(this,h=t[y],y)?(d.push([g=+x.call(this,h,y),p=+b.call(this,h,y)]),m.push([+_.call(this,h,y),+w.call(this,h,y)])):d.length&&(l(),d=[],m=[]);return d.length&&l(),v.length?v.join(""):null}var e=Ce,r=Ce,u=0,i=ze,a=zt,o=xi,l=o.key,c=o,s="L",f=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(a=n,t):a},t.interpolate=function(n){return arguments.length?(l="function"==typeof n?o=n:(o=ql.get(n)||xi).key,c=o.reverse||o,s=o.closed?"M":"L",t):l},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Ii(n){return n.radius}function Yi(n){return[n.x,n.y]}function Zi(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-Ha;return[e*Math.cos(r),e*Math.sin(r)]}}function Vi(){return 64}function Xi(){return"circle"}function $i(n){var t=Math.sqrt(n/Ua);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Bi(n){return function(){var t,e,r;(t=this[n])&&(r=t[e=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[e]:delete this[n],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Wi(n,t,e){return Sa(n,Il),n.namespace=t,n.id=e,n}function Ji(n,t,e,r){var u=n.id,i=n.namespace;return Y(n,"function"==typeof e?function(n,a,o){n[i][u].tween.set(t,r(e.call(n,n.__data__,a,o)))}:(e=r(e),function(n){n[i][u].tween.set(t,e)}))}function Gi(n){return null==n&&(n=""),function(){this.textContent=n}}function Ki(n){return null==n?"__transition__":"__transition_"+n+"__"}function Qi(n,t,e,r,u){function i(n){var t=v.delay;return s.t=t+l,n>=t?a(n-t):void(s.c=a)}function a(e){var u=p.active,i=p[u];i&&(i.timer.c=null,i.timer.t=NaN,--p.count,delete p[u],i.event&&i.event.interrupt.call(n,n.__data__,i.index));for(var a in p)if(r>+a){var c=p[a];c.timer.c=null,c.timer.t=NaN,--p.count,delete p[a]}s.c=o,qn(function(){return s.c&&o(e||1)&&(s.c=null,s.t=NaN),1},0,l),p.active=r,v.event&&v.event.start.call(n,n.__data__,t),g=[],v.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&g.push(r)}),h=v.ease,f=v.duration}function o(u){for(var i=u/f,a=h(i),o=g.length;o>0;)g[--o].call(n,a);return i>=1?(v.event&&v.event.end.call(n,n.__data__,t),--p.count?delete p[r]:delete n[e],1):void 0}var l,s,f,h,g,p=n[e]||(n[e]={active:0,count:0}),v=p[r];v||(l=u.time,s=qn(i,0,l),v=p[r]={tween:new c,time:l,timer:s,delay:u.delay,duration:u.duration,ease:u.ease,index:t},u=null,++p.count)}function na(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function ta(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function ea(n){return n.toISOString()}function ra(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=oa.bisect(Gl,u);return i==Gl.length?[t.year,Ku(n.map(function(n){return n/31536e6}),e)[2]]:i?t[u/Gl[i-1]<Gl[i]/u?i-1:i]:[nc,Ku(n,e)[2]]}return r.invert=function(t){return ua(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(ua)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,ua(+e+1),t).length}var i=r.domain(),a=Yu(i),o=null==n?u(a,10):"number"==typeof n&&u(a,n);return o&&(n=o[0],t=o[1]),r.domain(Xu(i,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=ua(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=ua(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Yu(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],ua(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return ra(n.copy(),t,e)},Ju(r,n)}function ua(n){return new Date(n)}function ia(n){return JSON.parse(n.responseText)}function aa(n){var t=sa.createRange();return t.selectNode(sa.body),t.createContextualFragment(n.responseText)}var oa={version:"3.5.15"},la=[].slice,ca=function(n){return la.call(n)},sa=this.document;if(sa)try{ca(sa.documentElement.childNodes)[0].nodeType}catch(fa){ca=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),sa)try{sa.createElement("DIV").style.setProperty("opacity",0,"")}catch(ha){var ga=this.Element.prototype,pa=ga.setAttribute,va=ga.setAttributeNS,da=this.CSSStyleDeclaration.prototype,ma=da.setProperty;ga.setAttribute=function(n,t){pa.call(this,n,t+"")},ga.setAttributeNS=function(n,t,e){va.call(this,n,t,e+"")},da.setProperty=function(n,t,e){ma.call(this,n,t+"",e)}}oa.ascending=e,oa.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:NaN},oa.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&e>r&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}return e},oa.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&r>e&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}return e},oa.extent=function(n,t){var e,r,u,i=-1,a=n.length;if(1===arguments.length){for(;++i<a;)if(null!=(r=n[i])&&r>=r){e=u=r;break}for(;++i<a;)null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}else{for(;++i<a;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=u=r;break}for(;++i<a;)null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}return[e,u]},oa.sum=function(n,t){var e,r=0,i=n.length,a=-1;if(1===arguments.length)for(;++a<i;)u(e=+n[a])&&(r+=e);else for(;++a<i;)u(e=+t.call(n,n[a],a))&&(r+=e);return r},oa.mean=function(n,t){var e,i=0,a=n.length,o=-1,l=a;if(1===arguments.length)for(;++o<a;)u(e=r(n[o]))?i+=e:--l;else for(;++o<a;)u(e=r(t.call(n,n[o],o)))?i+=e:--l;return l?i/l:void 0},oa.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},oa.median=function(n,t){var i,a=[],o=n.length,l=-1;if(1===arguments.length)for(;++l<o;)u(i=r(n[l]))&&a.push(i);else for(;++l<o;)u(i=r(t.call(n,n[l],l)))&&a.push(i);return a.length?oa.quantile(a.sort(e),.5):void 0},oa.variance=function(n,t){var e,i,a=n.length,o=0,l=0,c=-1,s=0;if(1===arguments.length)for(;++c<a;)u(e=r(n[c]))&&(i=e-o,o+=i/++s,l+=i*(e-o));else for(;++c<a;)u(e=r(t.call(n,n[c],c)))&&(i=e-o,o+=i/++s,l+=i*(e-o));return s>1?l/(s-1):void 0},oa.deviation=function(){var n=oa.variance.apply(this,arguments);return n?Math.sqrt(n):n};var ya=i(e);oa.bisectLeft=ya.left,oa.bisect=oa.bisectRight=ya.right,oa.bisector=function(n){return i(1===n.length?function(t,r){return e(n(t),r)}:n)},oa.shuffle=function(n,t,e){(i=arguments.length)<3&&(e=n.length,2>i&&(t=0));for(var r,u,i=e-t;i;)u=Math.random()*i--|0,r=n[i+t],n[i+t]=n[u+t],n[u+t]=r;return n},oa.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},oa.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;)i[e]=[t=u,u=n[++e]];return i},oa.transpose=function(n){if(!(u=n.length))return[];for(var t=-1,e=oa.min(n,a),r=new Array(e);++t<e;)for(var u,i=-1,o=r[t]=new Array(u);++i<u;)o[i]=n[i][t];return r},oa.zip=function(){return oa.transpose(arguments)},oa.keys=function(n){var t=[];for(var e in n)t.push(e);return t},oa.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},oa.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},oa.merge=function(n){for(var t,e,r,u=n.length,i=-1,a=0;++i<u;)a+=n[i].length;for(e=new Array(a);--u>=0;)for(r=n[u],t=r.length;--t>=0;)e[--a]=r[t];return e};var Ma=Math.abs;oa.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e===1/0)throw new Error("infinite range");var r,u=[],i=o(Ma(e)),a=-1;if(n*=i,t*=i,e*=i,0>e)for(;(r=n+e*++a)>t;)u.push(r/i);else for(;(r=n+e*++a)<t;)u.push(r/i);return u},oa.map=function(n,t){var e=new c;if(n instanceof c)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,u=-1,i=n.length;if(1===arguments.length)for(;++u<i;)e.set(u,n[u]);else for(;++u<i;)e.set(t.call(n,r=n[u],u),r)}else for(var a in n)e.set(a,n[a]);return e};var xa="__proto__",ba="\x00";l(c,{has:h,get:function(n){return this._[s(n)]},set:function(n,t){return this._[s(n)]=t},remove:g,keys:p,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:f(t),value:this._[t]});return n},size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,f(t),this._[t])}}),oa.nest=function(){function n(t,a,o){if(o>=i.length)return r?r.call(u,a):e?a.sort(e):a;for(var l,s,f,h,g=-1,p=a.length,v=i[o++],d=new c;++g<p;)(h=d.get(l=v(s=a[g])))?h.push(s):d.set(l,[s]);return t?(s=t(),f=function(e,r){s.set(e,n(t,r,o))}):(s={},f=function(e,r){s[e]=n(t,r,o)}),d.forEach(f),s}function t(n,e){if(e>=i.length)return n;var r=[],u=a[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,u={},i=[],a=[];return u.map=function(t,e){return n(e,t,0)},u.entries=function(e){return t(n(oa.map,e,0),0)},u.key=function(n){return i.push(n),u},u.sortKeys=function(n){return a[i.length-1]=n,u},u.sortValues=function(n){return e=n,u},u.rollup=function(n){return r=n,u},u},oa.set=function(n){var t=new m;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},l(m,{has:h,add:function(n){return this._[s(n+="")]=!0,n},remove:g,values:p,size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,f(t))}}),oa.behavior={},oa.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;)n[e=arguments[r]]=M(n,t,t[e]);return n};var _a=["webkit","ms","moz","Moz","o","O"];oa.dispatch=function(){for(var n=new _,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=w(n);return n},_.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},oa.event=null,oa.requote=function(n){return n.replace(wa,"\\$&")};var wa=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Sa={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},ka=function(n,t){return t.querySelector(n)},Na=function(n,t){return t.querySelectorAll(n)},Ea=function(n,t){var e=n.matches||n[x(n,"matchesSelector")];return(Ea=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(ka=function(n,t){return Sizzle(n,t)[0]||null},Na=Sizzle,Ea=Sizzle.matchesSelector),oa.selection=function(){return oa.select(sa.documentElement)};var Aa=oa.selection.prototype=[];Aa.select=function(n){var t,e,r,u,i=[];n=A(n);for(var a=-1,o=this.length;++a<o;){i.push(t=[]),t.parentNode=(r=this[a]).parentNode;for(var l=-1,c=r.length;++l<c;)(u=r[l])?(t.push(e=n.call(u,u.__data__,l,a)),e&&"__data__"in u&&(e.__data__=u.__data__)):t.push(null)}return E(i)},Aa.selectAll=function(n){var t,e,r=[];n=C(n);for(var u=-1,i=this.length;++u<i;)for(var a=this[u],o=-1,l=a.length;++o<l;)(e=a[o])&&(r.push(t=ca(n.call(e,e.__data__,o,u))),t.parentNode=e);return E(r)};var Ca={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};oa.ns={prefix:Ca,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&"xmlns"!==(e=n.slice(0,t))&&(n=n.slice(t+1)),Ca.hasOwnProperty(e)?{space:Ca[e],local:n}:n}},Aa.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=oa.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(z(t,n[t]));return this}return this.each(z(n,t))},Aa.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=T(n)).length,u=-1;if(t=e.classList){for(;++u<r;)if(!t.contains(n[u]))return!1}else for(t=e.getAttribute("class");++u<r;)if(!q(n[u]).test(t))return!1;return!0}for(t in n)this.each(R(t,n[t]));return this}return this.each(R(n,t))},Aa.style=function(n,e,r){var u=arguments.length;if(3>u){if("string"!=typeof n){2>u&&(e="");for(r in n)this.each(P(r,n[r],e));return this}if(2>u){var i=this.node();return t(i).getComputedStyle(i,null).getPropertyValue(n)}r=""}return this.each(P(n,e,r))},Aa.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(U(t,n[t]));return this}return this.each(U(n,t))},Aa.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},Aa.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},Aa.append=function(n){return n=j(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},Aa.insert=function(n,t){return n=j(n),t=A(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},Aa.remove=function(){return this.each(F)},Aa.data=function(n,t){function e(n,e){var r,u,i,a=n.length,f=e.length,h=Math.min(a,f),g=new Array(f),p=new Array(f),v=new Array(a);if(t){var d,m=new c,y=new Array(a);for(r=-1;++r<a;)(u=n[r])&&(m.has(d=t.call(u,u.__data__,r))?v[r]=u:m.set(d,u),y[r]=d);for(r=-1;++r<f;)(u=m.get(d=t.call(e,i=e[r],r)))?u!==!0&&(g[r]=u,u.__data__=i):p[r]=H(i),m.set(d,!0);for(r=-1;++r<a;)r in y&&m.get(y[r])!==!0&&(v[r]=n[r])}else{for(r=-1;++r<h;)u=n[r],i=e[r],u?(u.__data__=i,g[r]=u):p[r]=H(i);for(;f>r;++r)p[r]=H(e[r]);for(;a>r;++r)v[r]=n[r]}p.update=g,p.parentNode=g.parentNode=v.parentNode=n.parentNode,o.push(p),l.push(g),s.push(v)}var r,u,i=-1,a=this.length;if(!arguments.length){for(n=new Array(a=(r=this[0]).length);++i<a;)(u=r[i])&&(n[i]=u.__data__);return n}var o=Z([]),l=E([]),s=E([]);if("function"==typeof n)for(;++i<a;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<a;)e(r=this[i],n);return l.enter=function(){return o},l.exit=function(){return s},l},Aa.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},Aa.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=O(n));for(var i=0,a=this.length;a>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var o=0,l=e.length;l>o;o++)(r=e[o])&&n.call(r,r.__data__,o,i)&&t.push(r)}return E(u)},Aa.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;)(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},Aa.sort=function(n){n=I.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},Aa.each=function(n){return Y(this,function(t,e,r){n.call(t,t.__data__,e,r)})},Aa.call=function(n){var t=ca(arguments);return n.apply(t[0]=this,t),this},Aa.empty=function(){return!this.node()},Aa.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i)return i}return null},Aa.size=function(){var n=0;return Y(this,function(){++n}),n};var za=[];oa.selection.enter=Z,oa.selection.enter.prototype=za,za.append=Aa.append,za.empty=Aa.empty,za.node=Aa.node,za.call=Aa.call,za.size=Aa.size,za.select=function(n){for(var t,e,r,u,i,a=[],o=-1,l=this.length;++o<l;){r=(u=this[o]).update,a.push(t=[]),t.parentNode=u.parentNode;for(var c=-1,s=u.length;++c<s;)(i=u[c])?(t.push(r[c]=e=n.call(u.parentNode,i.__data__,c,o)),e.__data__=i.__data__):t.push(null)}return E(a)},za.insert=function(n,t){return arguments.length<2&&(t=V(this)),Aa.insert.call(this,n,t)},oa.select=function(t){var e;return"string"==typeof t?(e=[ka(t,sa)],e.parentNode=sa.documentElement):(e=[t],e.parentNode=n(t)),E([e])},oa.selectAll=function(n){var t;return"string"==typeof n?(t=ca(Na(n,sa)),t.parentNode=sa.documentElement):(t=ca(n),t.parentNode=null),E([t])},Aa.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(X(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(X(n,t,e))};var La=oa.map({mouseenter:"mouseover",mouseleave:"mouseout"});sa&&La.forEach(function(n){"on"+n in sa&&La.remove(n)});var qa,Ta=0;oa.mouse=function(n){return J(n,k())};var Ra=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;oa.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=k().changedTouches),t)for(var r,u=0,i=t.length;i>u;++u)if((r=t[u]).identifier===e)return J(n,r)},oa.behavior.drag=function(){function n(){this.on("mousedown.drag",i).on("touchstart.drag",a)}function e(n,t,e,i,a){return function(){function o(){var n,e,r=t(h,v);r&&(n=r[0]-M[0],e=r[1]-M[1],p|=n|e,M=r,g({type:"drag",x:r[0]+c[0],y:r[1]+c[1],dx:n,dy:e}))}function l(){t(h,v)&&(m.on(i+d,null).on(a+d,null),y(p),g({type:"dragend"}))}var c,s=this,f=oa.event.target.correspondingElement||oa.event.target,h=s.parentNode,g=r.of(s,arguments),p=0,v=n(),d=".drag"+(null==v?"":"-"+v),m=oa.select(e(f)).on(i+d,o).on(a+d,l),y=W(f),M=t(h,v);u?(c=u.apply(s,arguments),c=[c.x-M[0],c.y-M[1]]):c=[0,0],g({type:"dragstart"})}}var r=N(n,"drag","dragstart","dragend"),u=null,i=e(b,oa.mouse,t,"mousemove","mouseup"),a=e(G,oa.touch,y,"touchmove","touchend");return n.origin=function(t){return arguments.length?(u=t,n):u},oa.rebind(n,r,"on")},oa.touches=function(n,t){return arguments.length<2&&(t=k().touches),t?ca(t).map(function(t){var e=J(n,t);return e.identifier=t.identifier,e}):[]};var Da=1e-6,Pa=Da*Da,Ua=Math.PI,ja=2*Ua,Fa=ja-Da,Ha=Ua/2,Oa=Ua/180,Ia=180/Ua,Ya=Math.SQRT2,Za=2,Va=4;oa.interpolateZoom=function(n,t){var e,r,u=n[0],i=n[1],a=n[2],o=t[0],l=t[1],c=t[2],s=o-u,f=l-i,h=s*s+f*f;if(Pa>h)r=Math.log(c/a)/Ya,e=function(n){return[u+n*s,i+n*f,a*Math.exp(Ya*n*r)]};else{var g=Math.sqrt(h),p=(c*c-a*a+Va*h)/(2*a*Za*g),v=(c*c-a*a-Va*h)/(2*c*Za*g),d=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(v*v+1)-v);r=(m-d)/Ya,e=function(n){var t=n*r,e=rn(d),o=a/(Za*g)*(e*un(Ya*t+d)-en(d));return[u+o*s,i+o*f,a*e/rn(Ya*t+d)]}}return e.duration=1e3*r,e},oa.behavior.zoom=function(){function n(n){n.on(L,f).on($a+".zoom",g).on("dblclick.zoom",p).on(R,h)}function e(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function r(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}function u(n){k.k=Math.max(A[0],Math.min(A[1],n))}function i(n,t){t=r(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function a(t,e,r,a){t.__chart__={x:k.x,y:k.y,k:k.k},u(Math.pow(2,a)),i(d=e,r),t=oa.select(t),C>0&&(t=t.transition().duration(C)),t.call(n.event)}function o(){b&&b.domain(x.range().map(function(n){return(n-k.x)/k.k}).map(x.invert)),w&&w.domain(_.range().map(function(n){return(n-k.y)/k.k}).map(_.invert))}function l(n){z++||n({type:"zoomstart"})}function c(n){o(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function s(n){--z||(n({type:"zoomend"}),d=null)}function f(){function n(){o=1,i(oa.mouse(u),h),c(a)}function r(){f.on(q,null).on(T,null),g(o),s(a)}var u=this,a=D.of(u,arguments),o=0,f=oa.select(t(u)).on(q,n).on(T,r),h=e(oa.mouse(u)),g=W(u);Ol.call(u),l(a)}function h(){function n(){var n=oa.touches(p);return g=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=e(n))}),n}function t(){var t=oa.event.target;oa.select(t).on(x,r).on(b,o),_.push(t);for(var e=oa.event.changedTouches,u=0,i=e.length;i>u;++u)d[e[u].identifier]=null;var l=n(),c=Date.now();if(1===l.length){if(500>c-M){var s=l[0];a(p,s,d[s.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),S()}M=c}else if(l.length>1){var s=l[0],f=l[1],h=s[0]-f[0],g=s[1]-f[1];m=h*h+g*g}}function r(){var n,t,e,r,a=oa.touches(p);Ol.call(p);for(var o=0,l=a.length;l>o;++o,r=null)if(e=a[o],r=d[e.identifier]){if(t)break;n=e,t=r}if(r){var s=(s=e[0]-n[0])*s+(s=e[1]-n[1])*s,f=m&&Math.sqrt(s/m);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],u(f*g)}M=null,i(n,t),c(v)}function o(){if(oa.event.touches.length){for(var t=oa.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var u in d)return void n()}oa.selectAll(_).on(y,null),w.on(L,f).on(R,h),N(),s(v)}var g,p=this,v=D.of(p,arguments),d={},m=0,y=".zoom-"+oa.event.changedTouches[0].identifier,x="touchmove"+y,b="touchend"+y,_=[],w=oa.select(p),N=W(p);t(),l(v),w.on(L,null).on(R,t)}function g(){var n=D.of(this,arguments);y?clearTimeout(y):(Ol.call(this),v=e(d=m||oa.mouse(this)),l(n)),y=setTimeout(function(){y=null,s(n)},50),S(),u(Math.pow(2,.002*Xa())*k.k),i(d,v),c(n)}function p(){var n=oa.mouse(this),t=Math.log(k.k)/Math.LN2;a(this,n,e(n),oa.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var v,d,m,y,M,x,b,_,w,k={x:0,y:0,k:1},E=[960,500],A=Ba,C=250,z=0,L="mousedown.zoom",q="mousemove.zoom",T="mouseup.zoom",R="touchstart.zoom",D=N(n,"zoomstart","zoom","zoomend");return $a||($a="onwheel"in sa?(Xa=function(){return-oa.event.deltaY*(oa.event.deltaMode?120:1)},"wheel"):"onmousewheel"in sa?(Xa=function(){return oa.event.wheelDelta},"mousewheel"):(Xa=function(){return-oa.event.detail},"MozMousePixelScroll")),n.event=function(n){n.each(function(){var n=D.of(this,arguments),t=k;Fl?oa.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},l(n)}).tween("zoom:zoom",function(){var e=E[0],r=E[1],u=d?d[0]:e/2,i=d?d[1]:r/2,a=oa.interpolateZoom([(u-k.x)/k.k,(i-k.y)/k.k,e/k.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=a(t),o=e/r[2];this.__chart__=k={x:u-r[0]*o,y:i-r[1]*o,k:o},c(n)}}).each("interrupt.zoom",function(){s(n)}).each("end.zoom",function(){s(n)}):(this.__chart__=k,l(n),c(n),s(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},o(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:null},u(+t),o(),n):k.k},n.scaleExtent=function(t){return arguments.length?(A=null==t?Ba:[+t[0],+t[1]],n):A},n.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],n):m},n.size=function(t){return arguments.length?(E=t&&[+t[0],+t[1]],n):E},n.duration=function(t){return arguments.length?(C=+t,n):C},n.x=function(t){return arguments.length?(b=t,x=t.copy(),k={x:0,y:0,k:1},n):b},n.y=function(t){return arguments.length?(w=t,_=t.copy(),k={x:0,y:0,k:1},n):w},oa.rebind(n,D,"on")};var Xa,$a,Ba=[0,1/0];oa.color=on,on.prototype.toString=function(){return this.rgb()+""},oa.hsl=ln;var Wa=ln.prototype=new on;Wa.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new ln(this.h,this.s,this.l/n)},Wa.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new ln(this.h,this.s,n*this.l)},Wa.rgb=function(){return cn(this.h,this.s,this.l)},oa.hcl=sn;var Ja=sn.prototype=new on;Ja.brighter=function(n){return new sn(this.h,this.c,Math.min(100,this.l+Ga*(arguments.length?n:1)))},Ja.darker=function(n){return new sn(this.h,this.c,Math.max(0,this.l-Ga*(arguments.length?n:1)))},Ja.rgb=function(){return fn(this.h,this.c,this.l).rgb()},oa.lab=hn;var Ga=18,Ka=.95047,Qa=1,no=1.08883,to=hn.prototype=new on;to.brighter=function(n){return new hn(Math.min(100,this.l+Ga*(arguments.length?n:1)),this.a,this.b)},to.darker=function(n){return new hn(Math.max(0,this.l-Ga*(arguments.length?n:1)),this.a,this.b)},to.rgb=function(){return gn(this.l,this.a,this.b)},oa.rgb=yn;var eo=yn.prototype=new on;eo.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),new yn(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new yn(u,u,u)},eo.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new yn(n*this.r,n*this.g,n*this.b)},eo.hsl=function(){return wn(this.r,this.g,this.b)},eo.toString=function(){return"#"+bn(this.r)+bn(this.g)+bn(this.b)};var ro=oa.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ro.forEach(function(n,t){ro.set(n,Mn(t))}),oa.functor=En,oa.xhr=An(y),oa.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var a=Cn(n,t,null==e?r:u(e),i);return a.row=function(n){return arguments.length?a.response(null==(e=n)?r:u(n)):e},a}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function i(t){return t.map(a).join(n)}function a(n){return o.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var o=new RegExp('["'+n+"\n]"),l=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(s>=c)return a;if(u)return u=!1,i;var t=s;if(34===n.charCodeAt(t)){for(var e=t;e++<c;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}s=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++s):10===r&&(u=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;c>s;){var r=n.charCodeAt(s++),o=1;if(10===r)u=!0;else if(13===r)u=!0,10===n.charCodeAt(s)&&(++s,++o);else if(r!==l)continue;return n.slice(t,s-o)}return n.slice(t)}for(var r,u,i={},a={},o=[],c=n.length,s=0,f=0;(r=e())!==a;){for(var h=[];r!==i&&r!==a;)h.push(r),r=e();t&&null==(h=t(h,f++))||o.push(h)}return o},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new m,u=[];return t.forEach(function(n){for(var t in n)r.has(t)||u.push(r.add(t))}),[u.map(a).join(n)].concat(t.map(function(t){return u.map(function(n){return a(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(i).join("\n")},e},oa.csv=oa.dsv(",","text/csv"),oa.tsv=oa.dsv("	","text/tab-separated-values");var uo,io,ao,oo,lo=this[x(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};oa.timer=function(){qn.apply(this,arguments)},oa.timer.flush=function(){Rn(),Dn()},oa.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var co=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Un);oa.formatPrefix=function(n,t){var e=0;return(n=+n)&&(0>n&&(n*=-1),t&&(n=oa.round(n,Pn(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),co[8+e/3]};var so=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,fo=oa.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=oa.round(n,Pn(n,t))).toFixed(Math.max(0,Math.min(20,Pn(n*(1+1e-15),t))))}}),ho=oa.time={},go=Date;Hn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){po.setUTCDate.apply(this._,arguments)},setDay:function(){po.setUTCDay.apply(this._,arguments)},setFullYear:function(){po.setUTCFullYear.apply(this._,arguments)},setHours:function(){po.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){po.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){po.setUTCMinutes.apply(this._,arguments)},setMonth:function(){po.setUTCMonth.apply(this._,arguments)},setSeconds:function(){po.setUTCSeconds.apply(this._,arguments)},setTime:function(){po.setTime.apply(this._,arguments)}};var po=Date.prototype;ho.year=On(function(n){return n=ho.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),ho.years=ho.year.range,ho.years.utc=ho.year.utc.range,ho.day=On(function(n){var t=new go(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),ho.days=ho.day.range,ho.days.utc=ho.day.utc.range,ho.dayOfYear=function(n){var t=ho.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=ho[n]=On(function(n){return(n=ho.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=ho.year(n).getDay();return Math.floor((ho.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});ho[n+"s"]=e.range,ho[n+"s"].utc=e.utc.range,ho[n+"OfYear"]=function(n){var e=ho.year(n).getDay();return Math.floor((ho.dayOfYear(n)+(e+t)%7)/7)}}),ho.week=ho.sunday,ho.weeks=ho.sunday.range,ho.weeks.utc=ho.sunday.utc.range,ho.weekOfYear=ho.sundayOfYear;var vo={"-":"",_:" ",0:"0"},mo=/^\s*\d+/,yo=/^%/;oa.locale=function(n){return{numberFormat:jn(n),timeFormat:Yn(n)}};var Mo=oa.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});oa.format=Mo.numberFormat,oa.geo={},st.prototype={s:0,t:0,add:function(n){ft(n,this.t,xo),ft(xo.s,this.s,this),this.s?this.t+=xo.t:this.s=xo.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var xo=new st;oa.geo.stream=function(n,t){n&&bo.hasOwnProperty(n.type)?bo[n.type](n,t):ht(n,t)};var bo={Feature:function(n,t){ht(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;)ht(e[r].geometry,t)}},_o={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){gt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)gt(e[r],t,0)},Polygon:function(n,t){pt(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)pt(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;)ht(e[r],t)}};oa.geo.area=function(n){return wo=0,oa.geo.stream(n,ko),wo};var wo,So=new st,ko={sphere:function(){wo+=4*Ua},point:b,lineStart:b,lineEnd:b,polygonStart:function(){So.reset(),ko.lineStart=vt},polygonEnd:function(){var n=2*So;wo+=0>n?4*Ua+n:n,ko.lineStart=ko.lineEnd=ko.point=b}};oa.geo.bounds=function(){function n(n,t){M.push(x=[s=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=dt([t*Oa,e*Oa]);if(m){var u=yt(m,r),i=[u[1],-u[0],0],a=yt(i,u);bt(a),a=_t(a);var l=t-p,c=l>0?1:-1,v=a[0]*Ia*c,d=Ma(l)>180;if(d^(v>c*p&&c*t>v)){var y=a[1]*Ia;y>g&&(g=y)}else if(v=(v+360)%360-180,d^(v>c*p&&c*t>v)){var y=-a[1]*Ia;f>y&&(f=y)}else f>e&&(f=e),e>g&&(g=e);d?p>t?o(s,t)>o(s,h)&&(h=t):o(t,h)>o(s,h)&&(s=t):h>=s?(s>t&&(s=t),t>h&&(h=t)):t>p?o(s,t)>o(s,h)&&(h=t):o(t,h)>o(s,h)&&(s=t)}else n(t,e);m=r,p=t}function e(){b.point=t}function r(){x[0]=s,x[1]=h,b.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=Ma(r)>180?r+(r>0?360:-360):r}else v=n,d=e;ko.point(n,e),t(n,e)}function i(){ko.lineStart()}function a(){u(v,d),ko.lineEnd(),Ma(y)>Da&&(s=-(h=180)),x[0]=s,x[1]=h,m=null}function o(n,t){return(t-=n)<0?t+360:t}function l(n,t){return n[0]-t[0]}function c(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var s,f,h,g,p,v,d,m,y,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=u,b.lineStart=i,b.lineEnd=a,y=0,ko.polygonStart()},polygonEnd:function(){ko.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>So?(s=-(h=180),f=-(g=90)):y>Da?g=90:-Da>y&&(f=-90),x[0]=s,x[1]=h}};return function(n){g=h=-(s=f=1/0),M=[],oa.geo.stream(n,b);var t=M.length;if(t){M.sort(l);for(var e,r=1,u=M[0],i=[u];t>r;++r)e=M[r],c(e[0],u)||c(e[1],u)?(o(u[0],e[1])>o(u[0],u[1])&&(u[1]=e[1]),o(e[0],u[1])>o(u[0],u[1])&&(u[0]=e[0])):i.push(u=e);for(var a,e,p=-(1/0),t=i.length-1,r=0,u=i[t];t>=r;u=e,++r)e=i[r],(a=o(u[1],e[0]))>p&&(p=a,s=e[0],h=u[1])}return M=x=null,s===1/0||f===1/0?[[NaN,NaN],[NaN,NaN]]:[[s,f],[h,g]]}}(),oa.geo.centroid=function(n){No=Eo=Ao=Co=zo=Lo=qo=To=Ro=Do=Po=0,oa.geo.stream(n,Uo);var t=Ro,e=Do,r=Po,u=t*t+e*e+r*r;return Pa>u&&(t=Lo,e=qo,r=To,Da>Eo&&(t=Ao,e=Co,r=zo),u=t*t+e*e+r*r,Pa>u)?[NaN,NaN]:[Math.atan2(e,t)*Ia,tn(r/Math.sqrt(u))*Ia]};var No,Eo,Ao,Co,zo,Lo,qo,To,Ro,Do,Po,Uo={sphere:b,point:St,lineStart:Nt,lineEnd:Et,polygonStart:function(){Uo.lineStart=At},polygonEnd:function(){Uo.lineStart=Nt}},jo=Rt(zt,jt,Ht,[-Ua,-Ua/2]),Fo=1e9;oa.geo.clipExtent=function(){var n,t,e,r,u,i,a={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(o){return arguments.length?(i=Zt(n=+o[0][0],t=+o[0][1],e=+o[1][0],r=+o[1][1]),u&&(u.valid=!1,u=null),a):[[n,t],[e,r]]}};return a.extent([[0,0],[960,500]])},(oa.geo.conicEqualArea=function(){return Vt(Xt)}).raw=Xt,oa.geo.albers=function(){return oa.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},oa.geo.albersUsa=function(){function n(n){var i=n[0],a=n[1];return t=null,e(i,a),t||(r(i,a),t)||u(i,a),t}var t,e,r,u,i=oa.geo.albers(),a=oa.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=oa.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=.12&&.234>u&&r>=-.425&&-.214>r?a:u>=.166&&.234>u&&r>=-.214&&-.115>r?o:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=a.stream(n),r=o.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),a.precision(t),o.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),a.scale(.35*t),o.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length)return i.translate();var c=i.scale(),s=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[s-.455*c,f-.238*c],[s+.455*c,f+.238*c]]).stream(l).point,r=a.translate([s-.307*c,f+.201*c]).clipExtent([[s-.425*c+Da,f+.12*c+Da],[s-.214*c-Da,f+.234*c-Da]]).stream(l).point,u=o.translate([s-.205*c,f+.212*c]).clipExtent([[s-.214*c+Da,f+.166*c+Da],[s-.115*c-Da,f+.234*c-Da]]).stream(l).point,n},n.scale(1070)};var Ho,Oo,Io,Yo,Zo,Vo,Xo={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Oo=0,Xo.lineStart=$t},polygonEnd:function(){Xo.lineStart=Xo.lineEnd=Xo.point=b,Ho+=Ma(Oo/2)}},$o={point:Bt,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},Bo={point:Gt,lineStart:Kt,lineEnd:Qt,polygonStart:function(){Bo.lineStart=ne},polygonEnd:function(){Bo.point=Gt,Bo.lineStart=Kt,Bo.lineEnd=Qt}};oa.geo.path=function(){function n(n){return n&&("function"==typeof o&&i.pointRadius(+o.apply(this,arguments)),a&&a.valid||(a=u(i)),oa.geo.stream(n,a)),i.result()}function t(){return a=null,n}var e,r,u,i,a,o=4.5;return n.area=function(n){return Ho=0,oa.geo.stream(n,u(Xo)),Ho},n.centroid=function(n){return Ao=Co=zo=Lo=qo=To=Ro=Do=Po=0,oa.geo.stream(n,u(Bo)),Po?[Ro/Po,Do/Po]:To?[Lo/To,qo/To]:zo?[Ao/zo,Co/zo]:[NaN,NaN]},n.bounds=function(n){return Zo=Vo=-(Io=Yo=1/0),oa.geo.stream(n,u($o)),[[Io,Yo],[Zo,Vo]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||re(n):y,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new Wt:new te(n),"function"!=typeof o&&i.pointRadius(o),t()):r},n.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(i.pointRadius(+t),+t),n):o},n.projection(oa.geo.albersUsa()).context(null)},oa.geo.transform=function(n){return{stream:function(t){var e=new ue(t);for(var r in n)e[r]=n[r];return e}}},ue.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},oa.geo.projection=ae,oa.geo.projectionMutator=oe,(oa.geo.equirectangular=function(){return ae(ce)}).raw=ce.invert=ce,oa.geo.rotation=function(n){function t(t){return t=n(t[0]*Oa,t[1]*Oa),t[0]*=Ia,t[1]*=Ia,t}return n=fe(n[0]%360*Oa,n[1]*Oa,n.length>2?n[2]*Oa:0),t.invert=function(t){return t=n.invert(t[0]*Oa,t[1]*Oa),t[0]*=Ia,t[1]*=Ia,t},t},se.invert=ce,oa.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=fe(-n[0]*Oa,-n[1]*Oa,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Ia,n[1]*=Ia}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=ve((t=+r)*Oa,u*Oa),n):t},n.precision=function(r){return arguments.length?(e=ve(t*Oa,(u=+r)*Oa),n):u},n.angle(90)},oa.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Oa,u=n[1]*Oa,i=t[1]*Oa,a=Math.sin(r),o=Math.cos(r),l=Math.sin(u),c=Math.cos(u),s=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*a)*e+(e=c*s-l*f*o)*e),l*s+c*f*o)},oa.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return oa.range(Math.ceil(i/d)*d,u,d).map(h).concat(oa.range(Math.ceil(c/m)*m,l,m).map(g)).concat(oa.range(Math.ceil(r/p)*p,e,p).filter(function(n){return Ma(n%d)>Da}).map(s)).concat(oa.range(Math.ceil(o/v)*v,a,v).filter(function(n){return Ma(n%m)>Da}).map(f))}var e,r,u,i,a,o,l,c,s,f,h,g,p=10,v=p,d=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(l).slice(1),h(u).reverse().slice(1),g(c).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],c=+t[0][1],l=+t[1][1],i>u&&(t=i,i=u,u=t),c>l&&(t=c,c=l,l=t),n.precision(y)):[[i,c],[u,l]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],o=+t[0][1],a=+t[1][1],r>e&&(t=r,r=e,e=t),o>a&&(t=o,o=a,a=t),n.precision(y)):[[r,o],[e,a]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],n):[d,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],v=+t[1],n):[p,v]},n.precision=function(t){return arguments.length?(y=+t,s=me(o,a,90),f=ye(r,e,y),h=me(c,l,90),g=ye(i,u,y),n):y},n.majorExtent([[-180,-90+Da],[180,90-Da]]).minorExtent([[-180,-80-Da],[180,80+Da]])},oa.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=Me,u=xe;return n.distance=function(){return oa.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},oa.geo.interpolate=function(n,t){return be(n[0]*Oa,n[1]*Oa,t[0]*Oa,t[1]*Oa)},oa.geo.length=function(n){return Wo=0,oa.geo.stream(n,Jo),Wo};var Wo,Jo={sphere:b,point:b,lineStart:_e,lineEnd:b,polygonStart:b,polygonEnd:b},Go=we(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(oa.geo.azimuthalEqualArea=function(){return ae(Go)}).raw=Go;var Ko=we(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},y);(oa.geo.azimuthalEquidistant=function(){return ae(Ko)}).raw=Ko,(oa.geo.conicConformal=function(){return Vt(Se)}).raw=Se,(oa.geo.conicEquidistant=function(){return Vt(ke)}).raw=ke;var Qo=we(function(n){return 1/n},Math.atan);(oa.geo.gnomonic=function(){return ae(Qo)}).raw=Qo,Ne.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Ha]},(oa.geo.mercator=function(){return Ee(Ne)}).raw=Ne;var nl=we(function(){return 1},Math.asin);(oa.geo.orthographic=function(){return ae(nl)}).raw=nl;var tl=we(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(oa.geo.stereographic=function(){return ae(tl)}).raw=tl,Ae.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Ha]},(oa.geo.transverseMercator=function(){var n=Ee(Ae),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=Ae,oa.geom={},oa.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,u=En(e),i=En(r),a=n.length,o=[],l=[];for(t=0;a>t;t++)o.push([+u.call(this,n[t],t),+i.call(this,n[t],t),t]);for(o.sort(qe),t=0;a>t;t++)l.push([o[t][0],-o[t][1]]);var c=Le(o),s=Le(l),f=s[0]===c[0],h=s[s.length-1]===c[c.length-1],g=[];for(t=c.length-1;t>=0;--t)g.push(n[o[c[t]][2]]);for(t=+f;t<s.length-h;++t)g.push(n[o[s[t]][2]]);return g}var e=Ce,r=ze;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},oa.geom.polygon=function(n){return Sa(n,el),n};var el=oa.geom.polygon.prototype=[];el.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;)n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1];return.5*u},el.centroid=function(n){var t,e,r=-1,u=this.length,i=0,a=0,o=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;)t=o,o=this[r],e=t[0]*o[1]-o[0]*t[1],i+=(t[0]+o[0])*e,a+=(t[1]+o[1])*e;return[i*n,a*n]},el.clip=function(n){for(var t,e,r,u,i,a,o=De(n),l=-1,c=this.length-De(this),s=this[c-1];++l<c;){for(t=n.slice(),n.length=0,u=this[l],i=t[(r=t.length-o)-1],e=-1;++e<r;)a=t[e],Te(a,s,u)?(Te(i,s,u)||n.push(Re(i,a,s,u)),n.push(a)):Te(i,s,u)&&n.push(Re(i,a,s,u)),i=a;o&&n.push(n[0]),s=u}return n};var rl,ul,il,al,ol,ll=[],cl=[];Ye.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Ve),t.length},tr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},er.prototype={insert:function(n,t){var e,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=ar(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(u=r.R,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.R&&(ur(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ir(this,r))):(u=r.L,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.L&&(ir(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ur(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,u=n.U,i=n.L,a=n.R;if(e=i?a?ar(a):i:a,u?u.L===n?u.L=e:u.R=e:this._=e,i&&a?(r=e.C,e.C=n.C,e.L=i,i.U=e,e!==a?(u=e.U,e.U=n.U,n=e.R,u.L=n,e.R=a,a.U=e):(e.U=u,u=e,n=e.R)):(r=n.C,n=e),n&&(n.U=u),!r){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===u.L){if(t=u.R,t.C&&(t.C=!1,u.C=!0,ur(this,u),t=u.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ir(this,t),t=u.R),t.C=u.C,u.C=t.R.C=!1,ur(this,u),n=this._;break}}else if(t=u.L,t.C&&(t.C=!1,u.C=!0,ir(this,u),t=u.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,ur(this,t),t=u.L),t.C=u.C,u.C=t.L.C=!1,ir(this,u),n=this._;break}t.C=!0,n=u,u=u.U}while(!n.C);n&&(n.C=!1)}}},oa.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=o[0][0],u=o[0][1],i=o[1][0],a=o[1][1];return or(e(n),o).cells.forEach(function(e,o){var l=e.edges,c=e.site,s=t[o]=l.length?l.map(function(n){var t=n.start();return[t.x,t.y]}):c.x>=r&&c.x<=i&&c.y>=u&&c.y<=a?[[r,a],[i,a],[i,u],[r,u]]:[];s.point=n[o]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(i(n,t)/Da)*Da,y:Math.round(a(n,t)/Da)*Da,i:t}})}var r=Ce,u=ze,i=r,a=u,o=sl;return n?t(n):(t.links=function(n){return or(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return or(e(n)).cells.forEach(function(e,r){for(var u,i,a=e.site,o=e.edges.sort(Ve),l=-1,c=o.length,s=o[c-1].edge,f=s.l===a?s.r:s.l;++l<c;)u=s,i=f,s=o[l].edge,f=s.l===a?s.r:s.l,r<i.i&&r<f.i&&cr(a,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(i=En(r=n),t):r},t.y=function(n){return arguments.length?(a=En(u=n),t):u},t.clipExtent=function(n){return arguments.length?(o=null==n?sl:n,t):o===sl?null:o},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):o===sl?null:o&&o[1]},t)};var sl=[[-1e6,-1e6],[1e6,1e6]];oa.geom.delaunay=function(n){return oa.geom.voronoi().triangles(n)},oa.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,a,o){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var l=n.x,s=n.y;if(null!=l)if(Ma(l-e)+Ma(s-r)<.01)c(n,t,e,r,u,i,a,o);else{var f=n.point;n.x=n.y=n.point=null,c(n,f,l,s,u,i,a,o),c(n,t,e,r,u,i,a,o)}else n.x=e,n.y=r,n.point=t}else c(n,t,e,r,u,i,a,o)}function c(n,t,e,r,u,a,o,l){var c=.5*(u+o),s=.5*(a+l),f=e>=c,h=r>=s,g=h<<1|f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=hr()),f?u=c:o=c,h?a=s:l=s,i(n,t,e,r,u,a,o,l)}var s,f,h,g,p,v,d,m,y,M=En(o),x=En(l);if(null!=t)v=t,d=e,m=r,y=u;else if(m=y=-(v=d=1/0),f=[],h=[],p=n.length,a)for(g=0;p>g;++g)s=n[g],s.x<v&&(v=s.x),s.y<d&&(d=s.y),s.x>m&&(m=s.x),s.y>y&&(y=s.y),f.push(s.x),h.push(s.y);else for(g=0;p>g;++g){var b=+M(s=n[g],g),_=+x(s,g);v>b&&(v=b),d>_&&(d=_),b>m&&(m=b),_>y&&(y=_),f.push(b),h.push(_)}var w=m-v,S=y-d;w>S?y=d+w:m=v+S;var k=hr();if(k.add=function(n){i(k,n,+M(n,++g),+x(n,g),v,d,m,y)},k.visit=function(n){gr(n,k,v,d,m,y)},k.find=function(n){return pr(k,n[0],n[1],v,d,m,y)},g=-1,null==t){for(;++g<p;)i(k,n[g],f[g],h[g],v,d,m,y);--g}else n.forEach(k.add);return f=h=n=s=null,k}var a,o=Ce,l=ze;return(a=arguments.length)?(o=sr,l=fr,3===a&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(o=n,i):o},i.y=function(n){return arguments.length?(l=n,i):l},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},oa.interpolateRgb=vr,oa.interpolateObject=dr,oa.interpolateNumber=mr,oa.interpolateString=yr;var fl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hl=new RegExp(fl.source,"g");oa.interpolate=Mr,oa.interpolators=[function(n,t){var e=typeof t;return("string"===e?ro.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?vr:yr:t instanceof on?vr:Array.isArray(t)?xr:"object"===e&&isNaN(t)?dr:mr)(n,t)}],oa.interpolateArray=xr;var gl=function(){return y},pl=oa.map({linear:gl,poly:Er,quad:function(){return Sr},cubic:function(){return kr},sin:function(){return Ar},exp:function(){return Cr},circle:function(){return zr},elastic:Lr,back:qr,bounce:function(){return Tr}}),vl=oa.map({"in":y,out:_r,"in-out":wr,"out-in":function(n){return wr(_r(n))}});oa.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=pl.get(e)||gl,r=vl.get(r)||y,br(r(e.apply(null,la.call(arguments,1))))},oa.interpolateHcl=Rr,oa.interpolateHsl=Dr,oa.interpolateLab=Pr,oa.interpolateRound=Ur,oa.transform=function(n){var t=sa.createElementNS(oa.ns.prefix.svg,"g");return(oa.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new jr(e?e.matrix:dl)})(n)},jr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var dl={a:1,b:0,c:0,d:1,e:0,f:0};oa.interpolateTransform=$r,oa.layout={},oa.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Jr(n[e]));return t}},oa.layout.chord=function(){function n(){var n,c,f,h,g,p={},v=[],d=oa.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(c=0,g=-1;++g<i;)c+=u[h][g];v.push(c),m.push(oa.range(i)),n+=c}for(a&&d.sort(function(n,t){return a(v[n],v[t])}),o&&m.forEach(function(n,t){n.sort(function(n,e){return o(u[t][n],u[t][e])})}),n=(ja-s*i)/n,c=0,h=-1;++h<i;){for(f=c,g=-1;++g<i;){var y=d[h],M=m[y][g],x=u[y][M],b=c,_=c+=x*n;p[y+"-"+M]={index:y,subindex:M,startAngle:b,endAngle:_,value:x}}r[y]={index:y,startAngle:f,endAngle:c,value:v[y]},c+=s}for(h=-1;++h<i;)for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}l&&t()}function t(){e.sort(function(n,t){return l((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,a,o,l,c={},s=0;return c.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,c):u},c.padding=function(n){return arguments.length?(s=n,e=r=null,c):s},c.sortGroups=function(n){return arguments.length?(a=n,e=r=null,c):a},c.sortSubgroups=function(n){return arguments.length?(o=n,e=null,c):o},c.sortChords=function(n){return arguments.length?(l=n,e&&t(),c):l},c.chords=function(){return e||n(),e},c.groups=function(){return r||n(),r},c},oa.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,a=t.cy-n.y,o=u-e,l=i*i+a*a;if(l>o*o/m){if(v>l){var c=t.charge/l;n.px-=i*c,n.py-=a*c}return!0}if(t.point&&l&&v>l){var c=t.pointCharge/l;n.px-=i*c,n.py-=a*c}}return!t.charge}}function t(n){n.px=oa.event.x,n.py=oa.event.y,l.resume()}var e,r,u,i,a,o,l={},c=oa.dispatch("start","tick","end"),s=[1,1],f=.9,h=ml,g=yl,p=-30,v=Ml,d=.1,m=.64,M=[],x=[];return l.tick=function(){if((u*=.99)<.005)return e=null,c.end({type:"end",alpha:u=0}),!0;var t,r,l,h,g,v,m,y,b,_=M.length,w=x.length;for(r=0;w>r;++r)l=x[r],h=l.source,g=l.target,y=g.x-h.x,b=g.y-h.y,(v=y*y+b*b)&&(v=u*a[r]*((v=Math.sqrt(v))-i[r])/v,y*=v,b*=v,g.x-=y*(m=h.weight+g.weight?h.weight/(h.weight+g.weight):.5),g.y-=b*m,h.x+=y*(m=1-m),h.y+=b*m);if((m=u*d)&&(y=s[0]/2,b=s[1]/2,r=-1,m))for(;++r<_;)l=M[r],l.x+=(y-l.x)*m,l.y+=(b-l.y)*m;if(p)for(ru(t=oa.geom.quadtree(M),u,o),r=-1;++r<_;)(l=M[r]).fixed||t.visit(n(l));for(r=-1;++r<_;)l=M[r],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*f,l.y-=(l.py-(l.py=l.y))*f);c.tick({type:"tick",alpha:u})},l.nodes=function(n){return arguments.length?(M=n,l):M},l.links=function(n){return arguments.length?(x=n,l):x},l.size=function(n){return arguments.length?(s=n,l):s},l.linkDistance=function(n){return arguments.length?(h="function"==typeof n?n:+n,l):h},l.distance=l.linkDistance,l.linkStrength=function(n){return arguments.length?(g="function"==typeof n?n:+n,l):g},l.friction=function(n){return arguments.length?(f=+n,l):f},l.charge=function(n){return arguments.length?(p="function"==typeof n?n:+n,l):p},l.chargeDistance=function(n){return arguments.length?(v=n*n,l):Math.sqrt(v)},l.gravity=function(n){return arguments.length?(d=+n,l):d},l.theta=function(n){return arguments.length?(m=n*n,l):Math.sqrt(m)},l.alpha=function(n){return arguments.length?(n=+n,u?n>0?u=n:(e.c=null,e.t=NaN,e=null,c.end({type:"end",alpha:u=0})):n>0&&(c.start({type:"start",alpha:u=n}),e=qn(l.tick)),l):u},l.start=function(){function n(n,r){if(!e){for(e=new Array(u),l=0;u>l;++l)e[l]=[];for(l=0;c>l;++l){var i=x[l];e[i.source.index].push(i.target),e[i.target.index].push(i.source)}}for(var a,o=e[t],l=-1,s=o.length;++l<s;)if(!isNaN(a=o[l][n]))return a;return Math.random()*r}var t,e,r,u=M.length,c=x.length,f=s[0],v=s[1];for(t=0;u>t;++t)(r=M[t]).index=t,r.weight=0;for(t=0;c>t;++t)r=x[t],"number"==typeof r.source&&(r.source=M[r.source]),"number"==typeof r.target&&(r.target=M[r.target]),++r.source.weight,++r.target.weight;for(t=0;u>t;++t)r=M[t],isNaN(r.x)&&(r.x=n("x",f)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(i=[],"function"==typeof h)for(t=0;c>t;++t)i[t]=+h.call(this,x[t],t);else for(t=0;c>t;++t)i[t]=h;if(a=[],"function"==typeof g)for(t=0;c>t;++t)a[t]=+g.call(this,x[t],t);else for(t=0;c>t;++t)a[t]=g;if(o=[],"function"==typeof p)for(t=0;u>t;++t)o[t]=+p.call(this,M[t],t);else for(t=0;u>t;++t)o[t]=p;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return r||(r=oa.behavior.drag().origin(y).on("dragstart.force",Qr).on("drag.force",t).on("dragend.force",nu)),arguments.length?void this.on("mouseover.force",tu).on("mouseout.force",eu).call(r):r},oa.rebind(l,c,"on")};var ml=20,yl=1,Ml=1/0;oa.layout.hierarchy=function(){function n(u){var i,a=[u],o=[];for(u.depth=0;null!=(i=a.pop());)if(o.push(i),(c=e.call(n,i,i.depth))&&(l=c.length)){for(var l,c,s;--l>=0;)a.push(s=c[l]),s.parent=i,s.depth=i.depth+1;r&&(i.value=0),i.children=c}else r&&(i.value=+r.call(n,i,i.depth)||0),delete i.children;return au(u,function(n){var e,u;t&&(e=n.children)&&e.sort(t),r&&(u=n.parent)&&(u.value+=n.value)}),o}var t=cu,e=ou,r=lu;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(iu(t,function(n){n.children&&(n.value=0)}),au(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},oa.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(a=i.length)){var a,o,l,c=-1;for(r=t.value?r/t.value:0;++c<a;)n(o=i[c],e,l=o.value*r,u),e+=l}}function t(n){var e=n.children,r=0;if(e&&(u=e.length))for(var u,i=-1;++i<u;)r=Math.max(r,t(e[i]));return 1+r}function e(e,i){var a=r.call(this,e,i);return n(a[0],0,u[0],u[1]/t(a[0])),a}var r=oa.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},uu(e,r)},oa.layout.pie=function(){function n(a){var o,l=a.length,c=a.map(function(e,r){return+t.call(n,e,r)}),s=+("function"==typeof r?r.apply(this,arguments):r),f=("function"==typeof u?u.apply(this,arguments):u)-s,h=Math.min(Math.abs(f)/l,+("function"==typeof i?i.apply(this,arguments):i)),g=h*(0>f?-1:1),p=oa.sum(c),v=p?(f-l*g)/p:0,d=oa.range(l),m=[];return null!=e&&d.sort(e===xl?function(n,t){return c[t]-c[n]}:function(n,t){return e(a[n],a[t])}),d.forEach(function(n){m[n]={data:a[n],value:o=c[n],startAngle:s,endAngle:s+=o*v+g,padAngle:h}}),m}var t=Number,e=xl,r=0,u=ja,i=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n.padAngle=function(t){return arguments.length?(i=t,n):i},n};var xl={};oa.layout.stack=function(){function n(o,l){if(!(h=o.length))return o;var c=o.map(function(e,r){return t.call(n,e,r)}),s=c.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),a.call(n,t,e)]})}),f=e.call(n,s,l);c=oa.permute(c,f),s=oa.permute(s,f);var h,g,p,v,d=r.call(n,s,l),m=c[0].length;for(p=0;m>p;++p)for(u.call(n,c[0][p],v=d[p],s[0][p][1]),g=1;h>g;++g)u.call(n,c[g][p],v+=s[g-1][p][1],s[g][p][1]);return o}var t=y,e=pu,r=vu,u=gu,i=fu,a=hu;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:bl.get(t)||pu,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:_l.get(t)||vu,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(a=t,n):a},n.out=function(t){return arguments.length?(u=t,n):u},n};var bl=oa.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(du),i=n.map(mu),a=oa.range(r).sort(function(n,t){return u[n]-u[t]}),o=0,l=0,c=[],s=[];for(t=0;r>t;++t)e=a[t],l>o?(o+=i[e],c.push(e)):(l+=i[e],s.push(e));return s.reverse().concat(c)},reverse:function(n){return oa.range(n.length).reverse()},"default":pu}),_l=oa.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,a=[],o=0,l=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];r>o&&(o=r),a.push(r)}for(e=0;i>e;++e)l[e]=(o-a[e])/2;return l},wiggle:function(n){var t,e,r,u,i,a,o,l,c,s=n.length,f=n[0],h=f.length,g=[];for(g[0]=l=c=0,e=1;h>e;++e){for(t=0,u=0;s>t;++t)u+=n[t][e][1];for(t=0,i=0,o=f[e][0]-f[e-1][0];s>t;++t){for(r=0,a=(n[t][e][1]-n[t][e-1][1])/(2*o);t>r;++r)a+=(n[r][e][1]-n[r][e-1][1])/o;i+=a*n[t][e][1]}g[e]=l-=u?i/u*o:0,c>l&&(c=l)}for(e=0;h>e;++e)g[e]-=c;return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,a=1/u,o=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];if(r)for(t=0;u>t;t++)n[t][e][1]/=r;else for(t=0;u>t;t++)n[t][e][1]=a}for(e=0;i>e;++e)o[e]=0;return o},zero:vu});oa.layout.histogram=function(){function n(n,i){for(var a,o,l=[],c=n.map(e,this),s=r.call(this,c,i),f=u.call(this,s,c,i),i=-1,h=c.length,g=f.length-1,p=t?1:1/h;++i<g;)a=l[i]=[],a.dx=f[i+1]-(a.x=f[i]),a.y=0;if(g>0)for(i=-1;++i<h;)o=c[i],o>=s[0]&&o<=s[1]&&(a=l[oa.bisect(f,o,1,g)-1],a.y+=p,a.push(n[i]));return l}var t=!0,e=Number,r=bu,u=Mu;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=En(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return xu(n,t)}:En(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},oa.layout.pack=function(){function n(n,i){var a=e.call(this,n,i),o=a[0],l=u[0],c=u[1],s=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(o.x=o.y=0,au(o,function(n){n.r=+s(n.value)}),au(o,Nu),r){var f=r*(t?1:Math.max(2*o.r/l,2*o.r/c))/2;au(o,function(n){n.r+=f}),au(o,Nu),au(o,function(n){n.r-=f})}return Cu(o,l/2,c/2,t?1:1/Math.max(2*o.r/l,2*o.r/c)),a}var t,e=oa.layout.hierarchy().sort(_u),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},uu(n,e)},oa.layout.tree=function(){function n(n,u){var s=a.call(this,n,u),f=s[0],h=t(f);if(au(h,e),h.parent.m=-h.z,iu(h,r),c)iu(f,i);else{var g=f,p=f,v=f;iu(f,function(n){n.x<g.x&&(g=n),n.x>p.x&&(p=n),n.depth>v.depth&&(v=n)});var d=o(g,p)/2-g.x,m=l[0]/(p.x+o(p,g)/2+d),y=l[1]/(v.depth||1);iu(f,function(n){n.x=(n.x+d)*m,n.y=n.depth*y})}return s}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var u,i=t.children,a=0,o=i.length;o>a;++a)r.push((i[a]=u={_:i[a],parent:t,children:(u=i[a].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=u);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){Du(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+o(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+o(n._,r._));n.parent.A=u(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function u(n,t,e){if(t){for(var r,u=n,i=n,a=t,l=u.parent.children[0],c=u.m,s=i.m,f=a.m,h=l.m;a=Tu(a),u=qu(u),a&&u;)l=qu(l),i=Tu(i),i.a=n,r=a.z+f-u.z-c+o(a._,u._),r>0&&(Ru(Pu(a,n,e),n,r),c+=r,s+=r),f+=a.m,c+=u.m,h+=l.m,s+=i.m;a&&!Tu(i)&&(i.t=a,i.m+=f-s),u&&!qu(l)&&(l.t=u,l.m+=c-h,e=n)}return e}function i(n){n.x*=l[0],n.y=n.depth*l[1]}var a=oa.layout.hierarchy().sort(null).value(null),o=Lu,l=[1,1],c=null;return n.separation=function(t){return arguments.length?(o=t,n):o},n.size=function(t){return arguments.length?(c=null==(l=t)?i:null,n):c?null:l},n.nodeSize=function(t){return arguments.length?(c=null==(l=t)?null:i,n):c?l:null},uu(n,a)},oa.layout.cluster=function(){function n(n,i){var a,o=t.call(this,n,i),l=o[0],c=0;au(l,function(n){var t=n.children;t&&t.length?(n.x=ju(t),n.y=Uu(t)):(n.x=a?c+=e(n,a):0,n.y=0,a=n)});var s=Fu(l),f=Hu(l),h=s.x-e(s,f)/2,g=f.x+e(f,s)/2;return au(l,u?function(n){n.x=(n.x-l.x)*r[0],n.y=(l.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(l.y?n.y/l.y:1))*r[1]}),o}var t=oa.layout.hierarchy().sort(null).value(null),e=Lu,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},uu(n,t)},oa.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;)r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var i=e.children;if(i&&i.length){var a,o,l,c=f(e),s=[],h=i.slice(),p=1/0,v="slice"===g?c.dx:"dice"===g?c.dy:"slice-dice"===g?1&e.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(n(h,c.dx*c.dy/e.value),s.area=0;(l=h.length)>0;)s.push(a=h[l-1]),s.area+=a.area,"squarify"!==g||(o=r(s,v))<=p?(h.pop(),p=o):(s.area-=s.pop().area,u(s,v,c,!1),v=Math.min(c.dx,c.dy),s.length=s.area=0,p=1/0);s.length&&(u(s,v,c,!0),s.length=s.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,a=f(t),o=r.slice(),l=[];for(n(o,a.dx*a.dy/t.value),l.area=0;i=o.pop();)l.push(i),l.area+=i.area,null!=i.z&&(u(l,i.z?a.dx:a.dy,a,!o.length),l.length=l.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,a=-1,o=n.length;++a<o;)(e=n[a].area)&&(i>e&&(i=e),e>u&&(u=e));return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,a=n.length,o=e.x,c=e.y,s=t?l(n.area/t):0;
if(t==e.dx){for((r||s>e.dy)&&(s=e.dy);++i<a;)u=n[i],u.x=o,u.y=c,u.dy=s,o+=u.dx=Math.min(e.x+e.dx-o,s?l(u.area/s):0);u.z=!0,u.dx+=e.x+e.dx-o,e.y+=s,e.dy-=s}else{for((r||s>e.dx)&&(s=e.dx);++i<a;)u=n[i],u.x=o,u.y=c,u.dx=s,c+=u.dy=Math.min(e.y+e.dy-c,s?l(u.area/s):0);u.z=!1,u.dy+=e.y+e.dy-c,e.x+=s,e.dx-=s}}function i(r){var u=a||o(r),i=u[0];return i.x=i.y=0,i.value?(i.dx=c[0],i.dy=c[1]):i.dx=i.dy=0,a&&o.revalue(i),n([i],i.dx*i.dy/i.value),(a?e:t)(i),h&&(a=u),u}var a,o=oa.layout.hierarchy(),l=Math.round,c=[1,1],s=null,f=Ou,h=!1,g="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(n){return arguments.length?(c=n,i):c},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Ou(t):Iu(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Iu(t,n)}if(!arguments.length)return s;var r;return f=null==(s=n)?Ou:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(l=n?Math.round:Number,i):l!=Number},i.sticky=function(n){return arguments.length?(h=n,a=null,i):h},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},uu(i,o)},oa.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r;while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=oa.random.normal.apply(oa,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=oa.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},oa.scale={};var wl={floor:y,ceil:y};oa.scale.linear=function(){return Wu([0,1],[0,1],Mr,!1)};var Sl={s:1,g:1,p:1,r:1,e:1};oa.scale.log=function(){return ri(oa.scale.linear().domain([0,1]),10,!0,[1,10])};var kl=oa.format(".0e"),Nl={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};oa.scale.pow=function(){return ui(oa.scale.linear(),1,[0,1])},oa.scale.sqrt=function(){return oa.scale.pow().exponent(.5)},oa.scale.ordinal=function(){return ai([],{t:"range",a:[[]]})},oa.scale.category10=function(){return oa.scale.ordinal().range(El)},oa.scale.category20=function(){return oa.scale.ordinal().range(Al)},oa.scale.category20b=function(){return oa.scale.ordinal().range(Cl)},oa.scale.category20c=function(){return oa.scale.ordinal().range(zl)};var El=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(xn),Al=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(xn),Cl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(xn),zl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(xn);oa.scale.quantile=function(){return oi([],[])},oa.scale.quantize=function(){return li(0,1,[0,1])},oa.scale.threshold=function(){return ci([.5],[0,1])},oa.scale.identity=function(){return si([0,1])},oa.svg={},oa.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),c=Math.max(0,+r.apply(this,arguments)),s=a.apply(this,arguments)-Ha,f=o.apply(this,arguments)-Ha,h=Math.abs(f-s),g=s>f?0:1;if(n>c&&(p=c,c=n,n=p),h>=Fa)return t(c,g)+(n?t(n,1-g):"")+"Z";var p,v,d,m,y,M,x,b,_,w,S,k,N=0,E=0,A=[];if((m=(+l.apply(this,arguments)||0)/2)&&(d=i===Ll?Math.sqrt(n*n+c*c):+i.apply(this,arguments),g||(E*=-1),c&&(E=tn(d/c*Math.sin(m))),n&&(N=tn(d/n*Math.sin(m)))),c){y=c*Math.cos(s+E),M=c*Math.sin(s+E),x=c*Math.cos(f-E),b=c*Math.sin(f-E);var C=Math.abs(f-s-2*E)<=Ua?0:1;if(E&&mi(y,M,x,b)===g^C){var z=(s+f)/2;y=c*Math.cos(z),M=c*Math.sin(z),x=b=null}}else y=M=0;if(n){_=n*Math.cos(f-N),w=n*Math.sin(f-N),S=n*Math.cos(s+N),k=n*Math.sin(s+N);var L=Math.abs(s-f+2*N)<=Ua?0:1;if(N&&mi(_,w,S,k)===1-g^L){var q=(s+f)/2;_=n*Math.cos(q),w=n*Math.sin(q),S=k=null}}else _=w=0;if(h>Da&&(p=Math.min(Math.abs(c-n)/2,+u.apply(this,arguments)))>.001){v=c>n^g?0:1;var T=p,R=p;if(Ua>h){var D=null==S?[_,w]:null==x?[y,M]:Re([y,M],[S,k],[x,b],[_,w]),P=y-D[0],U=M-D[1],j=x-D[0],F=b-D[1],H=1/Math.sin(Math.acos((P*j+U*F)/(Math.sqrt(P*P+U*U)*Math.sqrt(j*j+F*F)))/2),O=Math.sqrt(D[0]*D[0]+D[1]*D[1]);R=Math.min(p,(n-O)/(H-1)),T=Math.min(p,(c-O)/(H+1))}if(null!=x){var I=yi(null==S?[_,w]:[S,k],[y,M],c,T,g),Y=yi([x,b],[_,w],c,T,g);p===T?A.push("M",I[0],"A",T,",",T," 0 0,",v," ",I[1],"A",c,",",c," 0 ",1-g^mi(I[1][0],I[1][1],Y[1][0],Y[1][1]),",",g," ",Y[1],"A",T,",",T," 0 0,",v," ",Y[0]):A.push("M",I[0],"A",T,",",T," 0 1,",v," ",Y[0])}else A.push("M",y,",",M);if(null!=S){var Z=yi([y,M],[S,k],n,-R,g),V=yi([_,w],null==x?[y,M]:[x,b],n,-R,g);p===R?A.push("L",V[0],"A",R,",",R," 0 0,",v," ",V[1],"A",n,",",n," 0 ",g^mi(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-g," ",Z[1],"A",R,",",R," 0 0,",v," ",Z[0]):A.push("L",V[0],"A",R,",",R," 0 0,",v," ",Z[0])}else A.push("L",_,",",w)}else A.push("M",y,",",M),null!=x&&A.push("A",c,",",c," 0 ",C,",",g," ",x,",",b),A.push("L",_,",",w),null!=S&&A.push("A",n,",",n," 0 ",L,",",1-g," ",S,",",k);return A.push("Z"),A.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=hi,r=gi,u=fi,i=Ll,a=pi,o=vi,l=di;return n.innerRadius=function(t){return arguments.length?(e=En(t),n):e},n.outerRadius=function(t){return arguments.length?(r=En(t),n):r},n.cornerRadius=function(t){return arguments.length?(u=En(t),n):u},n.padRadius=function(t){return arguments.length?(i=t==Ll?Ll:En(t),n):i},n.startAngle=function(t){return arguments.length?(a=En(t),n):a},n.endAngle=function(t){return arguments.length?(o=En(t),n):o},n.padAngle=function(t){return arguments.length?(l=En(t),n):l},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+a.apply(this,arguments)+ +o.apply(this,arguments))/2-Ha;return[Math.cos(t)*n,Math.sin(t)*n]},n};var Ll="auto";oa.svg.line=function(){return Mi(y)};var ql=oa.map({linear:xi,"linear-closed":bi,step:_i,"step-before":wi,"step-after":Si,basis:zi,"basis-open":Li,"basis-closed":qi,bundle:Ti,cardinal:Ei,"cardinal-open":ki,"cardinal-closed":Ni,monotone:Fi});ql.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var Tl=[0,2/3,1/3,0],Rl=[0,1/3,2/3,0],Dl=[0,1/6,2/3,1/6];oa.svg.line.radial=function(){var n=Mi(Hi);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},wi.reverse=Si,Si.reverse=wi,oa.svg.area=function(){return Oi(y)},oa.svg.area.radial=function(){var n=Oi(Hi);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},oa.svg.chord=function(){function n(n,o){var l=t(this,i,n,o),c=t(this,a,n,o);return"M"+l.p0+r(l.r,l.p1,l.a1-l.a0)+(e(l,c)?u(l.r,l.p1,l.r,l.p0):u(l.r,l.p1,c.r,c.p0)+r(c.r,c.p1,c.a1-c.a0)+u(c.r,c.p1,l.r,l.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=o.call(n,u,r),a=l.call(n,u,r)-Ha,s=c.call(n,u,r)-Ha;return{r:i,a0:a,a1:s,p0:[i*Math.cos(a),i*Math.sin(a)],p1:[i*Math.cos(s),i*Math.sin(s)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>Ua)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=Me,a=xe,o=Ii,l=pi,c=vi;return n.radius=function(t){return arguments.length?(o=En(t),n):o},n.source=function(t){return arguments.length?(i=En(t),n):i},n.target=function(t){return arguments.length?(a=En(t),n):a},n.startAngle=function(t){return arguments.length?(l=En(t),n):l},n.endAngle=function(t){return arguments.length?(c=En(t),n):c},n},oa.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),a=e.call(this,n,u),o=(i.y+a.y)/2,l=[i,{x:i.x,y:o},{x:a.x,y:o},a];return l=l.map(r),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=Me,e=xe,r=Yi;return n.source=function(e){return arguments.length?(t=En(e),n):t},n.target=function(t){return arguments.length?(e=En(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},oa.svg.diagonal.radial=function(){var n=oa.svg.diagonal(),t=Yi,e=n.projection;return n.projection=function(n){return arguments.length?e(Zi(t=n)):t},n},oa.svg.symbol=function(){function n(n,r){return(Pl.get(t.call(this,n,r))||$i)(e.call(this,n,r))}var t=Xi,e=Vi;return n.type=function(e){return arguments.length?(t=En(e),n):t},n.size=function(t){return arguments.length?(e=En(t),n):e},n};var Pl=oa.map({circle:$i,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*jl)),e=t*jl;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/Ul),e=t*Ul/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/Ul),e=t*Ul/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});oa.svg.symbolTypes=Pl.keys();var Ul=Math.sqrt(3),jl=Math.tan(30*Oa);Aa.transition=function(n){for(var t,e,r=Fl||++Yl,u=Ki(n),i=[],a=Hl||{time:Date.now(),ease:Nr,delay:0,duration:250},o=-1,l=this.length;++o<l;){i.push(t=[]);for(var c=this[o],s=-1,f=c.length;++s<f;)(e=c[s])&&Qi(e,s,u,r,a),t.push(e)}return Wi(i,u,r)},Aa.interrupt=function(n){return this.each(null==n?Ol:Bi(Ki(n)))};var Fl,Hl,Ol=Bi(Ki()),Il=[],Yl=0;Il.call=Aa.call,Il.empty=Aa.empty,Il.node=Aa.node,Il.size=Aa.size,oa.transition=function(n,t){return n&&n.transition?Fl?n.transition(t):n:oa.selection().transition(n)},oa.transition.prototype=Il,Il.select=function(n){var t,e,r,u=this.id,i=this.namespace,a=[];n=A(n);for(var o=-1,l=this.length;++o<l;){a.push(t=[]);for(var c=this[o],s=-1,f=c.length;++s<f;)(r=c[s])&&(e=n.call(r,r.__data__,s,o))?("__data__"in r&&(e.__data__=r.__data__),Qi(e,s,i,u,r[i][u]),t.push(e)):t.push(null)}return Wi(a,i,u)},Il.selectAll=function(n){var t,e,r,u,i,a=this.id,o=this.namespace,l=[];n=C(n);for(var c=-1,s=this.length;++c<s;)for(var f=this[c],h=-1,g=f.length;++h<g;)if(r=f[h]){i=r[o][a],e=n.call(r,r.__data__,h,c),l.push(t=[]);for(var p=-1,v=e.length;++p<v;)(u=e[p])&&Qi(u,p,o,a,i),t.push(u)}return Wi(l,o,a)},Il.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=O(n));for(var i=0,a=this.length;a>i;i++){u.push(t=[]);for(var e=this[i],o=0,l=e.length;l>o;o++)(r=e[o])&&n.call(r,r.__data__,o,i)&&t.push(r)}return Wi(u,this.namespace,this.id)},Il.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):Y(this,null==t?function(t){t[r][e].tween.remove(n)}:function(u){u[r][e].tween.set(n,t)})},Il.attr=function(n,t){function e(){this.removeAttribute(o)}function r(){this.removeAttributeNS(o.space,o.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(o);return e!==n&&(t=a(e,n),function(n){this.setAttribute(o,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(o.space,o.local);return e!==n&&(t=a(e,n),function(n){this.setAttributeNS(o.space,o.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var a="transform"==n?$r:Mr,o=oa.ns.qualify(n);return Ji(this,"attr."+n,t,o.local?i:u)},Il.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=oa.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Il.style=function(n,e,r){function u(){this.style.removeProperty(n)}function i(e){return null==e?u:(e+="",function(){var u,i=t(this).getComputedStyle(this,null).getPropertyValue(n);return i!==e&&(u=Mr(i,e),function(t){this.style.setProperty(n,u(t),r)})})}var a=arguments.length;if(3>a){if("string"!=typeof n){2>a&&(e="");for(r in n)this.style(r,n[r],e);return this}r=""}return Ji(this,"style."+n,e,i)},Il.styleTween=function(n,e,r){function u(u,i){var a=e.call(this,u,i,t(this).getComputedStyle(this,null).getPropertyValue(n));return a&&function(t){this.style.setProperty(n,a(t),r)}}return arguments.length<3&&(r=""),this.tween("style."+n,u)},Il.text=function(n){return Ji(this,"text",n,Gi)},Il.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Il.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=oa.ease.apply(oa,arguments)),Y(this,function(r){r[e][t].ease=n}))},Il.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:Y(this,"function"==typeof n?function(r,u,i){r[e][t].delay=+n.call(r,r.__data__,u,i)}:(n=+n,function(r){r[e][t].delay=n}))},Il.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:Y(this,"function"==typeof n?function(r,u,i){r[e][t].duration=Math.max(1,n.call(r,r.__data__,u,i))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Il.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var u=Hl,i=Fl;try{Fl=e,Y(this,function(t,u,i){Hl=t[r][e],n.call(t,t.__data__,u,i)})}finally{Hl=u,Fl=i}}else Y(this,function(u){var i=u[r][e];(i.event||(i.event=oa.dispatch("start","end","interrupt"))).on(n,t)});return this},Il.transition=function(){for(var n,t,e,r,u=this.id,i=++Yl,a=this.namespace,o=[],l=0,c=this.length;c>l;l++){o.push(n=[]);for(var t=this[l],s=0,f=t.length;f>s;s++)(e=t[s])&&(r=e[a][u],Qi(e,s,a,i,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),n.push(e)}return Wi(o,a,i)},oa.svg.axis=function(){function n(n){n.each(function(){var n,c=oa.select(this),s=this.__chart__||e,f=this.__chart__=e.copy(),h=null==l?f.ticks?f.ticks.apply(f,o):f.domain():l,g=null==t?f.tickFormat?f.tickFormat.apply(f,o):y:t,p=c.selectAll(".tick").data(h,f),v=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Da),d=oa.transition(p.exit()).style("opacity",Da).remove(),m=oa.transition(p.order()).style("opacity",1),M=Math.max(u,0)+a,x=Zu(f),b=c.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),oa.transition(b));v.append("line"),v.append("text");var w,S,k,N,E=v.select("line"),A=m.select("line"),C=p.select("text").text(g),z=v.select("text"),L=m.select("text"),q="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=na,w="x",k="y",S="x2",N="y2",C.attr("dy",0>q?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+x[0]+","+q*i+"V0H"+x[1]+"V"+q*i)):(n=ta,w="y",k="x",S="y2",N="x2",C.attr("dy",".32em").style("text-anchor",0>q?"end":"start"),_.attr("d","M"+q*i+","+x[0]+"H0V"+x[1]+"H"+q*i)),E.attr(N,q*u),z.attr(k,q*M),A.attr(S,0).attr(N,q*u),L.attr(w,0).attr(k,q*M),f.rangeBand){var T=f,R=T.rangeBand()/2;s=f=function(n){return T(n)+R}}else s.rangeBand?s=f:d.call(n,f,s);v.call(n,s,f),m.call(n,f,f)})}var t,e=oa.scale.linear(),r=Zl,u=6,i=6,a=3,o=[10],l=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Vl?t+"":Zl,n):r},n.ticks=function(){return arguments.length?(o=ca(arguments),n):o},n.tickValues=function(t){return arguments.length?(l=t,n):l},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(a=+t,n):a},n.tickSubdivide=function(){return arguments.length&&n},n};var Zl="bottom",Vl={top:1,right:1,bottom:1,left:1};oa.svg.brush=function(){function n(t){t.each(function(){var t=oa.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),a=t.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var o=t.selectAll(".resize").data(v,y);o.exit().remove(),o.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Xl[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),o.style("display",n.empty()?"none":null);var l,f=oa.transition(t),h=oa.transition(a);c&&(l=Zu(c),h.attr("x",l[0]).attr("width",l[1]-l[0]),r(f)),s&&(l=Zu(s),h.attr("y",l[0]).attr("height",l[1]-l[0]),u(f)),e(f)})}function e(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+f[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function r(n){n.select(".extent").attr("x",f[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1]-f[0])}function u(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function i(){function i(){32==oa.event.keyCode&&(C||(M=null,L[0]-=f[1],L[1]-=h[1],C=2),S())}function v(){32==oa.event.keyCode&&2==C&&(L[0]+=f[1],L[1]+=h[1],C=0,S())}function d(){var n=oa.mouse(b),t=!1;x&&(n[0]+=x[0],n[1]+=x[1]),C||(oa.event.altKey?(M||(M=[(f[0]+f[1])/2,(h[0]+h[1])/2]),L[0]=f[+(n[0]<M[0])],L[1]=h[+(n[1]<M[1])]):M=null),E&&m(n,c,0)&&(r(k),t=!0),A&&m(n,s,1)&&(u(k),t=!0),t&&(e(k),w({type:"brush",mode:C?"move":"resize"}))}function m(n,t,e){var r,u,i=Zu(t),l=i[0],c=i[1],s=L[e],v=e?h:f,d=v[1]-v[0];return C&&(l-=s,c-=d+s),r=(e?p:g)?Math.max(l,Math.min(c,n[e])):n[e],C?u=(r+=s)+d:(M&&(s=Math.max(l,Math.min(c,2*M[e]-r))),r>s?(u=r,r=s):u=s),v[0]!=r||v[1]!=u?(e?o=null:a=null,v[0]=r,v[1]=u,!0):void 0}function y(){d(),k.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),oa.select("body").style("cursor",null),q.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),z(),w({type:"brushend"})}var M,x,b=this,_=oa.select(oa.event.target),w=l.of(b,arguments),k=oa.select(b),N=_.datum(),E=!/^(n|s)$/.test(N)&&c,A=!/^(e|w)$/.test(N)&&s,C=_.classed("extent"),z=W(b),L=oa.mouse(b),q=oa.select(t(b)).on("keydown.brush",i).on("keyup.brush",v);if(oa.event.changedTouches?q.on("touchmove.brush",d).on("touchend.brush",y):q.on("mousemove.brush",d).on("mouseup.brush",y),k.interrupt().selectAll("*").interrupt(),C)L[0]=f[0]-L[0],L[1]=h[0]-L[1];else if(N){var T=+/w$/.test(N),R=+/^n/.test(N);x=[f[1-T]-L[0],h[1-R]-L[1]],L[0]=f[T],L[1]=h[R]}else oa.event.altKey&&(M=L.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),oa.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),d()}var a,o,l=N(n,"brushstart","brush","brushend"),c=null,s=null,f=[0,0],h=[0,0],g=!0,p=!0,v=$l[0];return n.event=function(n){n.each(function(){var n=l.of(this,arguments),t={x:f,y:h,i:a,j:o},e=this.__chart__||t;this.__chart__=t,Fl?oa.select(this).transition().each("start.brush",function(){a=e.i,o=e.j,f=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=xr(f,t.x),r=xr(h,t.y);return a=o=null,function(u){f=t.x=e(u),h=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=t.i,o=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,v=$l[!c<<1|!s],n):c},n.y=function(t){return arguments.length?(s=t,v=$l[!c<<1|!s],n):s},n.clamp=function(t){return arguments.length?(c&&s?(g=!!t[0],p=!!t[1]):c?g=!!t:s&&(p=!!t),n):c&&s?[g,p]:c?g:s?p:null},n.extent=function(t){var e,r,u,i,l;return arguments.length?(c&&(e=t[0],r=t[1],s&&(e=e[0],r=r[0]),a=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(l=e,e=r,r=l),(e!=f[0]||r!=f[1])&&(f=[e,r])),s&&(u=t[0],i=t[1],c&&(u=u[1],i=i[1]),o=[u,i],s.invert&&(u=s(u),i=s(i)),u>i&&(l=u,u=i,i=l),(u!=h[0]||i!=h[1])&&(h=[u,i])),n):(c&&(a?(e=a[0],r=a[1]):(e=f[0],r=f[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(l=e,e=r,r=l))),s&&(o?(u=o[0],i=o[1]):(u=h[0],i=h[1],s.invert&&(u=s.invert(u),i=s.invert(i)),u>i&&(l=u,u=i,i=l))),c&&s?[[e,u],[r,i]]:c?[e,r]:s&&[u,i])},n.clear=function(){return n.empty()||(f=[0,0],h=[0,0],a=o=null),n},n.empty=function(){return!!c&&f[0]==f[1]||!!s&&h[0]==h[1]},oa.rebind(n,l,"on")};var Xl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$l=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Bl=ho.format=Mo.timeFormat,Wl=Bl.utc,Jl=Wl("%Y-%m-%dT%H:%M:%S.%LZ");Bl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?ea:Jl,ea.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},ea.toString=Jl.toString,ho.second=On(function(n){return new go(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),ho.seconds=ho.second.range,ho.seconds.utc=ho.second.utc.range,ho.minute=On(function(n){return new go(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),ho.minutes=ho.minute.range,ho.minutes.utc=ho.minute.utc.range,ho.hour=On(function(n){var t=n.getTimezoneOffset()/60;return new go(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),ho.hours=ho.hour.range,ho.hours.utc=ho.hour.utc.range,ho.month=On(function(n){return n=ho.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),ho.months=ho.month.range,ho.months.utc=ho.month.utc.range;var Gl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Kl=[[ho.second,1],[ho.second,5],[ho.second,15],[ho.second,30],[ho.minute,1],[ho.minute,5],[ho.minute,15],[ho.minute,30],[ho.hour,1],[ho.hour,3],[ho.hour,6],[ho.hour,12],[ho.day,1],[ho.day,2],[ho.week,1],[ho.month,1],[ho.month,3],[ho.year,1]],Ql=Bl.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",zt]]),nc={range:function(n,t,e){return oa.range(Math.ceil(n/e)*e,+t,e).map(ua)},floor:y,ceil:y};Kl.year=ho.year,ho.scale=function(){return ra(oa.scale.linear(),Kl,Ql)};var tc=Kl.map(function(n){return[n[0].utc,n[1]]}),ec=Wl.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",zt]]);tc.year=ho.year.utc,ho.scale.utc=function(){return ra(oa.scale.linear(),tc,ec)},oa.text=An(function(n){return n.responseText}),oa.json=function(n,t){return Cn(n,"application/json",ia,t)},oa.html=function(n,t){return Cn(n,"text/html",aa,t)},oa.xml=An(function(n){return n.responseXML}),"function"==typeof define&&define.amd?(this.d3=oa,define(oa)):"object"==typeof module&&module.exports?module.exports=oa:this.d3=oa}();
</script>
<script>/**
 * Parts Copyright (C) 2011-2012, Alex Russell (slightlyoff@chromium.org)
 * Parts Copyright (C) Copyright (C) 1998-2000 Greg J. Badros
 *
 * Use of this source code is governed by the LGPL, which can be found in the
 * COPYING.LGPL file.
 *
 * This is a compiled version of Cassowary/JS. For source versions or to
 * contribute, see the github project:
 *
 *  https://github.com/slightlyoff/cassowary-js-refactor
 *
 */

(function() {
(function(a){"use strict";try{(function(){}).bind(a)}catch(b){Object.defineProperty(Function.prototype,"bind",{value:function(a){var b=this;return function(){return b.apply(a,arguments)}},enumerable:!1,configurable:!0,writable:!0})}var c=a.HTMLElement!==void 0,d=function(a){for(var b=null;a&&a!=Object.prototype;){if(a.tagName){b=a.tagName;break}a=a.prototype}return b||"div"},e=1e-8,f={},g=function(a,b){if(a&&b){if("function"==typeof a[b])return a[b];var c=a.prototype;if(c&&"function"==typeof c[b])return c[b];if(c!==Object.prototype&&c!==Function.prototype)return"function"==typeof a.__super__?g(a.__super__,b):void 0}},h=a.c={debug:!1,trace:!1,verbose:!1,traceAdded:!1,GC:!1,GEQ:1,LEQ:2,inherit:function(b){var e=null,g=null;b["extends"]&&(g=b["extends"],delete b["extends"]),b.initialize&&(e=b.initialize,delete b.initialize);var h=e||function(){};Object.defineProperty(h,"__super__",{value:g?g:Object,enumerable:!1,configurable:!0,writable:!1}),b._t&&(f[b._t]=h);var i=h.prototype=Object.create(g?g.prototype:Object.prototype);if(this.extend(i,b),c&&g&&g.prototype instanceof a.HTMLElement){var j=h,k=d(i),l=function(a){return a.__proto__=i,j.apply(a,arguments),i.created&&a.created(),i.decorate&&a.decorate(),a};this.extend(i,{upgrade:l}),h=function(){return l(a.document.createElement(k))},h.prototype=i,this.extend(h,{ctor:j})}return h},extend:function(a,b){return this.own(b,function(c){var d=Object.getOwnPropertyDescriptor(b,c);try{"function"==typeof d.get||"function"==typeof d.set?Object.defineProperty(a,c,d):"function"==typeof d.value||"_"===c.charAt(0)?(d.writable=!0,d.configurable=!0,d.enumerable=!1,Object.defineProperty(a,c,d)):a[c]=b[c]}catch(e){}}),a},own:function(b,c,d){return Object.getOwnPropertyNames(b).forEach(c,d||a),b},traceprint:function(a){h.verbose&&console.log(a)},fnenterprint:function(a){console.log("* "+a)},fnexitprint:function(a){console.log("- "+a)},assert:function(a,b){if(!a)throw new h.InternalError("Assertion failed: "+b)},plus:function(a,b){return a instanceof h.Expression||(a=new h.Expression(a)),b instanceof h.Expression||(b=new h.Expression(b)),a.plus(b)},minus:function(a,b){return a instanceof h.Expression||(a=new h.Expression(a)),b instanceof h.Expression||(b=new h.Expression(b)),a.minus(b)},times:function(a,b){return("number"==typeof a||a instanceof h.Variable)&&(a=new h.Expression(a)),("number"==typeof b||b instanceof h.Variable)&&(b=new h.Expression(b)),a.times(b)},divide:function(a,b){return("number"==typeof a||a instanceof h.Variable)&&(a=new h.Expression(a)),("number"==typeof b||b instanceof h.Variable)&&(b=new h.Expression(b)),a.divide(b)},approx:function(a,b){if(a===b)return!0;var c,d;return c=a instanceof h.Variable?a.value:a,d=b instanceof h.Variable?b.value:b,0==c?e>Math.abs(d):0==d?e>Math.abs(c):Math.abs(c-d)<Math.abs(c)*e},_inc:function(a){return function(){return a++}}(0),parseJSON:function(a){return JSON.parse(a,function(a,b){if("object"!=typeof b||"string"!=typeof b._t)return b;var c=b._t,d=f[c];if(c&&d){var e=g(d,"fromJSON");if(e)return e(b,d)}return b})}};"function"==typeof require&&"undefined"!=typeof module&&"undefined"==typeof load&&(a.exports=h)})(this),function(a){"use strict";var b=function(a){var b=a.hashCode?a.hashCode:""+a;return b},c=function(a,b){Object.keys(a).forEach(function(c){b[c]=a[c]})},d={};a.HashTable=a.inherit({initialize:function(){this.size=0,this._store={},this._keyStrMap={},this._deleted=0},set:function(a,c){var d=b(a);this._store.hasOwnProperty(d)||this.size++,this._store[d]=c,this._keyStrMap[d]=a},get:function(a){if(!this.size)return null;a=b(a);var c=this._store[a];return c!==void 0?this._store[a]:null},clear:function(){this.size=0,this._store={},this._keyStrMap={}},_compact:function(){var a={};c(this._store,a),this._store=a},_compactThreshold:100,_perhapsCompact:function(){this._size>64||this._deleted>this._compactThreshold&&(this._compact(),this._deleted=0)},"delete":function(a){a=b(a),this._store.hasOwnProperty(a)&&(this._deleted++,delete this._store[a],this.size>0&&this.size--)},each:function(a,b){if(this.size){this._perhapsCompact();var c=this._store,d=this._keyStrMap;Object.keys(this._store).forEach(function(e){a.call(b||null,d[e],c[e])},this)}},escapingEach:function(a,b){if(this.size){this._perhapsCompact();for(var c=this,e=this._store,f=this._keyStrMap,g=d,h=Object.keys(e),i=0;h.length>i;i++)if(function(d){c._store.hasOwnProperty(d)&&(g=a.call(b||null,f[d],e[d]))}(h[i]),g){if(void 0!==g.retval)return g;if(g.brk)break}}},clone:function(){var b=new a.HashTable;return this.size&&(b.size=this.size,c(this._store,b._store),c(this._keyStrMap,b._keyStrMap)),b},equals:function(b){if(b===this)return!0;if(!(b instanceof a.HashTable)||b._size!==this._size)return!1;for(var c=Object.keys(this._store),d=0;c.length>d;d++){var e=c[d];if(this._keyStrMap[e]!==b._keyStrMap[e]||this._store[e]!==b._store[e])return!1}return!0},toString:function(){var b="";return this.each(function(a,c){b+=a+" => "+c+"\n"}),b}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.HashSet=a.inherit({_t:"c.HashSet",initialize:function(){this.storage=[],this.size=0},add:function(a){var b=this.storage;b.indexOf(a),-1==b.indexOf(a)&&b.push(a),this.size=this.storage.length},values:function(){return this.storage},has:function(a){var b=this.storage;return-1!=b.indexOf(a)},"delete":function(a){var b=this.storage.indexOf(a);return-1==b?null:(this.storage.splice(b,1)[0],this.size=this.storage.length,void 0)},clear:function(){this.storage.length=0},each:function(a,b){this.size&&this.storage.forEach(a,b)},escapingEach:function(a,b){this.size&&this.storage.forEach(a,b)},toString:function(){var a=this.size+" {",b=!0;return this.each(function(c){b?b=!1:a+=", ",a+=c}),a+="}\n"},toJSON:function(){var a=[];return this.each(function(b){a.push(b.toJSON())}),{_t:"c.HashSet",data:a}},fromJSON:function(b){var c=new a.HashSet;return b.data&&(c.size=b.data.length,c.storage=b.data),c}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.Error=a.inherit({initialize:function(a){a&&(this._description=a)},_name:"c.Error",_description:"An error has occured in Cassowary",set description(a){this._description=a},get description(){return"("+this._name+") "+this._description},get message(){return this.description},toString:function(){return this.description}});var b=function(b,c){return a.inherit({"extends":a.Error,initialize:function(){a.Error.apply(this,arguments)},_name:b||"",_description:c||""})};a.ConstraintNotFound=b("c.ConstraintNotFound","Tried to remove a constraint never added to the tableu"),a.InternalError=b("c.InternalError"),a.NonExpression=b("c.NonExpression","The resulting expression would be non"),a.NotEnoughStays=b("c.NotEnoughStays","There are not enough stays to give specific values to every variable"),a.RequiredFailure=b("c.RequiredFailure","A required constraint cannot be satisfied"),a.TooDifficult=b("c.TooDifficult","The constraints are too difficult to solve")}(this.c||module.parent.exports||{}),function(a){"use strict";var b=1e3;a.SymbolicWeight=a.inherit({_t:"c.SymbolicWeight",initialize:function(){this.value=0;for(var a=1,c=arguments.length-1;c>=0;--c)this.value+=arguments[c]*a,a*=b},toJSON:function(){return{_t:this._t,value:this.value}}})}(this.c||module.parent.exports||{}),function(a){a.Strength=a.inherit({initialize:function(b,c,d,e){this.name=b,this.symbolicWeight=c instanceof a.SymbolicWeight?c:new a.SymbolicWeight(c,d,e)},get required(){return this===a.Strength.required},toString:function(){return this.name+(this.isRequired?"":":"+this.symbolicWeight)}}),a.Strength.required=new a.Strength("<Required>",1e3,1e3,1e3),a.Strength.strong=new a.Strength("strong",1,0,0),a.Strength.medium=new a.Strength("medium",0,1,0),a.Strength.weak=new a.Strength("weak",0,0,1)}(this.c||("undefined"!=typeof module?module.parent.exports.c:{})),function(a){"use strict";a.AbstractVariable=a.inherit({isDummy:!1,isExternal:!1,isPivotable:!1,isRestricted:!1,_init:function(b,c){this.hashCode=a._inc(),this.name=(c||"")+this.hashCode,b&&(b.name!==void 0&&(this.name=b.name),b.value!==void 0&&(this.value=b.value),b.prefix!==void 0&&(this._prefix=b.prefix))},_prefix:"",name:"",value:0,toJSON:function(){var a={};return this._t&&(a._t=this._t),this.name&&(a.name=this.name),this.value!==void 0&&(a.value=this.value),this._prefix&&(a._prefix=this._prefix),this._t&&(a._t=this._t),a},fromJSON:function(b,c){var d=new c;return a.extend(d,b),d},toString:function(){return this._prefix+"["+this.name+":"+this.value+"]"}}),a.Variable=a.inherit({_t:"c.Variable","extends":a.AbstractVariable,initialize:function(b){this._init(b,"v");var c=a.Variable._map;c&&(c[this.name]=this)},isExternal:!0}),a.DummyVariable=a.inherit({_t:"c.DummyVariable","extends":a.AbstractVariable,initialize:function(a){this._init(a,"d")},isDummy:!0,isRestricted:!0,value:"dummy"}),a.ObjectiveVariable=a.inherit({_t:"c.ObjectiveVariable","extends":a.AbstractVariable,initialize:function(a){this._init(a,"o")},value:"obj"}),a.SlackVariable=a.inherit({_t:"c.SlackVariable","extends":a.AbstractVariable,initialize:function(a){this._init(a,"s")},isPivotable:!0,isRestricted:!0,value:"slack"})}(this.c||module.parent.exports||{}),function(a){"use strict";a.Point=a.inherit({initialize:function(b,c,d){if(b instanceof a.Variable)this._x=b;else{var e={value:b};d&&(e.name="x"+d),this._x=new a.Variable(e)}if(c instanceof a.Variable)this._y=c;else{var f={value:c};d&&(f.name="y"+d),this._y=new a.Variable(f)}},get x(){return this._x},set x(b){b instanceof a.Variable?this._x=b:this._x.value=b},get y(){return this._y},set y(b){b instanceof a.Variable?this._y=b:this._y.value=b},toString:function(){return"("+this.x+", "+this.y+")"}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.Expression=a.inherit({initialize:function(b,c,d){a.GC&&console.log("new c.Expression"),this.constant="number"!=typeof d||isNaN(d)?0:d,this.terms=new a.HashTable,b instanceof a.AbstractVariable?this.setVariable(b,"number"==typeof c?c:1):"number"==typeof b&&(isNaN(b)?console.trace():this.constant=b)},initializeFromHash:function(b,c){return a.verbose&&(console.log("*******************************"),console.log("clone c.initializeFromHash"),console.log("*******************************")),a.GC&&console.log("clone c.Expression"),this.constant=b,this.terms=c.clone(),this},multiplyMe:function(a){this.constant*=a;var b=this.terms;return b.each(function(c,d){b.set(c,d*a)}),this},clone:function(){a.verbose&&(console.log("*******************************"),console.log("clone c.Expression"),console.log("*******************************"));var b=new a.Expression;return b.initializeFromHash(this.constant,this.terms),b},times:function(b){if("number"==typeof b)return this.clone().multiplyMe(b);if(this.isConstant)return b.times(this.constant);if(b.isConstant)return this.times(b.constant);throw new a.NonExpression},plus:function(b){return b instanceof a.Expression?this.clone().addExpression(b,1):b instanceof a.Variable?this.clone().addVariable(b,1):void 0},minus:function(b){return b instanceof a.Expression?this.clone().addExpression(b,-1):b instanceof a.Variable?this.clone().addVariable(b,-1):void 0},divide:function(b){if("number"==typeof b){if(a.approx(b,0))throw new a.NonExpression;return this.times(1/b)}if(b instanceof a.Expression){if(!b.isConstant)throw new a.NonExpression;return this.times(1/b.constant)}},addExpression:function(b,c,d,e){return b instanceof a.AbstractVariable&&(b=new a.Expression(b),a.trace&&console.log("addExpression: Had to cast a var to an expression")),c=c||1,this.constant+=c*b.constant,b.terms.each(function(a,b){this.addVariable(a,b*c,d,e)},this),this},addVariable:function(b,c,d,e){null==c&&(c=1),a.trace&&console.log("c.Expression::addVariable():",b,c);var f=this.terms.get(b);if(f){var g=f+c;0==g||a.approx(g,0)?(e&&e.noteRemovedVariable(b,d),this.terms.delete(b)):this.setVariable(b,g)}else a.approx(c,0)||(this.setVariable(b,c),e&&e.noteAddedVariable(b,d));return this},setVariable:function(a,b){return this.terms.set(a,b),this},anyPivotableVariable:function(){if(this.isConstant)throw new a.InternalError("anyPivotableVariable called on a constant");var b=this.terms.escapingEach(function(a){return a.isPivotable?{retval:a}:void 0});return b&&void 0!==b.retval?b.retval:null},substituteOut:function(b,c,d,e){a.trace&&(a.fnenterprint("CLE:substituteOut: "+b+", "+c+", "+d+", ..."),a.traceprint("this = "+this));var f=this.setVariable.bind(this),g=this.terms,h=g.get(b);g.delete(b),this.constant+=h*c.constant,c.terms.each(function(b,c){var i=g.get(b);if(i){var j=i+h*c;a.approx(j,0)?(e.noteRemovedVariable(b,d),g.delete(b)):f(b,j)}else f(b,h*c),e&&e.noteAddedVariable(b,d)}),a.trace&&a.traceprint("Now this is "+this)},changeSubject:function(a,b){this.setVariable(a,this.newSubject(b))},newSubject:function(b){a.trace&&a.fnenterprint("newSubject:"+b);var c=1/this.terms.get(b);return this.terms.delete(b),this.multiplyMe(-c),c},coefficientFor:function(a){return this.terms.get(a)||0},get isConstant(){return 0==this.terms.size},toString:function(){var b="",c=!1;if(!a.approx(this.constant,0)||this.isConstant){if(b+=this.constant,this.isConstant)return b;c=!0}return this.terms.each(function(a,d){c&&(b+=" + "),b+=d+"*"+a,c=!0}),b},equals:function(b){return b===this?!0:b instanceof a.Expression&&b.constant===this.constant&&b.terms.equals(this.terms)},Plus:function(a,b){return a.plus(b)},Minus:function(a,b){return a.minus(b)},Times:function(a,b){return a.times(b)},Divide:function(a,b){return a.divide(b)}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.AbstractConstraint=a.inherit({initialize:function(b,c){this.hashCode=a._inc(),this.strength=b||a.Strength.required,this.weight=c||1},isEditConstraint:!1,isInequality:!1,isStayConstraint:!1,get required(){return this.strength===a.Strength.required},toString:function(){return this.strength+" {"+this.weight+"} ("+this.expression+")"}});var b=a.AbstractConstraint.prototype.toString,c=function(b,c,d){a.AbstractConstraint.call(this,c||a.Strength.strong,d),this.variable=b,this.expression=new a.Expression(b,-1,b.value)};a.EditConstraint=a.inherit({"extends":a.AbstractConstraint,initialize:function(){c.apply(this,arguments)},isEditConstraint:!0,toString:function(){return"edit:"+b.call(this)}}),a.StayConstraint=a.inherit({"extends":a.AbstractConstraint,initialize:function(){c.apply(this,arguments)},isStayConstraint:!0,toString:function(){return"stay:"+b.call(this)}});var d=a.Constraint=a.inherit({"extends":a.AbstractConstraint,initialize:function(b,c,d){a.AbstractConstraint.call(this,c,d),this.expression=b}});a.Inequality=a.inherit({"extends":a.Constraint,_cloneOrNewCle:function(b){return b.clone?b.clone():new a.Expression(b)},initialize:function(b,c,e,f,g){var h=b instanceof a.Expression,i=e instanceof a.Expression,j=b instanceof a.AbstractVariable,k=e instanceof a.AbstractVariable,l="number"==typeof b,m="number"==typeof e;if((h||l)&&k){var n=b,o=c,p=e,q=f,r=g;if(d.call(this,this._cloneOrNewCle(n),q,r),o==a.LEQ)this.expression.multiplyMe(-1),this.expression.addVariable(p);else{if(o!=a.GEQ)throw new a.InternalError("Invalid operator in c.Inequality constructor");this.expression.addVariable(p,-1)}}else if(j&&(i||m)){var n=e,o=c,p=b,q=f,r=g;if(d.call(this,this._cloneOrNewCle(n),q,r),o==a.GEQ)this.expression.multiplyMe(-1),this.expression.addVariable(p);else{if(o!=a.LEQ)throw new a.InternalError("Invalid operator in c.Inequality constructor");this.expression.addVariable(p,-1)}}else{if(h&&m){var s=b,o=c,t=e,q=f,r=g;if(d.call(this,this._cloneOrNewCle(s),q,r),o==a.LEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(t));else{if(o!=a.GEQ)throw new a.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(t),-1)}return this}if(l&&i){var s=e,o=c,t=b,q=f,r=g;if(d.call(this,this._cloneOrNewCle(s),q,r),o==a.GEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(t));else{if(o!=a.LEQ)throw new a.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(t),-1)}return this}if(h&&i){var s=b,o=c,t=e,q=f,r=g;if(d.call(this,this._cloneOrNewCle(t),q,r),o==a.GEQ)this.expression.multiplyMe(-1),this.expression.addExpression(this._cloneOrNewCle(s));else{if(o!=a.LEQ)throw new a.InternalError("Invalid operator in c.Inequality constructor");this.expression.addExpression(this._cloneOrNewCle(s),-1)}}else{if(h)return d.call(this,b,c,e);if(c==a.GEQ)d.call(this,new a.Expression(e),f,g),this.expression.multiplyMe(-1),this.expression.addVariable(b);else{if(c!=a.LEQ)throw new a.InternalError("Invalid operator in c.Inequality constructor");d.call(this,new a.Expression(e),f,g),this.expression.addVariable(b,-1)}}}},isInequality:!0,toString:function(){return d.prototype.toString.call(this)+" >= 0) id: "+this.hashCode}}),a.Equation=a.inherit({"extends":a.Constraint,initialize:function(b,c,e,f){if(b instanceof a.Expression&&!c||c instanceof a.Strength)d.call(this,b,c,e);else if(b instanceof a.AbstractVariable&&c instanceof a.Expression){var g=b,h=c,i=e,j=f;d.call(this,h.clone(),i,j),this.expression.addVariable(g,-1)}else if(b instanceof a.AbstractVariable&&"number"==typeof c){var g=b,k=c,i=e,j=f;d.call(this,new a.Expression(k),i,j),this.expression.addVariable(g,-1)}else if(b instanceof a.Expression&&c instanceof a.AbstractVariable){var h=b,g=c,i=e,j=f;d.call(this,h.clone(),i,j),this.expression.addVariable(g,-1)}else{if(!(b instanceof a.Expression||b instanceof a.AbstractVariable||"number"==typeof b)||!(c instanceof a.Expression||c instanceof a.AbstractVariable||"number"==typeof c))throw"Bad initializer to c.Equation";b=b instanceof a.Expression?b.clone():new a.Expression(b),c=c instanceof a.Expression?c.clone():new a.Expression(c),d.call(this,b,e,f),this.expression.addExpression(c,-1)}a.assert(this.strength instanceof a.Strength,"_strength not set")},toString:function(){return d.prototype.toString.call(this)+" = 0)"}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.EditInfo=a.inherit({initialize:function(a,b,c,d,e){this.constraint=a,this.editPlus=b,this.editMinus=c,this.prevEditConstant=d,this.index=e},toString:function(){return"<cn="+this.constraint+", ep="+this.editPlus+", em="+this.editMinus+", pec="+this.prevEditConstant+", index="+this.index+">"}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.Tableau=a.inherit({initialize:function(){this.columns=new a.HashTable,this.rows=new a.HashTable,this._infeasibleRows=new a.HashSet,this._externalRows=new a.HashSet,this._externalParametricVars=new a.HashSet},noteRemovedVariable:function(b,c){a.trace&&console.log("c.Tableau::noteRemovedVariable: ",b,c);var d=this.columns.get(b);c&&d&&d.delete(c)},noteAddedVariable:function(a,b){b&&this.insertColVar(a,b)},getInternalInfo:function(){var a="Tableau Information:\n";return a+="Rows: "+this.rows.size,a+=" (= "+(this.rows.size-1)+" constraints)",a+="\nColumns: "+this.columns.size,a+="\nInfeasible Rows: "+this._infeasibleRows.size,a+="\nExternal basic variables: "+this._externalRows.size,a+="\nExternal parametric variables: ",a+=this._externalParametricVars.size,a+="\n"},toString:function(){var a="Tableau:\n";return this.rows.each(function(b,c){a+=b,a+=" <==> ",a+=c,a+="\n"}),a+="\nColumns:\n",a+=this.columns,a+="\nInfeasible rows: ",a+=this._infeasibleRows,a+="External basic variables: ",a+=this._externalRows,a+="External parametric variables: ",a+=this._externalParametricVars},insertColVar:function(b,c){var d=this.columns.get(b);d||(d=new a.HashSet,this.columns.set(b,d)),d.add(c)},addRow:function(b,c){a.trace&&a.fnenterprint("addRow: "+b+", "+c),this.rows.set(b,c),c.terms.each(function(a){this.insertColVar(a,b),a.isExternal&&this._externalParametricVars.add(a)},this),b.isExternal&&this._externalRows.add(b),a.trace&&a.traceprint(""+this)},removeColumn:function(b){a.trace&&a.fnenterprint("removeColumn:"+b);var c=this.columns.get(b);c?(this.columns.delete(b),c.each(function(a){var c=this.rows.get(a);c.terms.delete(b)},this)):a.trace&&console.log("Could not find var",b,"in columns"),b.isExternal&&(this._externalRows.delete(b),this._externalParametricVars.delete(b))},removeRow:function(b){a.trace&&a.fnenterprint("removeRow:"+b);var c=this.rows.get(b);return a.assert(null!=c),c.terms.each(function(c){var e=this.columns.get(c);null!=e&&(a.trace&&console.log("removing from varset:",b),e.delete(b))},this),this._infeasibleRows.delete(b),b.isExternal&&this._externalRows.delete(b),this.rows.delete(b),a.trace&&a.fnexitprint("returning "+c),c},substituteOut:function(b,c){a.trace&&a.fnenterprint("substituteOut:"+b+", "+c),a.trace&&a.traceprint(""+this);var d=this.columns.get(b);d.each(function(a){var d=this.rows.get(a);d.substituteOut(b,c,a,this),a.isRestricted&&0>d.constant&&this._infeasibleRows.add(a)},this),b.isExternal&&(this._externalRows.add(b),this._externalParametricVars.delete(b)),this.columns.delete(b)},columnsHasKey:function(a){return!!this.columns.get(a)}})}(this.c||module.parent.exports||{}),function(a){var b=a.Tableau,c=b.prototype,d=1e-8,e=a.Strength.weak;a.SimplexSolver=a.inherit({"extends":a.Tableau,initialize:function(){a.Tableau.call(this),this._stayMinusErrorVars=[],this._stayPlusErrorVars=[],this._errorVars=new a.HashTable,this._markerVars=new a.HashTable,this._objective=new a.ObjectiveVariable({name:"Z"}),this._editVarMap=new a.HashTable,this._editVarList=[],this._slackCounter=0,this._artificialCounter=0,this._dummyCounter=0,this.autoSolve=!0,this._fNeedsSolving=!1,this._optimizeCount=0,this.rows.set(this._objective,new a.Expression),this._stkCedcns=[0],a.trace&&a.traceprint("objective expr == "+this.rows.get(this._objective))},addLowerBound:function(b,c){var d=new a.Inequality(b,a.GEQ,new a.Expression(c));return this.addConstraint(d)},addUpperBound:function(b,c){var d=new a.Inequality(b,a.LEQ,new a.Expression(c));return this.addConstraint(d)},addBounds:function(a,b,c){return this.addLowerBound(a,b),this.addUpperBound(a,c),this},add:function(){for(var a=0;arguments.length>a;a++)this.addConstraint(arguments[a]);return this},addConstraint:function(b){a.trace&&a.fnenterprint("addConstraint: "+b);var c=Array(2),d=Array(1),e=this.newExpression(b,c,d);if(d=d[0],this.tryAddingDirectly(e)||this.addWithArtificialVariable(e),this._fNeedsSolving=!0,b.isEditConstraint){var f=this._editVarMap.size,g=c[0],h=c[1];!g instanceof a.SlackVariable&&console.warn("cvEplus not a slack variable =",g),!h instanceof a.SlackVariable&&console.warn("cvEminus not a slack variable =",h),a.debug&&console.log("new c.EditInfo("+b+", "+g+", "+h+", "+d+", "+f+")");var i=new a.EditInfo(b,g,h,d,f);this._editVarMap.set(b.variable,i),this._editVarList[f]={v:b.variable,info:i}}return this.autoSolve&&(this.optimize(this._objective),this._setExternalVariables()),this},addConstraintNoException:function(b){a.trace&&a.fnenterprint("addConstraintNoException: "+b);try{return this.addConstraint(b),!0}catch(c){return!1}},addEditVar:function(b,c){return a.trace&&a.fnenterprint("addEditVar: "+b+" @ "+c),this.addConstraint(new a.EditConstraint(b,c||a.Strength.strong))},beginEdit:function(){return a.assert(this._editVarMap.size>0,"_editVarMap.size > 0"),this._infeasibleRows.clear(),this._resetStayConstants(),this._stkCedcns.push(this._editVarMap.size),this},endEdit:function(){return a.assert(this._editVarMap.size>0,"_editVarMap.size > 0"),this.resolve(),this._stkCedcns.pop(),this.removeEditVarsTo(this._stkCedcns[this._stkCedcns.length-1]),this},removeAllEditVars:function(){return this.removeEditVarsTo(0)},removeEditVarsTo:function(b){try{for(var c=this._editVarList.length,d=b;c>d;d++)this._editVarList[d]&&this.removeConstraint(this._editVarMap.get(this._editVarList[d].v).constraint);return this._editVarList.length=b,a.assert(this._editVarMap.size==b,"_editVarMap.size == n"),this}catch(e){throw new a.InternalError("Constraint not found in removeEditVarsTo")}},addPointStays:function(b){return a.trace&&console.log("addPointStays",b),b.forEach(function(a,b){this.addStay(a.x,e,Math.pow(2,b)),this.addStay(a.y,e,Math.pow(2,b))},this),this},addStay:function(b,c,d){var f=new a.StayConstraint(b,c||e,d||1);return this.addConstraint(f)},removeConstraint:function(a){return this.removeConstraintInternal(a),this},removeConstraintInternal:function(b){a.trace&&a.fnenterprint("removeConstraintInternal: "+b),a.trace&&a.traceprint(""+this),this._fNeedsSolving=!0,this._resetStayConstants();var c=this.rows.get(this._objective),d=this._errorVars.get(b);a.trace&&a.traceprint("eVars == "+d),null!=d&&d.each(function(e){var f=this.rows.get(e);null==f?c.addVariable(e,-b.weight*b.strength.symbolicWeight.value,this._objective,this):c.addExpression(f,-b.weight*b.strength.symbolicWeight.value,this._objective,this),a.trace&&a.traceprint("now eVars == "+d)},this);var e=this._markerVars.get(b);if(this._markerVars.delete(b),null==e)throw new a.InternalError("Constraint not found in removeConstraintInternal");if(a.trace&&a.traceprint("Looking to remove var "+e),null==this.rows.get(e)){var f=this.columns.get(e);a.trace&&a.traceprint("Must pivot -- columns are "+f);var g=null,h=0;f.each(function(b){if(b.isRestricted){var c=this.rows.get(b),d=c.coefficientFor(e);if(a.trace&&a.traceprint("Marker "+e+"'s coefficient in "+c+" is "+d),0>d){var f=-c.constant/d;(null==g||h>f||a.approx(f,h)&&b.hashCode<g.hashCode)&&(h=f,g=b)}}},this),null==g&&(a.trace&&a.traceprint("exitVar is still null"),f.each(function(a){if(a.isRestricted){var b=this.rows.get(a),c=b.coefficientFor(e),d=b.constant/c;(null==g||h>d)&&(h=d,g=a)}},this)),null==g&&(0==f.size?this.removeColumn(e):f.escapingEach(function(a){return a!=this._objective?(g=a,{brk:!0}):void 0},this)),null!=g&&this.pivot(e,g)}if(null!=this.rows.get(e)&&this.removeRow(e),null!=d&&d.each(function(a){a!=e&&this.removeColumn(a)},this),b.isStayConstraint){if(null!=d)for(var j=0;this._stayPlusErrorVars.length>j;j++)d.delete(this._stayPlusErrorVars[j]),d.delete(this._stayMinusErrorVars[j])}else if(b.isEditConstraint){a.assert(null!=d,"eVars != null");var k=this._editVarMap.get(b.variable);this.removeColumn(k.editMinus),this._editVarMap.delete(b.variable)}return null!=d&&this._errorVars.delete(d),this.autoSolve&&(this.optimize(this._objective),this._setExternalVariables()),this},reset:function(){throw a.trace&&a.fnenterprint("reset"),new a.InternalError("reset not implemented")},resolveArray:function(b){a.trace&&a.fnenterprint("resolveArray"+b);var c=b.length;this._editVarMap.each(function(a,d){var e=d.index;c>e&&this.suggestValue(a,b[e])},this),this.resolve()},resolvePair:function(a,b){this.suggestValue(this._editVarList[0].v,a),this.suggestValue(this._editVarList[1].v,b),this.resolve()},resolve:function(){a.trace&&a.fnenterprint("resolve()"),this.dualOptimize(),this._setExternalVariables(),this._infeasibleRows.clear(),this._resetStayConstants()},suggestValue:function(b,c){a.trace&&console.log("suggestValue("+b+", "+c+")");var d=this._editVarMap.get(b);if(!d)throw new a.Error("suggestValue for variable "+b+", but var is not an edit variable");var e=c-d.prevEditConstant;return d.prevEditConstant=c,this.deltaEditConstant(e,d.editPlus,d.editMinus),this},solve:function(){return this._fNeedsSolving&&(this.optimize(this._objective),this._setExternalVariables()),this},setEditedValue:function(b,c){if(!this.columnsHasKey(b)&&null==this.rows.get(b))return b.value=c,this;if(!a.approx(c,b.value)){this.addEditVar(b),this.beginEdit();try{this.suggestValue(b,c)}catch(d){throw new a.InternalError("Error in setEditedValue")}this.endEdit()}return this},addVar:function(b){if(!this.columnsHasKey(b)&&null==this.rows.get(b)){try{this.addStay(b)}catch(c){throw new a.InternalError("Error in addVar -- required failure is impossible")}a.trace&&a.traceprint("added initial stay on "+b)}return this},getInternalInfo:function(){var a=c.getInternalInfo.call(this);return a+="\nSolver info:\n",a+="Stay Error Variables: ",a+=this._stayPlusErrorVars.length+this._stayMinusErrorVars.length,a+=" ("+this._stayPlusErrorVars.length+" +, ",a+=this._stayMinusErrorVars.length+" -)\n",a+="Edit Variables: "+this._editVarMap.size,a+="\n"},getDebugInfo:function(){return""+this+this.getInternalInfo()+"\n"},toString:function(){var a=c.getInternalInfo.call(this);return a+="\n_stayPlusErrorVars: ",a+="["+this._stayPlusErrorVars+"]",a+="\n_stayMinusErrorVars: ",a+="["+this._stayMinusErrorVars+"]",a+="\n",a+="_editVarMap:\n"+this._editVarMap,a+="\n"},getConstraintMap:function(){return this._markerVars},addWithArtificialVariable:function(b){a.trace&&a.fnenterprint("addWithArtificialVariable: "+b);var c=new a.SlackVariable({value:++this._artificialCounter,prefix:"a"}),d=new a.ObjectiveVariable({name:"az"}),e=b.clone();a.trace&&a.traceprint("before addRows:\n"+this),this.addRow(d,e),this.addRow(c,b),a.trace&&a.traceprint("after addRows:\n"+this),this.optimize(d);var f=this.rows.get(d);if(a.trace&&a.traceprint("azTableauRow.constant == "+f.constant),!a.approx(f.constant,0))throw this.removeRow(d),this.removeColumn(c),new a.RequiredFailure;var g=this.rows.get(c);if(null!=g){if(g.isConstant)return this.removeRow(c),this.removeRow(d),void 0;var h=g.anyPivotableVariable();this.pivot(h,c)}a.assert(null==this.rows.get(c),"rowExpression(av) == null"),this.removeColumn(c),this.removeRow(d)},tryAddingDirectly:function(b){a.trace&&a.fnenterprint("tryAddingDirectly: "+b);var c=this.chooseSubject(b);return null==c?(a.trace&&a.fnexitprint("returning false"),!1):(b.newSubject(c),this.columnsHasKey(c)&&this.substituteOut(c,b),this.addRow(c,b),a.trace&&a.fnexitprint("returning true"),!0)},chooseSubject:function(b){a.trace&&a.fnenterprint("chooseSubject: "+b);var c=null,d=!1,e=!1,f=b.terms,g=f.escapingEach(function(a,b){if(d){if(!a.isRestricted&&!this.columnsHasKey(a))return{retval:a}}else if(a.isRestricted){if(!e&&!a.isDummy&&0>b){var f=this.columns.get(a);(null==f||1==f.size&&this.columnsHasKey(this._objective))&&(c=a,e=!0)}}else c=a,d=!0},this);if(g&&void 0!==g.retval)return g.retval;if(null!=c)return c;var h=0,g=f.escapingEach(function(a,b){return a.isDummy?(this.columnsHasKey(a)||(c=a,h=b),void 0):{retval:null}},this);if(g&&void 0!==g.retval)return g.retval;if(!a.approx(b.constant,0))throw new a.RequiredFailure;return h>0&&b.multiplyMe(-1),c},deltaEditConstant:function(b,c,d){a.trace&&a.fnenterprint("deltaEditConstant :"+b+", "+c+", "+d);var e=this.rows.get(c);if(null!=e)return e.constant+=b,0>e.constant&&this._infeasibleRows.add(c),void 0;var f=this.rows.get(d);if(null!=f)return f.constant+=-b,0>f.constant&&this._infeasibleRows.add(d),void 0;var g=this.columns.get(d);g||console.log("columnVars is null -- tableau is:\n"+this),g.each(function(a){var c=this.rows.get(a),e=c.coefficientFor(d);c.constant+=e*b,a.isRestricted&&0>c.constant&&this._infeasibleRows.add(a)},this)},dualOptimize:function(){a.trace&&a.fnenterprint("dualOptimize:");for(var b=this.rows.get(this._objective);this._infeasibleRows.size;){var c=this._infeasibleRows.values()[0];this._infeasibleRows.delete(c);var d=null,e=this.rows.get(c);if(e&&0>e.constant){var g,f=Number.MAX_VALUE,h=e.terms;if(h.each(function(c,e){if(e>0&&c.isPivotable){var h=b.coefficientFor(c);g=h/e,(f>g||a.approx(g,f)&&c.hashCode<d.hashCode)&&(d=c,f=g)}}),f==Number.MAX_VALUE)throw new a.InternalError("ratio == nil (MAX_VALUE) in dualOptimize");this.pivot(d,c)}}},newExpression:function(b,c,d){a.trace&&(a.fnenterprint("newExpression: "+b),a.traceprint("cn.isInequality == "+b.isInequality),a.traceprint("cn.required == "+b.required));var e=b.expression,f=new a.Expression(e.constant),g=new a.SlackVariable,h=new a.DummyVariable,i=new a.SlackVariable,j=new a.SlackVariable,k=e.terms;if(k.each(function(a,b){var c=this.rows.get(a);c?f.addExpression(c,b):f.addVariable(a,b)},this),b.isInequality){if(a.trace&&a.traceprint("Inequality, adding slack"),++this._slackCounter,g=new a.SlackVariable({value:this._slackCounter,prefix:"s"}),f.setVariable(g,-1),this._markerVars.set(b,g),!b.required){++this._slackCounter,i=new a.SlackVariable({value:this._slackCounter,prefix:"em"}),f.setVariable(i,1);
var l=this.rows.get(this._objective);l.setVariable(i,b.strength.symbolicWeight.value*b.weight),this.insertErrorVar(b,i),this.noteAddedVariable(i,this._objective)}}else if(b.required)a.trace&&a.traceprint("Equality, required"),++this._dummyCounter,h=new a.DummyVariable({value:this._dummyCounter,prefix:"d"}),f.setVariable(h,1),this._markerVars.set(b,h),a.trace&&a.traceprint("Adding dummyVar == d"+this._dummyCounter);else{a.trace&&a.traceprint("Equality, not required"),++this._slackCounter,j=new a.SlackVariable({value:this._slackCounter,prefix:"ep"}),i=new a.SlackVariable({value:this._slackCounter,prefix:"em"}),f.setVariable(j,-1),f.setVariable(i,1),this._markerVars.set(b,j);var l=this.rows.get(this._objective);a.trace&&console.log(l);var m=b.strength.symbolicWeight.value*b.weight;0==m&&(a.trace&&a.traceprint("cn == "+b),a.trace&&a.traceprint("adding "+j+" and "+i+" with swCoeff == "+m)),l.setVariable(j,m),this.noteAddedVariable(j,this._objective),l.setVariable(i,m),this.noteAddedVariable(i,this._objective),this.insertErrorVar(b,i),this.insertErrorVar(b,j),b.isStayConstraint?(this._stayPlusErrorVars.push(j),this._stayMinusErrorVars.push(i)):b.isEditConstraint&&(c[0]=j,c[1]=i,d[0]=e.constant)}return 0>f.constant&&f.multiplyMe(-1),a.trace&&a.fnexitprint("returning "+f),f},optimize:function(b){a.trace&&a.fnenterprint("optimize: "+b),a.trace&&a.traceprint(""+this),this._optimizeCount++;var c=this.rows.get(b);a.assert(null!=c,"zRow != null");for(var g,h,e=null,f=null;;){if(g=0,h=c.terms,h.escapingEach(function(a,b){return a.isPivotable&&g>b?(g=b,e=a,{brk:1}):void 0},this),g>=-d)return;a.trace&&console.log("entryVar:",e,"objectiveCoeff:",g);var i=Number.MAX_VALUE,j=this.columns.get(e),k=0;if(j.each(function(b){if(a.trace&&a.traceprint("Checking "+b),b.isPivotable){var c=this.rows.get(b),d=c.coefficientFor(e);a.trace&&a.traceprint("pivotable, coeff = "+d),0>d&&(k=-c.constant/d,(i>k||a.approx(k,i)&&b.hashCode<f.hashCode)&&(i=k,f=b))}},this),i==Number.MAX_VALUE)throw new a.InternalError("Objective function is unbounded in optimize");this.pivot(e,f),a.trace&&a.traceprint(""+this)}},pivot:function(b,c){a.trace&&console.log("pivot: ",b,c);var d=!1;d&&console.time(" SimplexSolver::pivot"),null==b&&console.warn("pivot: entryVar == null"),null==c&&console.warn("pivot: exitVar == null"),d&&console.time("  removeRow");var e=this.removeRow(c);d&&console.timeEnd("  removeRow"),d&&console.time("  changeSubject"),e.changeSubject(c,b),d&&console.timeEnd("  changeSubject"),d&&console.time("  substituteOut"),this.substituteOut(b,e),d&&console.timeEnd("  substituteOut"),d&&console.time("  addRow"),this.addRow(b,e),d&&console.timeEnd("  addRow"),d&&console.timeEnd(" SimplexSolver::pivot")},_resetStayConstants:function(){a.trace&&console.log("_resetStayConstants");for(var b=0;this._stayPlusErrorVars.length>b;b++){var c=this.rows.get(this._stayPlusErrorVars[b]);null==c&&(c=this.rows.get(this._stayMinusErrorVars[b])),null!=c&&(c.constant=0)}},_setExternalVariables:function(){a.trace&&a.fnenterprint("_setExternalVariables:"),a.trace&&a.traceprint(""+this),this._externalParametricVars.each(function(b){null!=this.rows.get(b)?a.trace&&console.log("Error: variable"+b+" in _externalParametricVars is basic"):b.value=0},this),this._externalRows.each(function(a){var b=this.rows.get(a);a.value!=b.constant&&(a.value=b.constant)},this),this._fNeedsSolving=!1,this.onsolved()},onsolved:function(){},insertErrorVar:function(b,c){a.trace&&a.fnenterprint("insertErrorVar:"+b+", "+c);var d=this._errorVars.get(c);d||(d=new a.HashSet,this._errorVars.set(b,d)),d.add(c)}})}(this.c||module.parent.exports||{}),function(a){"use strict";a.Timer=a.inherit({initialize:function(){this.isRunning=!1,this._elapsedMs=0},start:function(){return this.isRunning=!0,this._startReading=new Date,this},stop:function(){return this.isRunning=!1,this._elapsedMs+=new Date-this._startReading,this},reset:function(){return this.isRunning=!1,this._elapsedMs=0,this},elapsedTime:function(){return this.isRunning?(this._elapsedMs+(new Date-this._startReading))/1e3:this._elapsedMs/1e3}})}(this.c||module.parent.exports||{}),__cassowary_parser=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var b={parse:function(b,c){function k(a){g>e||(e>g&&(g=e,h=[]),h.push(a))}function l(){var a,b,c,d,f;if(d=e,f=e,a=z(),null!==a){if(c=m(),null!==c)for(b=[];null!==c;)b.push(c),c=m();else b=null;null!==b?(c=z(),null!==c?a=[a,b,c]:(a=null,e=f)):(a=null,e=f)}else a=null,e=f;return null!==a&&(a=function(a,b){return b}(d,a[1])),null===a&&(e=d),a}function m(){var a,b,c,d;return c=e,d=e,a=P(),null!==a?(b=s(),null!==b?a=[a,b]:(a=null,e=d)):(a=null,e=d),null!==a&&(a=function(a,b){return b}(c,a[0])),null===a&&(e=c),a}function n(){var a;return b.length>e?(a=b.charAt(e),e++):(a=null,0===f&&k("any character")),a}function o(){var a;return/^[a-zA-Z]/.test(b.charAt(e))?(a=b.charAt(e),e++):(a=null,0===f&&k("[a-zA-Z]")),null===a&&(36===b.charCodeAt(e)?(a="$",e++):(a=null,0===f&&k('"$"')),null===a&&(95===b.charCodeAt(e)?(a="_",e++):(a=null,0===f&&k('"_"')))),a}function p(){var a;return f++,/^[\t\x0B\f \xA0\uFEFF]/.test(b.charAt(e))?(a=b.charAt(e),e++):(a=null,0===f&&k("[\\t\\x0B\\f \\xA0\\uFEFF]")),f--,0===f&&null===a&&k("whitespace"),a}function q(){var a;return/^[\n\r\u2028\u2029]/.test(b.charAt(e))?(a=b.charAt(e),e++):(a=null,0===f&&k("[\\n\\r\\u2028\\u2029]")),a}function r(){var a;return f++,10===b.charCodeAt(e)?(a="\n",e++):(a=null,0===f&&k('"\\n"')),null===a&&("\r\n"===b.substr(e,2)?(a="\r\n",e+=2):(a=null,0===f&&k('"\\r\\n"')),null===a&&(13===b.charCodeAt(e)?(a="\r",e++):(a=null,0===f&&k('"\\r"')),null===a&&(8232===b.charCodeAt(e)?(a="\u2028",e++):(a=null,0===f&&k('"\\u2028"')),null===a&&(8233===b.charCodeAt(e)?(a="\u2029",e++):(a=null,0===f&&k('"\\u2029"')))))),f--,0===f&&null===a&&k("end of line"),a}function s(){var a,c,d;return d=e,a=z(),null!==a?(59===b.charCodeAt(e)?(c=";",e++):(c=null,0===f&&k('";"')),null!==c?a=[a,c]:(a=null,e=d)):(a=null,e=d),null===a&&(d=e,a=y(),null!==a?(c=r(),null!==c?a=[a,c]:(a=null,e=d)):(a=null,e=d),null===a&&(d=e,a=z(),null!==a?(c=t(),null!==c?a=[a,c]:(a=null,e=d)):(a=null,e=d))),a}function t(){var a,c;return c=e,f++,b.length>e?(a=b.charAt(e),e++):(a=null,0===f&&k("any character")),f--,null===a?a="":(a=null,e=c),a}function u(){var a;return f++,a=v(),null===a&&(a=x()),f--,0===f&&null===a&&k("comment"),a}function v(){var a,c,d,g,h,i,j;if(h=e,"/*"===b.substr(e,2)?(a="/*",e+=2):(a=null,0===f&&k('"/*"')),null!==a){for(c=[],i=e,j=e,f++,"*/"===b.substr(e,2)?(d="*/",e+=2):(d=null,0===f&&k('"*/"')),f--,null===d?d="":(d=null,e=j),null!==d?(g=n(),null!==g?d=[d,g]:(d=null,e=i)):(d=null,e=i);null!==d;)c.push(d),i=e,j=e,f++,"*/"===b.substr(e,2)?(d="*/",e+=2):(d=null,0===f&&k('"*/"')),f--,null===d?d="":(d=null,e=j),null!==d?(g=n(),null!==g?d=[d,g]:(d=null,e=i)):(d=null,e=i);null!==c?("*/"===b.substr(e,2)?(d="*/",e+=2):(d=null,0===f&&k('"*/"')),null!==d?a=[a,c,d]:(a=null,e=h)):(a=null,e=h)}else a=null,e=h;return a}function w(){var a,c,d,g,h,i,j;if(h=e,"/*"===b.substr(e,2)?(a="/*",e+=2):(a=null,0===f&&k('"/*"')),null!==a){for(c=[],i=e,j=e,f++,"*/"===b.substr(e,2)?(d="*/",e+=2):(d=null,0===f&&k('"*/"')),null===d&&(d=q()),f--,null===d?d="":(d=null,e=j),null!==d?(g=n(),null!==g?d=[d,g]:(d=null,e=i)):(d=null,e=i);null!==d;)c.push(d),i=e,j=e,f++,"*/"===b.substr(e,2)?(d="*/",e+=2):(d=null,0===f&&k('"*/"')),null===d&&(d=q()),f--,null===d?d="":(d=null,e=j),null!==d?(g=n(),null!==g?d=[d,g]:(d=null,e=i)):(d=null,e=i);null!==c?("*/"===b.substr(e,2)?(d="*/",e+=2):(d=null,0===f&&k('"*/"')),null!==d?a=[a,c,d]:(a=null,e=h)):(a=null,e=h)}else a=null,e=h;return a}function x(){var a,c,d,g,h,i,j;if(h=e,"//"===b.substr(e,2)?(a="//",e+=2):(a=null,0===f&&k('"//"')),null!==a){for(c=[],i=e,j=e,f++,d=q(),f--,null===d?d="":(d=null,e=j),null!==d?(g=n(),null!==g?d=[d,g]:(d=null,e=i)):(d=null,e=i);null!==d;)c.push(d),i=e,j=e,f++,d=q(),f--,null===d?d="":(d=null,e=j),null!==d?(g=n(),null!==g?d=[d,g]:(d=null,e=i)):(d=null,e=i);null!==c?a=[a,c]:(a=null,e=h)}else a=null,e=h;return a}function y(){var a,b;for(a=[],b=p(),null===b&&(b=w(),null===b&&(b=x()));null!==b;)a.push(b),b=p(),null===b&&(b=w(),null===b&&(b=x()));return a}function z(){var a,b;for(a=[],b=p(),null===b&&(b=r(),null===b&&(b=u()));null!==b;)a.push(b),b=p(),null===b&&(b=r(),null===b&&(b=u()));return a}function A(){var a,b;return b=e,a=C(),null===a&&(a=B()),null!==a&&(a=function(a,b){return{type:"NumericLiteral",value:b}}(b,a)),null===a&&(e=b),a}function B(){var a,c,d;if(d=e,/^[0-9]/.test(b.charAt(e))?(c=b.charAt(e),e++):(c=null,0===f&&k("[0-9]")),null!==c)for(a=[];null!==c;)a.push(c),/^[0-9]/.test(b.charAt(e))?(c=b.charAt(e),e++):(c=null,0===f&&k("[0-9]"));else a=null;return null!==a&&(a=function(a,b){return parseInt(b.join(""))}(d,a)),null===a&&(e=d),a}function C(){var a,c,d,g,h;return g=e,h=e,a=B(),null!==a?(46===b.charCodeAt(e)?(c=".",e++):(c=null,0===f&&k('"."')),null!==c?(d=B(),null!==d?a=[a,c,d]:(a=null,e=h)):(a=null,e=h)):(a=null,e=h),null!==a&&(a=function(a,b){return parseFloat(b.join(""))}(g,a)),null===a&&(e=g),a}function D(){var a,c,d,g;if(g=e,/^[\-+]/.test(b.charAt(e))?(a=b.charAt(e),e++):(a=null,0===f&&k("[\\-+]")),a=null!==a?a:"",null!==a){if(/^[0-9]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,0===f&&k("[0-9]")),null!==d)for(c=[];null!==d;)c.push(d),/^[0-9]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,0===f&&k("[0-9]"));else c=null;null!==c?a=[a,c]:(a=null,e=g)}else a=null,e=g;return a}function E(){var a,b;return f++,b=e,a=F(),null!==a&&(a=function(a,b){return b}(b,a)),null===a&&(e=b),f--,0===f&&null===a&&k("identifier"),a}function F(){var a,b,c,d,g;if(f++,d=e,g=e,a=o(),null!==a){for(b=[],c=o();null!==c;)b.push(c),c=o();null!==b?a=[a,b]:(a=null,e=g)}else a=null,e=g;return null!==a&&(a=function(a,b,c){return b+c.join("")}(d,a[0],a[1])),null===a&&(e=d),f--,0===f&&null===a&&k("identifier"),a}function G(){var a,c,d,g,h,i,j;return i=e,a=E(),null!==a&&(a=function(a,b){return{type:"Variable",name:b}}(i,a)),null===a&&(e=i),null===a&&(a=A(),null===a&&(i=e,j=e,40===b.charCodeAt(e)?(a="(",e++):(a=null,0===f&&k('"("')),null!==a?(c=z(),null!==c?(d=P(),null!==d?(g=z(),null!==g?(41===b.charCodeAt(e)?(h=")",e++):(h=null,0===f&&k('")"')),null!==h?a=[a,c,d,g,h]:(a=null,e=j)):(a=null,e=j)):(a=null,e=j)):(a=null,e=j)):(a=null,e=j),null!==a&&(a=function(a,b){return b}(i,a[2])),null===a&&(e=i))),a}function H(){var a,b,c,d,f;return a=G(),null===a&&(d=e,f=e,a=I(),null!==a?(b=z(),null!==b?(c=H(),null!==c?a=[a,b,c]:(a=null,e=f)):(a=null,e=f)):(a=null,e=f),null!==a&&(a=function(a,b,c){return{type:"UnaryExpression",operator:b,expression:c}}(d,a[0],a[2])),null===a&&(e=d)),a}function I(){var a;return 43===b.charCodeAt(e)?(a="+",e++):(a=null,0===f&&k('"+"')),null===a&&(45===b.charCodeAt(e)?(a="-",e++):(a=null,0===f&&k('"-"')),null===a&&(33===b.charCodeAt(e)?(a="!",e++):(a=null,0===f&&k('"!"')))),a}function J(){var a,b,c,d,f,g,h,i,j;if(h=e,i=e,a=H(),null!==a){for(b=[],j=e,c=z(),null!==c?(d=K(),null!==d?(f=z(),null!==f?(g=H(),null!==g?c=[c,d,f,g]:(c=null,e=j)):(c=null,e=j)):(c=null,e=j)):(c=null,e=j);null!==c;)b.push(c),j=e,c=z(),null!==c?(d=K(),null!==d?(f=z(),null!==f?(g=H(),null!==g?c=[c,d,f,g]:(c=null,e=j)):(c=null,e=j)):(c=null,e=j)):(c=null,e=j);null!==b?a=[a,b]:(a=null,e=i)}else a=null,e=i;return null!==a&&(a=function(a,b,c){for(var d=b,e=0;c.length>e;e++)d={type:"MultiplicativeExpression",operator:c[e][1],left:d,right:c[e][3]};return d}(h,a[0],a[1])),null===a&&(e=h),a}function K(){var a;return 42===b.charCodeAt(e)?(a="*",e++):(a=null,0===f&&k('"*"')),null===a&&(47===b.charCodeAt(e)?(a="/",e++):(a=null,0===f&&k('"/"'))),a}function L(){var a,b,c,d,f,g,h,i,j;if(h=e,i=e,a=J(),null!==a){for(b=[],j=e,c=z(),null!==c?(d=M(),null!==d?(f=z(),null!==f?(g=J(),null!==g?c=[c,d,f,g]:(c=null,e=j)):(c=null,e=j)):(c=null,e=j)):(c=null,e=j);null!==c;)b.push(c),j=e,c=z(),null!==c?(d=M(),null!==d?(f=z(),null!==f?(g=J(),null!==g?c=[c,d,f,g]:(c=null,e=j)):(c=null,e=j)):(c=null,e=j)):(c=null,e=j);null!==b?a=[a,b]:(a=null,e=i)}else a=null,e=i;return null!==a&&(a=function(a,b,c){for(var d=b,e=0;c.length>e;e++)d={type:"AdditiveExpression",operator:c[e][1],left:d,right:c[e][3]};return d}(h,a[0],a[1])),null===a&&(e=h),a}function M(){var a;return 43===b.charCodeAt(e)?(a="+",e++):(a=null,0===f&&k('"+"')),null===a&&(45===b.charCodeAt(e)?(a="-",e++):(a=null,0===f&&k('"-"'))),a}function N(){var a,b,c,d,f,g,h,i,j;if(h=e,i=e,a=L(),null!==a){for(b=[],j=e,c=z(),null!==c?(d=O(),null!==d?(f=z(),null!==f?(g=L(),null!==g?c=[c,d,f,g]:(c=null,e=j)):(c=null,e=j)):(c=null,e=j)):(c=null,e=j);null!==c;)b.push(c),j=e,c=z(),null!==c?(d=O(),null!==d?(f=z(),null!==f?(g=L(),null!==g?c=[c,d,f,g]:(c=null,e=j)):(c=null,e=j)):(c=null,e=j)):(c=null,e=j);null!==b?a=[a,b]:(a=null,e=i)}else a=null,e=i;return null!==a&&(a=function(a,b,c){for(var d=b,e=0;c.length>e;e++)d={type:"Inequality",operator:c[e][1],left:d,right:c[e][3]};return d}(h,a[0],a[1])),null===a&&(e=h),a}function O(){var a;return"<="===b.substr(e,2)?(a="<=",e+=2):(a=null,0===f&&k('"<="')),null===a&&(">="===b.substr(e,2)?(a=">=",e+=2):(a=null,0===f&&k('">="')),null===a&&(60===b.charCodeAt(e)?(a="<",e++):(a=null,0===f&&k('"<"')),null===a&&(62===b.charCodeAt(e)?(a=">",e++):(a=null,0===f&&k('">"'))))),a}function P(){var a,c,d,g,h,i,j,l,m;if(j=e,l=e,a=N(),null!==a){for(c=[],m=e,d=z(),null!==d?("=="===b.substr(e,2)?(g="==",e+=2):(g=null,0===f&&k('"=="')),null!==g?(h=z(),null!==h?(i=N(),null!==i?d=[d,g,h,i]:(d=null,e=m)):(d=null,e=m)):(d=null,e=m)):(d=null,e=m);null!==d;)c.push(d),m=e,d=z(),null!==d?("=="===b.substr(e,2)?(g="==",e+=2):(g=null,0===f&&k('"=="')),null!==g?(h=z(),null!==h?(i=N(),null!==i?d=[d,g,h,i]:(d=null,e=m)):(d=null,e=m)):(d=null,e=m)):(d=null,e=m);null!==c?a=[a,c]:(a=null,e=l)}else a=null,e=l;return null!==a&&(a=function(a,b,c){for(var d=b,e=0;c.length>e;e++)d={type:"Equality",operator:c[e][1],left:d,right:c[e][3]};return d}(j,a[0],a[1])),null===a&&(e=j),a}function Q(a){a.sort();for(var b=null,c=[],d=0;a.length>d;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);return c}function R(){for(var a=1,c=1,d=!1,f=0;Math.max(e,g)>f;f++){var h=b.charAt(f);"\n"===h?(d||a++,c=1,d=!1):"\r"===h||"\u2028"===h||"\u2029"===h?(a++,c=1,d=!0):(c++,d=!1)}return{line:a,column:c}}var d={start:l,Statement:m,SourceCharacter:n,IdentifierStart:o,WhiteSpace:p,LineTerminator:q,LineTerminatorSequence:r,EOS:s,EOF:t,Comment:u,MultiLineComment:v,MultiLineCommentNoLineTerminator:w,SingleLineComment:x,_:y,__:z,Literal:A,Integer:B,Real:C,SignedInteger:D,Identifier:E,IdentifierName:F,PrimaryExpression:G,UnaryExpression:H,UnaryOperator:I,MultiplicativeExpression:J,MultiplicativeOperator:K,AdditiveExpression:L,AdditiveOperator:M,InequalityExpression:N,InequalityOperator:O,LinearExpression:P};if(void 0!==c){if(void 0===d[c])throw Error("Invalid rule name: "+a(c)+".")}else c="start";var e=0,f=0,g=0,h=[],S=d[c]();if(null===S||e!==b.length){var T=Math.max(e,g),U=b.length>T?b.charAt(T):null,V=R();throw new this.SyntaxError(Q(h),U,T,V.line,V.column)}return S},toSource:function(){return this._source}};return b.SyntaxError=function(b,c,d,e,f){function g(b,c){var d,e;switch(b.length){case 0:d="end of input";break;case 1:d=b[0];break;default:d=b.slice(0,b.length-1).join(", ")+" or "+b[b.length-1]}return e=c?a(c):"end of input","Expected "+d+" but "+e+" found."}this.name="SyntaxError",this.expected=b,this.found=c,this.message=g(b,c),this.offset=d,this.line=e,this.column=f},b.SyntaxError.prototype=Error.prototype,b}();
}).call(
  (typeof module != "undefined") ?
      (module.compiled = true && module) : this
);
</script>
<script>/* 
This is part of Cambio 2.1 program (https://hekili.ca.sandia.gov/cambio) and is licensed under the LGPL v2.1 license
   
   This library is free software; you can redistribute it and/or
   modify it under the terms of the GNU Lesser General Public
   License as published by the Free Software Foundation; either
   version 2.1 of the License, or (at your option) any later version.

   This library is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   Lesser General Public License for more details.

   You should have received a copy of the GNU Lesser General Public
   License along with this library; if not, write to the Free Software
   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA

   
Feature TODO list (created 20160220):
  -Fix intermitten issue of zooming in messes up (especially aver dragging starting from the y-axis title)
  [Done 20160218] -Add legend
  [Done 20160218: Christian] -Zoom in on y-axis
  [Done 20160815: Liza] -Draw Peaks
  [Done 20180214: Christian]Add peak info display
  -Make it so x-axis binning is given seperately for each histogram
  [Done 20160310] -Add reference photopeak line drawing
  [Done 20160310] -Box that gives stats that follow mouse
  [Done 20160520] -x-axis tick labels can overlap (especially for higher enegy values zoomed in for a small range)
  [Done 20160520] -Resize plot area based on y-axis label sizes (but if actively zooming in with mouse wheel, keep centered at mouse)
  [Done 20160218] -scroll-wheel over y-axis adds remove default amount of padding above/bellow charts scroll left-right (track pad two fingers) pan left/right
  [Done 20160218: Christian] -control (alt on mac) drag create duplicate charts that drag with mouse (for energy recalibration)
  [Done 20180411] -Add in a mock Wt.WT.emit(...) function and hook up signals
  [Done 20160218: Christian]Animate the click-and-drag-right zoom in effect
  [Done 20180214: Christian]Some sliders to change scale factor on background and second spectrum (should appear only when something is clicked on to show them)
  [Done 20180216: Christian] -Background subtraction mode
  -Add statistical error bars
  [Done 20160815: Christian] -Add escape peak, compon scatter, etc. mouse interactions
  [Done 20160815: Christian] -Add arrows to end of x axis to indicate if the chart extends to the right and left (e.g. can pan)
  [Done 20160521] -Add compact x-axis mode
  [Done 20180214: Christian]Add widget to scale background and second spectrum
  [Done 20170318: Christian] -Add in (optional) x-axis slider widget (the one that shows the entire chart, and indicates what portion you are viewing and lets you drag to change this)
  [Done 20170218: Christian] -Add in InterSpec specific mouse functionality (drawing line for peak, deleting peaks, etc)
  [Done 20161216: Christian] -Add in ability to add in text to label features (very low priority)
  -Add ability to support polynomial binning with deviation pairs (instead of just lower edge energy)
  [Done 20180220: Christian] -Customize strokes, colors, lines, etc.
  [Done 20160520] -Dont let zoom in to less than one bin width
  [Done 20160521] -Fix x-axis labels that hang off end of plot area
  [Done 20160520] -Fix adding chart title and compensating for x-axis title
  -Customize mouse point to zoom-in/zoom-out where appropriate
  -Optimize frequency of rebinning of data (prevent extra rebinned data from being drawn)
  -Need some way to filter reference gamma lines to not draw insignificant lines.  Ex, Th232 gives ~900 dom elements, which can slow things down
*/

SpectrumChartD3 = function(elem, options) {
  var self = this;

  // Add any polyfills needed to run D3 code
  browserPolyfill();

  this.chart = typeof elem === 'string' ? document.getElementById(elem) : elem; 

  this.cx = this.chart.clientWidth;
  this.cy = this.chart.clientHeight;

  this.options = options || {}; 
  
  //if( options.yscale !== "lin" && options.yscale !== "linear" && options.yscale !== "log" && options.yscale !== "sqrt" )
  this.options.yscale = "lin";
  this.options.gridx = false;
  this.options.gridy = false;
  this.options.compactXAxis = false; 
  this.options.adjustYAxisPadding = true;
  this.options.wheelScrollYAxis = true;
  this.options.showAnimation = false;
  this.options.showXAxisSliderChart = false;

  this.options.allowPeakFit = (typeof options.allowPeakFit == 'boolean') ? options.allowPeakFit : false;

  this.options.showUserLabels = (typeof options.showUserLabels == 'boolean') ? options.showUserLabels : false;
  this.options.showPeakLabels = (typeof options.showPeakLabels == 'boolean') ? options.showPeakLabels : false;
  this.options.showNuclideNames = (typeof options.showNuclideNames == 'boolean') ? options.showNuclideNames : false;
  this.options.showNuclideEnergies = (typeof options.showNuclideEnergies == 'boolean') ? options.showNuclideEnergies : false;
  
  this.options.showLegend = true;
  this.options.scaleBackgroundSecondary = (typeof options.scaleBackgroundSecondary == 'boolean') ? options.scaleBackgroundSecondary : false;

  this.options.refLineTopPad = 30;
  
  self.options.logYFracTop = 0.05;
  self.options.logYFracBottom = 0.025;
  self.options.linYFracTop = 0.1;
  self.options.linYFracBottom = 0.1;
  self.options.sqrtYFracTop = 0.1;
  self.options.sqrtYFracBottom = 0.1;

  this.options.showRefLineInfoForMouseOver = (typeof options.showRefLineInfoForMouseOver == 'boolean') ? options.showRefLineInfoForMouseOver : true;
  this.options.showMouseStats = (typeof options.showMouseStats == 'boolean') ? options.showMouseStats : true;
  this.options.showComptonEdge = (typeof options.showComptonEdge == 'boolean') ? options.showComptonEdge : false;
  this.options.showComptonPeaks = (typeof options.showComptonPeaks == 'boolean') ? options.showComptonPeaks : false;
  this.options.showEscapePeaks = (typeof options.showEscapePeaks == 'boolean') ? options.showEscapePeaks : false;
  this.options.showSumPeaks = (typeof options.showSumPeaks == 'boolean') ? options.showSumPeaks : false;
  this.options.backgroundSubtract = (typeof options.backgroundSubtract == 'boolean') ? options.backgroundSubtract : false;
  this.options.enableColorPicker = (typeof options.enableColorPicker == 'boolean') ? options.enableColorPicker : false;

  // Set which spectrums to draw peaks for
  this.options.drawPeaksFor = {
    FOREGROUND: true,
    BACKGROUND: false,
    SECONDARY: false,
  };

  this.options.showXRangeArrows = (typeof options.showXRangeArrows == 'boolean') ? options.showXRangeArrows : true;

  this.options.maxScaleFactor = 10;

  this.padding = {
     "top":  5,
     "titlePad" : 5,
     "right":   10,
     "bottom": 5,
     "xTitlePad": 5,
     "left":     5,
     "labelPad": 5,
     "title":    23,
     "label":    8,
     "sliderChart":    8,
  };
  
  this.padding.leftComputed = this.padding.left + this.padding.title + this.padding.label + this.padding.labelPad;
  this.padding.topComputed = this.padding.top + this.padding.titlePad + 15;
  this.padding.bottomComputed = this.padding.bottom +  this.padding.xTitlePad + 15;
  
  this.size = {
    "width":  Math.max(0, this.cx - this.padding.leftComputed - this.padding.right),
    "height": Math.max(0, this.cy - this.padding.topComputed  - this.padding.bottomComputed),
    "sliderChartHeight": (this.cy - this.padding.topComputed  - this.padding.bottomComputed) / 10,
    "sliderChartWidth": this.cx - this.padding.leftComputed - this.padding.right - 30,
  };

  this.animation = {
    "duration": 200,
    "frames": 6
  };

  /**
   * Added by Christian 20180215
   * Used to differentiate between different types of spectra, and for future additional usage
   * Each spectrum object should have an associated type with it, which we can compare using this enum.
   */
  this.spectrumTypes = {
    FOREGROUND: 'FOREGROUND',
    BACKGROUND: 'BACKGROUND',
    SECONDARY: 'SECONDARY',
  };

  /*pre IE9 support */
  if (!Array.isArray) {
    Array.isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    };
  }

  /*When dragging the plot, both dragging_plot and zooming_plot will be */
  /*  true.  When only zooming (e.g. mouse wheel), then only zooming_plot */
  /*  will be true. */
  this.dragging_plot = false;
  this.zooming_plot = false;

  this.refLines = [];

  /* x-scale */
  this.xScale = d3.scale.linear()
      .domain(this.options.xScaleDomain ? this.options.xScaleDomain : [0, 3000])
      .range([0, this.size.width]);

  /* drag x-axis logic */
  this.downx = Math.NaN;

  /* y-scale (inverted domain) */
  this.yScale = d3.scale.linear()
      .domain([0, 100])
      .nice()
      .range([0, this.size.height])
      .nice();

  this.downy = Math.NaN;

  /* Finds distance between two points */
  this.dist = function (a, b) {
    return Math.sqrt(Math.pow(a[0]-b[0],2) + Math.pow(a[1]-b[1],2));
  };

  this.min_max_x_values = function() {
    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
      return [-1,-1];

    var min = null, max = null;
    self.rawData.spectra.forEach(function(spectrum) {
      if (!spectrum.x)
        return;

      if (min == null || spectrum.x[0] < min) min = spectrum.x[0];
      if (max == null || spectrum.x[spectrum.x.length-1] > max) max = spectrum.x[spectrum.x.length-1];
    });

    return [min,max];
  };

  this.displayed_raw_start = function(spectrum){
    if( !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length )
      return -1;
    var xstart = self.xScale.domain()[0];
    if (!spectrum)
      spectrum = self.rawData.spectra[0]; /* use foreground by default */

 /* switch to using: */
 /* var bisector = d3.bisector(function(d){return d.x;}); */
 /* bisector.left(spectrum.x, xstart) */

    var i = 0;
    while( i < spectrum.x.length && spectrum.x[i] < xstart )
      ++i;
    return i;
  };

  this.displayed_raw_end = function(spectrum){
    if( !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
      return -1;
    var xend = self.xScale.domain()[1];
    if (!spectrum)
      spectrum = self.rawData.spectra[0]; /* use foreground by default */
    var i = spectrum.x.length - 1;
    while( i > 0 && spectrum.x[i] > xend )
      --i;
    return i + 1;
  };

  this.displayed_start = function(spectrum){
    if( !spectrum || !spectrum.points || !spectrum.points.length )
      return -1;
    var xstart = self.xScale.domain()[0];
    var i = 0;
    while( i < spectrum.points.length && spectrum.points[i].x <= xstart )
      ++i;
    return Math.max(i - 1,0);
  };

  this.displayed_end = function(spectrum){
    if( !spectrum || !spectrum.points || !spectrum.points.length )
      return -1;
    var xend = self.xScale.domain()[1];
    var i = spectrum.points.length - 1;
    while( i > 0 && spectrum.points[i].x >= xend )
      --i;
    return Math.min(i + 1, spectrum.points.length);
  };

  this.firstRaw = this.lastRaw = this.rebinFactor = -1;

  this.do_rebin();

  this.setYAxisDomain = function(){
    if( !isNaN(self.downy) )
      return;
    var yaxisDomain = self.getYAxisDomain(),
        y1 = yaxisDomain[0],
        y0 = yaxisDomain[1];
    this.yScale.domain([y1, y0]);
  }
  this.setYAxisDomain();


  /* drag y-axis logic */
  this.downy = Math.NaN;

  this.dragged = this.selected = null;


  this.vis = d3.select(this.chart).append("svg")
      .attr("width",  this.cx)
      .attr("height", this.cy)
      .append("g")
      .attr("transform", "translate(" + this.padding.leftComputed + "," + this.padding.topComputed + ")");

  this.plot = this.vis.append("rect")
      .attr("width", this.size.width)
      .attr("height", this.size.height)
      .attr("id", "chartarea"+this.chart.id )
      .style("fill", "#EEEEEE");
      /*.attr("pointer-events", "all"); */

  this.svg = d3.select(self.chart).select('svg');

  /*
  Chart vs. Vis vs. Document Body
  ___________________________________________
  | _______________________________________ |
  ||  ___________________________________  ||
  || |                                   | ||
  || |           VIS (SPECTRUM)          | ||
  || |                                   | ||
  || |___________________________________| ||
  ||                                       ||
  ||                  CHART                ||
  ||_______________________________________||
  |                                         |
  |                                         |
  |                   BODY                  |
  |                                         |
  |                                         |
  |_________________________________________|
  */

  /* 
  NOTE: Restoring the zoom behavior only for touch events
        This does NOT affect the behavior for other mouse events.
        Restoring the zoom behavior allows pinch zooming/panning with touch interactions.
  */
  this.zoom = d3.behavior.zoom()
    .x(self.xScale)
    .y(self.yScale)
    .on("zoom", self.handleZoom())
    .on("zoomend", self.handleZoomEnd());

  /* Vis interactions */
  this.vis
    .call(this.zoom)
    .on("mousedown", self.handleVisMouseDown())
    .on("mouseup", self.handleVisMouseUp())
    .on("wheel", self.handleVisWheel())
    .on("touchstart", self.handleVisTouchStart())
    .on("touchmove", self.handleVisTouchMove())
    .on("touchend", self.handleVisTouchEnd());

  /* Cancel the zooms for mouse events, we'll use our own implementation for these (however, keeping the touch zooming) */
  this.vis
    .on("mousedown.zoom", null)
    .on("mousemove.zoom", null)
    .on("mouseup.zoom", null)
    .on("mouseover.zoom", null)
    .on("mouseout.zoom", null)
    .on("wheel.zoom", null)
    .on("click.zoom", null)
    .on("dblclick.zoom", null);

  d3.select(document.body)
    .on("mouseup", self.handleCancelAllMouseEvents())
  d3.select(window).on("mouseup", self.handleCancelAllMouseEvents())
    .on("mousemove", function() { if (self.sliderBoxDown || self.leftDragRegionDown || self.rightDragRegionDown || self.currentlyAdjustingSpectrumScale) { d3.event.preventDefault(); d3.event.stopPropagation(); }});;



  /*  Chart Interactions */
  d3.select(this.chart)
    .on("mousemove", self.handleChartMouseMove())
    .on("mouseleave", self.handleChartMouseLeave())
    .on("mouseup", self.handleChartMouseUp())
    .on("wheel", self.handleChartWheel())
    .on("touchstart", self.handleChartTouchStart())
    .on("touchend", self.handleChartTouchEnd());

  /*
  To allow markers to be updated while mouse is outside of the chart, but still inside the visual.
  */
  this.yAxis = d3.svg.axis().scale(this.yScale)
   .orient("left")
   .innerTickSize(7)
   .outerTickSize(1)
   .ticks(0);

  this.yAxisBody = this.vis.append("g")
    .attr("class", "yaxis" )
    .attr("transform", "translate(0,0)")
    .call(this.yAxis);

  this.xAxis = d3.svg.axis().scale(this.xScale)
   .orient("bottom")
   .innerTickSize(7)
   .outerTickSize(1)
   .ticks(20, "f");

  this.xAxisBody = this.vis.append("g")
    .attr("class", "xaxis" )
    .attr("transform", "translate(0," + this.size.height + ")")
    .call(this.xAxis);

  this.vis.append("svg:clipPath")
    .attr("id", "clip" + this.chart.id )
    .append("svg:rect")
    .attr("x", 0)
    .attr("y", 0)
    .attr("width", this.size.width )
    .attr("height", this.size.height );

  self.addMouseInfoBox();

  /*Make a <g> element to draw everything we want that follows the mouse around */
  /*  when we're displaying reference photopeaks.  If the mouse isnt close enough */
  /*  to a reference line, then this whole <g> will be hidden */
  self.refLineInfo = this.vis.append("g")
    .attr("class", "refLineInfo")
    .style("display", "none");

  /*Put the reference photopeak line text in its own <g> element so */
  /*  we can call getBBox() on it to get its extent to to decide where to */
  /*  position the text relative to the selected phtotopeak. */
  self.refLineInfoTxt = self.refLineInfo.append("g");

  /*Add the text to the <g>.  We will use tspan's to append each line of information */
  self.refLineInfoTxt.append("text")
   .attr("x", 0)
   .attr("dy", "1em");

  /*Add a small red circle on the x axis to help indicate which line the info is */
  /*  currently showing for. */
  self.refLineInfo.append("circle")
    .attr("cx", 0)
    .attr("cy", self.size.height)
    .attr("r", 2)
    .style("fill","red");

  this.chartBody = this.vis.append("g")
    .attr("clip-path", "url(#clip" + this.chart.id + ")");

  self.peakVis = this.vis.append("g")
    .attr("class", "peakVis")
    .attr("transform","translate(0,0)")
    .attr("clip-path", "url(#clip" + this.chart.id + ")");

  /* add Chart Title */
  var title = this.options.title;
  this.options.title = null;
  this.setTitle( title, true );

  /* Add the x-axis label */
  if (this.options.xlabel) {
    this.xaxistitle = this.svg.append("text")
        .attr("class", "xaxistitle")
        .text(this.options.xlabel)
        .attr("x", this.size.width/2)
        .attr("y", this.size.height )
        .attr("dy",29)
        .style("text-anchor","middle");
  }

  /* add y-axis label */
  if (this.options.ylabel) {
    this.vis.append("g")
      .attr('id', 'yaxistitle-container') // Christian: To allow changing the y-axis title
      .append("text")
        .attr("class", "yaxistitle")
        .text(this.options.ylabel + (this.rebinFactor > 1 ? (" per " + this.rebinFactor + " Channels") : "") )
        .style("text-anchor","middle");
        /*.attr("transform","translate(" + -40 + " " + this.size.height/2+") rotate(-90)"); */
  }
}

registerKeyboardHandler = function(callback) {
  var callback = callback;
  d3.select(window).on("keydown", callback);
}

/**
 * Adds polyfills needed to run D3 code on older browsers such as IE11.
 */
browserPolyfill = function() {

  // Thanks to: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign
  //  Christian: Added to support Object.assign(...) method for IE11
  if (typeof Object.assign != 'function') {
    // Must be writable: true, enumerable: false, configurable: true
    Object.defineProperty(Object, "assign", {
      value: function assign(target, varArgs) { // .length of function is 2
        'use strict';
        if (target == null) { // TypeError if undefined or null
          throw new TypeError('Cannot convert undefined or null to object');
        }
  
        var to = Object(target);
  
        for (var index = 1; index < arguments.length; index++) {
          var nextSource = arguments[index];
  
          if (nextSource != null) { // Skip over if undefined or null
            for (var nextKey in nextSource) {
              // Avoid bugs when hasOwnProperty is shadowed
              if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                to[nextKey] = nextSource[nextKey];
              }
            }
          }
        }
        return to;
      },
      writable: true,
      configurable: true
    });
  }

  // Thanks to: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/log10
  //  Christian: Added to support Math.log10(...) method for IE11
  Math.log10 = Math.log10 || function(x) {
    return Math.log(x) * Math.LOG10E;
  };

  // Thanks to: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith
  //  Christian: Added to support the String method endsWith(...)
  if (!String.prototype.endsWith) {
    String.prototype.endsWith = function(search, this_len) {
      if (this_len === undefined || this_len > this.length) {
        this_len = this.length;
      }
      return this.substring(this_len - search.length, this_len) === search;
    };
  }

  // Thank to: https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/remove
  //  from:https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/remove()/remove().md
  //  Christian: Added to support the remove(...) method of HTML Element nodes
(function (arr) {
  arr.forEach(function (item) {
    if (item.hasOwnProperty('remove')) {
      return;
    }
    Object.defineProperty(item, 'remove', {
      configurable: true,
      enumerable: true,
      writable: true,
      value: function remove() {
        if (this.parentNode !== null)
          this.parentNode.removeChild(this);
      }
    });
  });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);
}


/**
 * -------------- Data Handlers --------------
 */
/**
 * elem: The element can be a DOM element, or the object ID of a WObject
 * event: must be an object which indicates also the JavaScript event and event target
 * args: array of args to pass into the Wt function
 */
SpectrumChartD3.prototype.WtEmit = function(elem, event) {
  if (!window.Wt) {
    console.warn('Wt not found! Canceling emit function...');
    return;
  }

  // To support ES5 syntax in IE11, we replace spread operator with this
  var args = Array.prototype.slice.call(arguments, SpectrumChartD3.prototype.WtEmit.length);

  // Emit the function to Wt
  // Wt.emit( elem, event, ...args);  // ES6 syntax
  Wt.emit.apply(Wt, [elem, event].concat(args));
}

SpectrumChartD3.prototype.dataPointDrag = function() {
  var self = this;
  return function(d) {
    registerKeyboardHandler(self.keydown());
    document.onselectstart = function() { return false; };
    self.selected = self.dragged = d;
    self.update(false); /* boolean set to false to indicate no animation needed */

  }
}

SpectrumChartD3.prototype.do_rebin = function() {
  var self = this;

  if( !this.rawData || !self.rawData.spectra || !self.rawData.spectra.length ) {
    return;
  }

  this.rawData.spectra.forEach(function(spectrum, spectrumi) {
    var newRebin = 1;
    spectrum.points = [];

    var firstRaw = self.displayed_raw_start(spectrum);
    var lastRaw = self.displayed_raw_end(spectrum);

    var npoints = lastRaw - firstRaw;
    if( npoints > 1 && self.size.width > 2 ) {
      newRebin = Math.ceil( npoints / (self.size.width) );
    }

    if( newRebin != spectrum.rebinFactor || self.firstRaw !== firstRaw || self.lastRaw !== lastRaw ){
      spectrum.points = [];

      if( spectrum.rebinFactor != newRebin ){
        var txt = self.options.ylabel ? self.options.ylabel : "";
        if( newRebin !== 1 )
          txt += " per " + newRebin + " Channels"
        self.vis.select(".yaxistitle").text( txt );
      }

      spectrum.rebinFactor = newRebin;
      spectrum.firstRaw = firstRaw;
      spectrum.lastRaw = lastRaw;

      /*Round firstRaw and lastRaw down and up to even multiples of newRebin */
      firstRaw -= (firstRaw % newRebin);
      lastRaw += newRebin - (lastRaw % newRebin);
      if( firstRaw >= newRebin )
        firstRaw -= newRebin;
      if( lastRaw > spectrum.x.length )
        lastRaw = spectrum.x.length;


      /*could do some optimizations here where we actually do a slightly larger */
      /*  range than displayed, so that next time we might not have to go back */
      /*  through the data to recompute things (it isnt clear if D3 will plot */
      /*  these datas, should check on this.) */
      /*Also, could _maybe_ use energy range, rather than indexes to track if we */
      /*  need to rebin the data or not... */

      /*console.log( "self.rebinFactor=" + self.rebinFactor ); */

      for( var i = firstRaw; i < lastRaw; i += newRebin ){
        var thisdata = { };
        if (i >= spectrum.x.length) {
          thisdata['x'] = spectrum.x[spectrum.x.length-1];
        }
        else
          thisdata['x'] = spectrum.x[i];

        if (spectrum.y.length > 0) {
          var key = 'y';
          thisdata[key] = 0;
          for( var j = 0; j < newRebin && i+j<spectrum.y.length; ++j )
            thisdata[key] += spectrum.y[i+j];
          thisdata[key] *= spectrum.yScaleFactor;
        }
        spectrum.points.push( thisdata );
      }
    }
  });
}

SpectrumChartD3.prototype.rebinSpectrum = function(spectrumToBeAdjusted, linei) {
  var self = this;

  if( !this.rawData || !this.rawData.spectra || !this.rawData.spectra.length ) 
    return;

  /* Check for the which corresponding spectrum line is the specified one to be rebinned */
  if (linei == null || !spectrumToBeAdjusted) 
    return;

  var newRebin = 1;

  var firstRaw = self.displayed_raw_start(spectrumToBeAdjusted);
  var lastRaw = self.displayed_raw_end(spectrumToBeAdjusted);

  var npoints = lastRaw - firstRaw;
  if( npoints > 1 && this.size.width > 2 )
    newRebin = Math.ceil( npoints / this.size.width );

  /* Since we can only adjust scale factors for background/secondary/others, we don't need to adjust y-axis title */
  /*
  if( spectrumToBeAdjusted.rebinFactor != newRebin ){
    var txt = this.options.ylabel ? this.options.ylabel : "";
    if( newRebin !== 1 )
      txt += " per " + newRebin + " Channels"
    d3.select(".yaxistitle").text( txt );
  }
  */

  spectrumToBeAdjusted.rebinFactor = newRebin;
  spectrumToBeAdjusted.firstRaw = firstRaw;
  spectrumToBeAdjusted.lastRaw = lastRaw;

  /*Round firstRaw and lastRaw down and up to even multiples of newRebin */
  firstRaw -= (firstRaw % newRebin);
  lastRaw += newRebin - (lastRaw % newRebin);
  if( firstRaw >= newRebin )
    firstRaw -= newRebin;
  if( lastRaw > spectrumToBeAdjusted.x.length )
    lastRaw = spectrumToBeAdjusted.x.length;


  /*could do some optimizations here where we actually do a slightly larger */
  /*  range than displayed, so that next time we might not have to go back */
  /*  through the data to recompute things (it isnt clear if D3 will plot */
  /*  these datas, should check on this.) */
  /*Also, could _maybe_ use energy range, rather than indexes to track if we */
  /*  need to rebin the data or not... */

  /*console.log( "self.rebinFactor=" + self.rebinFactor ); */
  var i = firstRaw;
  for( var pointi = 0; pointi < spectrumToBeAdjusted.points.length; pointi++ ){
    var thisdata = spectrumToBeAdjusted.points[pointi];

    if( spectrumToBeAdjusted.y.length > 0 ) {
      thisdata.y = 0;
      for( var j = 0; j < newRebin && i+j<spectrumToBeAdjusted.y.length; ++j )
        thisdata.y += spectrumToBeAdjusted.y[i+j];
      thisdata.y *= spectrumToBeAdjusted.yScaleFactor;
    }

    i += newRebin;
  }
}

/**
 * Adds or replaces the first spectrum seen with the passed-in type in the raw data with new spectrum data.
 */
SpectrumChartD3.prototype.setSpectrumData = function( spectrumData, resetdomain, spectrumType, id, backgroundID ) {
  var self = this;

  if (!spectrumData) return;
  if (!spectrumType || !(spectrumType in self.spectrumTypes)) return;

  if (!self.rawData) self.rawData = { updateTime: spectrumData.updateTime, spectra: [] };
  if (!self.rawData.updateTime) self.rawData.updateTime = spectrumData.updateTime;

  let spectra = self.rawData.spectra;
  let index = -1;
  spectrumData = spectrumData.spectra[0];

  console.log('setting ', spectrumData);

  // Set the ID if it was specified
  if (typeof id !== 'undefined') spectrumData.id = id;

  // Set the background ID if it was specified
  if (backgroundID) spectrumData.backgroundID = backgroundID;

  // Find index of first spectrum of this type
  for (let i = 0; i < spectra.length; i++) {
    if (spectra[i].type === spectrumType) {
      index = i;
      break;
    }
  }

  if (index < 0) {  // no spectrum of this type found, so add it onto raw data
    spectra.push(spectrumData);

  } else {  // spectrum found of this type, so replace it
    spectra[index] = spectrumData;
  }

  // Call primary function for setting data
  self.setData( self.rawData, resetdomain );
}

/**
 * Removes the first spectrum seen with the passed-in type in the raw data.
 */
SpectrumChartD3.prototype.removeSpectrumData = function( resetdomain, spectrumType ) {
  var self = this;

  if (!spectrumType || !(spectrumType in self.spectrumTypes)) return;
  if (!self.rawData) self.rawData = { spectra: [] };

  let spectra = self.rawData.spectra;
  let index = -1;

  // Find index of first spectrum of this type
  for (let i = 0; i < spectra.length; i++) {
    if (spectra[i].type === spectrumType) {
      index = i;
      break;
    }
  }

  if (index >= 0) {  // spectrum found of this type, so delete it
    spectra.splice(index, 1);
  }

  // Call primary function for setting data
  self.setData( self.rawData, resetdomain );
}

SpectrumChartD3.prototype.setData = function( data, resetdomain ) {
  // need to make some consistency checks on data here
  /*  -Has all necassary variables */
  /*  -Energy is monotonically increasing */
  /*  -All y's are the same length, and consistent with x. */
  /*  -No infs or nans. */

  var self = this;

  if (data && data.spectra && data.spectra.length)
    for (var i = 0; i < data.spectra.length; ++i)
      if (this['line'+i])
        this.vis.selectAll("#spectrumline"+i).remove();

  this.vis.selectAll('path.line').remove();
  if (this.sliderChart) this.sliderChart.selectAll('.sliderLine').remove(); // Clear x-axis slider chart lines if present

  this.rawData = null;
  this.firstRaw = this.lastRaw = this.rebinFactor = -1; /*force rebin calc */

  try
  {
    if( !data || !data.spectra ) throw null;
    if( !Array.isArray(data.spectra) || data.spectra.length < 1 ) throw 'No spectrum-data specified';
    /*check that x is same length or one longer than y. */
    /*Check that all specified y's are the same length */
  }catch(e){
    if(e) console.log(e);

    // Christian [05122018]: Added other necessary display render methods to ensure consistency even when chart has no data
    this.options.scaleBackgroundSecondary = false;
    this.removeSpectrumScaleFactorWidget();
    this.updateLegend();
    this.drawXAxisSliderChart();
    this.updateColorPickerItems();

    this.redraw()();
    return;
  }

  this.rawData = data;

  this.rawData.spectra.forEach( function(spectrum,i){
    if( !spectrum || !spectrum.y.length )
      return;
    if( spectrum.xeqn && spectrum.xeqn.length>1 && !spectrum.x && spectrum.y && spectrum.y.length )
    {
      /* A polynomial equation was specified, rather than lower channel energies */
      spectrum.x = [];
      for( var i = 0; i < spectrum.y.length; ++i )
      {
        spectrum.x[i] = spectrum.xeqn[0];
        for( var j = 1; j < spectrum.xeqn.length; ++j )
          spectrum.x[i] += spectrum.xeqn[j] * Math.pow(i,j);
      }
    }
  } );
  
  for (var i = 0; i < this.rawData.spectra.length; ++i)
    this['line'+i] = null;
  
  this.do_rebin();  /*this doesnt appear to be necassay, but JIC */

  /*Make it so the x-axis shows all the data */
  if( resetdomain ) {
    var bounds = self.min_max_x_values();
    var minx = bounds[0], maxx = bounds[1];
    
    this.setXAxisRange(minx, maxx);
  }

  /*reset the zoom, so first userzoom action wont behave wierdly */
  /* this.zoom.x(this.xScale); */
  /* this.zoom.y(this.yScale); */

  /* Hack: To properly choose the right set of points for the y-axis points */
  function y(line) {
    return function(d) {
      var y = self.yScale(d['y']);
      if (isNaN(y)) y = 0;
      return y; 
    }
  }

  var maxYScaleFactor = 0.1;
  for (var i = 0; i < this.rawData.spectra.length; ++i)
    this.rawData.spectra[i].dataSum = 0;

  /* Create the lines */
  for (var i = 0; i < data.spectra.length; ++i) {
    var spectrumi = i;
    var spectrum = data.spectra[i];
    if (!spectrum.lineColor) spectrum.lineColor = self.getRandomColor();  // Set line color if not yet set
    if (!spectrum.peakColor) spectrum.peakColor = self.getRandomColor();  // Set peak color if not yet set
    if (spectrum.y.length) {
      for (var j = 0; j < spectrum.y.length; ++j) {
        spectrum.dataSum += spectrum.y[j];
      }
      this['line' + i] = d3.svg.line()
        .interpolate("step-after")
        .x( function(d, pi) {
          return self.xScale(d.x);
        })
        .y( y(i) );

      this.chartBody.append("path")
        .attr("id", "spectrumline"+i)
        .attr("class", 'line')
        .attr("stroke", spectrum.lineColor ? spectrum.lineColor : 'black')
        .attr("d", this['line' + i](spectrum.points));

      if (spectrum.yScaleFactor)
        maxYScaleFactor = Math.max(spectrum.yScaleFactor, maxYScaleFactor);
    }
  }

  /* + 10 to add at keast some padding for scale */
  self.options.maxScaleFactor = maxYScaleFactor + 10;
  var maxsfinput;
  if (maxsfinput = document.getElementById("max-sf")) {
    maxsfinput.value = self.options.maxScaleFactor;
  }

  function needsDecimal(num) {
    return num % 1 != 0;
  }

  /* Update the spectrum drop down for adjusting y-scale factors */
  if (currentsftitle = document.getElementById("current-sf-title")) {
    var titles = self.getSpectrumTitles();
    currentsftitle.options.length = titles.length;
    titles.forEach(function(title,i) {
      if (i == 0)
        currentsftitle.options[i] = new Option("None", "", true, false);
      else
        currentsftitle.options[i] = new Option(title, title, false, false);
    });
  }

  this.updateColorPickerItems();
  this.addMouseInfoBox();

  this.updateLegend();
  this.drawScalerBackgroundSecondary();
  
  this.redraw()();
}


/**
 * Render/Drawing Functions
 */
SpectrumChartD3.prototype.update = function() {
  var self = this;

  if (!this.rawData || !this.rawData.spectra || !this.rawData.spectra.length)
    return;

  // Figure out which set of points to use
  //  Use background subtract if we're in that view mode, otherwise use the normal set of points
  const key = this.options.backgroundSubtract ? 'bgsubtractpoints' : 'points';

  this.rawData.spectra.forEach(function(spectrum, i) {
    var line = self.vis.select("#spectrumline"+i);
  
    if (spectrum.type === self.spectrumTypes.BACKGROUND) {
      line.attr('visibility', self.options.backgroundSubtract ? 'hidden' : 'visible');
      if (self.options.backgroundSubtract) return;
    }
    line.attr("d", self['line'+i](self.rawData.spectra[i][key]));
  });

  /*
  if( self.xrange !== self.xScale.range() ) {
    console.log( "xrange changed changed" );
  }

  if( self.xdomain !== self.xScale.domain() ) {
    console.log( "xrange domain changed" );
  }

  if( self.yrange !== self.yScale.range() ) {
    console.log( "yrange range changed" );
  }

  if( self.ydomain !== self.yScale.domain() ) {
    console.log( "yrange domain changed" );
  }

  if( self.prevRebinFactor !== this.rebinFactor ) {
    console.log( "rebin factor changed" );
  }

  self.prevRebinFactor = this.rebinFactor;
  self.xrange = self.xScale.range();   
  self.xdomain = self.xScale.domain(); 
  self.yrange = self.yScale.range();  
  self.ydomain = self.yScale.domain();
  */

  if (d3.event && d3.event.keyCode) {
    d3.event.preventDefault();
    d3.event.stopPropagation();
  }
}

SpectrumChartD3.prototype.redraw = function() {
  var self = this;

  return function() {
    self.do_rebin();
    self.rebinForBackgroundSubtract();  // Get the points for background subtract
    self.setYAxisDomain();

    var tx = function(d) { return "translate(" + self.xScale(d) + ",0)"; };
    var stroke = function(d) { return d ? "#ccc" : "#666"; };

    self.yAxis.scale(self.yScale);
    self.yAxisBody.call(self.yAxis);

    /**
     * Christian [032818]: Another perforance optimization. Assign style and event listeners 
     * for only major y-label ticks. This lessens the load and we can see a lot of improvement
     * in application to InterSpec and other high performing apps.
     */
    self.svg.selectAll('.yaxislabel')
      .each(function(d, i) {
        const label = d3.select(this);
        if (label.text().trim()) {  // If this y-label tick is a major tick
          label.style("cursor", "ns-resize")
            .on("mouseover", function(d) { d3.select(this).style("font-weight", "bold");})
            .on("mouseout",  function(d) { d3.select(this).style("font-weight", "normal");})
            .on("mousedown.drag",  self.yaxisDrag());

          if (self.isTouchDevice())
            label.on("touchstart.drag", self.yaxisDrag());
        }
      });

    if (self.options.showXAxisSliderChart) { self.drawXAxisSliderChart(); } 
    else                                   { self.cancelXAxisSliderChart(); }

    self.drawYTicks();
    
    self.calcLeftPadding( true );
    
    self.drawXTicks();

    self.drawXAxisArrows();

    /*The oringal code had the follwoing in, but I dont think is needed */
    /*self.plot.call(d3.behavior.zoom().x(self.xScale).y(self.yScale).on("zoom", self.redraw()));     */
    
    self.drawPeaks();
    self.drawRefGammaLines();
    self.updateMouseCoordText();

    self.update();

    self.yAxisZoomedOutFully = true;
    /* console.log('yaxis domain = ', self.yScale.domain()); */
  }
}

SpectrumChartD3.prototype.calcLeftPadding = function( updategeom ){
  
  if( !this.options.adjustYAxisPadding ) {
    this.padding.leftComputed = this.padding.left; 
    return;
  }
  
  var labels = this.vis.selectAll("g.y").selectAll("text");
  
  var labelw = 4;
  labels.forEach( function(label){
    labelw = Math.max( labelw, label.parentNode.getBBox().width );
  });
  
  var labelpad = this.padding.labelPad;
  var ticklen = 7; /*hardcoded as major tick x1 */
  var title = this.svg.select(".yaxistitle");
  if( title )
    title.attr("transform","translate(-" + (labelw+labelpad) + " " + this.size.height/2+") rotate(-90)");
  
  var newleft = ticklen + labelw + labelpad + this.padding.left + 4;
  
  if( !updategeom ) {
    this.padding.leftComputed = newleft;
  } else if( Math.abs(this.padding.leftComputed - newleft) > 1.0 ) {
    this.padding.leftComputed = newleft;
    this.handleResize( true );
  } 
}

/* Sets the title of the graph */
SpectrumChartD3.prototype.setTitle = function(title,dontRedraw) {
  var titleh = 0;
  if( (title == null || typeof title !== 'string') || title.length === 0 ){
    this.options.title = null;
    this.svg.select('#chartTitle').remove();
  } else {
    if( this.options.title )
      titleh = this.svg.selectAll(".title").text( title ).node().getBBox().height;
    else
      titleh = this.svg.append("text")
          .attr("id", "chartTitle")
          .attr("class", "title")
          .text(title)
          .attr("x", this.cx/2)
          .attr("dy", this.padding.title)
          .style("text-anchor","middle")
          .node().getBBox().height;
    this.options.title = title;
  }
  this.handleResize( dontRedraw ); 
  this.refreshRefGammaLines();
}

SpectrumChartD3.prototype.setXAxisTitle = function(title) {
  var self = this;

  self.options.xlabel = null;
  self.svg.select('.xaxistitle').remove();

  if( (title == null || typeof title !== 'string') || title.length === 0 )
    return;
  
  self.options.xlabel = title;
  self.xaxistitle = self.svg.append("text")
    .attr("class", "xaxistitle")
    .text(self.options.xlabel)
    .attr("x", self.size.width/2)
    .attr("y", self.size.height )
    .attr("dy",29)
    .style("text-anchor","middle");

  self.handleResize( false );
}

SpectrumChartD3.prototype.setYAxisTitle = function(title) {
  var self = this;

  self.options.ylabel = null;
  self.vis.select('#yaxistitle-container').remove();

  if( (title == null || typeof title !== 'string') || title.length === 0 )
    return;
  
  self.options.ylabel = title;
  self.vis.append("g")
    .attr('id', 'yaxistitle-container')
    .append("text")
      .attr("class", "yaxistitle")
      .text(self.options.ylabel + (self.rebinFactor > 1 ? (" per " + self.rebinFactor + " Channels") : "") )
      .style("text-anchor","middle");

  self.handleResize( true );
}

SpectrumChartD3.prototype.handleZoom = function() {
  var self = this;

  function shouldZoomInX() {
    var keys = Object.keys(self.touchesOnChart);

    if (keys.length == 1) {
      var touch = self.touchesOnChart[keys[0]];
      var x0 = Math.round( touch.startX );
      var x1 = Math.round( touch.pageX );
      return Math.abs(x0-x1)>=15;
    }
    else if (keys.length == 0 || keys.length > 2)
      return false;

    var touch1 = self.touchesOnChart[keys[0]];
    var touch2 = self.touchesOnChart[keys[1]];
    var adx1 = Math.abs( touch1.startX - touch2.startX );
    var adx2 = Math.abs( touch1.pageX  - touch2.pageX );
    var ady1 = Math.abs( touch1.startY - touch2.startY );
    var ady2 = Math.abs( touch1.pageY  - touch2.pageY );
    var ddx = Math.abs( adx2 - adx1 );
    var ddy = Math.abs( ady2 - ady1 );
    var areVertical = (adx2 > ady2);

    return (ddx >= ddy && ddx>20);
  }

  return function() {
    /* console.log( 'handleZoom' ); */
    var e = d3.event;
    var t = d3.touches(self.vis[0][0]);

    /* Two touches are close together if distance between two touches < 70px */
    /*    We want to cancel the zoom if this is true to prevent redrawing while detecting swipes (may need to change/remove this) */
    var areTwoTouchesCloseTogether = t.length === 2 && self.dist(t[0], t[1]) < 70; 

    if (e && e.sourceEvent && e.sourceEvent.type.startsWith("mouse")) {
      self.redraw()();
      return;
    }

    /* Awesome hack: saving the zoom scale and translation allows us to prevent double-tap zooming! */
    if (d3.event.sourceEvent === null || d3.event.sourceEvent.touches == 1 || areTwoTouchesCloseTogether ||
          self.deletePeakSwipe || self.controlDragSwipe || self.altShiftSwipe || self.zoomInYPinch || !shouldZoomInX()) {
      const domain = self.xScale.domain();
      
      self.setXAxisRange(domain[0], domain[1]);
      self.zoom.scale(self.savedZoomScale);
      self.zoom.translate(self.savedZoomTranslation);
      return false;
    }

    /* Get chart domain values */
    var xaxismin,
        xaxismax,
        bounds,
        x0 = self.xScale.domain()[0],
        x1 = self.xScale.domain()[1];

    /* Set the proper min/max chart values w/respect to data */
    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) {
      xaxismin = 0;
      xaxismax = 3000;
    } else {
      bounds = self.min_max_x_values();
      xaxismin = bounds[0];
      xaxismax = bounds[1];
    }

    /* Adjust domains properly to min/max chart values */
    if( x0 < xaxismin ){
      x1 += xaxismin - x0;
    }else if( x1 > xaxismax ){
      x0 -= x1 - xaxismax;
    }
      
    /* Set the x domain values */
    x0 = Math.max( x0, xaxismin );
    x1 = Math.min( x1, xaxismax);

    /* Update the x-domain to the new zoomed in values */
    self.setXAxisRange(x0, x1);

    /* Don't redraw (abort the function) if the domain did not change from last time */
    /*    Needed to add toPrecision(4) because domain would change (very) slightly sometimes  */
    if (self.previousX0 && self.previousX1 && 
        (x0.toPrecision(4) === self.previousX0.toPrecision(4) && x1.toPrecision(4) === self.previousX1.toPrecision(4))) {
      return false;
    }

    /* Set previous domain values to current ones */
    self.previousX0 = x0;
    self.previousX1 = x1;

    /* Redraw the chart */
    self.redraw()();
  }
}

SpectrumChartD3.prototype.handleZoomEnd = function () {
  var self = this;

  return function() {

      /* Reset the d3 zoom vector so next zoom action will be independant of this one */
      self.zoom.x(self.xScale);
      self.zoom.y(self.yScale);
  };
}

SpectrumChartD3.prototype.handleResize = function( dontRedraw ) {
  var self = this;

  const prevCx = this.cx;
  const prevCy = this.cy;
  
  this.cx = this.chart.clientWidth;
  this.cy = this.chart.clientHeight;

  if (self.sliderChartPlot) {
    this.cy -= self.size.sliderChartHeight + self.padding.sliderChart + 
      (self.xaxistitle != null && !d3.select(self.xaxistitle).empty() ? self.xaxistitle[0][0].clientHeight + 20 : 20); 
  }
  
  var titleh = 0, xtitleh = 0, xlabelh = 7 + 22;
  if( this.options.title ) {
    this.svg.selectAll(".title").forEach( function(t){
      titleh = t[0].getBBox().height;  
   });
  }
  
  if( this.xaxistitle )
    xtitleh = this.xaxistitle.node().getBBox().height;
  
  /*Bellow isnt quite working, so stick with estimate of 22 above */
  /*self.xAxisBody.selectAll('g.tick').forEach( function(t){ */
      /*console.log( t[0].getBBox().height );  /*sometimes gives 22.21875, sometimes 4 */
   /*}); */
  
  this.padding.topComputed = titleh + this.padding.top + (titleh > 0 ? this.padding.titlePad : 0);
  
  /*Not sure where the -12 comes from, but things seem to work out... */
  if( this.options.compactXAxis && xtitleh > 0 ) {
    var txth = 4 + this.padding.xTitlePad + xtitleh;
    this.padding.bottomComputed = this.padding.bottom + Math.max( txth, xlabelh-10 );
  } else {
    this.padding.bottomComputed = -12 + this.padding.bottom + xlabelh + (xtitleh > 0 ? this.padding.xTitlePad : 0) + xtitleh; 
  }
  
  
  /* console.log("height beore") */
  this.size.height = Math.max(0, this.cy - this.padding.topComputed - this.padding.bottomComputed);
  this.size.sliderChartHeight = this.size.height / 10;
 
  this.calcLeftPadding( false );
 
  if (!this.origWidth)
    this.origWidth = this.size.width;
  this.size.width = Math.max(0, this.cx - this.padding.leftComputed - this.padding.right);
  this.size.height = Math.max(0, this.cy - this.padding.topComputed - this.padding.bottomComputed);

  this.xScale.range([0, this.size.width]);
  this.vis.attr("width",  this.size.width)
          .attr("height", this.size.height);
  this.vis.attr("transform", "translate(" + this.padding.leftComputed + "," + this.padding.topComputed + ")");
  this.plot.attr("width", this.size.width)
           .attr("height", this.size.height);

  self.svg
      .attr("width", this.cx)
      .attr("height", this.cy)
      .attr("viewBox", "0 0 "+this.cx+" "+this.cy);

  this.vis.attr("width", this.cx )
          .attr("height", this.cy );

  d3.select("#chartarea"+this.chart.id)
          .attr("width", this.size.width )
          .attr("height", this.size.height );

  d3.select("#clip"+ this.chart.id).select("rect")
    .attr("width", this.size.width )
    .attr("height", this.size.height );

  /*Fix the text position */
  this.svg.selectAll(".title")
      .attr("x", this.cx/2);

      /* Christian: To keep the title from shifting during redraw, we translate the position of the label to stay in its place. */
      /* .attr("transform", "translate(" + ((this.size.width/2) - (this.origWidth/2)) + "," + 0 + ")"); */

  if( this.xaxistitle ){
    if( !this.options.compactXAxis ){
      this.xaxistitle.attr("x", this.cx/2);
      this.xaxistitle.attr("dy",xlabelh+this.padding.xTitlePad + (this.options.title ? 33 : 6)); /* Christian: hard-coded 33 to account for padding between x-axis labels and slider chart */

    } else {
      this.xaxistitle.attr("x", this.size.width - this.xaxistitle.node().getBBox().width + 30 );  /*Not certain why this 30 is needed (I'm probably leaving out some element) but necassary to have label line up right */
      this.xaxistitle.attr("dy",xtitleh + this.padding.xTitlePad + (this.options.title ? 31 : 4));
    }
    this.xaxistitle.attr("y", this.size.height);
  }

 /* this.vis.selectAll(".yaxistitle") */
    /* .attr("transform","translate(" + -40 + " " + this.size.height/2+") rotate(-90)"); */
  this.xAxisBody.attr("width", this.size.width )
                .attr("height", this.size.height )
                .attr("transform", "translate(0," + this.size.height + ")");

  // Christian: Prevents bug of initially rendering chart w/all ticks displayed 
  if (this.cx !== prevCx && this.cy !== prevCy)
    this.xAxisBody.call(this.xAxis);

  this.yAxisBody.attr("height", this.size.height )
                .call(this.yAxis);
  
  this.refLineInfo.select("circle").attr("cy", this.size.height);
  this.mouseInfo.attr("transform","translate(" + this.size.width + "," + this.size.height + ")");

  if( this.xGrid ) {
    this.xGrid.innerTickSize(-this.size.height)
    this.xGridBody.attr("width", this.size.width )
        .attr("height", this.size.height )
        .attr("transform", "translate(0," + this.size.height + ")")
        .call(this.xGrid);
  }

  if( this.yGrid ) {
    this.yGrid.innerTickSize(-this.size.width)
    this.yGridBody.attr("width", this.size.width )
        .attr("height", this.size.height )
        .attr("transform", "translate(0,0)")
        .call(this.yGrid);
  }
  
  /*Make sure the legend stays visible */
  if( this.legend ) {
    var trans = d3.transform(this.legend.attr("transform")).translate;
    var bb = this.legendBox.node().getBBox();
    var legx = ((trans[0]+bb.width) > this.cx) ? (this.cx-bb.width) : trans[0];
    var legy = ((trans[1]+bb.height) > this.cy) ? (this.cy-bb.height) : trans[1];
    this.legend.attr("transform", "translate(" + Math.max(0,legx) + "," + Math.max(legy,0) + ")" );
  }

  /* Make sure the scaler stays visible */
  if( this.scalerWidget ) {
    var trans = d3.transform(this.scalerWidget.attr("transform")).translate;
    var bb = this.scalerWidgetBox.node().getBBox();
    var scalerx = ((trans[0]+bb.width) > this.cx) ? (this.cx-bb.width) : trans[0];
    var scalery = ((trans[1]+bb.height) > this.cy) ? (this.cy-bb.height) : trans[1];
    this.scalerWidget.attr("transform", "translate(" + Math.max(0,scalerx) + "," + Math.max(scalery,0) + ")" );
  }

  if (!self.sliderChartWidthFactor) self.sliderChartWidthFactor = this.svg[0][0].clientWidth - self.size.sliderChartWidth;
  if (!self.sliderChartHeightFactor) self.sliderChartHeightFactor = self.size.sliderChartHeight / this.svg[0][0].clientHeight;
  self.size.sliderChartWidth = this.svg[0][0].clientWidth - self.sliderChartWidthFactor;
  self.size.sliderChartHeight = self.sliderChartHeightFactor * this.svg[0][0].clientHeight;
  if (this.options.showXAxisSliderChart) { self.drawXAxisSliderChart(); } 
  else                                   { self.cancelXAxisSliderChart(); }
  
  this.xScale.range([0, this.size.width]);
  this.yScale.range([0, this.size.height]);

  /* this.zoom.x(this.xScale); */
  /* this.zoom.y(this.yScale); */

  if( !dontRedraw ) {
    this.setData( this.rawData, false );
    this.redraw()();
  }
}

/* Pan chart is called when right-click dragging */
SpectrumChartD3.prototype.handlePanChart = function () {
  var self = this;

  var minx, maxx, bounds;
  if( !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length ){
    minx = 0;
    maxx = 3000;
  }else {
    bounds = self.min_max_x_values();
    minx = bounds[0];
    maxx = bounds[1];
  }

  /* We are now right click dragging  */
  self.rightClickDrag = true;

  /* For some reason, using the mouse position for self.vis makes panning slightly buggy, so I'm using the document body coordinates instead */
  var docMouse = d3.mouse(document.body);

  if (!docMouse || !self.rightClickDown)
    return;

  /* Set the pan right / pan left booleans */
  var panRight = docMouse[0] < self.rightClickDown[0],   /* pan right if current mouse position to the left from previous mouse position */
      panLeft = docMouse[0] > self.rightClickDown[0],    /* pan left if current mouse position to the right from previous mouse position */
      dx = 0;

  function newXDomain() {
    var currentX = docMouse[0],
        delta = currentX - self.rightClickDown[0],
        oldMin = self.xScale.range()[0],
        oldMax = self.xScale.range()[1];

    /* Declare new x domain members */
    var newXMin = oldMin, 
        newXMax = oldMax;

    newXMin = oldMin - delta;
    newXMax = oldMax - delta;

    newXMin = self.xScale.invert(newXMin);
    newXMax = self.xScale.invert(newXMax);

    /* Make sure we don't go set the domain out of bounds from the data */
    if( newXMin < minx ){
     newXMax += (minx - newXMin);
     newXMin = minx; 
    }
    if( newXMax > maxx ){
     newXMin = Math.max(minx,newXMin-(newXMax-maxx));
     newXMax = maxx;
    }
    return [newXMin, newXMax];
  }

  /* Get the new x values */
  var newXMin = newXDomain()[0],
      newXMax = newXDomain()[1];

  /* Pan the chart */
  self.setXAxisRange(newXMin, newXMax);
  self.redraw()();

  /* New mouse position set to current moue position */
  self.rightClickDown = docMouse;
}


/**
 * -------------- Chart Event Handlers --------------
 */
SpectrumChartD3.prototype.handleChartMouseMove = function() {
  var self = this;

  return function() {
    self.mousemove()();

    /* If no data is detected, then stop updating other mouse move parameters */
    if(!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length || !isNaN(self.downx) || !isNaN(self.downy) || self.legdown || self.scalerdown) 
      return;

    /* Prevent and stop default events from ocurring */
    d3.event.preventDefault();
    d3.event.stopPropagation();

    /* Get the absoulate minimum and maximum x-values valid in the data */
    var minx, maxx, bounds;
    if( !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length ){
      minx = 0;
      maxx = 3000;
    }else {
      bounds = self.min_max_x_values();
      minx = bounds[0];
      maxx = bounds[1];
    }
     
    /* Set the mouse and chart parameters */
    var m, x0px, x1px;

    m = d3.mouse(self.vis[0][0]);
    x0_min = self.xScale.range()[0];
    x1_max = self.xScale.range()[1];
    self.lastMouseMovePos = m;

    /* Adjust the last mouse move position in case user starts draggin from out of bounds */
    if (self.lastMouseMovePos[1] < 0)
      self.lastMouseMovePos[1] = 0;
    else if (self.lastMouseMovePos[1] > self.size.height)
      self.lastMouseMovePos[1] = self.size.height;

    /* Do any other mousemove events that could be triggered by the left mouse drag */
    self.handleMouseMoveSliderChart()();
    self.handleMouseMoveScaleFactorSlider()();

    /* It seems that d3.event.buttons is present on Chrome and Firefox, but is not in Safari. */
    /* d3.event.button is present in all browsers, but is a little less consistent so we need to keep track of when the left or right mouse is down. */
    if ((d3.event.button === 0 && self.leftMouseDown)) {        /* If left click being held down (left-click and drag) */
      const isWindows = self.isWindows();

      d3.select(document.body).attr("cursor", "move");

      /* Holding the Shift-key and left-click dragging --> Delete Peaks Mode */
      self.isDeletingPeaks = d3.event.shiftKey && !d3.event.altKey && !d3.event.ctrlKey && !d3.event.metaKey && !self.fittingPeak && !self.escapeKeyPressed;

      /* Holding the Alt+Shift-key and left-click dragging --> Count Gammas Mode */
      self.isCountingGammas = d3.event.altKey && d3.event.shiftKey && !d3.event.ctrlKey && !d3.event.metaKey && !self.fittingPeak && !self.escapeKeyPressed;

      /* Holding the Alt+Ctrl-key + Left-click Dragging --> Recalibration Mode */
      self.isRecalibrating = d3.event.altKey && d3.event.ctrlKey && !d3.event.metaKey && !d3.event.shiftKey && !self.fittingPeak && !self.escapeKeyPressed; 

      /* Holding the Command-key + Left-click dragging --> Zoom-in Y Mode */
      // For Windows, you can zoom-in on the y-axis using Alt + Left-drag
      self.isZoomingInYAxis = (isWindows ? d3.event.altKey : d3.event.metaKey) && !(isWindows ? d3.event.metaKey : d3.event.altKey) && !d3.event.ctrlKey && !d3.event.shiftKey && !self.fittingPeak && !self.escapeKeyPressed;

      /* Holding the Alt-key + Left-click dragging ---> Undefined, maybe a future implementation? */
      self.isUndefinedMouseAction = (isWindows ? d3.event.metaKey : d3.event.altKey) && !d3.event.ctrlKey && !(isWindows ? d3.event.altKey : d3.event.metaKey) && !d3.event.shiftKey && !self.fittingPeak && !self.escapeKeyPressed;

      var isZoomingInXAxis = !d3.event.altKey && !d3.event.ctrlKey && !d3.event.metaKey && !d3.event.shiftKey && !self.fittingPeak && !self.escapeKeyPressed;

      /* If erasing peaks */
      if( self.fittingPeak ) {          /* If fitting peaks */
        self.handleMouseMovePeakFit();

      } else if (self.isDeletingPeaks) {   /* If deleting peaks */
        self.handleMouseMoveDeletePeak();

      } else if (self.isCountingGammas) {   /* If counting gammas */
        self.handleMouseMoveCountGammas();

      } else if (self.isRecalibrating) {      /* If recalibrating the chart */
        self.handleMouseMoveRecalibration();

      } else if (self.isZoomingInYAxis) {        /* If zooming in y-axis */
        self.handleMouseMoveZoomInY();

      } else if (self.isUndefinedMouseAction) {   /* If undefined mouse action */
        /* Do nothing, save for future feature */
        self.handleCancelAllMouseEvents()();

      } else if (isZoomingInXAxis) {    /* If zooming in x-axis */
        self.handleMouseMoveZoomInX();

      } else {
        self.handleCancelAllMouseEvents()();
      }

      return;

    } else if ( self.rightClickDown )  /* Right Click Dragging: pans the chart left and right */
      self.handlePanChart();
    

    self.updateFeatureMarkers(-1);
  }
}

SpectrumChartD3.prototype.handleChartMouseLeave = function() {
  var self = this;

  return function () {
      if (!d3.event)
        return;

      if (!d3.select(d3.event.toElement)[0].parentNode || d3.event.toElement === document.body || d3.event.toElement.nodeName === "HTML" 
              || d3.event.toElement.nodeName === "DIV" || d3.event.toElement.offsetParent === document.body) {

        /* For debugging where the mouse is specifically out of */
        /* if (!d3.select(d3.event.toElement)[0].parentNode) */
        /*   console.log("mouse out of the window"); */
        /* else */
        /*   console.log("mouse out of the chart"); */

        /* Cancel erasing peaks */
        self.handleCancelMouseDeletePeak();

        /* Cancel the right-click-drag action */
        self.handleCancelMouseRecalibration();

        /* Cancel the left-click-drag zoom action */
        self.handleCancelMouseZoomInX();

        /* Cancel the left-click-drag zooming in y axis action */
        self.handleCancelMouseZoomInY();

        /* Cancel count gammas */
        self.handleCancelMouseCountGammas();
      }

      self.updateFeatureMarkers(-1);

      self.mousedOverRefLine = null;
      self.refLineInfo.style("display", "none");
      self.mouseInfo.style("display", "none");
  }
}

SpectrumChartD3.prototype.handleChartMouseUp = function() {
  var self = this;

  return function () {
    self.downx = Math.NaN;
    self.downy = Math.NaN;
    d3.select(document.body).style("cursor", "default");

    /* Here we can decide to either zoom-in or not after we let go of the left-mouse button from zooming in on the CHART.
       In this case, we are deciding to zoom-in if the above event occurs.

       If you want to do the opposite action, you call self.handleCancelMouseZoomInX()
     */

    self.handleMouseUpDeletePeak();

    self.handleMouseUpZoomInX();

    self.handleMouseUpZoomInY();

    self.handleMouseUpRecalibration();

    self.handleMouseUpCountGammas();

    self.lastMouseMovePos = null;
    self.sliderChartMouse = null;
  }
}

SpectrumChartD3.prototype.handleChartWheel = function () {
  var self = this;

  return function() {
    /* Keep event from bubbling up any further */
    if (d3.event) {
      d3.event.preventDefault();
      d3.event.stopPropagation();
    } else
      return;

    /*Get mouse pixel x and y location */
    var m = d3.mouse(self.vis[0][0]);

    /* Handle y axis zooming if wheeling in y-axis */
    if (m[0] < 0 && m[1] > 0 && m[0] < self.size.height && self.options.wheelScrollYAxis) {
      self.handleYAxisWheel();
      return;
    }
  }
}

SpectrumChartD3.prototype.handleChartTouchStart = function() {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();
  }
}

SpectrumChartD3.prototype.handleChartTouchEnd = function() {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();

    self.sliderBoxDown = false;
    self.leftDragRegionDown = false;
    self.rightDragRegionDown = false;
    self.sliderChartTouch = null;
    self.savedSliderTouch = null;
  }
}


/**
 * -------------- Vis Event Handlers --------------
 */
SpectrumChartD3.prototype.handleVisMouseDown = function () {
  var self = this;

  return function () {
    console.log("mousedown on plot function!"); 
    self.dragging_plot = true;

    self.updateFeatureMarkers(null);

    self.mousedowntime = new Date();
    self.mousedownpos = d3.mouse(document.body);

    registerKeyboardHandler(self.keydown());

    if( !isNaN(self.downx) || !isNaN(self.downy) || self.legdown || self.scalerdown )
    {
        console.log( "Is null down" )
      return;
    }

    /* Cancel the default d3 event properties */
    d3.event.preventDefault();
    d3.event.stopPropagation(); 

    var m = d3.mouse(self.vis[0][0]);

    if (d3.event.metaKey)
      self.zoomInYMouse = m;
    else
      self.zoomInYMouse = null;

    self.leftMouseDown = null;
    self.zoominmouse = self.deletePeaksMouse = self.countGammasMouse = self.recalibrationMousePos = null; 

    /*
      On Firefox, clicking while holding the Ctrl key triggers a "right click".
      To fix this problem, we save the condition for d3.event.buttons to keep consistent for Firefox/Chrome browsers.
      The d3.event.button condition is saved for other browsers, including Safari.
    */
    if( (d3.event.buttons === 1 || d3.event.button === 0) && m[0] >= 0 && m[0] < self.size.width && m[1] >= 0 && m[1] < self.size.height ) {    /* if left click-and-drag and mouse is in bounds */
      console.log("left mousedown");

      /* Set cursor to move icon */
      d3.select('body').style("cursor", "move");

      /* Set the zoom in/erase mouse properties */
      self.leftMouseDown = self.zoominmouse = self.deletePeaksMouse = self.countGammasMouse = self.recalibrationMousePos = m;
      self.peakFitMouseDown = m;
      self.origdomain = self.xScale.domain();
      self.zoominaltereddomain = false;
      self.zoominx0 = self.xScale.invert(m[0]);
      self.zoominy0 = self.xScale.invert(m[1]);

      self.recalibrationStartEnergy = [ self.xScale.invert(m[0]), self.xScale.invert(m[1]) ];
      self.isRecalibrating = false;

      /* We are fitting peaks (if alt-key held) */
      self.fittingPeak = d3.event.ctrlKey && !d3.event.altKey && !d3.event.metaKey && !d3.event.shiftKey && d3.event.keyCode !== 27;

      /* Initially set the escape key flag false */
      self.escapeKeyPressed = false;
      
      /* Create the initial zoom box if we are not fitting peaks */
      if( !self.fittingPeak ) {
        var zoomInXBox = self.vis.select("#zoomInXBox")
            zoomInXText = self.vis.select("#zoomInXText");

        zoomInXBox.remove();
        zoomInXText.remove();

        /* Set the zoom-in box and display onto chart */
        zoomInXBox = self.vis.append("rect")
          .attr("id", "zoomInXBox")
          .attr("class","leftbuttonzoombox")
          .attr("width", 1 )
          .attr("height", self.size.height)
          .attr("x", m[0])
          .attr("y", 0)
          .attr("pointer-events", "none");
      }

      self.updateFeatureMarkers(-1);
      
      self.zooming_plot = true;
      return false;

    } else if ( d3.event.button === 2 ) {    /* listen to right-click mouse down event */
      console.log("Right mouse down!");
      console.log(d3.event);
      self.rightClickDown = d3.mouse(document.body);
      self.rightClickDrag = false;

      /* Since this is the right-mouse button, we are not zooming in */
      self.zooming_plot = false;
    } else{

      console.log("Something else: d3.event.buttons=" + d3.event.buttons + ", d3.event.buttom=" + d3.event.button + ", m[0]=" + m[0] + ", self.size.width=" + self.size.width + ", m[1]=" + m[1] + ", self.size.height=" + self.size.height );
    }
  }
}

SpectrumChartD3.prototype.handleVisMouseUp = function () {
  var self = this;

  return function () {
    console.log("mouseup on vis!");

    if (!d3.event)
      return;

    /* Set the client/page coordinates of the mouse */
    var m = d3.mouse(self.vis[0][0])
        x = m[0],
        y = m[1],
        pageX = d3.event.pageX,
        pageY = d3.event.pageY,
        energy = self.xScale.invert(x),
        count = self.yScale.invert(y);

    /* Handle any of default mouseup actions */
    self.mouseup()();

    /* We are not dragging the plot anymore */
    self.dragging_plot = false;

    /* Update feature marker positions */
    self.updateFeatureMarkers(null);

    /* If the slider chart is displayed and the user clicks on that, cancel the mouse click action */
    if (y >= (self.size.height + 
      (self.xaxistitle != null && !d3.select(self.xaxistitle).empty() ? self.xaxistitle[0][0].clientHeight + 20 : 20) + 
      self.padding.sliderChart)) {
      return;
    }

    /* Figure out right clicks */
    if (d3.event.button === 2 && !self.rightClickDrag && !d3.event.ctrlKey) {
      console.log("Emit RIGHT CLICK (ON PLOT) signal!\nenergy = ", energy, ", count = ", count, ", pageX = ", pageX, ", pageY = ", pageY );
      self.WtEmit(self.chart.id, {name: 'rightclicked'}, energy, count, pageX, pageY);
      return;
    }
    
    /* Figure out clicks and double clicks */
    var nowtime = new Date();
    var clickDelay = 200;

    if (self.mousedownpos && self.dist(self.mousedownpos, d3.mouse(document.body)) < 5) {    /* user clicked on screen */
      if( nowtime - self.mousedowntime < clickDelay ) {

        if (self.lastClickEvent && nowtime - self.lastClickEvent < clickDelay) {    /* check for double click */
          if (self.mousewait) {
            window.clearTimeout(self.mousewait);
            self.mousewait = null;
          }
          console.log("Emit DOUBLE CLICK signal!", "\nenergy = ", energy, ", count = ", count, ", x = ", x, ", y = ", y);
          self.WtEmit(self.chart.id, {name: 'doubleclicked'}, energy, count);

        } else {
          self.mousewait = window.setTimeout((function(e) {
            self.updateFeatureMarkers(self.xScale.invert( x ));    /* update the sum peak where user clicked */

            return function() {
              console.log( "Emit CLICK signal!", "\nenergy = ", energy, ", count = ", count, ", pageX = ", pageX, ", pageY = ", pageY );
              self.WtEmit(self.chart.id, {name: 'leftclicked'}, energy, count, pageX, pageY);

              if( self.unhighlightPeakFunc )
                self.unhighlightPeakFunc(); /* need to look into if unhighlightPeakFunc should always be defined (currently not - was throwing exception) */
              self.mousewait = null;
            }
          })(d3.event), clickDelay);
        }
        self.lastClickEvent = new Date();
      }
    }

    if( !isNaN(self.downx) || !isNaN(self.downy) || self.legdown || self.scalerdown )
      return;

    /* Handle fitting peaks (if needed) */
    if (self.fittingPeak)
      self.handleMouseUpPeakFit();

    /* Handle zooming in x-axis (if needed) */
    if (self.zooming_plot) {
      self.handleMouseUpZoomInX();
    }

    /* Handle deleting peaks (if needed) */
    self.handleMouseUpDeletePeak();
    
    /* Handle recalibration (if needed) */
    self.handleMouseUpRecalibration();

    /* Handle zooming in y-axis (if needed) */
    self.handleMouseUpZoomInY();

    /* HAndle counting gammas (if needed) */
    self.handleMouseUpCountGammas();

    /* Delete any other mouse actions going on */
    self.leftMouseDown = null;
    self.zoominbox = null;
    self.zoominx0 = null;
    self.zoominy0 = null;
    self.zoominmouse = null;
    self.fittingPeak = null;
    self.escapeKeyPressed = false;

    /* Set delete peaks mode off */
    self.isDeletingPeaks = false;
    self.deletePeaksMouse = null;

    /* Set the count gammas mode off */
    self.countGammasMouse = null;

    /* Set the recalibration mode off */
    self.recalibrationMousePos = null;

    self.handleCancelMouseZoomInY();

    /* Set the right click drag and mouse down off */
    self.rightClickDown = null;
    self.rightClickDrag = false;

    /* Cancel default d3 event properties */
    d3.event.preventDefault();
    d3.event.stopPropagation();

    /* Not zooming in anymore */
    self.zooming_plot = false;

    /* Not using x-axis slider anymore */
    self.sliderBoxDown = false;
    self.leftDragRegionDown = false;
    self.rightDragRegionDown = false;
    self.sliderChartMouse = null;
    self.savedSliderMouse = null;
  }
}

SpectrumChartD3.prototype.handleVisWheel = function () {
  var self = this;

  return function () {
    var e = d3.event;

    /*Keep event from bubbling up any further */
    e.preventDefault();
    e.stopPropagation();

    /*If the user is doing anything else, return */
    /*Note that if you do a two finger pinch on a mac book pro, you get e.ctrlKey==true and e.composed==true  */
    if( !e || e.altKey || (e.ctrlKey && !e.composed) || e.shiftKey || e.metaKey || e.button != 0 /*|| e.buttons != 0*/ ) {
     console.log( "Special condition with wheel, ignoring mousewheel e=" + e + ", e.altKey=" + e.altKey + ", e.ctrlKey=" + e.ctrlKey + ", e.shiftKey=" + e.shiftKey + ", e.metaKey=" + e.metaKey + ", e.button=" + e.button + ", e.buttons=" + e.buttons );
     console.log( e );
     return;
    }

    /*Get mouse pixel x and y location */
    var m = d3.mouse(self.vis[0][0]);

    /*Make sure within chart area */
    if( m[0] < 0 || m[0] > self.size.width || m[1] < 0 || m[1] > self.size.height ){

    /* If wheeling in y-axis labels, zoom in the y-axis range */
    if (m[0] < 0 && m[1] > 0 && m[1] < self.size.height && self.options.wheelScrollYAxis && self.rawData && self.rawData.spectra && self.rawData.spectra.length) {
      self.handleYAxisWheel();
      return;
    }

     console.log( "Scroll outside of vis, ignoring mousewheel" );
     return;
    }  

    /*If we are doing any other actions with the chart, then to bad. */
    if( self.dragging_plot || self.zoominbox || self.fittingPeak ){
     console.log( "Plot is being dragged, zoomed, or peak fit, ignoring mousewheel" );
     return;
    }

    /*Dont do anything if there is no data */
    if( !self.rawData || !self.rawData.spectra || self.rawData.spectra.length < 1 ){
     console.log( "No data, ignoring mousewheel" );
     return;
    }

    var mindatax, maxdatax, bounds, foreground;
    foreground = self.rawData.spectra[0];
    bounds = self.min_max_x_values();
    mindatax = bounds[0];
    maxdatax = bounds[1];

    //
    if ((self.xScale.domain()[0] <= mindatax && self.xScale.domain()[1] >= maxdatax && e.deltaX > 0)
        || (self.xScale.domain()[1] >= maxdatax && self.xScale.domain()[0] <= maxdatax && e.deltaX < 0)) {
      //Should put in some sort of last seen deltaX so that if the user starts goign in the otehr direction
      //  than the zoom in that direction can start immediately, instead of when the user scrolls al the way
      //  back through zero.
      console.log("Cannot scroll past the minimum/maximum data from chart, ignoring mousewheel")
      return;
    }

    /*Here we will set a timer so that if it is more than 1 second since the */
    /*  last wheel movement, we will consider the wheel event over, and start  */
    /*  fresh. */
    /*  This is just an example, and likely needs changed, or just removed. */
    if( self.wheeltimer ){
     /*This is not the first wheel event of the current user wheel action, */
     /*  lets clear the previous timeout (we'll reset a little bellow).  */
     window.clearTimeout(self.wheeltimer);
    } else {
     /*This is the first wheel event of this user wheel action, lets record */
     /*  initial mouse energy, counts, as well as the initial x-axis range. */
     self.scroll_start_x = self.xScale.invert(m[0]);
     self.scroll_start_y = self.yScale.invert(m[1]);
     self.scroll_start_domain = self.xScale.domain();
     self.scroll_start_raw_channel = d3.bisector(function(d){return d;}).left(foreground.x, self.scroll_start_x);
     self.scroll_start_raw_channel = Math.max(0,self.scroll_start_raw_channel);
     self.scroll_start_raw_channel = Math.min(foreground.x.length-1,self.scroll_start_raw_channel);
     self.scroll_total_x = 0;
     self.scroll_total_y = 0;
    }

    /*Function to clear out any variables assigned during scrolling, or finish */
    /*  up any actions that should be done  */
    function wheelcleanup(e){
     console.log( "mousewheel, stopped" );
     self.wheeltimer = null;
     self.scroll_start_x = null;
     self.scroll_start_y = null;
     self.scroll_start_domain = null;
     self.scroll_start_raw_channel = null;
     self.scroll_total_x = null;
     self.scroll_total_y = null;
    }

    /*Set a timeout to call wheelcleanup after a little time of not resieving  */
    /*  any user wheel actions. */
    self.wheeltimer = window.setTimeout( wheelcleanup, 1000 );

    /*scroll_total_x/y is the total number of scroll units the mouse has done */
    /*  since the user started doing this current mouse wheel. */
    self.scroll_total_x += e.deltaX;
    self.scroll_total_y += e.deltaY;

    var MAX_SCROLL_TOTAL = 200;

    /*Zoom all the way out by the time we get self.scroll_total_y = +200, */
    /*  or, zoom in to 3 bins by the time self.scroll_total_y = -200; */
    self.scroll_total_y = Math.max( self.scroll_total_y, -MAX_SCROLL_TOTAL );
    self.scroll_total_y = Math.min( self.scroll_total_y, MAX_SCROLL_TOTAL );

    //console.log("wheel on chart {" + self.scroll_total_x + "," + self.scroll_total_y + "}");

    var initial_range_x = self.scroll_start_domain[1] - self.scroll_start_domain[0];
    var terminal_range_x;
    if( self.scroll_total_y > 0 ){
      terminal_range_x = (maxdatax - mindatax);
    } else {
     /*Find the bin one to the left of original mouse, and two to the right  */
     var terminalmin = Math.max(0,self.scroll_start_raw_channel - 1);
     var terminalmax = Math.min(foreground.x.length-1,self.scroll_start_raw_channel + 2);
     terminalmin = foreground.x[terminalmin];
     terminalmax = foreground.x[terminalmax];
     terminal_range_x = terminalmax - terminalmin; 
    }

    var frac_y = Math.abs(self.scroll_total_y) / MAX_SCROLL_TOTAL;
    var new_range = initial_range_x + frac_y * (terminal_range_x - initial_range_x);  

    /*Make it so the mouse is over the same energy as when the wheeling started */
    var vis_mouse_frac = m[0] / self.size.width;  

    var new_x_min = self.scroll_start_x - (vis_mouse_frac * new_range);

    var new_x_max = new_x_min + new_range;


    /*Now translate the chart left and right.  100 x wheel units is one initial  */
    /*  width left or right */
    /*  TODO: should probably make it so that on trackpads at least, there is */
    /*        is some threshold on the x-wheel before (like it has to be  */
    /*        greater than the y-wheel) before the panning is applied; this  */
    /*        would also imply treating the x-wheel using deltas on each event */
    /*        instead of using the cumulative totals like now. */
    var mouse_dx_wheel = Math.min(initial_range_x,new_range) * (self.scroll_total_x / MAX_SCROLL_TOTAL);
    new_x_min += mouse_dx_wheel;
    new_x_max += mouse_dx_wheel;

    if( new_x_min < mindatax ){
     new_x_max += (mindatax - new_x_min);
     new_x_min = mindatax; 
    }

    if( new_x_max > maxdatax ){
     new_x_min = Math.max(mindatax,new_x_min-(new_x_max-maxdatax));
     new_x_max = maxdatax;
    }

    /*Finally set the new x domain, and redraw the chart (which will take care */
    /*  of setting the y-domain). */
    self.setXAxisRange(new_x_min, new_x_max);
    self.redraw()();

    self.updateFeatureMarkers(-1);
  }
}

SpectrumChartD3.prototype.handleVisTouchStart = function() {
  var self = this;

  return function() {

      /* Prevent default event actions from occurring (eg. zooming into page when trying to zoom into graph) */
      d3.event.preventDefault();
      d3.event.stopPropagation();

      /* Get the touches on the screen */
      var t = d3.touches(self.vis[0][0]),
          touchHoldTimeInterval = 600;

      /* Save the original zoom scale and translation */
      self.savedZoomScale = self.zoom.scale();
      self.savedZoomTranslation = self.zoom.translate();

      /* Represent where we initialized our touch start value */
      self.touchStart = t;
      self.touchStartEvent = d3.event;
      self.touchPageStart = d3.touches(document.body).length === 1 ? [d3.event.pageX, d3.event.pageY] : null;

      if (t.length === 2) {
        self.countGammasStartTouches = self.createPeaksStartTouches = self.touchStart;
      }

      self.updateTouchesOnChart(self.touchStartEvent);

      /* Boolean for the touch of a touch-hold signal */
      self.touchHoldEmitted = false;

      self.touchHold = window.setTimeout((function(e) {
        var x = t[0][0],
            y = t[0][1],
            pageX = d3.event.pageX,
            pageY = d3.event.pageY,
            energy = self.xScale.invert(x),
            count = self.yScale.invert(y);

        return function() {

          /* Emit the tap signal, unhighlight any peaks that are highlighted */
          if (self.touchStart && self.dist([pageX, pageY], self.touchPageStart) < 5 && !self.touchHoldEmitted) {
            console.log( "Emit TAP HOLD (RIGHT TAP) signal!", "\nenergy = ", energy, ", count = ", count, ", x = ", x, ", y = ", y );
            self.WtEmit(self.chart.id, {name: 'rightclicked'}, energy, count, pageX, pageY);
            if(self.unhighlightPeakFunc)
              self.unhighlightPeakFunc(); /* need to look into if unhighlightPeakFunc should always be defined (currently not - was throwing exception) */
            self.touchHoldEmitted = true;
          }

          /* Clear the touch hold wait, the signal has already been emitted */
          self.touchHold = null;
        }     
      })(d3.event), touchHoldTimeInterval);
    }
}

SpectrumChartD3.prototype.handleVisTouchMove = function() {
  var self = this;

  /* Touch interaction helpers */
  function isDeletePeakSwipe() {

    if (!self.touchesOnChart)
      return false;

    var keys = Object.keys(self.touchesOnChart);

    /* Delete peak swipe = two-finger vertical swipe */
    if (keys.length !== 2)
      return false;

    var maxDyDiff = 15,
        minDxDiff = 25;

    var t1 = self.touchesOnChart[keys[0]],
        t2 = self.touchesOnChart[keys[1]];

    var dy1 = t1.startY - t1.pageY,
        dy2 = t2.startY - t2.pageY,
        dyDiff = Math.abs(dy2 - dy1);

    if (dyDiff > maxDyDiff || Math.abs(t1.pageX - t2.pageX) < minDxDiff) {
      return false;
    }

    var dy = Math.min(dy1,dy2),
        dx1 = t1.startX - t1.pageX,
        dx2 = t2.startX - t2.pageX,
        dx = Math.abs(dx1 - dx2);

    return dy > dx && dy > maxDyDiff;
  }

  function isControlDragSwipe() {

    if (!self.touchesOnChart)
      return false;

    var keys = Object.keys(self.touchesOnChart);

    if (keys.length !== 2)
      return false;

    var t1 = self.touchesOnChart[keys[0]],
        t2 = self.touchesOnChart[keys[1]];

    if (t1.startX > t1.pageX || t2.startX > t2.pageX)
      return false;

    if( !isFinite(t1.startX) || !isFinite(t1.pageX)
    || !isFinite(t2.startX) || !isFinite(t2.pageX)
    || !isFinite(t1.startY) || !isFinite(t1.pageY)
    || !isFinite(t2.startY) || !isFinite(t2.pageY) )
      return false;

    var startdx = t1.startX - t2.startX;
        nowdx = t1.pageX - t2.pageX;
        yavrg = 0.5*(t1.startY+t2.startY);

    if( Math.abs(yavrg-t1.pageY) > 20 || 
        Math.abs(yavrg-t2.pageY) > 20 || 
        Math.abs(startdx-nowdx) > 20 ) 
      return false;

    return Math.abs(t1.pageX - t1.startX) > 30;
  }

  function isAltShiftSwipe() {
    var keys = Object.keys(self.touchesOnChart);

    if( keys.length !== 2 ) 
      return false;

    var t1 = self.touchesOnChart[keys[0]],
        t2 = self.touchesOnChart[keys[1]];

    if( Math.abs(t1.startX-t2.startX) > 20 || Math.abs(t1.pageX-t2.pageX) > 25 )
      return false;

    return ( (t1.pageX - t1.startX) > 30 );
  }

  function isZoomInYPinch() {
    if (!self.touchesOnChart)
      return false;

    var keys = Object.keys(self.touchesOnChart);

    if (keys.length !== 2)
      return false;

    var touch1 = self.touchesOnChart[keys[0]];
    var touch2 = self.touchesOnChart[keys[1]];
    var adx1 = Math.abs( touch1.startX - touch2.startX );
    var adx2 = Math.abs( touch1.pageX  - touch2.pageX );
    var ady1 = Math.abs( touch1.startY - touch2.startY );
    var ady2 = Math.abs( touch1.pageY  - touch2.pageY );
    var ddx = Math.abs( adx2 - adx1 );
    var ddy = Math.abs( ady2 - ady1 );
    var areVertical = (adx2 > ady2);

    return ddx < ddy && ddy>20
  }

  function deleteTouchLine() {
    /* Delete the touch lines if they exist on the vis */

    if (self.touchLineX) {
      self.touchLineX.remove();
      self.touchLineX = null;
    }

    if (self.touchLineY) {
      self.touchLineY.remove();
      self.touchLineY = null;
    }
  }

  return function() {

      /* Prevent default event actions from occurring (eg. zooming into page when trying to zoom into graph) */
      d3.event.preventDefault();
      d3.event.stopPropagation();

      /* Nullify our touchstart position, we are now moving our touches */
      self.touchStart = null;

      /* Get the touches on the chart */
      var t = d3.touches(self.vis[0][0]);

      if (t.length === 2) {
        self.deletePeaksTouches = t;
      }

      /* Panning = one finger drag */
      self.touchPan = t.length === 1;
      self.deletePeakSwipe = isDeletePeakSwipe() && !self.currentlyAdjustingSpectrumScale;
      self.controlDragSwipe = isControlDragSwipe() && !self.currentlyAdjustingSpectrumScale;
      self.altShiftSwipe = isAltShiftSwipe() && !self.currentlyAdjustingSpectrumScale;
      self.zoomInYPinch = isZoomInYPinch() && !self.currentlyAdjustingSpectrumScale;

      if (self.deletePeakSwipe) {
        self.handleTouchMoveDeletePeak();

      } else if (self.controlDragSwipe) {
        self.handleTouchMovePeakFit();

      } else if (self.altShiftSwipe) {
        self.handleTouchMoveCountGammas();

      } else if (self.zoomInYPinch) {
        self.handleTouchMoveZoomInY();

      } else if (self.currentlyAdjustingSpectrumScale) {
        self.handleTouchMoveAdjustSpectrumScale()();

      } else {
        self.handleCancelTouchCountGammas();
        self.handleCancelTouchDeletePeak();
        self.handleCancelTouchPeakFit();
        self.handleTouchCancelZoomInY();
      }

      /* 
      Clear the touch hold signal if:
        - More than one touches on chart
        - No touch positions on the page detected
        - We moved our touches by > 5 pixels
      */
      if (t.length > 1 || !self.touchPageStart || self.dist([d3.event.pageX, d3.event.pageY], self.touchPageStart) > 5) {
        if (self.touchHold) {
          window.clearTimeout(self.touchHold);
          self.touchHold = null;
        }
      }


      /* Update mouse coordinates, feature markers on a touch pan action */
      if (self.touchPan) {
        self.mousemove();
        self.updateMouseCoordText();
        self.updateFeatureMarkers(-1);
      }

      /* Hide the peak info */
      self.hidePeakInfo();

      /* Delete the touch line */
      deleteTouchLine();

      /* Update our map of touches on the chart */
      self.updateTouchesOnChart(d3.event);

      self.lastTouches = t;
    }
}

SpectrumChartD3.prototype.handleVisTouchEnd = function() {
  var self = this;

  function updateTouchLine(touches) {

    /* Touches is an error, abort function */
    if (!touches)
      return;

    /* Do not update the touch line (remove it) if there are more than two touches on the screen */
    if (touches.length != 1) {
      deleteTouchLine();
      return;
    }

    /* Set the coordinates of the touch */
    var t = touches[0];

    /* Create the x-value touch line, or update its coordinates if it already exists */
    if (!self.touchLineX) {
      self.touchLineX = self.vis.append("line")
        .attr("class", "touchLine")
        .attr("x1", t[0])
        .attr("x2", t[0])
        .attr("y1", 0)
        .attr("y2", self.size.height);

    } else {
      self.touchLineX.attr("x1", t[0])
        .attr("x2", t[0])
    }

    /* Create the y-value touch line, or update its coordinates if it already exists */
    if (!self.touchLineY) {
      self.touchLineY = self.vis.append("line")
        .attr("class", "touchLine")
        .attr("x1", t[0]-10)
        .attr("x2", t[0]+10)
        .attr("y1", t[1])
        .attr("y2", t[1]);
    } else {
      self.touchLineY.attr("x1", t[0]-10)
        .attr("x2", t[0]+10)
        .attr("y1", t[1])
        .attr("y2", t[1]);
    }
  }
  function deleteTouchLine() {

    /* Delete the touch lines if they exist on the vis */
    if (self.touchLineX) {
      self.touchLineX.remove();
      self.touchLineX = null;
    }

    if (self.touchLineY) {
      self.touchLineY.remove();
      self.touchLineY = null;
    }
  }

  return function() {

      /* Prevent default event actions from occurring (eg. zooming into page when trying to zoom into graph) */
      d3.event.preventDefault();
      d3.event.stopPropagation();

      /* Get the touches on the screen */
      var t = d3.event.changedTouches;
      var visTouches = d3.touches(self.vis[0][0]);
      if (visTouches.length === 0) {
        self.touchesOnChart = null;
      }

      if (self.touchPan)
        console.log("touchend from pan!");

      else {
        /* Detect tap/double tap signals */
        if (t.length === 1 && self.touchStart) {

          /* Get page, chart coordinates of event */
          var x = self.touchStart[0][0],
              y = self.touchStart[0][1],
              pageX = d3.event.pageX,
              pageY = d3.event.pageY
              currentTapEvent = d3.event,
              energy = self.xScale.invert(x),
              count = self.yScale.invert(y);

          /* Set the double tap setting parameters */
          var tapRadius = 35,                   /* Radius area for where a double-tap is valid (anything outside this considered a single tap) */
              doubleTapTimeInterval = 200;      /* Time interval for double tap */

          /* Update the feature marker positions (argument added for sum peaks) */
          self.updateFeatureMarkers(self.xScale.invert(x));

          /* Update the touch line position */
          updateTouchLine(self.touchStart);

          /* Emit the proper TAP/DOUBLE-TAP signal */
          if (self.touchPageStart && self.dist(self.touchPageStart, [pageX, pageY]) < tapRadius ) {

            if (self.lastTapEvent &&
                  self.lastTapEvent.timeStamp && currentTapEvent.timeStamp - self.lastTapEvent.timeStamp < doubleTapTimeInterval &&
                  self.dist([self.lastTapEvent.pageX, self.lastTapEvent.pageY], [pageX, pageY]) < tapRadius) {

              /* Clear the single-tap wait if it exists, then emit the double tap signal */
              if (self.tapWait) {
                window.clearTimeout(self.tapWait);
                self.tapWait = null;
              }

              /* Emit the double-tap signal, clear any touch lines/highlighted peaks in chart */
              console.log("Emit DOUBLE TAP signal!", "\nenergy = ", energy, ", count = ", count, ", x = ", x, ", y = ", y);
              self.WtEmit(self.chart.id, {name: 'doubleclicked'}, energy, count);
              deleteTouchLine();
              if( self.unhighlightPeakFunc )
                self.unhighlightPeakFunc(); /* need to look into if unhighlightPeakFunc should always be defined (currently not - was throwing exception) */

            } else {

              /* Create the single-tap wait emit action in case there is no more taps within double tap time interval */
              self.tapWait = window.setTimeout((function(e) {

                /* Move the feature markers to tapped coordinate */
                self.updateFeatureMarkers(self.xScale.invert(x));    /* update the sum peak where user clicked */

                /* Don't emit the tap signal if there was a tap-hold */
                if (self.touchHoldEmitted)
                  return false;

                return function() {

                  /* Emit the tap signal, unhighlight any peaks that are highlighted */
                  console.log( "Emit TAP signal!", "\nx = ", x, ", y = ", y, ", pageX = ", pageX, ", pageY = ", pageY );
                  if( self.unhighlightPeakFunc )
                    self.unhighlightPeakFunc(); /* need to look into if unhighlightPeakFunc should always be defined (currently not - was throwing exception) */
                  var touchStartPosition = self.touchStart;

                  /* Highlight peaks where tap position falls */
                  if (self.peakPaths) {
                    for (i = self.peakPaths.length-1; i >= 0; i--) {
                      if (self.xScale.invert(x) >= self.peakPaths[i].lowerEnergy && self.xScale.invert(x) <= self.peakPaths[i].upperEnergy) {
                        const path = self.peakPaths[i].path;
                        const paths = self.peakPaths[i].paths;
                        const roi = self.peakPaths[i].roi;
                        self.handleMouseOverPeak(path, null, 0, paths, roi, path);
                        break;
                      }
                    }
                  }
                  /* Clear the single-tap wait, the signal has already been emitted */
                  self.tapWait = null;
                }     
              })(d3.event), doubleTapTimeInterval);
            
            }

            /* Set last tap event to current one */
            self.lastTapEvent = currentTapEvent;
          }

        } else    /* Touch move detected, aborting tap signal */
          self.updateFeatureMarkers(-1);
      }

      self.updateTouchesOnChart(d3.event);
      self.updateMouseCoordText();
      self.updatePeakInfo();

      self.handleTouchEndCountGammas();
      self.handleTouchEndDeletePeak();
      self.handleTouchEndPeakFit();
      self.handleTouchEndZoomInY();
      

      self.touchPan = false;
      self.touchZoom = false;
      self.touchStart = null;
      self.touchStart = null;
      self.touchHoldEmitted = false;

      self.deletePeakSwipe = false;
      self.controlDragSwipe = false;
      self.altShiftSwipe = false;
      self.zoomInYPinch = false;

      self.countGammasStartTouches = null;

      self.sliderBoxDown = false;
      self.leftDragRegionDown = false;
      self.rightDragRegionDown = false;
      self.sliderChartTouch = null;
      self.savedSliderTouch = null;
    };
}


/**
 * -------------- General Key/Mouse Event Handlers --------------
 */
SpectrumChartD3.prototype.mousemove = function () {
  var self = this;

  return function() {
    /*This function is called whenever a mouse movement occurs */
    /* console.log("mousemove function called from ", d3.event.type); */

    var p = d3.mouse(self.vis[0][0]),
        t = d3.event.changedTouches;

    var energy = self.xScale.invert(p[0]),
        mousey = self.yScale.invert(p[1]);


    self.updateFeatureMarkers(-1);
    self.updateMouseCoordText();
    self.updatePeakInfo();

    if( self.legdown ) {
      d3.event.preventDefault();
      d3.event.stopPropagation();

      var x = d3.event.x ? d3.event.x : d3.event.touches ?  d3.event.touches[0].clientX : d3.event.clientX,
          y = d3.event.y ? d3.event.y : d3.event.touches ?  d3.event.touches[0].clientY : d3.event.clientY,
          calculated_x = d3.mouse(self.vis[0][0])[0]; /* current mouse x position */

      if ( calculated_x >= -self.padding.leftComputed && y >= 0 && 
           calculated_x <= self.cx && y <= self.cy ) {
        /* console.log("change legend pos"); */
        var tx = (x - self.legdown.x) + self.legdown.x0;
        var ty = (y - self.legdown.y) + self.legdown.y0; 
        self.legend.attr("transform", "translate(" + tx + "," + ty + ")");
      }
    }

    if (self.scalerdown) {
      d3.event.preventDefault();
      d3.event.stopPropagation();

      var x = d3.event.x ? d3.event.x : d3.event.touches ?  d3.event.touches[0].clientX : d3.event.clientX,
          y = d3.event.y ? d3.event.y : d3.event.touches ?  d3.event.touches[0].clientY : d3.event.clientY,
          calculated_x = d3.mouse(self.vis[0][0])[0]; /* current mouse x position */

      if ( calculated_x >= -self.padding.leftComputed && y >= 0 && 
           calculated_x <= self.cx && y <= self.cy ) {
        /* console.log("change legend pos"); */
        var tx = (x - self.scalerdown.x) + self.scalerdown.x0;
        var ty = (y - self.scalerdown.y) + self.scalerdown.y0; 
        self.scalerWidget.attr("transform", "translate(" + tx + "," + ty + ")");
      }
    }

    if (self.adjustingBackgroundScale || self.adjustingSecondaryScale) {
      d3.event.preventDefault();
      d3.event.stopPropagation();
    }

    if( self.rawData && self.rawData.spectra && self.rawData.spectra.length ) {
      var foreground = self.rawData.spectra[0];
      var lowerchanval = d3.bisector(function(d){return d.x;}).left(foreground.points,energy,1) - 1;
      var counts = foreground.points[lowerchanval].y;
      var lefteenergy = foreground.points[lowerchanval].x;
      var rightenergy = foreground.points[lowerchanval+1>=foreground.points.length ? foreground.points.length-1 : lowerchanval+1].x;
      var midenergy = 0.5*(lefteenergy + rightenergy);
      var detchannel = lowerchanval*foreground.rebinFactor;

      /*Here is where we would update some sort of display or whatever */
      /*console.log( "counts=" + counts + " in " + self.rebinFactor + " channels, starting at energy " + lefteenergy ); */

      /* self.focus.attr("transform", "translate(" + self.xScale(midenergy) + "," + self.yScale(counts) + ")"); */
      /* self.focus.style("display", null); */
      /* self.focus.select("text").text( "counts=" + counts + " in " + self.rebinFactor + " channels, starting at energy " + lefteenergy ); */

    } else {
      /* self.focus.style("display", "none"); */
    }


    if (self.dragged) {
      /*We make it here if a data point is dragged (which is not allowed) */

      /*self.dragged.y = self.yScale.invert(Math.max(0, Math.min(self.size.height, p[1]))); */
      self.update(false); /* boolean set to false to indicate no animation needed */
    };
    if (!isNaN(self.downx) && self.xScale.invert(p[0]) > 0) {       /* make sure that xaxisDrag does not go lower than 0 (buggy behavior) */

      /* We make it here when a x-axis label is clicked on, and has been dragged a bit */
      d3.select('body').style("cursor", "ew-resize");
      var rupx = self.xScale.invert(p[0]),
          xaxis1 = self.xScale.domain()[0],
          xaxis2 = self.xScale.domain()[1],
          xextent = xaxis2 - xaxis1;
      if (rupx != 0) {
        var changex, new_domain;
        changex = self.downx / rupx;
        new_domain = [xaxis1, xaxis1 + (xextent * changex)];

        if( self.rawData && self.rawData.spectra && self.rawData.spectra.length && new_domain[1] > self.rawData.spectra[0].x[self.rawData.spectra[0].x.length-1] )
          new_domain[1] = self.rawData.spectra[0].x[self.rawData.spectra[0].x.length-1];

        self.setXAxisRange(new_domain[0], new_domain[1]);
        self.redraw()();
      }

      d3.event.preventDefault();
      d3.event.stopPropagation();
    };

    if (!isNaN(self.downy)) {
      d3.select('body').style("cursor", "ns-resize");
      var rupy = self.yScale.invert(p[1]),
          yaxis1 = self.yScale.domain()[1],
          yaxis2 = self.yScale.domain()[0],
          yextent = yaxis2 - yaxis1;
      if (rupy > 0) {
        var changey, new_domain;
        changey = self.downy / rupy;
        new_domain = [yaxis1 + (yextent * changey), yaxis1];

        self.yScale.domain(new_domain);
        self.redraw()();
      }

      d3.event.preventDefault();
      d3.event.stopPropagation();
    }
  }
}

SpectrumChartD3.prototype.mouseup = function () {
  var self = this;
  return function() {
    document.onselectstart = function() { return true; };
    d3.select('body').style("cursor", "auto");
    d3.select('body').style("cursor", "auto");
    if (!isNaN(self.downx)) {
      self.redraw()();
      self.downx = Math.NaN;
      /*d3.event.preventDefault(); */
      /*d3.event.stopPropagation(); */
    };
    if (!isNaN(self.downy)) {
      self.redraw()();
      self.downy = Math.NaN;
      /*d3.event.preventDefault(); */
      /*d3.event.stopPropagation(); */
    }
    if (self.dragged) {
      self.dragged = null
    }

    self.sliderBoxDown = false;
    self.leftDragRegionDown = false;
    self.rightDragRegionDown = false;
    self.sliderChartMouse = null;
    self.savedSliderMouse = null;
    self.currentlyAdjustingSpectrumScale = null;
  }
}

SpectrumChartD3.prototype.keydown = function () {
  var self = this;
  return function() {

    /*if (!self.selected) return; */

    switch (d3.event.keyCode) {
      case 27: { /*escape */
        self.escapeKeyPressed = true;

        if( self.fittingPeak ) {
          self.handleCancelMousePeakFit();
        }

        self.fittingPeak = false;
        self.handleCancelAllMouseEvents()();
        self.handleCancelAnimationZoom();
      }

      case 8: /* backspace */
      case 46: { /* delete */
        break;
      }
    }
  }
}

SpectrumChartD3.prototype.updateTouchesOnChart = function (touchEvent) {
  var self = this;

  /* Don't do anything if touch event not recognized */
  if (!touchEvent || !touchEvent.type.startsWith("touch"))
    return false;

  /* Create dictionary of touches on the chart */
  if (!self.touchesOnChart)
    self.touchesOnChart = {};

  /* Add each touch start into map of touches on the chart */
  var touch;
  for (i = 0; i < touchEvent.touches.length; i++) {
    /* Get the touch  */
    touch = touchEvent.touches[i];

    /* Here we add a new attribute to each touch: the start coordinates of the touch */
    /*   If the touch already exists in our map, then just update the start coordinates of the new touch */
    touch.startX = self.touchesOnChart[touch.identifier] ? self.touchesOnChart[touch.identifier].startX : touch.pageX;
    touch.startY = self.touchesOnChart[touch.identifier] ? self.touchesOnChart[touch.identifier].startY : touch.pageY;

    /* Add/replace touch into dictionary */
    self.touchesOnChart[touch.identifier] = touch;
  }

  /* Delete any touches that are not on the screen anymore (read from 'touchend' event) */
  if (touchEvent.type === "touchend") {
    for (i = 0; i < touchEvent.changedTouches.length; i++) {
      touch = touchEvent.changedTouches[i];

      if (self.touchesOnChart[touch.identifier])
        delete self.touchesOnChart[touch.identifier];
    }
  }
}

SpectrumChartD3.prototype.handleCancelAllMouseEvents = function() {
  var self = this;

  return function () {

    d3.select(document.body).style("cursor", "default");
    self.downx = Math.NaN;
    self.downy = Math.NaN;

    /* Cancel recalibration */
    self.handleCancelMouseRecalibration();

    /* Cancel deleting peaks */
    self.handleCancelMouseDeletePeak();

    /* Cancel zooming in x-axis */
    self.handleCancelMouseZoomInX();

    /* Cancel zooming in y-axis */
    self.handleCancelMouseZoomInY();

    /* Cancel counting gammas */
    self.handleCancelMouseCountGammas();

    /* Cancel peak fitting */
    self.erasePeakFitReferenceLines();

    /* Canceling out all mouse events for chart */
    self.zooming_plot = false;
    self.dragging_plot = false;
    self.recalibrationStartEnergy = null;

    /* Cancel all kept mouse positions for mouse events */
    self.leftMouseDown = null;
    self.zoominmouse = self.deletePeaksMouse = self.countGammasMouse = self.recalibrationMousePos = null;
    self.rightClickDown = null;

    /* Cancel all legend interactions */
    self.legdown = null;

    /* Cancel scaler interactions */
    self.scalerdown = null;

    /* Cancel all slider drag region interactions */
    self.sliderBoxDown = false;
    self.leftDragRegionDown = false;
    self.rightDragRegionDown = false;

    /* Cancel all scaler widget interactions */
    self.currentlyAdjustingSpectrumScale = null;
  }
}


/**
 * -------------- Reference Gamma Lines Functions --------------
 */
SpectrumChartD3.prototype.drawRefGammaLines = function() {
  /*Drawing of the refrenece lines is super duper un-optimized!!! */
  var self = this;

  if( !self.refLines || !self.refLines.length || !self.refLines[0].lines  || !self.refLines[0].lines.length ) {
    /*console.log( "no reference lines, " + self.refLines.length ); */
    self.vis.selectAll("g.ref").remove();
    return;
  }

  function getLinesInRange(xrange,lines) {
    var bisector = d3.bisector(function(d){return d.e;});
    var lindex = bisector.left( lines, xrange[0] );
    var rindex = bisector.right( lines, xrange[1] );
    return lines.slice(lindex,rindex).filter(function(d){return d.h > 1E-16;});
  }

  var lowerx = this.xScale.domain()[0], upperx = this.xScale.domain()[1];


  var reflines = [];
  self.refLines.forEach( function(input) {
    var lines = getLinesInRange(self.xScale.domain(),input.lines);
    input.maxVisibleAmp = d3.max(lines, function(d){return d.h;});  /*same as lines[0].parent.maxVisibleAmp = ... */
    reflines = reflines.concat( lines );
  });

  reflines.sort( function(l,r){ return ((l.e < r.e) ? -1 : (l.e===r.e ? 0 : 1)); } );

  var tx = function(d) { return "translate(" + self.xScale(d.e) + ",0)"; };
  var gy = self.vis.selectAll("g.ref")
            .data( reflines,function(d){return d.e;} )
            .attr("transform", tx)
            .attr("stroke-width",1);

  var gye = gy.enter().insert("g", "a")
    .attr("class", "ref")
    .attr("transform", tx);

  /*color:'#0000FF',parent:'Ba133',age:'0.00 us',lines:[{e:30.27,h:6.22e-05,pa */
  var stroke = function(d) { return d.parent.color; };

  var dashfunc = function(d){
    var particles = ["gamma", "xray", "beta", "alpha",   "positron", "electronCapture"];
    var dash      = [null,    ("3,3"),("1,1"),("3,2,1"), ("3,1"),    ("6,6") ];
    var index = particles.indexOf(d.particle);
    if( index < 0 ) { console.log( 'Invalid particle: ' + d.particle ); return null; }
    return (index > -1) ? dash[index] : null;
  };

  var h = self.size.height;
  var m = Math.min(h,self.options.refLineTopPad); /*leave 20px margin at top of chart */


  gye.append("line")
    .style("stroke-dasharray", dashfunc )
    .attr("stroke", stroke )
    /* .attr("class", function(d,i){ return "refline " + i;} ) */
    .attr("y1", h )
    .attr("dx", "-0.5" )
    /* .attr("y2", function(d){ console.log("y2="); return h - (h-m)*d.h/maxVisibleAmp; } ) */
    /*.on("mouseover", function(d) { d3.select(this).style("stroke-width", "3");}) */
    /*.on("mouseout",  function(d) { d3.select(this).style("stroke-width", "1");}) */
     ;

  /* EXIT */
  /* Remove old elements as needed. */
  gy.exit().remove();

  /*Now update the height of all the lines.  If we did this in the gye.append("line") */
  /*  line above then the values for existing lines wouldnt be updated (only */
  /*  the new lines would have correct height) */
  gy.select("line").attr("y2", function(d){ return Math.min(h - (h-m)*d.h/d.parent.maxVisibleAmp,h-2) ; } );
}

SpectrumChartD3.prototype.refreshRefGammaLines = function() {
  var self = this;

  // No need to clear, we don't have any data
  if (!self.refLines)
    return;

  // Erase all the reference lines
  self.vis.selectAll("g.ref").remove();

  // Redraw the reference gamma lines
  self.drawRefGammaLines();
}

SpectrumChartD3.prototype.clearReferenceLines = function() {
  var self = this;

  // No need to clear, we don't have any data
  if (!self.refLines)
    return;

  self.refLines = null;
  self.redraw()();
}

SpectrumChartD3.prototype.setReferenceLines = function( data ) {
  var self = this;
  self.vis.selectAll("g.ref").remove();
 
  var default_colors = ["#0000FF","#006600", "#006666", "#0099FF","#9933FF", "#FF66FF", "#CC3333", "#FF6633","#FFFF99", "#CCFFCC", "#0000CC", "#666666", "#003333"];

  if( !data ){
    this.refLines = null;
  } else {
    try {
      if( !Array.isArray(data) )
        throw "Input is not an array of reference lines";

      data.forEach( function(a,i){
         if( !a.color )
           a.color = default_colors[i%default_colors.length];
         if( !a.lines || !Array.isArray(a.lines) )
           throw "Reference lines does not contain an array of lines";
         a.lines.forEach( function(d){
           /*{e:30.27,h:6.22e-05,particle:'xray',decay:'xray',el:'barium'} */
           /*particle in ["gamma", "xray", "beta", "alpha",   "positron", "electronCapture"]; */
           if( (typeof d.e !== "number") || (typeof d.h !== "number") || (typeof d.particle !== "string") )
             throw "Refernce line is invalid (" + JSON.stringify(d) + ")";
         });
       });

    /*this.refLines = JSON.parse(JSON.stringify(data));  /*creates deep copy, but then also have to go through and */
    this.refLines = data;
    this.refLines.forEach( function(a,i){ a.lines.forEach( function(d){ d.parent = a; } ) } );
  }catch(e){
    this.refLines = null;
    console.log( "invalid input to setReferenceLines" );
  }
    this.refLines = data;
  }

  this.redraw()();
}

SpectrumChartD3.prototype.setShowRefLineInfoForMouseOver = function( show ) {
  var self = this;

  self.options.showRefLineInfoForMouseOver = show;
  self.redraw()();
}


/**
 * -------------- Grid Lines Functions --------------
 */
SpectrumChartD3.prototype.setGridX = function( onstate ) {
  if( this.options.gridx == onstate )
    return;

  this.options.gridx = onstate;

  if( onstate ) {
    this.xGrid = d3.svg.axis().scale(this.xScale)
                   .orient("bottom")
                   .innerTickSize(-this.size.height)
                   .outerTickSize(0)
                   .tickFormat( "" )
                   .tickPadding(10)
                   .ticks( 20,"" );

    this.xGridBody = this.vis.insert("g", ".refLineInfo")
        .attr("width", this.size.width )
        .attr("height", this.size.height )
        .attr("class", "xgrid" )
        .attr("transform", "translate(0," + this.size.height + ")")
        .call( this.xGrid );
  } else {
    this.xGridBody.remove();
    this.xGrid = null;
    this.xGridBody = null;
  }

  this.redraw(true)();
}

SpectrumChartD3.prototype.setGridY = function( onstate ) {
  if( this.options.gridy == onstate )
    return;

  this.options.gridy = onstate;

  if( onstate ) {
    this.yGrid = d3.svg.axis().scale(this.yScale)
                   .orient("left")
                   .innerTickSize(-this.size.width)
                   .outerTickSize(0)
                   .tickFormat( "" )
                   .tickPadding(10);

    this.yGridBody = this.vis.insert("g", ".refLineInfo")
        .attr("width", this.size.width )
        .attr("height", this.size.height )
        .attr("class", "ygrid" )
        .attr("transform", "translate(0,0)")
        .call( this.yGrid );
  } else {
    this.yGridBody.remove();
    this.yGrid = null;
    this.yGridBody = null;
  }

  this.redraw()();
}


/**
 * -------------- Mouse Coordinate Info Functions --------------
 */
SpectrumChartD3.prototype.addMouseInfoBox = function(){
  if( this.mouseInfo )
    this.mouseInfo.remove();

  this.mouseInfo = this.vis.append("g")
                     .attr("class", "mouseInfo")
                     .style("display", "none")
                     .attr("transform","translate(" + this.size.width + "," + this.size.height + ")");

  this.mouseInfoBox = this.mouseInfo.append('rect')
               .attr("class", "mouseInfoBox")
               .attr('width', "12em")
               .attr('height', "2.5em")
               .attr('x', "-12.5em")
               .attr('y', "-3.1em");

  this.mouseInfo.append("g").append("text");
}

SpectrumChartD3.prototype.updateMouseCoordText = function() {
  var self = this;

  /*without d3.event */
  if( !d3.event )
    return;
  if ( !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length )
    return;

  var p = d3.mouse(self.vis[0][0]);
  /* console.log("fix mouse text"); */

  if( !p ){
    p = d3.touch(self.vis[0][0]);
    p =  (p && p.length===1) ? p[0] : null;
  }

  if( !p ){
    self.mousedOverRefLine = null;
    self.refLineInfo.style("display", "none");
    self.mouseInfo.style("display", "none");
    return;
  }

  var energy = self.xScale.invert(p[0]);
  var y = self.yScale.invert(p[1]);

  /*Find what channel this energy cooresponds */
  var channel, lowerchanval, counts = null, backgroundSubtractCounts = null;
  var foreground = self.rawData.spectra[0];
  var background = self.getSpectrumByID(foreground.backgroundID);
  var bisector = d3.bisector(function(d){return d.x;});
  channel = (foreground.x && foreground.x.length) ? d3.bisector(function(d){return d;}).right(foreground.x, energy) : -1;
  if( foreground.points && foreground.points.length ){
    lowerchanval = bisector.left(foreground.points,energy,1) - 1;
    counts = foreground.points[lowerchanval].y; 
  }
  if (self.options.backgroundSubtract && counts !== null && background) {
    lowerchanval = bisector.left(background.points,energy,1) - 1;
    backgroundSubtractCounts = Math.max(0, counts - (background.points[lowerchanval] ? background.points[lowerchanval].y : 0));
  }

  /*console.log( "updateMouseCoordText: {" + energy + "," + y + "} and also fix self.refLines[0] usage"); */

  /*Currently two majorish issues with the mouse text */
  /*  1) The counts for the foreground are all that is given. Should give for background/second */
  /*  2) Currently gives a channel (singular), but when there this.rebinFactor!=1, should give range */
  /*Also, formatting could be a bit better */
  /*Also need to make displaying this box an option */
  /*Could also add a blue dot in the data or something, along with lines to the axis, both features should be optional */

  /*Right now if mouse stats arent deesired we are just not showing them, but */
  /*  still updating them... */

  if( self.options.showMouseStats ){
    self.mouseInfo.style("display", null );
    var mousetxt = self.mouseInfo.select("text");
    mousetxt.attr('dy', "-2em");
    mousetxt.selectAll("tspan").remove();

    var xmmsg = ""+(Math.round(10*energy)/10) + " keV";
    if( channel )
      xmmsg += ", chan: " + channel;
    var ymmsg = "";
    if( counts !== null )
      ymmsg += "counts: " + (Math.round(10*counts)/10) + (foreground.rebinFactor === 1 ? "" : ("/" + foreground.rebinFactor));
    ymmsg += (counts!==null?", ":"") + "y: " + (Math.round(10*y)/10);
    var bgsubmsg = "";
    if( backgroundSubtractCounts !== null )
      bgsubmsg += "counts (BG sub): " + (Math.round(10*backgroundSubtractCounts)/10) + (foreground.rebinFactor === 1 ? "" : ("/" + foreground.rebinFactor));

    var bgsubmsglen = 0;
    if (backgroundSubtractCounts !== null)
      bgsubmsglen = mousetxt.append('svg:tspan').attr('x', "-12em").attr('dy', "-1em")
                      .text( bgsubmsg ).node().getComputedTextLength();


    var ymmsglen = mousetxt.append('svg:tspan').attr('x', "-12em").attr('dy', "-1em")
                    .text( ymmsg ).node().getComputedTextLength();
    var xmmsglen = mousetxt.append('svg:tspan').attr('x', "-12em").attr('dy', "-1em")
            .text( xmmsg ).node().getComputedTextLength();

    /*Resize the box to match the text size */
    self.mouseInfoBox.attr('width', Math.max(xmmsglen,ymmsglen,bgsubmsglen) + 9 )
      .attr('height', backgroundSubtractCounts !== null ? '3.1em' : '2.5em')
      .attr('y', backgroundSubtractCounts !== null ? '-3.9em' : '-3.1em');
  } else {
    self.mouseInfo.style("display", "none" );
  }

  var mindist = 9.0e20, nearestpx = 9.0e20;

  var nearestline = null;
  var h = self.size.height;
  var m = Math.min(h,self.options.refLineTopPad);
  var visy = Math.max(h-m,1);

  var reflines = self.vis.selectAll("g.ref");

  reflines[0].forEach( function(d,i){
    var yh = d.childNodes[0].y1.baseVal.value - d.childNodes[0].y2.baseVal.value;
    /*var xpx = d.transform.baseVal[0].matrix.e; */
    var xpx = self.xScale(d.__data__.e);
    var dpx = Math.abs(xpx - p[0]);

    /*In principle, this check (or __data__.mousedover) shouldnt be necassary, */
    /*  but with out it sometimes lines will stay fat that arent supposed to. */
    /* Also, I think setting attr values is expensive, so only doing if necassary. */
    if( d.__data__.mousedover && d !== self.mousedOverRefLine ){
      d3.select(d).attr("stroke-width",1).attr("dx", "-0.5" );
      d.__data__.mousedover = null;
    }

    var dist = dpx + dpx/(yh/visy);
    if( dist < mindist ) {
      mindist = dist;
      nearestline = d;
      nearestpx = dpx;
    }
  } );

  if( nearestpx > 10 ) {
    if( self.mousedOverRefLine ){
      d3.select(self.mousedOverRefLine).attr("stroke-width",1).attr("dx", "-0.5" );
      self.mousedOverRefLine.__data__.mousedover = null;
    }
    self.mousedOverRefLine = null;
    self.refLineInfo.style("display", "none");
    return;
  }

  if( self.mousedOverRefLine===nearestline )
    return;

  if( self.mousedOverRefLine ){
    d3.select(self.mousedOverRefLine).attr("stroke-width",1).attr("dx", "-0.5" );
    self.mousedOverRefLine.__data__.mousedover = null;
  }

  self.mousedOverRefLine = nearestline;

  var linedata = nearestline.__data__;
  linedata.mousedover = true;
  var e = linedata.e;
  var sf = linedata.h;
  var linepx = self.xScale(e);

  var txt, textdescrip, attTxt;
  var detector = linedata.parent.detector
  var shielding = linedata.parent.shielding;
  var shieldingThickness = linedata.parent.shieldingThickness;
  var nearestLineParent = linedata.parent.parent;


  /*20160308: self.refLines[0] should now contain member variable particleSf */
  /*  that gives a map from the particle name to the scale factor applied to */
  /*  get sf. ex: var abs_br = self.refLines[0].particleSf[linedata.particle] * sf. */

  textdescrip = (nearestLineParent ? (nearestLineParent + ', ') : "") +  e + ' keV, rel. amp. ' + sf;

  if( linedata.decay ) {
    if( linedata.particle === 'gamma' ) {
      txt = linedata.decay;
      if( linedata.decay.indexOf('Capture') < 0 )
        txt += ' decay';
    }else if( linedata.particle === 'xray' ) {
      textdescrip = linedata.el + ' x-ray, ' +  e + ' keV, I=' + sf;
    }else if( (typeof linedata.particle === 'string') && linedata.particle.length ){
      textdescrip = linedata.particle + ' from ' + nearestLineParent + ", " +  e + ' keV, I=' + sf;
    }
  }

  if( linedata.particle === 'gamma' || linedata.particle === 'xray' ) {
    if( shielding && shieldingThickness )
      attTxt = shieldingThickness + ' of ' + shielding;
    if( detector )
      attTxt = (attTxt ? (attTxt + ' with a ' + detector) : 'Assuming a ' + detector);
  }

  self.refLineInfo.style("display", null).attr("transform", "translate("+linepx+",0)" );
  var svgtxt = self.refLineInfoTxt.select("text")
                   .attr("dy", "1em")
                   .attr("fill", linedata.parent.color);
  svgtxt.selectAll("tspan").remove();
  if ( self.options.showRefLineInfoForMouseOver ) {
    svgtxt.append('svg:tspan').attr('x', 0).attr('dy', "1em").text( textdescrip );
    if( txt )
      svgtxt.append('svg:tspan').attr('x', 0).attr('dy', "1em").text( txt );
    if( attTxt )
      svgtxt.append('svg:tspan').attr('x', 0).attr('dy', "1em").text( attTxt );

    /*Now detect if svgtxt is running off the right side of the chart, and if so */
    /*  put to the left of the line */
    var tx = function(d) {
      var w = this.getBBox().width;
      return ((linepx+5+w)>self.size.width) ? ("translate("+(-5-w)+",0)") : "translate(5,0)";
    };
    self.refLineInfoTxt.attr("transform", tx );
  }


  d3.select(nearestline).attr("stroke-width",2).select("line").attr("dx", "-1" );
}

SpectrumChartD3.prototype.setShowMouseStats = function(d) {
  this.options.showMouseStats = d;
  this.mouseInfo.style("display", d ? null : "none");
  if( d )
    this.updateMouseCoordText();
}


/**
 * -------------- Legend Functions --------------
 */
SpectrumChartD3.prototype.updateLegend = function() {
  var self = this;
  
  if( !this.options.showLegend || !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length ) {
    if( this.legend ) {
      this.legend.remove();
      this.legend = null;
      this.legendBox = null;
      this.legBody = null;
      this.legendHeaderClose = null;
      var legendoption = document.getElementById("legendoption");
      if (legendoption && self.rawData && self.rawData.spectra && self.rawData.spectra.length) {
        legendoption.checked = false;
      }
      console.log( 'Should emit legend closed' );
    }
    return;
  }
  
  if( !this.legend ) {

    function moveleg(){                 /* move legend  */
      if( self.legdown ) {
        /* console.log(d3.event); */
        d3.event.preventDefault();
        d3.event.stopPropagation();

        var x = d3.event.x ? d3.event.x : d3.event.touches ?  d3.event.touches[0].clientX : d3.event.clientX;
        var y = d3.event.y ? d3.event.y : d3.event.touches ?  d3.event.touches[0].clientY : d3.event.clientY;

        var calculated_x = d3.mouse(self.vis[0][0])[0];

        if ( calculated_x >= -self.padding.leftComputed && y >= 0 && 
             calculated_x <= self.cx && y <= self.cy ) {
          console.log("change pos");
          var tx = (x - self.legdown.x) + self.legdown.x0;
          var ty = (y - self.legdown.y) + self.legdown.y0; 
          self.legend.attr("transform", "translate(" + tx + "," + ty + ")");
        }
      }
    }


    this.legend = d3.select(this.chart).select("svg").append("g")
                      .attr("class", "legend")
                      .attr("transform","translate(" + (this.cx - 120 - this.padding.right) + ","+ (this.padding.topComputed + 10) + ")");
    this.legendBox = this.legend.append('rect')
               .attr("class", "legendBack")
               .attr('width', "100")
               .attr('height', "1em")
               .attr( "rx", "5px")
               .attr( "ry", "5px");
    this.legBody = this.legend.append("g")
                       .attr("transform","translate(8,17)");
                       
    this.legendHeader = this.legend.append("g"); 
    this.legendHeader
               .style("display", "none")
               .append('rect')
               .attr("class", "legendHeader")
               .attr('width', "100px")
               .attr('height', "1.5em")
               .attr( "rx", "5px")
               .attr( "ry", "5px")
               .style("cursor", "pointer");
    
    /*Add a close button to get rid of the legend */
    this.legendHeaderClose = this.legendHeader.append('g').attr("transform","translate(4,4)");
    this.legendHeaderClose.append("rect")
            .attr("class", "d3closebut")
            .attr('height', "12")
            .attr('width', "12");
    this.legendHeaderClose.append("path")
        .attr("style", "stroke: white; stroke-width: 1.5px;" )
        .attr("d", "M 2,2 L 10,10 M 10,2 L 2,10");
    this.legendHeaderClose.on("click", function(){ self.options.showLegend = false; self.updateLegend(); } )
                          .on("touchend", function(){ self.options.showLegend = false; self.updateLegend(); } );   
               
    /*this.legendHeader.append("text") */
    /*      .text("Legend") */
    /*      .attr("x", 62.5) */
    /*      .attr("y", "1.1em") */
    /*      .style("text-anchor","middle") */
    /*      .style("cursor", "pointer"); */
    
    this.legend.on("mouseover", function(d){if( !self.dragging_plot && !self.zooming_plot ) self.legendHeader.style("display", null);} )
      .on("mouseout", function(d){self.legendHeader.style("display", "none");} )
      .on("mousemove", moveleg)
      .on("touchmove", moveleg)
      .on("wheel", function(d){d3.event.preventDefault(); d3.event.stopPropagation();} );
    
    function mousedownleg(){
      console.log("mouse down on legend");
      if (d3.event.defaultPrevented) return;
      if( self.dragging_plot || self.zooming_plot ) return;
      d3.event.preventDefault();
      d3.event.stopPropagation();
      var trans = d3.transform(self.legend.attr("transform")).translate;

      var x = d3.event.x ? d3.event.x : d3.event.touches ?  d3.event.touches[0].clientX : d3.event.clientX;
      var y = d3.event.y ? d3.event.y : d3.event.touches ?  d3.event.touches[0].clientY : d3.event.clientY;
      self.legdown = {x: x, y: y, x0: trans[0], y0: trans[1]};
    };
    
    this.legendHeader.on("mouseover", function(d) { if( !self.dragging_plot && !self.zooming_plot ) self.legend.attr("class", "legend activeLegend");} )
      .on("touchstart", function(d) { if( !self.dragging_plot && !self.zooming_plot ) self.legend.attr("class", "legend activeLegend"); } )
      .on("mouseout",  function(d) { if (self.legend) self.legend.attr("class", "legend"); } )
      .on("touchend",  function(d) { if (self.legend) self.legend.attr("class", "legend"); } )
      .on("mousedown.drag",  mousedownleg )
      .on("touchstart.drag",  mousedownleg )
      .on("touchend.drag", function() {self.legdown = null;})
      .on("mouseup.drag", function(){self.legdown = null;} )
      .on("mousemove.drag", moveleg)
      .on("mouseout.drag", moveleg);

    this.legend.on("touchstart", function(d) { if( !self.dragging_plot && !self.zooming_plot ) self.legendHeader.style("display", null); } )
      .on("touchstart.drag", mousedownleg)
      .on("touchend.drag",  function() 
      {
      if (!self.legend || !self.legendHeader) {
        self.legdown = null;
        return;
      }

      self.legend.attr("class", "legend"); 
      window.setTimeout(function() { self.legendHeader.style("display", "none"); }, 1500) 
      self.legdown = null; 
      });
  }
  
  var origtrans = d3.transform(this.legend.attr("transform")).translate;
  var bb = this.legend.node().getBBox();
  var fromRight = this.cx - origtrans[0] - this.legendBox.attr('width');
  
  this.legBody.selectAll("g").remove();

  var ypos = 0;
  if (this.rawData && this.rawData.spectra) {
    this.rawData.spectra.forEach( function(spectrum,i){
      if( !spectrum || !spectrum.y.length )
        return;
      
      var sf = spectrum.yScaleFactor;
      var title = spectrum.title;
      var lt = spectrum.liveTime;
      var rt = spectrum.realTime;
      var neut = spectrum.neutrons;
      title = title ? title : ("Spectrum " + (i+1));
      var nsum = spectrum.dataSum;
      title += " (" + nsum.toFixed(nsum > 1000 ? 0 : 1) + " counts)"; 
    
      var thisentry = self.legBody.append("g")
        .attr("transform","translate(0," + ypos + ")");
      
      thisentry.append("path")
        .attr("id", "spectrum-legend-line-" + i)  // reference for when updating color
        .attr("class", "line" )
        .attr("stroke", spectrum.lineColor ? spectrum.lineColor : "black")
        .attr("d", "M0,-5 L12,-5");
      var thistxt = thisentry.append("text")
        .attr("class", "legentry")
        .attr( "x", 15 )
        .text(title);
      if( typeof lt === "number" )
        thistxt.append('svg:tspan').attr('x', "20").attr('y', thisentry.node().getBBox().height)
                      .text( "Live Time " + lt.toPrecision(4) );
      if( typeof rt === "number" )
        thistxt.append('svg:tspan').attr('x', "20").attr('y', thisentry.node().getBBox().height)
                      .text( "Real Time " + rt.toPrecision(4) );
      if( typeof neut === "number" )
        thistxt.append('svg:tspan').attr('x', "20").attr('y', thisentry.node().getBBox().height)
                      .text( "Neutron Count " + neut );
      if( typeof sf === "number" && sf != 1 )
        thistxt.append('svg:tspan').attr('x', "20").attr('y', thisentry.node().getBBox().height)
                      .text( "Scaled by " + sf.toPrecision(4) );
                      
      ypos += thisentry.node().getBBox().height + 5;
    });
  }
                    
  /*Resize the box to match the text size */
  var w = this.legBody.node().getBBox().width + 15; 
  this.legendBox.attr('width', w );
  this.legendBox.attr('height', this.legBody.node().getBBox().height + 10 );
  this.legendHeaderClose.attr("transform","translate(" + (w-16) + ",4)");
  
  this.legendHeader.select('rect').attr('width', w );
  this.legendHeader.select('text').attr("x", w/2);
  
  /*this.legendBox.attr('height', legtxt.node().getBBox().height + hh + 8 ); */

  /*Set the transform so the space on the right of the legend stays the same */
  this.legend.attr("transform", "translate(" + (this.cx - fromRight - w) + "," + origtrans[1] + ")" );
}

SpectrumChartD3.prototype.setShowLegend = function( show ) {
  this.options.showLegend = Boolean(show);
  this.updateLegend();
}


/**
 * -------------- Y-axis Functions --------------
 */
SpectrumChartD3.prototype.yticks = function() {
  var ticks = [];
  var EPSILON = 1.0E-3;

  // Added check for raw data to not render ticks when no data is present
  if (!this.rawData || !this.rawData.spectra) return [];

  var formatYNumber = function(v) {
    /*poorly simulating "%.3g" in snprintf */
    /*SHould get rid of so many regexs, and shorten code (shouldnt there be a builtin function to print to "%.3"?) */
    var t;
    if( v >= 1000 || v < 0.1 )
    {
      t = v.toPrecision(3);
      t = t.replace(/\.0+e/g, "e").replace(/\.0+$/g, "");
      if( t.indexOf('.') > 0 )
        t = t.replace(/0+e/g, "e");
    } else {
      t = v.toFixed( Math.max(0,2-Math.floor(Math.log10(v))) );
      if( t.indexOf('.') > 0 )
        t = t.replace(/0+$/g, "");
      t = t.replace(/\.$/g, "");
    }

    return t;
  }

  var renderymin = this.yScale.domain()[1],
      renderymax = this.yScale.domain()[0],
      heightpx = this.size.height;
  var range = renderymax - renderymin;

  if( this.options.yscale === "lin" )
  {
    /*px_per_div: pixels between major and/or minor labels. */
    var px_per_div = 50;

    /*nlabel: approx number of major + minor labels we would like to have. */
    var nlabel = heightpx / px_per_div;

    /*renderInterval: Inverse of how many large labels to place between powers */
    /*  of 10 (1 is none, 0.5 is is one). */
    var renderInterval;

    /*n: approx how many labels will be used */
    var n = Math.pow(10, Math.floor(Math.log10(range/nlabel)));

    /*msd: approx how many sub dashes we would expect there to have to be */
    /*     to satisfy the spacing of labels we want with the given range. */
    var msd = range / nlabel / n;

    if( isNaN(n) || !isFinite(n) || nlabel<=0 || n<=0.0 ) { /*JIC */
      console.log( "n=" + n + ", nlabel=" + nlabel + ", range=" + range );
      return ticks;
    }
      var subdashes = 0;

      if( msd < 1.5 )
      {
        subdashes = 2;
        renderInterval = 0.5*n;
      }else if (msd < 3.3)
      {
        subdashes = 5;
        renderInterval = 0.5*n;
      }else if (msd < 7)
      {
        subdashes = 5;
        renderInterval = n;
      }else
      {
        subdashes = 10;
        renderInterval = n;
      }

      var biginterval = subdashes * renderInterval;
      var starty = biginterval * Math.floor((renderymin + 1.0E-15) / biginterval);

      if( starty < (renderymin-EPSILON*renderInterval) )
        starty += biginterval;

      for( var i = -Math.floor(Math.floor(starty-renderymin)/renderInterval); ; ++i)
      {
        if( i > 500 )  /*JIC */
          break;

        var v = starty + renderInterval * i;

        if( (v - renderymax) > EPSILON * renderInterval )
          break;

        var t = "";
        if( i>=0 && ((i % subdashes) == 0) )
          t += formatYNumber(v);

        var len = ((i % subdashes) == 0) ? true : false;

        ticks.push( {value: v, major: len, text: t } );
      }/*for( intervals to draw ticks for ) */
    }/*case Chart::LinearScale: */

    if( this.options.yscale === "log" )
    {
      /*Get the power of 10 just bellow or equal to rendermin. */
      var minpower = (renderymin > 0.0) ? Math.floor( Math.log10(renderymin) ) : -1;

      /*Get the power of 10 just above or equal to renderymax.  If renderymax */
      /*  is less than or equal to 0, set power to be 0. */
      var maxpower = (renderymax > 0.0) ? Math.ceil( Math.log10(renderymax) ): 0;

      /*Adjust minpower and maxpower */
      if( maxpower == minpower )
      {
        /*Happens when renderymin==renderymax which is a power of 10 */
        ++maxpower;
        --minpower;
      }else if( maxpower > 2 && minpower < -1)
      {
        /*We had a tiny value (possibly a fraction of a count), as well as a */
        /*  large value (>1000). */
        minpower = -1;
      }else if( maxpower >= 0 && minpower < -1 && (maxpower-minpower) > 6 )
      {
        /*we had a tiny power (1.0E-5), as well as one between 1 and 999, */
        /*  so we will only show the most significant decades */
        minpower = maxpower - 5;
      }/*if( minpower == maxpower ) / else / else */


      /*numdecades: number of decades the data covers, including the decade */
      /*  above and bellow the data. */
      var numdecades = maxpower - minpower + 1;

      /*minpxdecade: minimum number of pixels we need per decade. */
      var minpxdecade = 25;

      /*labeldelta: the number of decades between successive labeled large ticks */
      /*  each decade will have a large tick regardless */
      var labeldelta = 1;

      /*nticksperdecade: number of small+large ticks per decade */
      var nticksperdecade = 10;


      if( Math.floor(heightpx / minpxdecade) < numdecades )
      {
        labeldelta = numdecades / (heightpx / minpxdecade);
        nticksperdecade = 1;
      }/*if( (heightpx / minpxdecade) < numdecades ) */

      var t = null;
      var nticks = 0;
      var nmajorticks = 0;

      for( var decade = minpower; decade <= maxpower; ++decade )
      {
        var startcounts = Math.pow( 10.0, decade );
        var deltacounts = 10.0 * startcounts / nticksperdecade;
        var eps = deltacounts * EPSILON;

        if( (startcounts - renderymin) > -eps && (startcounts - renderymax) < eps )
        {
          t = ((decade%labeldelta)==0) ? formatYNumber(startcounts) : "";
          ++nticks;
          ++nmajorticks;
          ticks.push( {value: startcounts, major: true, text: t } );
        }/*if( startcounts >= renderymin && startcounts <= renderymax ) */


        for( var i = 1; i < (nticksperdecade-1); ++i )
        {
          var y = startcounts + i*deltacounts;
          if( (y - renderymin) > -eps && (y - renderymax) < eps )
          {
            ++nticks;  
            ticks.push( {value: y, major: false, text: null } );
          }
        }/*for( int i = 1; i < nticksperdecade; ++i ) */
      }/*for( int decade = minpower; decade <= maxpower; ++decade ) */

      /*If we have a decent number of (sub) labels, the user can orient */
      /*  themselves okay, so well get rid of the minor labels. */
      if( (nticks > 8 || (heightpx/nticks) < 25 || nmajorticks > 1) && nmajorticks > 0 ) {
        for( var i = 0; i < ticks.length; ++i )
          if( !ticks[i].major )
            ticks[i].label = "";
      }
      
      if( nmajorticks < 1 && ticks.length ) {
        ticks[0].text = formatYNumber(ticks[0].value);
        ticks[ticks.length-1].text = formatYNumber(ticks[ticks.length-1].value);
      }
      
      if( ticks.length === 0 )
      {
        /*cerr << "Forcing a single axis point in" << endl; */
        var y = 0.5*(renderymin+renderymax);
        var t = formatYNumber(y);
        ticks.push( {value: y, major: true, text: t } );
      }
    }/*case Chart::LogScale: */

  /*TODO: should to properly implement sqrt */
  if( this.options.yscale === "sqrt" ){
    /*Take the easy way out for now until I can get around to customizing */
    this.yScale.copy().ticks(10)
        .forEach(function(e){ticks.push({value:e,major:true,text:formatYNumber(e)});});
  }


  return ticks;
}

/* Sets y-axis drag for the chart. These are actions done by clicking and dragging one of the labels of the y-axis. */
SpectrumChartD3.prototype.yaxisDrag = function(d) {
  var self = this;
  return function(d) {
    console.log('yaxisDrag work');
    document.onselectstart = function() { return false; };
    var p = d3.mouse(self.vis[0][0]);
    self.downy = self.yScale.invert(p[1]);
  }
}

SpectrumChartD3.prototype.drawYTicks = function() {
  var self = this;
  var stroke = function(d) { return d ? "#ccc" : "#666"; };
  
  /* Regenerate y-ticks… */
    var ytick = self.yticks();
    var ytickvalues = ytick.map(function(d){return d.value;} );
    self.yScale.ticks(ytickvalues);

    self.yAxisBody.selectAll('text').remove();

    if( self.yGridBody ) {
      self.yGrid.tickValues( ytickvalues );

      /*Since the number of grid lines might change (but call(self.yGrid) expects the same number) */
      /*  we will remove, and re-add back in the grid... kinda a hack. */
      /*  Could probably go back to manually drawing the grid lined and get rid */
      /*  of yGrid and yGridBody... */
      self.yGridBody.remove();
      self.yGridBody = self.vis.insert("g", ".refLineInfo")
        .attr("width", self.size.width )
        .attr("height", self.size.height )
        .attr("class", "ygrid" )
        .attr("transform", "translate(0,0)")
        .call( self.yGrid );
      self.yGridBody.selectAll('g.tick')
        .filter(function(d,i){return !ytick[i].major;} )
        .attr("class","minorgrid");
    }

    var ty = function(d) { return "translate(0," + self.yScale(d) + ")"; };
    var gy;

    gy = self.vis.selectAll("g.y")
      .data(ytickvalues, String)
      .attr("transform", ty);


    var fy = function(d,i){ return ytick[i].text; }; /*self.yScale.tickFormat(10); */
    gy.select("text").text( fy );

    var gye = gy.enter().insert("g", "a")
        .attr("class", "y")
        .attr("transform", ty)
        .attr("background-fill", "#FFEEB6");

    gye.append("line")
       .attr("stroke", stroke)
       .attr("class", "yaxistick")
       .attr("x1", function(d,i){ return ytick[i].major ? -7 : -4; } )
       .attr("x2", 0 );

    gye.append("text")
        .attr("class", "yaxislabel")
        .attr("x", -8.5)
        .attr("dy", ".35em")
        .attr("text-anchor", "end")
        .text(fy);
        /* .style("cursor", "ns-resize") */
        /* .on("mouseover", function(d) { d3.select(this).style("font-weight", "bold");}) */
        /* .on("mouseout",  function(d) { d3.select(this).style("font-weight", "normal");}); */
        /* .on("mousedown.drag",  self.yaxisDrag()) */
        /* .on("touchstart.drag", self.yaxisDrag()); */

    gy.exit().remove();
}

SpectrumChartD3.prototype.setAdjustYAxisPadding = function( adjust, pad ) {
  this.options.adjustYAxisPadding = Boolean(adjust);
  
  if( typeof pad === "number" )
    this.padding.left = pad;
    
  this.handleResize( false );
}

SpectrumChartD3.prototype.setWheelScrollYAxis = function(d) {
  this.options.wheelScrollYAxis = d;
}


/**
 * -------------- Y-axis Scale Functions --------------
 */
SpectrumChartD3.prototype.setLogY = function(){
  /*To make the transition animated, see: http:/*bl.ocks.org/benjchristensen/2657838 */

  if( this.options.yscale === "log" )
    return;

  this.options.yscale = "log";

  this.yScale = d3.scale.log()
      .clamp(true)
      .domain([0, 100])
      .nice()
      .range([1, this.size.height])
      .nice();

  if( this.yGrid )
    this.yGrid.scale( this.yScale );

  this.redraw(this.options.showAnimation)();
}

SpectrumChartD3.prototype.setLinearY = function(){
  if( this.options.yscale === "lin" )
    return;

  this.options.yscale = "lin";
  this.yScale = d3.scale.linear()
      .domain([0, 100])
      .nice()
      .range([0, this.size.height])
      .nice();

  if( this.yGrid )
    this.yGrid.scale( this.yScale );

  this.redraw(this.options.showAnimation)();
}

SpectrumChartD3.prototype.setSqrtY = function(){
  if( this.options.yscale === "sqrt" )
    return;

  this.options.yscale = "sqrt";
  this.yScale = d3.scale.pow().exponent(0.5)
      .domain([0, 100])
      .range([0, this.size.height]);

  if( this.yGrid )
    this.yGrid.scale( this.yScale );

  this.redraw(this.options.showAnimation)();
}

SpectrumChartD3.prototype.handleYAxisWheel = function() {
  /*This function doesnt have the best behaviour in the world, but its a start */
  var self = this;
  /* console.log("handleYAxisWheel"); */
  
  if( !d3.event )
    return;
    
  var m = d3.mouse(this.vis[0][0]);
  var t = d3.touches(this.vis[0][0]);

  if( m[0] > 0 && !t )
    return false;
  
  var wdelta;
  /* wdelta = d3.event.wheelDelta == null ? d3.event.sourceEvent.wheelDelta : d3.event.wheelDelta;  /* old way using source events */
  wdelta = d3.event.deltaY ? d3.event.deltaY : d3.event.sourceEvent ? d3.event.sourceEvent.wheelDelta : 0;

  /* Implementation for touch interface */
  /* if (!wdelta && wdelta !== 0) { */
  /*   var t1,t2,dx,dy; */

  /*   t1 = t[0]; */
  /*   t2 = t[1]; */

  /*   dy = Math.abs(t1[1] - t2[1]); */

  /*   wdelta = self.previous_dy - dy; */
  /* } */

  
  var mult = 0;
  if( wdelta > 0 ){
    /*zoom out */
    mult = 0.02;
  } else if( wdelta != 0 ) {
    /*zoom in */
    mult = -0.02;
  }

  if( self.options.yscale == "log" ) {
    
    if( mult > 0 && self.options.logYFracBottom > 0.025 ){
      self.options.logYFracBottom -= mult;
    } else {
      self.options.logYFracTop += mult;
      self.options.logYFracTop = Math.min( self.options.logYFracTop, 10 );  
    }
    
    if( self.options.logYFracTop < 0 ){
      self.options.logYFracBottom += -self.options.logYFracTop;
      self.options.logYFracBottom = Math.min( self.options.logYFracBottom, 2.505 );
      console.log( 'self.options.logYFracBottom=' +  self.options.logYFracBottom );
      self.options.logYFracTop = 0;
    }
    
    
    self.options.logYFracTop = Math.max( self.options.logYFracTop, -0.95 );
    console.log( 'self.options.logYFracTop=' + self.options.logYFracTop );
    /* */
  } else if( self.options.yscale == "lin" ) {
    self.options.linYFracTop += mult;
    self.options.linYFracTop = Math.min( self.options.linYFracTop, 0.85 );
    self.options.linYFracTop = Math.max( self.options.linYFracTop, -0.95 );
    /*self.options.linYFracBottom = 0.1; */
  } else if( self.options.yscale == "sqrt" ) {
    self.options.sqrtYFracTop += mult;
    self.options.sqrtYFracTop = Math.min( self.options.sqrtYFracTop, 0.85 );
    self.options.sqrtYFracTop = Math.max( self.options.sqrtYFracTop, -0.95 );
    /*self.options.sqrtYFracBottom = 0.1;   */
  }            
            
  self.redraw()();
  
  if( d3.event.sourceEvent ){       
   d3.event.sourceEvent.preventDefault();
   d3.event.sourceEvent.stopPropagation();
  } else {
    d3.event.preventDefault();
    d3.event.stopPropagation();
  }
  return false;
}


/**
 * -------------- X-axis Functions --------------
 */
SpectrumChartD3.prototype.xticks = function() {

  var ticks = [];

  /*it so */
  /*  the x axis labels (hopefully) always line up nicely where we want them */
  /*  e.g. kinda like multiple of 5, 10, 25, 50, 100, etc. */
  var EPSILON = 1E-3;

  var rendermin = this.xScale.domain()[0];
  var rendermax = this.xScale.domain()[1];
  var range = rendermax - rendermin;
  
  /*ndigstart makes up for larger numbers taking more pixels to render, so */
  /* it keeps numbers from overlapping.  Bellow uses 15 to kinda rpresent the */
  /*  width of numbers in pixels. */
  var ndigstart = rendermin > 0 ? Math.floor(Math.log10(rendermin)) : 1;
  ndigstart = Math.max(1,Math.min(ndigstart,5));
  
  var nlabel = Math.floor( this.size.width / (50 + 15*(ndigstart-1)) );

  
  var renderInterval;/* = range / 10.0; */
  var n = Math.pow(10, Math.floor(Math.log10(range/nlabel)));
  var msd = range / (n * nlabel);


  if( isNaN(n) || !isFinite(n) || nlabel<=0 || n<=0.0 ) { /*JIC */
    console.log( "n=" + n + ", nlabel=" + nlabel + ", range=" + range );
    return ticks;
  }

  var subdashes = 0;

  /*console.log( "msd=" + msd + ", nlabel=" + nlabel + ", ndigstart=" + ndigstart ); */

  if (msd < 1.5)
  {
    subdashes = 2;
    renderInterval = 0.5*n;
  }else if (msd < 3.3)
  {
    subdashes = 5;
    renderInterval = 0.5*n;
  }else if (msd < 7)
  {
    subdashes = 5;
    renderInterval = n;
  }else
  {
    subdashes = 10;
    renderInterval = n;
  }

  var biginterval = subdashes * renderInterval;
  var startEnergy = biginterval * Math.floor((rendermin + 1.0E-15) / biginterval);

  if( startEnergy < (rendermin-EPSILON*renderInterval) )
    startEnergy += biginterval;

  for( var i = -Math.floor(Math.floor(startEnergy-rendermin)/renderInterval); ; ++i)
  {
    if( i > 5000 )  /*JIC */
      break;

    var v = startEnergy + renderInterval * i;

    if( (v - rendermax) > EPSILON * renderInterval )
      break;

    var t = "";
    if( i>=0 && (i % subdashes == 0) )
      t += v;

    ticks.push( {value: v, major: (i % subdashes == 0), text: t } );
  }/*for( intervals to draw ticks for ) */

  return ticks;
}

/* Sets x-axis drag for the chart. These are actions done by clicking and dragging one of the labels of the x-axis. */
SpectrumChartD3.prototype.xaxisDrag = function() {
  var self = this;
  return function(d) {
    /*This function is called once when you click on an x-axis label (which you can then start dragging it) */
    /*  And NOT when you click on the chart and drag it to pan */
    console.log( 'xaxisDrag work' );
    document.onselectstart = function() { return false; };
    var p = d3.mouse(self.vis[0][0]);

    if (self.xScale.invert(p[0]) > 0)           /* set self.downx equal to value of your mouse pos */
      self.downx = self.xScale.invert(p[0]);

    // Christian [05122018]: Commented out to prevent buggy drawing of chart when dragging ticks <= 0
    /*
    else                                        // if mouse pos < 0, use 0.1 as the value (value of 0 is buggy)
      self.downx = 0.1;
    */
   
    /*console.log("p=" + p ); */
    /*console.log("self.downx=" + self.downx); */
    /*console.log("self.vis[0][0]=" + self.vis[0][0]); */
  }
}

SpectrumChartD3.prototype.drawXAxisArrows = function(show_arrow) {
  var self = this;

  if (self.options.showXRangeArrows) {
    var max_x;

    if (!self.xaxis_arrow) {
      self.xaxis_arrow = self.svg.select('.xaxis').append('svg:defs')
        .attr("id", "xaxisarrowdef")
        .append("svg:marker")
        .attr("id", "arrowhead")
        .attr('class', 'xaxisarrow')
        .attr("refX", 0)
        .attr("refY", 6)
        .attr("markerWidth", 9)
        .attr("markerHeight", 14)
        .attr("orient", 0)
        .append("path")
          .attr("d", "M2,2 L2,13 L8,7 L2,2")
          .style("stroke", "black");
    }

    max_x = self.min_max_x_values()[1];

    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length || self.xScale.domain()[1] === max_x || (typeof show_arrow == 'boolean' && !show_arrow))            /* should be a better way to determine if can still pan */
      self.xAxisBody.select("path").attr("marker-end", null);
    else
      self.xAxisBody.select("path").attr("marker-end", "url(#arrowhead)");

  } else {
    if (self.xaxis_arrow) {
      self.xaxis_arrow.remove();
      self.xaxis_arrow = null;
    }

    self.svg.select("#xaxisarrowdef").remove();
  }
}

SpectrumChartD3.prototype.drawXTicks = function() {
  var self = this;
  var stroke = function(d) { return d ? "#ccc" : "#666"; };
  
  var xticks = self.xticks();
  var xtickvalues = xticks.map(function(d){return d.value;} );
  self.xAxis.tickValues( xtickvalues );
     
  /**
   * Regenerate x-ticks…
   * Christian [032818]: Commented out for performance improvement, D3 will reuse current tick nodes when
   *  using new axis tick values, so we don't need to remove the current ones
   */
  // self.xAxisBody.selectAll("g.tick").remove();

  self.xAxisBody.call(self.xAxis);

  /*Check that the last tick doesnt go off the chart area. */
  /*  This could probably be accomplished MUCH more efficiently */
  var xgticks = self.xAxisBody.selectAll('g.tick');
  var majorticks = xgticks.filter(function(d,i){ return xticks[i] && xticks[i].major; } );
  var minorticks = xgticks.filter(function(d,i){ return xticks[i] && !xticks[i].major; } );

  minorticks.select('line').attr('y2', '4');
  minorticks.select('text').text("");

  /**
   * Christian [032818]: Made a slight performance optimization by moving the D3 select assignment code
   * for styles and event listeners to major ticks. This still achieves the same result, but prevents wasted operations
   * by assigning the styles and event listeners to ticks that are actually displayed. Noticable improvements seen
   * when using w/InterSpec.
   */
  const majorticksText = majorticks.selectAll('text')
    .style("cursor", "ew-resize")
    .on("mouseover", function(d, i) { d3.select(this).style("font-weight", "bold");})
    .on("mouseout",  function(d) { d3.select(this).style("font-weight", "normal");})
    .on("mousedown.drag",  self.xaxisDrag());

  // Add touch event listeners for touch devices
  if (self.isTouchDevice()) {
    majorticksText.on("touchstart.drag", self.xaxisDrag());
  }

  if( this.options.compactXAxis ){
    /*We have to check every tick to see if it overlaps with the title */
    var xtitlex = this.xaxistitle.attr("x" );
    majorticks[0].forEach( function(tick){
      var txt = d3.select(tick).select('text')[0][0]; 
      if( (txt.getCTM().e + txt.getBBox().width) + 30 > xtitlex )  /*Not sure why we need this 30, but its in positioning of the x-axis title too */
        d3.select(txt)
        .text("");
    });
  } else {
    /*We only need to check the last tick to see if it goes off the chart */
    var lastmajor = majorticks[0].length ? majorticks[0][majorticks[0].length-1] : null; 
    if( lastmajor ) {
      lastmajor = d3.select(lastmajor).select('text')[0][0];
      if( (lastmajor.getCTM().e + lastmajor.getBBox().width) > this.cx )
        d3.select(lastmajor).text("");  
    }
  }
  /*this.options.compactXAxis */
  
  /*Can calculate the width needed for the y-axis, and could adjust the plot area.. */
  /*console.log( self.yAxisBody.node().getBBox().width ); */

  if( self.xGridBody ) {
    self.xGrid.tickValues( xtickvalues );
    self.xGridBody.remove();
    self.xGridBody = self.vis.insert("g", ".refLineInfo")
          .attr("width", self.size.width )
          .attr("height", self.size.height )
          .attr("class", "xgrid" )
          .attr("transform", "translate(0," + self.size.height + ")")
          .call( self.xGrid );
    self.xGridBody.selectAll('g.tick')
      .filter(function(d,i){ return !xticks[i].major; } )
      .attr("class","minorgrid");
  }
}

SpectrumChartD3.prototype.setXAxisRange = function( minimum, maximum ) {
  var self = this;

  self.xScale.domain([minimum, maximum]);
  self.WtEmit(self.chart.id, {name: 'xrangechanged'}, minimum, maximum);
}

SpectrumChartD3.prototype.setXAxisMinimum = function( minimum ) {
  var self = this;

  const maximum = self.xScale.domain()[1];

  self.xScale.domain([minimum, maximum]);
  self.redraw()();
}

SpectrumChartD3.prototype.setXAxisMaximum = function( maximum ) {
  var self = this;

  const minimum = self.xScale.domain()[0];

  self.xScale.domain([minimum, maximum]);
  self.redraw()();
}

SpectrumChartD3.prototype.setXRangeArrows = function(d) {
  var self = this;
  this.options.showXRangeArrows = d;
  this.drawXAxisArrows(d);
}

SpectrumChartD3.prototype.setCompactXAxis = function( compact ) {
  this.options.compactXAxis = Boolean(compact);
  
  /*Might want to add ability to change xTitlePad here.  */
  /*this.padding.xTitlePad = 10; */
    
  this.handleResize( false );
}


/**
 * -------------- Chart Pan (X-axis) Slider Functions --------------
 */
SpectrumChartD3.prototype.drawXAxisSliderChart = function() {
  var self = this;

  // Cancel if the chart or raw data are not present
  if (!self.chart || d3.select(self.chart).empty() || !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) {
    self.cancelXAxisSliderChart();
    return;
  }
  // Cancel the action and clean up if the option for the slider chart is not checked
  if (!self.options.showXAxisSliderChart && self.origBBox && self.origHeight) {
    self.cancelXAxisSliderChart();
    return;
  }

  function drawDragRegionLines() {
    d3.selectAll(".sliderDragRegionLine").remove();
    
    if (!self.sliderDragLeft || !self.sliderDragRight) {
      return;
    }
    var leftX = Number(self.sliderDragLeft.attr("x"));
    var leftY = Number(self.sliderDragLeft.attr("y"));
    var leftWidth =  Number(self.sliderDragLeft.attr("width"));
    var leftHeight = self.sliderDragLeft[0][0].height.baseVal.value;
    var rightX = Number(self.sliderDragRight.attr("x"));
    var rightY = Number(self.sliderDragRight.attr("y"));
    var rightWidth =  Number(self.sliderDragRight.attr("width"));
    var rightHeight = self.sliderDragRight[0][0].height.baseVal.value;

    var numberOfLines = 4;

    for (var i = 1; i < numberOfLines; i++) {
      self.sliderChart.append('line')
        .attr("class", "sliderDragRegionLine")
        .attr("x1", leftX + (i*leftWidth)/numberOfLines)
        .attr("x2", leftX + (i*leftWidth)/numberOfLines)
        .attr("y1", leftY + (leftHeight/4))
        .attr("y2", leftY + (3*leftHeight/4))
        .on("mousedown", self.handleMouseDownLeftSliderDrag())
        .on("mousemove", self.handleMouseMoveLeftSliderDrag(false))
        .on("mouseout", self.handleMouseOutLeftSliderDrag())
        .on("touchstart", self.handleTouchStartLeftSliderDrag())
        .on("touchmove", self.handleTouchMoveLeftSliderDrag(false));

      self.sliderChart.append('line')
        .attr("class", "sliderDragRegionLine")
        .attr("x1", rightX + (i*rightWidth)/numberOfLines)
        .attr("x2", rightX + (i*rightWidth)/numberOfLines)
        .attr("y1", rightY + (rightHeight/4))
        .attr("y2", rightY + (3*rightHeight/4))
        .on("mousedown", self.handleMouseDownRightSliderDrag())
        .on("mousemove", self.handleMouseMoveRightSliderDrag(false))
        .on("mouseout", self.handleMouseOutRightSliderDrag())
        .on("touchstart", self.handleTouchStartRightSliderDrag())
        .on("touchmove", self.handleTouchMoveRightSliderDrag(false));
    }
  }

  // Ensure that the slider chart height is always 1/10 of the chart height (for resizes)
  self.size.sliderChartHeight = self.size.height / 10;

  // Starting height of the chart (in px)
  var startingHeight = Number(d3.select(this.chart)[0][0].style.height.substring(0, d3.select(this.chart)[0][0].style.height.length - 2));

  // Extra padding calculated if x-axis title is present
  var extraPadding = self.xaxistitle != null && !d3.select(self.xaxistitle).empty() ? self.xaxistitle[0][0].clientHeight + 20 : 20;

  // Store the original bounding box and height of the chart without the x-axis slider chart
  if (!self.origBBox || !self.origHeight) {
    self.origBBox = d3.select(self.chart).select('svg').attr("viewBox");
    self.origHeight = d3.select(self.chart).select('svg').attr("height");
  }
  self.origBBox = d3.select(self.chart).select('svg').attr("viewBox");

  // Calculate the final chart height and position for storing the slider chart
  var height = (Number(self.origHeight) + self.size.sliderChartHeight + extraPadding + self.padding.sliderChart);

  // Set the chart svg viewBox and height accordingly to store the slider chart
  d3.select(self.chart).select('svg')
    .attr("viewBox", function() {
      var viewBox = self.origBBox.split(' ');
      return viewBox[0] + " " + viewBox[1] + " " + viewBox[2] + " " + height;
    })
    .attr("height", height);

  // Set the chart style height to have room for the slider chart
  if (startingHeight.toFixed() != (Number(self.origHeight) + self.size.sliderChartHeight + extraPadding + self.padding.sliderChart).toFixed()) {
    d3.select(this.chart)[0][0].style.height = height + "px";
  }

  // Store the original x and y-axis domain (we'll use these to draw the slider lines and position the slider box)
  var origdomain = self.xScale.domain();
  var origdomainrange = self.xScale.range();
  var origrange = self.yScale.domain();
  var bounds = self.min_max_x_values();
  var maxX = bounds[1];
  var minX = bounds[0];

  // Change the x and y-axis domain to the full range (for slider lines)
  self.xScale.domain([minX, maxX]);
  self.xScale.range([0, self.size.sliderChartWidth]);
  self.do_rebin();
  self.rebinForBackgroundSubtract();
  self.yScale.domain(self.getYAxisDomain());

  // Draw the elements for the slider chart
  if (d3.select("#sliderChart").empty()) {

    // G element of the slider chart
    self.sliderChart = d3.select("svg").append("g").attr("id", "sliderChart")
      .attr("transform", "translate(" + self.padding.leftComputed + "," + (480 + extraPadding + self.padding.sliderChart) + ")")
      // .on("mousemove", self.handleMouseMoveSliderChart());
      .on("touchstart", self.handleTouchStartSliderChart())
      .on("touchmove", self.handleTouchMoveSliderChart());

    // Plot area for data lines in slider chart
    self.sliderChartPlot = self.sliderChart.append("rect")
      .attr("id", "sliderchartarea"+self.chart.id )
      .attr("width", self.size.sliderChartWidth)
      .attr("height", self.size.sliderChartHeight)
      .style("fill", "#EEEEEE");

    // Chart body for slider (keeps the data lines)
    self.sliderChartBody = self.sliderChart.append("g")
      .attr("clip-path", "url(#sliderclip" + this.chart.id + ")");

    // Clip path for slider chart
    self.sliderChartClipPath = self.sliderChart.append('svg:clipPath')
        .attr("id", "sliderclip" + self.chart.id )
        .append("svg:rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", self.size.sliderChartWidth)
        .attr("height", self.size.sliderChartHeight);


    // For adding peaks into slider chart 
    // self.sliderPeakVis = d3.select("#sliderChart").append('g')
    //   .attr("id", "sliderPeakVis")
    //   .attr("class", "peakVis")
    //   .attr("transform", "translate(0,0)")
    //   .attr("clip-path", "url(#sliderclip" + this.chart.id + ")");

  } else {
    // Adjust the width, height, and transform for the slider chart elements (for resizing)
    self.sliderChartPlot.attr("width", self.size.sliderChartWidth)
      .attr("height", self.size.sliderChartHeight);
    self.sliderChartClipPath.attr("width", self.size.sliderChartWidth)
      .attr("height", self.size.sliderChartHeight);

    // self.sliderChart.attr("transform", "translate(0," + (self.size.height + extraPadding + self.padding.sliderChart) + ")");
  }

  // Commented out for adding peaks into slider chart sometime later
  // self.sliderPeakVis.selectAll('*').remove();
  // self.peakVis.select(function() {
  //   this.childNodes.forEach(function(path) {
  //     path = d3.select(path);
  //     self.sliderPeakVis.append('path')
  //       .attr("d", path.attr('d'))
  //       .attr("class", path.attr('class'))
  //       .attr("fill-opacity", path.attr('fill-opacity'))
  //       .attr("stroke-width", path.attr('stroke-width'))
  //       .attr("stroke", path.attr("stroke"))
  //       .attr("transform", "translate(0," + (self.size.height + extraPadding + self.padding.sliderChart) + ")");
  //   });
  // });

  // Add the slider draggable box and edges
  if (!self.sliderBox) {
    // Slider box
    self.sliderBox = self.sliderChart.append("rect")
      .attr("id", "sliderBox")
      .attr("class", "sliderBox")
      .attr("height", self.size.sliderChartHeight)
      .on("mousedown", self.handleMouseDownSliderBox())
      .on("touchstart", self.handleTouchStartSliderBox())
      .on("touchmove", self.handleTouchMoveSliderChart());

    // Left slider drag region
    self.sliderDragLeft = self.sliderChart.append("rect")
      .attr("id", "sliderDragLeft")
      .attr("class", "sliderDragRegion")
      .attr("rx", 2)
      .attr("ry", 2)
      .on("mousedown", self.handleMouseDownLeftSliderDrag())
      .on("mousemove", self.handleMouseMoveLeftSliderDrag(false))
      .on("mouseout", self.handleMouseOutLeftSliderDrag())
      .on("touchstart", self.handleTouchStartLeftSliderDrag())
      .on("touchmove", self.handleTouchMoveLeftSliderDrag(false));

    // Right slider drag region
    self.sliderDragRight = self.sliderChart.append("rect")
      .attr("id", "sliderDragRight")
      .attr("class", "sliderDragRegion")
      .attr("rx", 2)
      .attr("ry", 2)
      .on("mousedown", self.handleMouseDownRightSliderDrag())
      .on("mousemove", self.handleMouseMoveRightSliderDrag(false))
      .on("mouseout", self.handleMouseOutRightSliderDrag())
      .on("touchstart", self.handleTouchStartRightSliderDrag())
      .on("touchmove", self.handleTouchMoveRightSliderDrag(false));
  }

  var sliderBoxX = self.xScale(origdomain[0]);
  var sliderBoxWidth = self.xScale(origdomain[1]) - self.xScale(origdomain[0]);

  // Adjust the position of the slider box to the particular zoom region
  self.sliderBox.attr("x", sliderBoxX)
    .attr("width", sliderBoxWidth);
    // .on("mousemove", self.handleMouseMoveSliderChart());

  self.sliderDragLeft.attr("width", self.size.sliderChartWidth/100)
    .attr("height", self.size.sliderChartHeight/2.3);
  self.sliderDragRight.attr("width", self.size.sliderChartWidth/100)
    .attr("height", self.size.sliderChartHeight/2.3);

  self.sliderDragLeft.attr("x", sliderBoxX - Number(self.sliderDragLeft.attr("width"))/2)
    .attr("y", self.size.sliderChartHeight/2 - Number(self.sliderDragLeft.attr("height"))/2);

  self.sliderDragRight.attr("x", (sliderBoxX + sliderBoxWidth) - (Number(self.sliderDragRight.attr("width"))/2))
    .attr("y", self.size.sliderChartHeight/2 - Number(self.sliderDragRight.attr("height"))/2);

  self.drawSliderChartLines();
  drawDragRegionLines();

  // Restore the original x and y-axis domain
  self.xScale.domain(origdomain);
  self.xScale.range(origdomainrange);
  self.do_rebin();
  self.rebinForBackgroundSubtract();
  self.yScale.domain(origrange);
}

SpectrumChartD3.prototype.drawSliderChartLines = function()  {
  var self = this;

  // Cancel the action and clean up if the option for the slider chart is not checked or there is no slider chart displayed
  if (!self.options.showXAxisSliderChart || !self.sliderChartBody) return;

  // Delete the data lines if they are present
  for (let i = 0; i < self.rawData.spectra.length; ++i) {
    console.log(self['sliderLine' + i]);
    if (self['sliderLine' + i])
      self['sliderLine' + i].remove();
  }

  for (let i = 0; i < self.rawData.spectra.length; ++i) {
    let spectrum = self.rawData.spectra[i];
    if (self.options.backgroundSubtract && spectrum.type == self.spectrumTypes.BACKGROUND) continue;
    if (self['line'+i])
      self['sliderLine'+i] = self.sliderChartBody.append("path")
        .attr("id", 'sliderLine'+i)
        .attr("class", 'sline sliderLine')
        .attr("stroke", spectrum.lineColor ? spectrum.lineColor : 'black')
        .attr("d", self['line'+i](spectrum[self.options.backgroundSubtract ? 'bgsubtractpoints' : 'points']))
        .attr("transform","scale(1," + (self.size.sliderChartHeight / self.size.height) + ")");
  }
}

SpectrumChartD3.prototype.cancelXAxisSliderChart = function() {
  var self = this;
  self.size.sliderChartHeight = self.size.height / 10;

  var height = Number(d3.select(this.chart)[0][0].style.height.substring(0, d3.select(this.chart)[0][0].style.height.length - 2));

  if (!self.origBBox || !self.origHeight) {
    return;
  }

  if (self.sliderChart) {
    self.sliderChart.remove();
    self.sliderChartBody.remove();
    self.sliderChartPlot.remove();  
    self.sliderChartClipPath.remove();
    self.sliderBox.remove();
    self.svg.selectAll(".sliderDragRegion").remove();

    if (self.rawData && self.rawData.spectra && self.rawData.spectra.length)
      for (var i = 0; i < self.rawData.spectra.length; ++i)
        if (self['sliderLine'+i]) {
          self['sliderLine'+i].remove();
          self['sliderLine'+i] = null;
        }

    self.sliderChart = null;
    self.sliderChartPlot = null;
    self.sliderChartBody = null;
    self.sliderChartClipPath = null;
    self.sliderBox = null;
  }

  d3.select(self.chart)[0][0].style.height = self.origHeight + "px";
  this.svg.attr("viewBox", function() {
    var viewBoxAttrs = self.origBBox.split(' ');
    viewBoxAttrs[3] = self.origHeight.toString();
    return viewBoxAttrs.join(' ');
  });
  this.svg.attr("height", self.origHeight);

  self.origBBox = null;
  self.origHeight = null;

  self.sliderBoxDown = false;
  self.leftDragRegionDown = false;
  self.rightDragRegionDown = false;
  self.sliderChartMouse = null;
  self.savedSliderMouse = null;
}

SpectrumChartD3.prototype.setShowXAxisSliderChart = function(d) {
  this.options.showXAxisSliderChart = d;
  this.drawXAxisSliderChart();
}

SpectrumChartD3.prototype.handleMouseDownSliderBox = function() {
  var self = this;

  return function() {
    /* In order to stop selection of text around chart when clicking down on slider box. */
    d3.event.preventDefault();
    d3.event.stopPropagation();

    self.sliderBoxDown = true;
    self.leftDragRegionDown = false;
    self.rightDragRegionDown = false;

    /* Initially set the escape key flag false */
    self.escapeKeyPressed = false;    

    d3.select(document.body).style("cursor", "move");
  }
}

SpectrumChartD3.prototype.handleMouseMoveSliderChart = function() {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();
    /* console.log("sliderboxdown = ", self.sliderBoxDown); */
    /* console.log("leftDragRegionDown = ", self.leftDragRegionDown); */
    /* console.log("rightDragRegionDown = ", self.rightDragRegionDown); */

    if (self.leftDragRegionDown) {
      return self.handleMouseMoveLeftSliderDrag(true)();
    }

    if (self.rightDragRegionDown) {
      return self.handleMouseMoveRightSliderDrag(true)();
    }

    if (self.sliderBoxDown) {
      d3.select(document.body).style("cursor", "move");
      var m = d3.mouse(self.sliderChart[0][0]);
      var origdomain = self.xScale.domain();
      var origdomainrange = self.xScale.range();
      var bounds = self.min_max_x_values();
      var maxX = bounds[1];
      var minX = bounds[0];

      if (!self.sliderChartMouse) {
        self.sliderChartMouse = m;
      }

      var sliderBoxX = Number(self.sliderBox.attr("x"));
      var sliderBoxWidth = Number(self.sliderBox.attr("width"));
      var sliderDragRegionWidth = 3;
      var x = Math.min( self.size.sliderChartWidth - sliderBoxWidth, Math.max(0, sliderBoxX + (m[0] - self.sliderChartMouse[0])) );

      if ((sliderBoxX == 0 || sliderBoxX + sliderBoxWidth == self.size.sliderChartWidth)) {
        if (!self.savedSliderMouse)
          self.savedSliderMouse = m;
      }

      if (self.savedSliderMouse && m[0] != self.savedSliderMouse[0]) {
        if (sliderBoxX == 0 && m[0] < self.savedSliderMouse[0]) return;
        else if (sliderBoxX + sliderBoxWidth == self.size.sliderChartWidth && m[0] > self.savedSliderMouse[0]) return;
        else self.savedSliderMouse = null;
      }

      self.xScale.domain([minX, maxX]);
      self.xScale.range([0, self.size.sliderChartWidth]);
      self.sliderBox.attr("x", x);
      self.sliderDragLeft.attr("x", x);
      self.sliderDragRight.attr("x", x + sliderBoxWidth - sliderDragRegionWidth);

      origdomain = [ self.xScale.invert(x), self.xScale.invert(x + sliderBoxWidth) ];
      self.setXAxisRange(origdomain[0], origdomain[1]);
      self.xScale.range(origdomainrange);
      self.redraw()();

      self.sliderChartMouse = m;
    }
  }
}

SpectrumChartD3.prototype.handleMouseDownLeftSliderDrag = function() {
  var self = this;

  return function() {
    /* In order to stop selection of text around chart when clicking down on slider box. */
    d3.event.preventDefault();
    d3.event.stopPropagation();

    self.leftDragRegionDown = true;

    /* Initially set the escape key flag false */
    self.escapeKeyPressed = false;    
  }
}

SpectrumChartD3.prototype.handleMouseMoveLeftSliderDrag = function(redraw) {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();

    if (self.sliderBoxDown) {
      return self.handleMouseMoveSliderChart()();
    }

    d3.select(document.body).style("cursor", "ew-resize");

    if (!self.leftDragRegionDown || !redraw) {
      return;
    }

    var m = d3.mouse(self.sliderChart[0][0]);
    var origdomain = self.xScale.domain();
    var origdomainrange = self.xScale.range();
    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];
    var x = Math.max(m[0], 0);

    var sliderBoxX = self.xScale(origdomain[0]);
    var sliderBoxWidth = Number(self.sliderBox.attr("width"));
    var sliderDragRegionWidth = 3;
    var sliderDragPadding = 1;

    self.xScale.domain([minX, maxX]);
    self.xScale.range([0, self.size.sliderChartWidth]);

    if (m[0] > Number(self.sliderDragRight.attr("x") - sliderDragPadding)) {
      self.xScale.domain(origdomain);
      return;
    }

    self.sliderBox.attr("x", x);
    self.sliderDragLeft.attr("x", x);
    origdomain[0] = self.xScale.invert(x);

    self.setXAxisRange(origdomain[0], origdomain[1]);
    self.xScale.range(origdomainrange);
    self.redraw()();
  }
}

SpectrumChartD3.prototype.handleMouseOutLeftSliderDrag = function() {
  var self = this;

  return function() {
    if (!self.leftDragRegionDown) {
      d3.select(document.body).style("cursor", "default");
    }
  }
}

SpectrumChartD3.prototype.handleMouseDownRightSliderDrag = function() {
  var self = this;

  return function() {
    /* In order to stop selection of text around chart when clicking down on slider box. */
    d3.event.preventDefault();
    d3.event.stopPropagation();

    self.rightDragRegionDown = true;

    /* Initially set the escape key flag false */
    self.escapeKeyPressed = false;    
  }
}

SpectrumChartD3.prototype.handleMouseMoveRightSliderDrag = function(redraw) {
  var self = this;

  return function() {

    if (self.sliderBoxDown) {
      return; /*self.handleMouseMoveSliderChart()(); */
    }

    d3.event.preventDefault();
    d3.event.stopPropagation();
    d3.select('body').style("cursor", "ew-resize");

    if (!self.rightDragRegionDown || !redraw) {
      return;
    }

    var m = d3.mouse(self.sliderChart[0][0]);
    var origdomain = self.xScale.domain();
    var origdomainrange = self.xScale.range();
    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];
    var x = Math.min(m[0], self.size.sliderChartWidth);

    var sliderBoxX = self.xScale(origdomain[0]);
    var sliderBoxWidth = Number(self.sliderBox.attr("width"));
    var sliderDragRegionWidth = 3;
    var sliderDragPadding = 1;

    self.xScale.domain([minX, maxX]);
    self.xScale.range([0, self.size.sliderChartWidth]);

    if (m[0] - sliderDragRegionWidth < Number(self.sliderDragLeft.attr("x")) + Number(self.sliderDragLeft.attr("width"))) {
      self.xScale.domain(origdomain);
      self.xScale.range(origdomainrange);
      return;
    }

    self.sliderBox.attr("width", Math.abs(x - Number(self.sliderDragRight.attr("x"))));
    self.sliderDragRight.attr("x", x - sliderDragRegionWidth);
    origdomain[1] = self.xScale.invert(x);

    self.setXAxisRange(origdomain[0], origdomain[1]);
    self.xScale.range(origdomainrange);
    self.redraw()();
  }
}

SpectrumChartD3.prototype.handleMouseOutRightSliderDrag = function() {
  var self = this;

  return function() {
    if (!self.rightDragRegionDown) {
      d3.select(document.body).style("cursor", "default");
    }
  }
}

SpectrumChartD3.prototype.handleTouchStartSliderBox = function() {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();

    self.sliderBoxDown = true;
    self.leftDragRegionDown = false;
    self.rightDragRegionDown = false;

    var t = [d3.event.pageX, d3.event.pageY];
    var touchError = 25;
    var x1 = self.sliderBox[0][0].getBoundingClientRect().left;
    var x2 = self.sliderBox[0][0].getBoundingClientRect().right;

    if (d3.event.changedTouches.length !== 1)
      return;

    if (x1 - touchError <= t[0] && t[0] <= x1 + touchError) {
      self.sliderBoxDown = false;
      self.leftDragRegionDown = true;

    } else if (x2 - touchError <= t[0] && t[0] <= x2 + touchError) {
      self.sliderBoxDown = false;
      self.rightDragRegionDown = true;
    }
  }
}

SpectrumChartD3.prototype.handleTouchStartSliderChart = function() {
  var self = this;

  return function() {
    var t = [d3.event.pageX, d3.event.pageY];
    var touchError = 15;
    var x1 = self.sliderBox[0][0].getBoundingClientRect().left;
    var x2 = self.sliderBox[0][0].getBoundingClientRect().right;

    if (d3.event.changedTouches.length !== 1)
      return;

    if (x1 - touchError <= t[0] && t[0] <= x1 + touchError) {
      self.sliderBoxDown = false;
      self.leftDragRegionDown = true;

    } else if (x2 - touchError <= t[0] && t[0] <= x2 + touchError) {
      self.sliderBoxDown = false;
      self.rightDragRegionDown = true;
    }
  }
}

SpectrumChartD3.prototype.handleTouchMoveSliderChart = function() {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();

    if (self.leftDragRegionDown) {
      return self.handleTouchMoveLeftSliderDrag(true)();
    }

    if (self.rightDragRegionDown) {
      return self.handleTouchMoveRightSliderDrag(true)();
    }

    if (self.sliderBoxDown) {
      d3.select(document.body).style("cursor", "move");
      var t = d3.touches(self.sliderChart[0][0]);

      if (t.length !== 1)
        return;

      t = t[0];
      var origdomain = self.xScale.domain();
      var origdomainrange = self.xScale.range();
      var bounds = self.min_max_x_values();
      var maxX = bounds[1];
      var minX = bounds[0];

      if (!self.sliderChartTouch) {
        self.sliderChartTouch = t;
      }

      var sliderBoxX = Number(self.sliderBox.attr("x"));
      var sliderBoxWidth = Number(self.sliderBox.attr("width"));
      var sliderDragRegionWidth = 3;
      var x = Math.min( self.size.sliderChartWidth - sliderBoxWidth, Math.max(0, sliderBoxX + (t[0] - self.sliderChartTouch[0])) );

      if ((sliderBoxX == 0 || sliderBoxX + sliderBoxWidth == self.size.sliderChartWidth)) {
        if (!self.savedSliderTouch)
          self.savedSliderTouch = t;
      }

      if (self.savedSliderTouch && t[0] != self.savedSliderTouch[0]) {
        if (sliderBoxX == 0 && t[0] < self.savedSliderTouch[0]) return;
        else if (sliderBoxX + sliderBoxWidth == self.size.sliderChartWidth && t[0] > self.savedSliderTouch[0]) return;
        else self.savedSliderTouch = null;
      }

      self.xScale.domain([minX, maxX]);
      self.xScale.range([0, self.size.sliderChartWidth]);
      self.sliderBox.attr("x", x);
      self.sliderDragLeft.attr("x", x);
      self.sliderDragRight.attr("x", x + sliderBoxWidth - sliderDragRegionWidth);

      origdomain = [ self.xScale.invert(x), self.xScale.invert(x + sliderBoxWidth) ];
      self.setXAxisRange(origdomain[0], origdomain[1]);
      self.xScale.range(origdomainrange);
      self.redraw()();

      self.sliderChartTouch = t;

      /* IMPORTANT: To translate the current x-scale into the current zoom object */
      self.zoom.x(self.xScale);
    }
  }
}

SpectrumChartD3.prototype.handleTouchStartLeftSliderDrag = function() {
  var self = this;

  return function() {
    self.leftDragRegionDown = true;
  }
}

SpectrumChartD3.prototype.handleTouchMoveLeftSliderDrag = function(redraw) {
  var self = this;

  return function() {
    d3.event.preventDefault();
    d3.event.stopPropagation();

    if (self.sliderBoxDown) {
      return;
    }

    if (!self.leftDragRegionDown) {
      return;
    }

    var t = d3.touches(self.sliderChart[0][0]);
    if (t.length !== 1)
      return;

    t = t[0];
    var origdomain = self.xScale.domain();
    var origdomainrange = self.xScale.range();
    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];
    var x = Math.max(t[0], 0);

    var sliderBoxX = self.xScale(origdomain[0]);
    var sliderBoxWidth = Number(self.sliderBox.attr("width"));
    var sliderDragRegionWidth = 3;
    var sliderDragPadding = 1;

    self.xScale.domain([minX, maxX]);
    self.xScale.range([0, self.size.sliderChartWidth]);

    if (t[0] > Number(self.sliderDragRight.attr("x") - sliderDragPadding)) {
      self.xScale.domain(origdomain);
      return;
    }

    self.sliderBox.attr("x", x);
    self.sliderDragLeft.attr("x", x);
    origdomain[0] = self.xScale.invert(x);

    self.setXAxisRange(origdomain[0], origdomain[1]);
    self.xScale.range(origdomainrange);
    self.redraw()();

    /* IMPORTANT: To translate the current x-scale into the current zoom object */
    self.zoom.x(self.xScale);
  }
}

SpectrumChartD3.prototype.handleTouchStartRightSliderDrag = function() {
  var self = this;

  return function() {
    self.rightDragRegionDown = true;
  }
}

SpectrumChartD3.prototype.handleTouchMoveRightSliderDrag = function(redraw) {
  var self = this;

  return function() {
    if (self.sliderBoxDown) {
      return;
    }

    d3.event.preventDefault();
    d3.event.stopPropagation();

    if (!self.rightDragRegionDown) {
      return;
    }

    var t = d3.touches(self.sliderChart[0][0]);
    if (t.length !== 1)
      return;
  
    t = t[0];
    var origdomain = self.xScale.domain();
    var origdomainrange = self.xScale.range();
    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];
    var x = Math.min(t[0], self.size.sliderChartWidth);

    var sliderBoxX = self.xScale(origdomain[0]);
    var sliderBoxWidth = Number(self.sliderBox.attr("width"));
    var sliderDragRegionWidth = 3;
    var sliderDragPadding = 1;

    self.xScale.domain([minX, maxX]);
    self.xScale.range([0, self.size.sliderChartWidth]);

    if (t[0] - sliderDragRegionWidth < Number(self.sliderDragLeft.attr("x")) + Number(self.sliderDragLeft.attr("width"))) {
      self.xScale.domain(origdomain);
      self.xScale.range(origdomainrange);
      return;
    }

    self.sliderBox.attr("width", Math.abs(x - Number(self.sliderDragRight.attr("x"))));
    self.sliderDragRight.attr("x", x - sliderDragRegionWidth);
    origdomain[1] = self.xScale.invert(x);

    self.setXAxisRange(origdomain[0], origdomain[1]);
    self.xScale.range(origdomainrange);
    self.redraw()();

    /* IMPORTANT: To translate the current x-scale into the current zoom object */
    self.zoom.x(self.xScale);
  }
}


/**
 * -------------- Scale Factor Functions --------------
 */
SpectrumChartD3.prototype.drawScalerBackgroundSecondary = function() {
  var self = this;

  function hasYScaleFactors() {
    if (!self.rawData || !self.rawData.spectra) return false;
    var result = false;
    self.rawData.spectra.forEach(function (spectrum) { 
      if (spectrum.yScaleFactor != null)
        result = true;
    });
    return result;
  }
  function allNegativeYScaleFactors() {
    var result = true;
    self.rawData.spectra.forEach(function (spectrum) { 
      if (spectrum.yScaleFactor && spectrum.yScaleFactor >= 0)
        result = false;
    });
    return result;
  }
  function onlyForegroundPresent() {
    if (!self.rawData || !self.rawData.spectra) return false;
    var result = true;
    self.rawData.spectra.forEach(function (spectrum) { 
      if (spectrum && spectrum.title && spectrum.title.toUpperCase() != "FOREGROUND")
        result = false;
    });
    return result;
  }

  var onlyForegroundPresentInGraph = onlyForegroundPresent();
  var graphHasYScaleFactors = hasYScaleFactors();

  if (!self.rawData || !self.rawData.spectra || !graphHasYScaleFactors || onlyForegroundPresentInGraph || !self.options.scaleBackgroundSecondary) {
    self.removeSpectrumScaleFactorWidget();
    
    /* Display proper error messages */
    if (self.options.scaleBackgroundSecondary) {
      if (!self.rawData || !self.rawData.spectra)
        alert("No data specified for graph!");
      else if (!graphHasYScaleFactors)
        alert("No y-scale factors detected for any graph!");
      else if (onlyForegroundPresentInGraph)
        alert("Only chart foreground detected. Please specify a background/other chart for scaling y-values.");
    }

    return;
  }

  if (allNegativeYScaleFactors()) {
    self.removeSpectrumScaleFactorWidget();
    return;
  }

  if (!self.scalerWidget) {

    function moveScalerWidget(){
      if( self.scalerdown && !self.adjustingBackgroundScale && !self.adjustingSecondaryScale ) {
        d3.event.preventDefault();
        d3.event.stopPropagation();

        var x = d3.event.x ? d3.event.x : d3.event.touches ?  d3.event.touches[0].clientX : d3.event.clientX;
        var y = d3.event.y ? d3.event.y : d3.event.touches ?  d3.event.touches[0].clientY : d3.event.clientY;

        var calculated_x = d3.mouse(self.vis[0][0])[0];

        if ( calculated_x >= -self.padding.leftComputed && y >= 0 && 
             calculated_x <= self.cx && y <= self.cy ) {
          console.log("change pos");
          var tx = (x - self.scalerdown.x) + self.scalerdown.x0;
          var ty = (y - self.scalerdown.y) + self.scalerdown.y0; 
          self.scalerWidget.attr("transform", "translate(" + tx + "," + ty + ")");
        }
      }
    }

    self.scalerWidget = d3.select(this.chart).select("svg").append("g")
      .attr("class", "scalerwidget")
      .attr("transform","translate(" + (this.cx - (this.cx/2) - this.padding.right) + ","+ (this.padding.topComputed + 10) + ")");

    self.scalerWidgetBox = self.scalerWidget.append('rect')
      .attr("class", "scalerback")
      .attr('width', "100px")
      .attr('height', "5px")
      .attr( "rx", "5px")
      .attr( "ry", "5px");
    self.scalerWidgetBody = self.scalerWidget.append("g")
      .attr("transform","translate(8,17)");

    self.scalerWidgetHeader = self.scalerWidget.append("g"); 
    self.scalerWidgetHeader.style("display", "none")
      .append('rect')
      .attr("class", "scalerheader")
      .attr('width', "100px")
      .attr('height', "1.5em")
      .attr( "rx", "5px")
      .attr( "ry", "5px")
      .style("cursor", "pointer");
    
    /*Add a close button to get rid of the scaler widget */
    self.scalerWidgetClose = self.scalerWidgetHeader.append('g').attr("transform","translate(4,4)");
    self.scalerWidgetClose.append("rect")
      .attr("class", "d3closebut")
      .attr('height', "12")
      .attr('width', "12");
    self.scalerWidgetClose.append("path")
      .attr("style", "stroke: white; stroke-width: 1.5px;" )
      .attr("d", "M 2,2 L 10,10 M 10,2 L 2,10");
    self.scalerWidgetClose.on("click", function(){ self.options.scaleBackgroundSecondary = false; self.drawScalerBackgroundSecondary(); } )
                          .on("touchend", function(){ self.options.scaleBackgroundSecondary = false; self.drawScalerBackgroundSecondary(); } );   
    
    self.scalerWidget.on("mouseover", function(d){if( !self.dragging_plot && !self.zooming_plot ) self.scalerWidgetHeader.style("display", null);} )
      .on("mouseout", function(d){self.scalerWidgetHeader.style("display", "none");} )
      .on("mousemove", moveScalerWidget)
      .on("touchmove", moveScalerWidget)
      .on("wheel", function(d){d3.event.preventDefault(); d3.event.stopPropagation();} );
    
    function mousedownscaler(){
      console.log("mouse down on scaler");
      if (d3.event.defaultPrevented) return;
      if( self.dragging_plot || self.zooming_plot ) return;
      d3.event.preventDefault();
      d3.event.stopPropagation();
      var trans = d3.transform(self.scalerWidget.attr("transform")).translate;

      var x = d3.event.x ? d3.event.x : d3.event.touches ?  d3.event.touches[0].clientX : d3.event.clientX;
      var y = d3.event.y ? d3.event.y : d3.event.touches ?  d3.event.touches[0].clientY : d3.event.clientY;
      self.scalerdown = {x: x, y: y, x0: trans[0], y0: trans[1]};
    }
    
    self.scalerWidgetHeader.on("mouseover", function(d) { if( !self.dragging_plot && !self.zooming_plot ) self.scalerWidget.attr("class", "scalerwidget activescaler");} )
      .on("touchstart", function(d) { if( !self.dragging_plot && !self.zooming_plot ) self.scalerWidget.attr("class", "scalerwidget activescaler"); } )
      .on("mouseout",  function(d) { self.scalerWidget.attr("class", "scalerwidget"); } )
      .on("touchend",  function(d) { if (self.scalerWidget) self.scalerWidget.attr("class", "scalerwidget"); } )
      .on("mousedown.drag",  mousedownscaler )
      .on("touchstart.drag",  mousedownscaler )
      .on("touchend.drag", function() {self.scalerdown = null;})
      .on("mouseup.drag", function(){self.scalerdown = null;} )
      .on("mousemove.drag", moveScalerWidget)
      .on("mouseout.drag", moveScalerWidget);

    self.scalerWidget.on("touchstart", function(d) { mousedownscaler(); if( !self.dragging_plot && !self.zooming_plot ) self.scalerWidgetHeader.style("display", null); } )
      .on("touchend.drag",  function() 
      {
      if (!self.scalerWidget || !self.scalerWidgetHeader) {
        self.scalerdown = null;
        return; 
      }
      self.scalerWidget.attr("class", "scalerwidget"); 
      window.setTimeout(function() { self.scalerWidgetHeader.style("display", "none"); }, 1500) 
      self.scalerdown = null; 
      });
  }

  var origtrans = d3.transform(self.scalerWidget.attr("transform")).translate;
  var bb = self.scalerWidget.node().getBBox();
  var fromRight = self.cx - origtrans[0] - self.scalerWidgetBox.attr('width').replace("px","");

  self.scalerWidgetBody.selectAll("g").remove();

  function is_touch_device() {
    return 'ontouchstart' in window        /* works on most browsers  */
        || (navigator && navigator.maxTouchPoints);       /* works on IE10/11 and Surface */
  };

  var scalerWidth = 300;
  var toggleRadius = is_touch_device() ? 10 : 7;
  var xpos = 10;
  var ypos = 25;
  var scalerAdded = false;

  self.rawData.spectra.forEach(function(spectrum,i) {
    var spectrumScaleFactor = spectrum.yScaleFactor;
    var spectrumSelector = 'Spectrum-' + spectrum.id;

    if (i == 0 || spectrum.type === self.spectrumTypes.FOREGROUND)   /* Don't add scaling functionality for foreground */
      return;

    if (spectrumScaleFactor != null && spectrumScaleFactor >= 0) {
      spectrum.scale = d3.scale.linear()
        .domain([0, self.options.maxScaleFactor]) /* TODO: Have global max scale factor */
        .range([0, scalerWidth]);

      spectrum.scaleAxis = d3.svg.axis().scale(spectrum.scale)
        .orient("bottom")
        .innerTickSize(is_touch_device() ? 27 : 19)
        .outerTickSize(0)
        .ticks(5,'f');

      var spectrumSliderArea = self.scalerWidgetBody.append("g")
        .attr("id", spectrumSelector + "SliderArea")
        .attr("transform","translate(" + xpos + "," + ypos + ")")
        .call(spectrum.scaleAxis);

      spectrum.sliderText = spectrumSliderArea.append("text")
        .attr("x", 0)
        .attr("y", 0)
        .attr("text-anchor", "start")
        .text(spectrum.title + " Scale Factor: " + spectrumScaleFactor.toFixed(3));

      spectrum.sliderRect = spectrumSliderArea.append("rect")
        .attr("class", "scaleraxis")
        .attr("y", Number(spectrum.sliderText.attr("y")) + 10 + (is_touch_device() ? 5 : 0))
        .attr("rx", 5)
        .attr("ry", 5)
        .attr("width", scalerWidth)
        .attr("height", "1%");

      spectrum.sliderToggle = spectrumSliderArea.append("circle")
        .attr("class", "scalertoggle")
        .attr("cx", Math.min(spectrum.scale(spectrumScaleFactor), scalerWidth))
        .attr("cy", Number(spectrum.sliderRect.attr("y")) + toggleRadius/2)
        .attr("r", toggleRadius)
        .style("cursor", "pointer")
        .on("mousedown", function(){ 
          self.currentlyAdjustingSpectrumScale = spectrum.title;
          d3.event.preventDefault();
          d3.event.stopPropagation();
        })
        .on("mousemove", self.handleMouseMoveScaleFactorSlider())
        .on("mouseup", function(){ self.currentlyAdjustingSpectrumScale = null; })
        .on("touchstart", function(){ self.currentlyAdjustingSpectrumScale = spectrum.title; })
        .on("touchmove", self.handleMouseMoveScaleFactorSlider())
        .on("touchend", function(){ self.currentlyAdjustingSpectrumScale = null; });

      ypos += 60;
    }
  });

  /*Resize the box to match the text size */
  var w = self.scalerWidgetBody.node().getBBox().width + 15 + (2*xpos); 
  self.scalerWidgetHeader.attr("width", w)
  self.scalerWidgetBox.attr('width', w);
  self.scalerWidgetBox.attr('height', self.scalerWidgetBody.node().getBBox().height + 40 );
  self.scalerWidgetClose.attr("transform","translate(" + (w-16) + ",4)");

  if (!self.scalerWidgetTitle)
    self.scalerWidgetTitle = self.scalerWidget.append('text')
      .attr("x", w/2)
      .attr("text-anchor", "middle")
      .attr("transform", "translate(0," + 16 + ")")
      .attr("cursor", "pointer")
      .on("touchstart", function(d) { mousedownscaler();  if( !self.dragging_plot && !self.zooming_plot ) self.scalerWidget.attr("class", "scalerwidget activescaler"); } )
      .on("mousemove", function(d) { if( !self.dragging_plot && !self.zooming_plot ) self.scalerWidget.attr("class", "scalerwidget activescaler"); } )
      .on("mouseout",  function(d) { self.scalerWidget.attr("class", "scalerwidget"); } )
      .on("touchend",  function(d) { self.scalerWidget.attr("class", "scalerwidget"); } )
      .on("mousedown.drag",  mousedownscaler )
      .on("touchstart.drag",  mousedownscaler )
      .on("touchend.drag", function() {self.scalerdown = null;})
      .on("mouseup.drag", function(){self.scalerdown = null;} )
      .on("mousemove.drag", moveScalerWidget)
      .text("Spectrum Y-Value Scaler")
  
  self.scalerWidgetHeader.select('rect').attr('width', w );
  self.scalerWidgetHeader.select('text').attr("x", w/2);

  /*Set the transform so the space on the right of the legend stays the same */
  self.scalerWidget.attr("transform", "translate(" + (this.cx - fromRight - w) + "," + origtrans[1] + ")" );
}

SpectrumChartD3.prototype.removeSpectrumScaleFactorWidget = function() {
  var self = this;

  if (self.scalerWidget) {
    self.scalerWidget.remove();
    self.scalerWidget = null;
    self.scalerWidgetBox = null;
    self.scalerWidgetHeader = null;
    self.scalerWidgetBody = null;
    self.scalerWidgetClose = null;
    self.scalerWidgetTitle = null;
    self.backgroundScale = null;
    var scaleroption;
    if (scaleroption = document.getElementById("scaleroption"))
      scaleroption.checked = false;
    console.log( 'Should emit scaler widget closed' );
  }
}

SpectrumChartD3.prototype.setSpectrumScaleFactor = function(d) {
  var self = this;
  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;
  if (!self.currentlyAdjustingSpectrumScale && !self.currentDropDownScaleFactorSpectrum)
    return;

  var spectrumToCheck = self.currentlyAdjustingSpectrumScale ? self.currentlyAdjustingSpectrumScale : self.currentDropDownScaleFactorSpectrum;

  /* Check for the which corresponding spectrum line is the to be adjusted */
  var spectrumToBeAdjusted = null;
  var linei = null;
  self.rawData.spectra.forEach(function(spectrum,i) {
    if (spectrum.title && spectrum.title.toUpperCase() == spectrumToCheck.toUpperCase() && spectrumToBeAdjusted == null) {
      spectrumToBeAdjusted = spectrum;
      linei = i;
      return;
    }
  });

  if (spectrumToBeAdjusted == null || linei == null)
    return;
  if (!self['line'+linei] || self.vis.select("#spectrumline"+linei).empty())
    return;

  function needsDecimal(num) {
    return num % 1 != 0;
  }

  /* Here is a modified, slightly more efficient version of redraw 
    specific to changing the scale factors for spectrums. 
  */
  function scaleFactorChangeRedraw(spectrum, linei) {
    self.updateLegend();
    self.rebinSpectrum(spectrum, linei);
    self.do_rebin();
    self.setYAxisDomain();
    self.drawYTicks();
    self.update();
    self.drawPeaks();
  }

  var spectrumScaleFactor = Math.min(Number(d), self.options.maxScaleFactor);
  spectrumToBeAdjusted.yScaleFactor = spectrumScaleFactor;
  scaleFactorChangeRedraw(spectrumToBeAdjusted, linei);

  if (spectrumToBeAdjusted.sliderText)
    spectrumToBeAdjusted.sliderText.text(spectrumToBeAdjusted.title + " Scale Factor: " + (needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed()));
  if (spectrumToBeAdjusted.sliderToggle && spectrumToBeAdjusted.scale)
    spectrumToBeAdjusted.sliderToggle.attr("cx", Math.max( Math.min(spectrumToBeAdjusted.scale(spectrumScaleFactor), spectrumToBeAdjusted.scale.range()[1]), spectrumToBeAdjusted.scale.range()[0] ));

  /* Update the slider chart if needed */
  if (self["sliderLine"+linei]) {
    var origdomain = self.xScale.domain();
    var origdomainrange = self.xScale.range();
    var origrange = self.yScale.domain();
    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];

    /* Change the x and y-axis domain to the full range (for slider lines) */
    self.xScale.domain([minX, maxX]);
    self.xScale.range([0, self.size.sliderChartWidth]);
    self.do_rebin();
    self.yScale.domain(self.getYAxisDomain());

    self["sliderLine"+linei].attr("d", self["line"+linei](spectrumToBeAdjusted.points));

    /* Restore the original x and y-axis domain */
    self.xScale.domain(origdomain);
    self.xScale.range(origdomainrange);
    self.do_rebin();
    self.yScale.domain(origrange);
  }
}

SpectrumChartD3.prototype.setMaxScaleFactor = function(d) {
  var self = this;

  d = Math.max(Number(d), 0.1);

  if (self.options)
    this.options.maxScaleFactor = d;
  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  function needsDecimal(num) {
    return num % 1 != 0;
  }

  /* Here is a modified, slightly more efficient version of redraw 
    specific to changing the scale factors for spectrums. 
  */
  function scaleFactorChangeRedraw(spectrum, linei) {
    self.updateLegend();
    self.rebinSpectrum(spectrum, linei);
    self.do_rebin();
    self.setYAxisDomain();
    self.drawYTicks();
    self.update();
    self.drawPeaks();
  }

  self.rawData.spectra.forEach(function(spectrum,i) {
    /* Don't scale the foreground */
    if (i == 0)
      return;


    var spectrumScaleFactor = Math.min(spectrum.yScaleFactor, self.options.maxScaleFactor);
    var spectrumSelector = 'Spectrum-' + spectrum.id;
    spectrum.yScaleFactor = spectrumScaleFactor;

    var domain;
    if (!spectrum.scale || !spectrum.scaleAxis)
      return;

    domain = spectrum.scale.domain();
    spectrum.scale.domain([ domain[0], d ]);
    spectrum.scaleAxis.scale(spectrum.scale)
      .orient("bottom")
      .ticks(5,'f');
    d3.select("#" + spectrumSelector + "SliderArea").call(spectrum.scaleAxis);

    if (spectrum.sliderText)
      spectrum.sliderText.text(spectrum.title + " Scale Factor: " + (needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed()));
    if (spectrum.sliderToggle)
      spectrum.sliderToggle.attr("cx", Math.min(spectrum.scale(spectrum.yScaleFactor), spectrum.scale.range()[1]));

    scaleFactorChangeRedraw(spectrum, i);

    if (!self.vis.select("#spectrumline"+i).empty()) {
      self.vis.select("#spectrumline"+i).attr("d", self['line'+i](spectrum.points));
    }

    /* Update the slider chart if needed */
    if (self["sliderLine"+i]) {
      var origdomain = self.xScale.domain();
      var origdomainrange = self.xScale.range();
      var origrange = self.yScale.domain();
      var bounds = self.min_max_x_values();
      var maxX = bounds[1];
      var minX = bounds[0];

      /* Change the x and y-axis domain to the full range (for slider lines) */
      self.xScale.domain([minX, maxX]);
      self.xScale.range([0, self.size.sliderChartWidth]);
      self.do_rebin();
      self.yScale.domain(self.getYAxisDomain());

      self["sliderLine"+i].attr("d", self["line"+i](spectrum.points));

      /* Restore the original x and y-axis domain */
      self.xScale.domain(origdomain);
      self.xScale.range(origdomainrange);
      self.do_rebin();
      self.yScale.domain(origrange);
    }
  });
}

SpectrumChartD3.prototype.setDropDownSpectrumScaleFactor = function(d) {
  var self = this;
  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  function needsDecimal(num) {
    return num % 1 != 0;
  }

  self.currentDropDownScaleFactorSpectrum = d == "None" ? null : d;

  if (d != "None") {
    var valueChanged = false;
    self.rawData.spectra.forEach(function(spectrum) {
      if (spectrum.title && spectrum.title.toUpperCase() == self.currentDropDownScaleFactorSpectrum.toUpperCase() && d != "None" && !valueChanged) {
        valueChanged = true;

      var currentsfinput;
      var spectrumScaleFactor = spectrum.yScaleFactor;

      if (currentsfinput = document.getElementById("current-sf"))
        currentsfinput.value = needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed();
      return;
    }
    });
  }
}

SpectrumChartD3.prototype.setSpectrumScaleFactorWidget = function(d) {
  this.options.scaleBackgroundSecondary = d;
  this.drawScalerBackgroundSecondary();
}

SpectrumChartD3.prototype.handleMouseMoveScaleFactorSlider = function() {
  var self = this;

  function needsDecimal(num) {
    return num % 1 != 0;
  }

  /* Here is a modified, slightly more efficient version of redraw 
    specific to changing the scale factors for spectrums. 
  */
  function scaleFactorChangeRedraw(spectrum, linei) {
    self.updateLegend();
    self.rebinSpectrum(spectrum, linei);
    self.do_rebin();
    self.rebinForBackgroundSubtract();
    self.setYAxisDomain();
    self.drawYTicks();
    self.update();
    self.drawPeaks();
  }

  return function() {
    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length )
      return;
    if (!self.currentlyAdjustingSpectrumScale)
      return;

    /* Check for the which corresponding spectrum line is the background */
    var linei = null;
    var spectrum = null;
    for (var i = 0; i < self.rawData.spectra.length; ++i) {
      if (self.rawData.spectra[i].title.toUpperCase() == self.currentlyAdjustingSpectrumScale.toUpperCase()) {
        linei = i;
        spectrum = self.rawData.spectra[i];
        break;
      }
    }

    d3.event.preventDefault();
    d3.event.stopPropagation();

    if (linei == null || spectrum == null)
      return;

    d3.select(document.body).style("cursor", "pointer");

    var m = d3.mouse(spectrum.sliderRect[0][0]);
    var minrange = spectrum.scale.range()[0], maxrange = spectrum.scale.range()[1];
    var min = spectrum.scale.domain()[0];
    var max = spectrum.scale.domain()[1];

    var spectrumScaleFactor = Math.min(Math.max(min, spectrum.scale.invert(m[0])), max);
    var spectrumTitle = spectrum.title ? spectrum.title : "Spectrum " + i;  /* If spectrum doesn't have a title, use the format "Spectrum #" instead */

    spectrum.sliderToggle.attr("cx", spectrum.scale(spectrumScaleFactor));
    spectrum.sliderText.text(spectrumTitle + " Scale Factor: " + (needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed()));
    self.rawData.spectra[linei].yScaleFactor = spectrumScaleFactor;

    // If we are using background subtract, we have to redraw the entire chart if we update the scale factors
    if (self.options.backgroundSubtract) self.redraw()();
    else scaleFactorChangeRedraw(spectrum, linei);

    var currentsfinput;
    if (self.currentDropDownScaleFactorSpectrum == spectrumTitle && (currentsfinput = document.getElementById("current-sf")))
      currentsfinput.value = needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed();

    /* Update the slider chart if needed */
    if (self["sliderLine"+linei]) {
      var origdomain = self.xScale.domain();
      var origdomainrange = self.xScale.range();
      var origrange = self.yScale.domain();
      var bounds = self.min_max_x_values();
      var maxX = bounds[1];
      var minX = bounds[0];

      /* Change the x and y-axis domain to the full range (for slider lines) */
      self.xScale.domain([minX, maxX]);
      self.xScale.range([0, self.size.sliderChartWidth]);
      self.do_rebin();
      self.rebinForBackgroundSubtract();
      self.yScale.domain(self.getYAxisDomain());

      self.rawData.spectra.forEach(function(spec, speci) {
        if (self["sliderLine"+speci])
          self["sliderLine"+speci].attr("d", self["line"+speci](spec[self.options.backgroundSubtract ? 'bgsubtractpoints' : 'points']));
      })
      

      /* Restore the original x and y-axis domain */
      self.xScale.domain(origdomain);
      self.xScale.range(origdomainrange);
      self.do_rebin();
      self.rebinForBackgroundSubtract();
      self.yScale.domain(origrange);
    }
  }
}

SpectrumChartD3.prototype.handleTouchMoveAdjustSpectrumScale = function() {
  var self = this;

  function needsDecimal(num) {
    return num % 1 != 0;
  }

  /* Here is a modified, slightly more efficient version of redraw 
    specific to changing the scale factors for spectrums. 
  */
  function scaleFactorChangeRedraw(spectrum, linei) {
    self.updateLegend();
    self.rebinSpectrum(spectrum, linei);
    self.do_rebin();
    self.setYAxisDomain();
    self.drawYTicks();
    self.update();
    self.drawPeaks();
  }

  return function() {
    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length )
      return;
    if (!self.currentlyAdjustingSpectrumScale)
      return;


    /* Check for the which corresponding spectrum line is the background */
    var linei = null;
    var spectrum = null;
    for (var i = 0; i < self.rawData.spectra.length; ++i) {
      if (self.rawData.spectra[i].title.toUpperCase() == self.currentlyAdjustingSpectrumScale.toUpperCase()) {
        linei = i;
        spectrum = self.rawData.spectra[i];
        break;
      }
    }

    if (linei == null || spectrum == null)
      return;

    d3.event.preventDefault();
    d3.event.stopPropagation();

    var t = d3.touches(spectrum.sliderRect[0][0]);;

    if (t.length !== 1)
      return;
    t = t[0];

    var minrange = spectrum.scale.range()[0], maxrange = spectrum.scale.range()[1];
    var min = spectrum.scale.domain()[0];
    var max = spectrum.scale.domain()[1];

    var spectrumScaleFactor = Math.min(Math.max(min, spectrum.scale.invert(m[0])), max);
    var spectrumTitle = spectrum.title ? spectrum.title : "Spectrum " + (i + 1);  /* If spectrum doesn't have a title, use the format "Spectrum #" instead */

    spectrum.sliderToggle.attr("cx", spectrum.scale(spectrumScaleFactor));
    spectrum.sliderText.text(spectrumTitle + " Scale Factor: " + (needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed()));
    self.rawData.spectra[linei].yScaleFactor = spectrumScaleFactor;

    scaleFactorChangeRedraw(spectrum, linei);

    var currentsfinput;
    if (self.currentDropDownScaleFactorSpectrum == spectrumTitle && (currentsfinput = document.getElementById("current-sf")))
      currentsfinput.value = needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed();

    /* Update the slider chart if needed */
    if (self["sliderLine"+linei]) {
      var origdomain = self.xScale.domain();
      var origdomainrange = self.xScale.range();
      var origrange = self.yScale.domain();
      var bounds = self.min_max_x_values();
      var maxX = bounds[1];
      var minX = bounds[0];

      /* Change the x and y-axis domain to the full range (for slider lines) */
      self.xScale.domain([minX, maxX]);
      self.xScale.range([0, self.size.sliderChartWidth]);
      self.do_rebin();
      self.yScale.domain(self.getYAxisDomain());

      self.rawData.spectra.forEach(function(spec, speci) {
        if (self["sliderLine"+speci])
          self["sliderLine"+speci].attr("d", self["line"+speci](spec.points));
      })

      /* Restore the original x and y-axis domain */
      self.xScale.domain(origdomain);
      self.xScale.range(origdomainrange);
      self.do_rebin();
      self.yScale.domain(origrange);
    }
  }
}


/**
 * -------------- Peak ROI/Label Rendering Functions --------------
 */
SpectrumChartD3.prototype.drawPeaks = function() {
  var self = this;

  self.peakVis.selectAll("*").remove();

  if( !this.rawData || !this.rawData.spectra ) 
    return;

  var minx = self.xScale.domain()[0], maxx = self.xScale.domain()[1];

  function offset_integral(roi,x0,x1){
    if( roi.type === 'NoOffset' )
      return 0.0;
    if( roi.type === 'External' ){
      console.log( 'External contrinuum not supported yet' );
      return 0.0;
    }

    x0 -= roi.referenceEnergy; x1 -= roi.referenceEnergy;
    var answer = 0.0;
    for( var i = 0; i < roi.coeffs.length; ++i )
      answer += (roi.coeffs[i]/(i+1)) * (Math.pow(x1,i+1) - Math.pow(x0,i+1));
    return Math.max( answer, 0.0 );
  }

  function roiPath(roi,points,bgsubtractpoints,scaleFactor,background){
    var yl, yr;
    var lpx = self.xScale(roi.lowerEnergy), rpx = self.xScale(roi.upperEnergy);

    var paths = [];
    var bisector = d3.bisector(function(d){return d.x;});
    var xstartind = bisector.left( points, Math.max(roi.lowerEnergy,minx) );
    var xendind = bisector.right( points, Math.min(roi.upperEnergy,maxx) );

    // Boolean to signify whether to subtract points from background
    const useBackgroundSubtract = self.options.backgroundSubtract && background;

    if( xstartind>= (points.length-2) )
      return paths;
      
    if( xendind >= (points.length-2) )
      xendind = points.length - 2;

    /*The continuum values used for the first and last bin of the ROI are fudged */
    /*  for now...  To be fixed */

    /*XXX - Need to check continuum type!!! */

    var thisy = null, thisx = null, m, s, peak_area, cont_area;
    
    
    var firsty = offset_integral( roi, points[xstartind-(xstartind?1:0)].x, points[xstartind+(xstartind?0:1)].x ) * scaleFactor;

    // Background Subtract - Subtract the initial y-value with the corresponding background point
    if (useBackgroundSubtract) {
      var bi = bisector.left(background.points, points[xstartind-(xstartind?1:0)].x);
      firsty -= background.points[bi] ? background.points[bi].y : 0;
    }
    
    paths[0] = "M" + self.xScale(points[xstartind].x) + "," + self.yScale(firsty) + " L";
    for( var j = 0; j < roi.peaks.length; ++j )
      paths[j+1] = "";

    for( var i = xstartind; i < xendind; ++i ) {
      thisx = 0.5*(points[i].x + points[i+1].x);
      thisy = offset_integral( roi, points[i].x, points[i+1].x ) * scaleFactor;

      // Background Subtract - Subtract the current y-value with the corresponding background point
      if (useBackgroundSubtract) {
        var bi = bisector.left(background.points, points[i].x);
        thisy -= background.points[bi] ? background.points[bi].y : 0; 
      }

      paths[0] += " " + self.xScale(thisx) + "," + self.yScale(thisy);
      for( var j = 0; j < roi.peaks.length; ++j ) {
        m = roi.peaks[j].Centroid[0];
        s = roi.peaks[j].Width[0];
        if( thisx > (m - 5*s) && thisx < (m+5*s) ){
          if( !paths[j+1].length )
            paths[j+1] = "M" + self.xScale(thisx) + "," + self.yScale(thisy) + " L";
          else
            paths[j+1] += " " + self.xScale(thisx) + "," + self.yScale(thisy);
        }
      }
    }

    function erf(x) {
      /*http:/*stackoverflow.com/questions/14846767/std-normal-cdf-normal-cdf-or-error-function */
      var sign = (x >= 0) ? 1 : -1; /* save the sign of x */
      x = Math.abs(x);
      var a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027
          a5 = 1.061405429, p  = 0.3275911;
      var t = 1.0/(1.0 + p*x);
      var y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
      return sign * y; /* erf(-x) = -erf(x); */
    }

    function gaus_integral( peak, x0, x1 ) {
      var peak_mean = peak.Centroid[0], peak_sigma = peak.Width[0], peak_amplitude = peak.Amplitude[0];
         /*peak.LandauAmplitude, peak.LandauMode, peak.LandauSigma, */
      var sqrt2 = 1.414213562373095;
      var erflowarg = (x0-peak_mean)/(sqrt2*peak_sigma);
      var erfhigharg = (x1-peak_mean)/(sqrt2*peak_sigma);
      return peak_amplitude * 0.5 * (erf(erfhigharg) - erf(erflowarg));
    };

    var bisector = d3.bisector(function(d){return d.x;});
    for( var i = xendind - 1; i >= xstartind; --i ) {
      peak_area = 0.0;
      thisx = 0.5*(points[i].x + points[i+1].x);
      cont_area = offset_integral( roi, points[i].x, points[i+1].x ) * scaleFactor;

      // Background Subtract - Subtract the current y-value with the corresponding background point
      if (useBackgroundSubtract) cont_area -= background.points[bisector.left(background.points, points[i].x)].y;

      roi.peaks.forEach( function(peak,peakn){
        if( peak.type !== 'GaussianDefined' ){
          console.log( 'Need to implement peak.type==' + peak.type );
          return;
        }
        if( peak.skewType !== 'NoSkew' )
          console.log( 'Need to implement peak skew type ' + peak.skewType );
        var area = gaus_integral( peak, points[i].x, points[i+1].x );
        peak_area += area * scaleFactor;

        m = peak.Centroid[0];
        s = peak.Width[0];
        if( thisx > (m - 5*s) && thisx < (m+5*s) ){
          paths[peakn+1] += " " + self.xScale(thisx) + "," + self.yScale(cont_area + area);
        }
      });

      paths[0] += " " + self.xScale(thisx) + "," + self.yScale( peak_area + cont_area);
    }

    for( var i = 0; i < paths.length; ++i ) {
      var ind = paths[i].indexOf("L");
      if( ind > 2 )
        paths[i] += " " + paths[i].substr(1,ind-2);
    }
    /*path += " " + self.xScale(points[xstartind].x) + "," + self.yScale(firsty); */

    return paths;
  }/*function roiPath(roi) */

  function draw_roi(roi,specindex,spectrum) {
      /* roi:
      {
        type:'Linear',
        lowerEnergy:164.878,
        upperEnergy:203.311,
        referenceEnergy:164.878,
        coeffs:[49.2491,-0.365196],
        coeffUncerts:[2.88764,0.13389],
        fitForCoeff:[true,true],
        peaks: [
          {
            type:'GaussianDefined',
            skewType:'NoSkew',
            Centroid:[182.846,1.80707,true],
            Width:[7.17482,0.979233,true],
            Amplitude:[288.679,44.8641,true],
            LandauAmplitude:[0,-1,false],
            LandauMode:[0,-1,false],
            LandauSigma:[0,-1,false],
            Chi2:[0.573405,-1,false],
            forCalibration:true,
            forSourceFit:true,
            type:'NormalGamma',
            nuclide: {
              name: 'Mo99',
              decayParent:'Mo99',
              decayChild:'Tc99',
              DecayGammaEnergy:181.063
            }
          }]
        }
        */

        if( roi.type !== 'NoOffset' && roi.type !== 'Constant'
            && roi.type !== 'Linear' && roi.type !== 'Quardratic'
            && roi.type !==  'Cubic'  ){
          console.log( 'unrecognized roi.type: ' + roi.type );
          return;
        }

        if( roi.lowerEnergy > maxx || roi.upperEnergy < minx )
          return;

        if (!spectrum) {
          console.log("No spectrum specified to draw peaks");
          return;
        }

        let scaleFactor = spectrum.type !== self.spectrumTypes.FOREGROUND ? spectrum.yScaleFactor * 1.0 : 1.0;
        if (typeof scaleFactor === 'undefined' || scaleFactor === null) scaleFactor = 1.0;

        var paths = roiPath( roi, spectrum.points, spectrum.bgsubtractpoints, scaleFactor, self.getSpectrumByID(spectrum.backgroundID) );
        paths.forEach( function(p,num){
          if( num===1 && paths.length===2 )
            return;
          var path = self.peakVis.append("path")
            .attr("d", p );

          var labels = [],
              labelAlreadyAdded = false;

          if (!self.peakLabelArray)                       /* This is a hack for gettng the correct highlighted peak to correspond with its label. */
            self.peakLabelArray = [];                     /* Declare an array of tuples that have a corresponding peak DOM with a label text*/
          if (!self.leftoverPeakLabels)
            self.leftoverPeakLabels = [];

          if (self.leftoverPeakLabels.length > 0) {                                                    /* If there are still leftover labels not corresponding with a peak, then it */
            self.peakLabelArray.push( { "path": path, "label": self.leftoverPeakLabels.shift() } );  /* is the current peak's label */
            labelAlreadyAdded = true;
          }
          else
            for (i = 0; i < roi.peaks.length; i++) {                                                      /* Draw a label for each peak inside an ROI, put it in the label vector */
              var peak = roi.peaks[i],
                  label = self.drawPeakLabelCassowary(peak, path);
              self.peakLabelData.push({
                specindex: specindex,
                path: path,
                paths: paths,
                roi: roi,
                peak: peak,
                lowerEnergy: roi.lowerEnergy,
                upperEnergy: roi.upperEnergy,
              })
              if (label)
                labels.push(label);
            }

          if (labels.length > 0 && !labelAlreadyAdded)                                  /* The first element inside the labels vector is the current peak's label */
            self.peakLabelArray.push( { "path": path, "label": labels.shift() } );

          self.leftoverPeakLabels = self.leftoverPeakLabels.concat(labels);         /* Any leftover peaks are put inside this array */

          /* Highlights a specified peak (darken the context) */
          function highlightPeak(d, peak) {
            if (self.zooming_plot)
              return;

            if (self.highlightedPeak)
              unhighlightPeak(0, self.highlightedPeak);

            var thePeak = this;
            console.log(thePeak);
            if (d3.event == null || d3.event.touches) {
              thePeak = peak;
              if (!thePeak || thePeak.attr("fill-opacity") != 0.6)
                return;
            }

            if (d3.select(thePeak).attr("fill-opacity") != 0.6)
              return;

            if (self.leftMouseDown || self.rightClickDown)
              return;

            if (!peak) {
              if (paths.length === 2) 
                d3.select(thePeak).attr("fill-opacity",0.8);
              else
                d3.select(thePeak).attr("stroke-width",2).attr("fill-opacity",0.8);

            } else {
              if (paths.length === 2) 
                peak.attr("fill-opacity",0.8);
              else
                peak.attr("stroke-width",2).attr("fill-opacity",0.8);
            }

            if (d3.select(thePeak)[0].parentNode) {    /* if the 'this' pointer is the path for the peak, then declare the highlighted peak to be that */
              self.highlightedPeak = thePeak;
            } else if (peak)
              self.highlightedPeak = peak;

            for (i = 0; i < self.peakLabelArray.length; i++)
              if (self.peakLabelArray[i].path === (peak ? peak : path)) {
                self.peakLabelArray[i].label.attr('stroke', 'black')
                  .attr("z-index", 100);
                self.highlightedLabel = self.peakLabelArray[i].label;
              }
          }

          self.unhighlightPeakFunc = self.unhighlightPeak.bind(self, null, null, paths);
          self.highlightPeakFunc = self.highlightPeak.bind(self, null, null, paths, path); 

          function onRightClickOnPeak() {
            console.log("Emit RIGHT CLICK (ON PEAK) signal. (Peak roi = ", roi, ")");
          }

          self.peakPaths.push({
            path: path,
            paths: paths,
            roi: roi,
            lowerEnergy: roi.lowerEnergy,
            upperEnergy: roi.upperEnergy,
          });

          if( num === 0 ){
            path.attr("class", "roi spectrum-peak-" + specindex)
              .style("fill", spectrum.peakColor)
              .attr("fill-opacity",0.6);

            if( paths.length === 2 ){
              path.attr("stroke-width",1)
                .attr("stroke", spectrum.peakColor )
                .on("mouseover", function(d, peak) { self.handleMouseOverPeak(this, d, peak, paths, roi, path) } )
                .on("mousemove", self.handleMouseMovePeak())
                .on("touchend", self.highlightPeak.bind(self, null, null, paths, path))
                .on("mouseout", function(d, peak) { self.handleMouseOutPeak(this, d, peak, paths); } );
            }

          } else {
            path/* .attr("class", "peak") */
            .attr("class", "spectrum-peak-" + specindex)
              .style("fill", spectrum.peakColor )
              .attr("fill-opacity",0.0)
              .attr("stroke-width",1)
              .attr("stroke", spectrum.peakColor );

          }

          /* For right-clicking on a peak */
          path.on("contextmenu", onRightClickOnPeak);
        });
  };

  self.peakPaths = [];
  self.peakLabelData = [];
  for (let i = 0; i < this.rawData.spectra.length; i++) {
    let spectrumi = i;
    if (!this.rawData.spectra[i] || !this.rawData.spectra[i].peaks || !this.rawData.spectra[i].peaks.length)
      continue;
    if ((this.rawData.spectra[i].type === 'FOREGROUND' && !this.options.drawPeaksFor.FOREGROUND))
      continue;
    if ((this.rawData.spectra[i].type === 'BACKGROUND' && (!this.options.drawPeaksFor.BACKGROUND || this.options.backgroundSubtract)))
      continue;
    if ((this.rawData.spectra[i].type === 'SECONDARY' && !this.options.drawPeaksFor.SECONDARY))
      continue;

    this.rawData.spectra[i].peaks.forEach( function(roi){
      draw_roi(roi,i,self.rawData.spectra[spectrumi]);
      
      /*console.log( 'There are ' + (peaks ? peaks.length : 'null') + " peaks" ); */
    });
    
    if( self.current_fitting_peak )
      draw_roi( self.current_fitting_peak, 0, self.rawData.spectra[0] /* foreground */ );
  }
}

SpectrumChartD3.prototype.drawPeakLabelCassowary = function(peak,path) {
  var self = this;

  if ( self.options.showUserLabels || self.options.showPeakLabels || self.options.showNuclideNames ) {
      var chartBox = d3.select("#chartarea"+self.chart.id)[0][0].getBBox();    /* box coordinates for the chart area */

      // Don't draw peak label if chart isn't set up yet
      if (!chartBox.width || !chartBox.height)
        return;

      self.solver = new c.SimplexSolver();        /* Initialize a default, new solver for each label creation */
      var chart = self.peakVis;
      var pathNode = path.node();                 /* node for the peak element */

      /*
      The path box coordinates are the box coordinates for the peak. These are used for positioning the label properly
      with respect to the peak.
      */
      var pathX = pathNode.getBBox().x,
          pathY = pathNode.getBBox().y,
          pathBoxHeight = pathNode.getBBox().height,
          pathBoxWidth = pathNode.getBBox().width,
          pathBoxMiddle = (pathX + pathBoxWidth) / 2;

      var peakEnergy = peak.Centroid[0].toFixed(2) + " keV";
      var nuclide = peak.nuclide;
      var userLabelText = peak.userLabel;

      var label, userLabel, peakEnergyLabel, nuclideNameLabel;

      /* Main label DOM */
      label = chart.append("text");
      label.attr('class', 'label')
        .attr("text-anchor", "start")
        .attr("x", pathX)
        .attr("y", pathY - 10 )
        .attr("energy", peakEnergy);

      if (self.options.showUserLabels) {                      /* T-span element for the user label */
        if (userLabelText) {                                  /* Gets priority for top-most text in label */
          userLabel = label.append("tspan");
          userLabel.attr("class", "userLabel")
            .attr("x", pathX)
            .attr("dy", 0)
            .text(userLabelText)
            .style('font-size', '7.5px');
        }
      }

      if (self.options.showPeakLabels) {                      /* T-span element for the peak label */
          peakEnergyLabel = label.append("tspan");            /* Gets second in priority for top-most text in label */
          peakEnergyLabel.attr("class", "peakEnergyLabel")
            .attr("x", pathX)
            .attr("dy", userLabel ?  "1em" : 0)              /* If user label is not present, then this is the top-most element */
            .text(peakEnergy)
            .style('font-size', '7.5px');

          /* if (userLabel) */
          /*   peakEnergyLabel.attr("dx", -userLabel.node().getBBox().width/2); */
      }

      if (self.options.showNuclideNames && nuclide) {         /* T-span element for nuclide label */
        nuclideNameLabel = label.append("tspan");             /* Third in priority for top-most text in label */
        nuclideNameLabel.attr("class", "nuclideLabel")
          .attr("x", pathX)
          .attr("dy", self.options.showUserLabels && self.options.showPeakLabels ? "1em" : self.options.showUserLabels || self.options.showPeakLabels ?  "1em" : 0)
          /* .attr("dx", -label.node().getBBox().width/2)                */
          .text(nuclide.name)
          .style('font-size', '7.5px');
      }

      if ( !userLabel && !peakEnergyLabel && !nuclideNameLabel) {      /* Do not display an label if the user label, peak label, or nuclide name label are not displayed */
        label.remove();                                                     /* This means that although nuclide energy label option is selected, it is not displayed! */
        return;
      }

      if (self.options.showNuclideEnergies && nuclide) {                    /* Nuclide energy label displayed only if nuclide name labels are displayed! */
        if (self.options.showNuclideNames)
          nuclideNameLabel.text(nuclide.name + ", " + nuclide.DecayGammaEnergy.toString() + " keV" );
      }

      /* Inequality constants for constraints */
      var greaterThan = c.GEQ,
          lessThan = c.LEQ;

      /*
      Strengths of constraints: These determine the prioirity of which constraints are given for a specific label.
      A required constraint means it must be followed, or else a Constraint Error is thrown.
      A strong constraint isn't required, but has priority over weaker constraints. (and so on for the weaker consraints.
      */
      var weak = c.Strength.weak,
          medium = c.Strength.medium,
          strong = c.Strength.strong,
          required = c.Strength.required;

      /*
      Create variable values for the Constraint Solver to handle. In particular, for centering each label at 
      the center of the peak, we want to capture the left-x value, the mid-point x-value, the width of the label,
      and the middle x-value for the path box of a peak.

      Initially, we provided the starting coordiantes for the labels and initialized their values in their variable creation.
      What we want to get in the end of adding all the constraints are different values for these positions so that the label placement
      is exactly where we want it to be.
      */
      var labelLeftX = new c.Variable ( { value : pathX } ),                                                       /* Left coordinate for label */
          labelRightY = new c.Variable ( { value : pathX + label.node().getBBox().width } ),                       /* Right coordinate for label */
          labelTopY = new c.Variable ( { value : label.node().getBBox().y } ),                                     /* Top coordinate for label */
          labelBottomY = new c.Variable ( { value : label.node().getBBox().y + label.node().getBBox().height } ),  /* Bottom coordinate for label */
          labelMid = new c.Variable( { value : (pathX + (label.node().getBBox().width) / 2) } ),                   /* Mid-point coordinate for label (in terms of x) */
          labelHeight = new c.Variable( { value : label.node().getBBox().height } ),                               /* Height of label */
          labelWidth = new c.Variable( { value : label.node().getBBox().width } ),                                 /* Width of label */
          peakMid = new c.Variable( { value : pathX + (pathBoxWidth / 2) } );                                      /* Mid-point for the box for the peak element */

      var cle;  /* These are reusable variables for creating equations for constraints. */

      /*
      Christian:
      The mid-point x-value of a peak and the width of the label will be staying constant throughout each added constraint.
      Add these constraints into the Constraint Solver.
      */
      self.solver.addConstraint(new c.StayConstraint( peakMid, required  ) );           /* mid-point of the box for the peak element stays constant (you're not moving the peak!) */
      self.solver.addConstraint(new c.StayConstraint( labelHeight, required  ) );       /* keep height constant */
      self.solver.addConstraint(new c.StayConstraint( labelWidth, required  ) );        /* keep width constant */
      self.solver.addConstraint(new c.StayConstraint( labelTopY, weak ) );             /* try to keep initial y-position constant (right above the peak) */



      /*
      Label assertions for the mid-point, width, and height values for a label. 
      These keep the internal size of a label consistent of what it currently is.
      */
      cle = c.plus(labelLeftX, c.divide(labelWidth, 2));                   
      var labelMidPointAssertion = new c.Equation( labelMid, cle );      /* Left-x + (width/2) == mid-point */

      cle = c.plus(labelLeftX, labelWidth);
      var labelWidthAssertion = new c.Equation( labelRightY, cle );      /* left-x + width == right-x */

      cle = c.plus(labelTopY, labelHeight);     
      var labelHeightAssertion = new c.Equation( labelBottomY, cle );    /* top-y + height == bottom-y */

      /* var original_area = labelHeight.value * labelWidth.values */

      self.solver.addConstraint( labelMidPointAssertion );           
      self.solver.addConstraint( labelWidthAssertion );
      self.solver.addConstraint( labelHeightAssertion );

      /*
      Label position assertions. These are added again to keep the size of the label consistent and accurate for collision detection with other elements.
      For example, the bottom coordinate of a label is always equal to the top_coordinate + height.
      Although many of these are obvious, it is important for consistency in collision detection.
      */
      self.solver.addConstraint( new c.Equation(labelTopY, c.minus(labelBottomY, labelHeight) ) );         /* labelTopY = labelBottomY - label height */
      self.solver.addConstraint( new c.Equation(labelBottomY, c.plus(labelTopY, labelHeight) ) );          /* label bottom y = label top y + label height */
      self.solver.addConstraint( new c.Equation(labelLeftX, c.minus(labelRightY, labelWidth) ) );          /* label left x = label right x - label width */
      self.solver.addConstraint( new c.Equation(labelRightY, c.plus(labelLeftX, labelWidth) ) );           /* label right x = label left x + label width */

      self.solver.addConstraint( new c.Equation(labelHeight, c.minus(labelBottomY, labelTopY) ) );         /* label height = labelBottomY - labelTopY */
      self.solver.addConstraint( new c.Equation(labelWidth, c.minus(labelRightY, labelLeftX) ) );          /* label width = labelRightY - labelLeftX   */
      self.solver.addConstraint( new c.Equation(labelMid, c.plus(labelLeftX, c.divide(labelWidth, 2) ) ) ); /* label mid-point = lable_leftX + (labelWidth/2) */

      self.solver.addConstraint( new c.Inequality( labelMid, greaterThan, labelLeftX ) );     /* mid-point coordinate > left coordinate */
      self.solver.addConstraint( new c.Inequality( labelRightY, greaterThan, labelLeftX) );  /* right coordinate > left coordinate */
      self.solver.addConstraint( new c.Inequality( labelBottomY, greaterThan, labelTopY ) ); /* bottom coordinate > top coordinate */

      /* Label does not fall out of bounds - constraints */
      self.solver.addConstraint( new c.Inequality(labelLeftX, greaterThan, 0) );                      /* Left coordinate does not fall out of bounds to the left */
      self.solver.addConstraint( new c.Inequality(labelTopY, greaterThan, self.padding.top*2) );      /* Top coordinate does not fall out of bounds from the top */
      self.solver.addConstraint( new c.Inequality( labelRightY, lessThan, chartBox.x + chartBox.width ) );        /* Right coordinate does not exceed right bounds of chart */
      self.solver.addConstraint( new c.Inequality( labelBottomY, lessThan, chartBox.y + chartBox.height ) );      /* Bottom coordinate does not exceed bottom bounds of chart */
      self.solver.addConstraint( new c.Inequality(labelBottomY, greaterThan, self.padding.top*2) );   /* Bottom coordinates does not fall out of bounds from the top */

      /* self.solver.addConstraint( new c.Inequality( labelBottomY, lessThan, pathY, weak) );   /* bottom y for label is above peak box */


      /*
      To align the label properly with the peak, we try to keep the mid-point x-coordinate of a label
      aligned with the middle of the box for a peak element. To do this, we try to set the mid-point value
      for the label equal to the mid-point value for a peak's box.
      */
      var labelMidAtPeakMid = new c.Equation(labelMid, peakMid, strong, 5)
      self.solver.addConstraint( labelMidAtPeakMid );


      var numberOfSamePeaks = 1,                       /* keeps track of the number of the same peak labels */
          ypadding = 10,                                  /* y-padding between labels */
          xpadding = 20;                                  /* x-padding between labels */

      /* Returns true if another label overlaps the current label from the top. */
      function overlapFromTop(topY, otherLabel) {
        otherLabelSelect = d3.select(otherLabel);

        var otherLabelTopY = Number( ( otherLabelSelect.attr('y') == null ? otherLabel.getBBox().y : otherLabelSelect.attr('y') ) );
        var otherLabelBottomY = otherLabelTopY + otherLabel.getBBox().height;
        return otherLabelTopY < topY && otherLabelBottomY >= topY;
      }
      /* Returns true if another label overlaps the current label from the bottom. */
      function overlapFromBottom(topY, bottomY, otherLabel) {
        otherLabelSelect = d3.select(otherLabel);
        var otherLabelTopY = Number( ( otherLabelSelect.attr('y') == null ? otherLabel.getBBox().y : otherLabelSelect.attr('y') ) );
        return otherLabelTopY > topY && otherLabelTopY <= bottomY;
      }
      /* Returns true if another label overlaps the current label from the left side. */
      function overlapFromLeftSide(leftX, rightX, otherLabel){
        otherLabelSelect = d3.select(otherLabel);
        var otherLabelLeftX =  Number( ( otherLabelSelect.attr('x') == null ? otherLabel.getBBox().x : otherLabelSelect.attr('x') ) );
        var otherLabelRightY = otherLabelLeftX + otherLabel.getBBox().width;
        return otherLabelRightY >= leftX && otherLabelRightY <= rightX;
      }
      /* Returns true if another label overlaps the current label from the right side. */
      function overlapFromRightSide(leftX, rightX, otherLabel){
        otherLabelSelect = d3.select(otherLabel);
        var otherLabelLeftX =  Number( ( otherLabelSelect.attr('x') == null ? otherLabel.getBBox().x : otherLabelSelect.attr('x') ) );
        var otherLabelRightY = otherLabelLeftX + otherLabel.getBBox().width;
        return otherLabelLeftX <= rightX && otherLabelLeftX >= leftX;
      }
      /* Returns true if another label overlaps the current label directly. (Same left and top coordinates) */
      function overlapDirectly(leftX, topY, otherLabel){
        otherLabelSelect = d3.select(otherLabel);
        var otherLabelLeftX =  Number( ( otherLabelSelect.attr('x') == null ? otherLabel.getBBox().x : otherLabelSelect.attr('x') ) );
        var otherLabelTopY = Number( ( otherLabelSelect.attr('y') == null ? otherLabel.getBBox().y : otherLabelSelect.attr('y') ) );
        return otherLabelTopY == topY && otherLabelLeftX == leftX;
      }
      /* Returns true if another label overlaps the current label from anywhere. */
      function overlap( leftX, rightX, topY, bottomY, otherLabel  ) {
        var overlapFromSide = overlapFromLeftSide(leftX, rightX, otherLabel) || overlapFromRightSide(leftX, rightX, otherLabel);

        return (overlapFromTop(topY, otherLabel) && overlapFromSide) || 
               (overlapFromBottom(topY, bottomY, otherLabel) && overlapFromSide) ||
               (overlapFromSide && topY == Number(otherLabelSelect.attr('y'))) ||
               overlapDirectly(leftX, topY, otherLabel);
      }
      /* Adds a required inequality to the constraint solver. If an error is thrown and te required inequality cannot be added,
         then the inequality is changed to have a "strong" strength 
      */
      function addRequiredInequality( variable, inequality, value, otherLabel ) {
        try { self.solver.addConstraint( new c.Inequality( variable, inequality, value, required ), required ); }
        catch (e) { 
          console.log("Failed to make a constraint 'required', so making it 'strong'. Constraint was for ", peakEnergy, " on ", otherLabel.textContent);
          self.solver.addConstraint( new c.Inequality( variable, inequality, value, strong, 100 ), required ); 
        }
      }



      /*
      Main function called for fixing the overlaps for a label. To sum up how this function works:

        1. For each of the previous peaks drawn before this current label being drawn

          a.  If that box for a peak overlaps the current label from the side (but have the same top-coordinate values)
            i)  Move the current label to the right and down

          b.  Else if the box for a peak overlaps the current label from the top and to the side
            i)  Move the current label down

          c.  Else if the box for a peak overlaps the current label from the bottom and to the side
            i)  Move the current label up.

        2. For each of the previous labels drawn before this current label being drawn

          a.  If that other label overlaps the current label directly (same left and top coordiantes)
            i)  Move the current label down

          b.  Else if the other label overlaps the current label from the side, but the top coordinate values are the same
            i)  Move the current label to the right
            ii) Move the current label down

          c.  Else if the other label overlaps the current label from the side and the top
            i)  Move the current label down

          d.  Else if the other label overlaps the current label from the bottom and the side
            i)  Move the current label up
      */
      function fixOverlaps() {
        var overlappedLabels = [];

        /* For overlapping peaks - not yet finsihed! */
        self.peakVis.selectAll("path").each(function(d, i) {
          var peak = d3.select(this),
              peakBox = peak.node().getBBox();

          var peakLeftX =  peakBox.x,
              peakRightX = peakLeftX + peakBox.width,
              peakTopY = peakBox.y,
              peakBottomY = peakTopY + peakBox.height;

          var peakOverlapsFromTop = overlapFromTop(labelTopY.value, peak.node()),
              peakOverlapsFromBottom = overlapFromBottom(labelTopY.value, labelBottomY.value, peak.node()),
              peakOverlapsFromSide = overlapFromLeftSide( labelLeftX.value, labelRightY.value, peak.node() ) || 
                                        overlapFromRightSide(labelLeftX.value, labelRightY.value, peak.node()),
              overlapping = overlap(labelLeftX.value, labelRightY.value, labelTopY.value, labelBottomY.value, peak.node());

          if (overlapping) {
            /* console.log(peakEnergy, " overlaps the peak ", peak.node()); */

            if (peakOverlapsFromSide && labelTopY.value == peakTopY) {
              /* console.log(otherLabel.textContent, " is overlapping ", text, " from side, so moving ", text, " down."); */
              addRequiredInequality( labelLeftX, greaterThan, peakRightX+xpadding, peak );                         /* move label to the right */
              addRequiredInequality( labelTopY, greaterThan, peakBottomY+ypadding, peak );                         /* move label down */
            }
            else if (peakOverlapsFromTop && peakOverlapsFromSide) {
              /* console.log(otherLabel.textContent, " is overlapping ", text, " from top, so moving ", text, " down."); */
              addRequiredInequality( labelTopY, greaterThan, peakBottomY+ypadding, peak );                         /* move label down */
            }
            else if (peakOverlapsFromBottom && peakOverlapsFromSide) {
              /* console.log(otherLabel.textContent, " is overlapping ", text, " from bottom, so moving ", text, " up."); */
              addRequiredInequality( labelBottomY, lessThan, peakTopY-ypadding, peak );                            /* move label up */
            }
          }
        });

        self.peakVis.selectAll("text").each(function(d, i){
          otherLabel = d3.select(this).node();

          if (otherLabel != label.node() && otherLabel.textContent == label.node().textContent) {                           /* delete duplicate labels */

                                                                                                                          /* removel label if overlapping directly and same text content */
            if ( !(self.options.showNuclideNames && !self.options.showPeakLabels && !self.options.showNuclideEnergies) || overlapDirectly( labelLeftX.value, labelTopY.value, otherLabel) ) {
              otherLabel.remove();                /* If showing only nuclide name, don't delete duplicates */

            }
            ++numberOfSamePeaks;
          }
          else if ( otherLabel != label.node() ) {
            otherLabelSelect = d3.select(otherLabel);

            var otherLabelLeftX =  Number(otherLabelSelect.attr('x')),
                otherLabelRightY = otherLabelLeftX + otherLabel.getBBox().width,
                otherLabelTopY = Number(otherLabelSelect.attr('y')),
                otherLabelBottomY = otherLabelTopY + otherLabel.getBBox().height;

            /* Get booleans for overlap from other label */
            var otherLabelOverlapsFromTop = overlapFromTop(labelTopY.value, otherLabel),
                otherLabelOverlapsFromBottom = overlapFromBottom(labelTopY.value, labelBottomY.value, otherLabel),
                otherLabelOverlapsFromSide = overlapFromLeftSide( labelLeftX.value, labelRightY.value, otherLabel ) || overlapFromRightSide(labelLeftX.value, labelRightY.value, otherLabel),
                directOverlap = overlapDirectly( labelLeftX.value, labelTopY.value, otherLabel),
                overlapping = overlap(labelLeftX.value, labelRightY.value, labelTopY.value, labelBottomY.value, otherLabel);

            if ( overlapping ) {
              overlappedLabels.push( otherLabel );

              if (directOverlap) {
                addRequiredInequality( labelTopY, greaterThan, otherLabelBottomY+ypadding, otherLabel );                         /* move label down */
              }
              else if (otherLabelOverlapsFromSide && labelTopY.value == otherLabelTopY) {
                /* console.log(otherLabel.textContent, " is overlapping ", text, " from side, so moving ", text, " down."); */
                addRequiredInequality( labelLeftX, greaterThan, otherLabelRightY+xpadding, otherLabel );                         /* move label to the right */
                addRequiredInequality( labelTopY, greaterThan, otherLabelBottomY+ypadding, otherLabel );                         /* move label down */
              }
              else if (otherLabelOverlapsFromTop && otherLabelOverlapsFromSide) {
                /* console.log(otherLabel.textContent, " is overlapping ", text, " from top, so moving ", text, " down."); */
                addRequiredInequality( labelTopY, greaterThan, otherLabelBottomY+ypadding, otherLabel );                         /* move label down */
              }
              else if (otherLabelOverlapsFromBottom && otherLabelOverlapsFromSide) {
                /* console.log(otherLabel.textContent, " is overlapping ", text, " from bottom, so moving ", text, " up."); */
                addRequiredInequality( labelBottomY, lessThan, otherLabelTopY-ypadding, otherLabel );                            /* move label up */
              }
              /* Do something with the font size here */
              /* I tried increasing the font size as much as it can without hitting the other labels, but it seems that it keeps the font at 1vw here. */
              /* self.solver.addConstraint( new c.Inequality( labelHeight, greaterThan, labelHeight.value + 2, strong ) );       /* label height > 1 */
              /* self.solver.addConstraint( new c.Inequality( labelWidth, greaterThan, labelWidth.value + 2, strong ) );  */

            }
          }
          return overlappedLabels;
        });
      }

      var overlappedLabels = fixOverlaps();
      /* fixOverlaps();          /* can uncomment to run fixOverlaps twice, which may optimize how the labels overlap, with the sacrifice for performance */

      /*
      Return label back to its original style.
      This means:
        - Label gets unbolded (if it was already bolded)
        - Label z-index goes back to default instead of being shown at the very top.
        - If an arrow/line is shown from the label to its corresponding peak, then that line/arrow is deleted.
      */
      function normalizeLabel(labelToNormalize) {                     /* Return label back to original style on mouse-out. */

            d3.select(labelToNormalize ? labelToNormalize : this)
              .style('z-index', 0)
              .style('cursor', 'default')
              .attr('stroke', 'none')
              .attr('font-weight', 'normal');

            /* delete the pointer line from the label to the peak */
            if (self.peakLabelLine) {
              self.peakLabelLine.remove();
              self.peakLabelLine = null;
            }
        }

      /*
      Highlight a selected label.
      This means:
        - Label becomes bold
        - Label's z-index goes to very top (so that the whole text is shown)
        - A line is drawn from the label to its corresponding peak
      */
      function highlightLabel() {
            if ( !self.dragging_plot ) {                          /* Bold the label text and add a line (arrow) that points to the peak when moused over text. */
              if ( self.labelToNormalize )
                normalizeLabel(self.labelToNormalize);

              d3.select(this)
                .style('cursor', 'default')
                .attr('stroke', 'black')
                .attr('font-weight', 'bold')
                .attr("z-index", 100);

              var x1, x2, y1, y2;

              if ( labelLeftX.value > peakMid.value ) { x1 = labelLeftX.value; }
              else if ( labelRightY.value < peakMid.value ) {  x1 = labelRightY.value; }
              else { x1 = labelMid.value; }

              /* label heights are sometimes 1, mostly 18 --> look into the constraints why */
              if ( labelTopY.value > pathY && labelBottomY.value > pathY ) {  y1 = labelTopY.value+(labelHeight.value - 10);  }    /* if label is under peak */
              else {  y1 = labelBottomY.value-labelHeight.value + (self.options.showNuclideNames && self.options.showNuclideEnergies ? 10 : 0);  }
                                                                      /* To give some space between label and line */

              x2 = pathX + pathBoxWidth/2; 
              y2 = pathY-2;

               /* Here I am trying to draw an arrow marker for the line from the label to a peak */
               if (!self.peakLabelArrow)
                self.peakLabelArrow = self.peakVis.append('svg:defs').append("svg:marker")
                              .attr("id", "triangle")
                              .attr('class', 'peaklabelarrow')
                              .attr('viewbox', "0 -5 10 10")
                              .attr("refX", 2.5)
                              .attr("refY", 2.5)
                              .attr("markerWidth", 30)
                              .attr("markerHeight", 30)
                              .attr("orient", "auto")
                              .append("path")
                                .attr("d", "M 0 0 20 6 0 12 3 6")
                                .attr("transform", "scale(0.4,0.4)")
                                .style("stroke", "black");

              self.peakLabelLine = self.peakVis.append('line')
                            .attr('class', 'peaklabelarrow')
                            .attr('x1', x1)
                            .attr('y1', y1)
                            .attr('x2', x2)
                            .attr('y2', y2)
                            .attr("marker-end", "url(#triangle)");


            } 

            self.labelToNormalize = this;
          }

      label
        .attr("x", labelLeftX.value)
        .attr("y", labelTopY.value)

        /* Set the font-size here */
        /* .style("font-size", ((labelWidth.value * labelHeight.value) / original_area) + "vw") */

        .on("mouseover", highlightLabel)
        .on("mouseout",  normalizeLabel);

      if (self.isTouchDevice())
          label.on("touchstart", highlightLabel);

      if (userLabel)
        userLabel.attr("x", labelLeftX.value);
      if (peakEnergyLabel)
        peakEnergyLabel.attr("x", labelLeftX.value);
      if (nuclideNameLabel)
        nuclideNameLabel.attr("x", labelLeftX.value);
  }

    return label;

      /* Possible algorithm: Get list of all text nodes. Have a new array of grouped text nodes by overlapped text labels. This array will hold an array 
         of grouped nodes, and once this array has been created and filled, start doing stuff with it. Specifically, replace all those labels with something like
         "5 peaks from 100-200 kEV". Individual nodes will just be outputted normally ("500 kEV"). However, user may lose some information when zoomed all the
         way out of the graph. They would have to zoom-in further to see the peaks.
      */  
}

/* Sets whether or not peaks are highlighted */
SpectrumChartD3.prototype.setShowPeaks = function(spectrum,show) {
  this.options.drawPeaksFor[spectrum] = show;
  this.redraw()();
}

SpectrumChartD3.prototype.setShowUserLabels = function(d) {
  this.options.showUserLabels = d;
  this.redraw()();
}

SpectrumChartD3.prototype.setShowPeakLabels = function(d) {
  console.log('calling show peak labels = ', d);
  this.options.showPeakLabels = d;
  this.redraw()();
}

SpectrumChartD3.prototype.setShowNuclideNames = function(d) {
  this.options.showNuclideNames = d;
  this.redraw()();
}

SpectrumChartD3.prototype.setShowNuclideEnergies = function(d) {
  this.options.showNuclideEnergies = d;
  this.redraw()();
}


/**
 * -------------- Peak Fit Functions --------------
 * 
 * Liza: This function gets called whenever you press and hold the option key  */
/* (alt on non-macs) then click and hold down with the left mouse button,  */
/* and drag to the right.
 */
SpectrumChartD3.prototype.drawPeakFitReferenceLines = function() {
  var self = this;

  if (!self.rawData || !self.rawData.spectra)
    return;

  /* Cancel the function if no mouse position detected */
  if (!self.lastMouseMovePos || !self.leftMouseDown)
    return;

  /* Adjust the mouse move position with respect to the bounds of the vis */
  if (self.lastMouseMovePos[0] < 0)
    self.lastMouseMovePos[0] = 0;
  else if (self.lastMouseMovePos[0] > self.size.width)
    self.lastMouseMovePos[0] = self.size.width;

  /* Set the length of the arrows */
  var arrowLength = 25,
      arrowPadding = 7;

  /* To keep track of some of the line objects being drawn */
  var createPeakMouseCurrentLine,
      startLineArrowLine, currentLineArrowLine,
      startLineArrow, currentLineArrow,
      createPeakMouseText,
      contEstLine, contEstText;

  /* Create the leftmost starting point line  */
  if (d3.select("#createPeakMouseStartLine").empty()) {
    self.vis.append("line")
      .attr("id", "createPeakMouseStartLine")
      .attr("class", "createPeakMouseLine")
      .attr("x1", self.leftMouseDown[0])
      .attr("x2", self.leftMouseDown[0])
      .attr("y1", 0)
      .attr("y2", self.size.height);
  }

  /* Create/refer the rightmost current point line */
  if (d3.select("#createPeakMouseCurrentLine").empty()) {
    createPeakMouseCurrentLine = self.vis.append("line")
      .attr("id", "createPeakMouseCurrentLine")
      .attr("class", "createPeakMouseLine")
      .attr("x1", self.lastMouseMovePos[0])
      .attr("x2", self.lastMouseMovePos[0])
      .attr("y1", 0)
      .attr("y2", self.size.height);

  } else 
    createPeakMouseCurrentLine = d3.select("#createPeakMouseCurrentLine");

  createPeakMouseCurrentLine.attr("x1", self.lastMouseMovePos[0])
    .attr("x2", self.lastMouseMovePos[0]);

  /* Create the start arrow point of the leftmost line (staticly positioned) */
  if (d3.select("#startLineArrowLine").empty()) {
    startLineArrowLine = self.vis.append("line")
      .attr("id", "startLineArrowLine")
      .attr("class", "createPeakArrowLine")
      .attr("x1", self.leftMouseDown[0] - arrowLength - arrowPadding)
      .attr("x2", self.leftMouseDown[0] - arrowPadding)
      .attr("y1", self.size.height / 2)
      .attr("y2", self.size.height / 2);

    startLineArrow = self.vis.append('svg:defs').attr("id", "createPeakStartArrowDef")
                          .append("svg:marker")
                          .attr("id", "createPeakStartArrow")
                          .attr('class', 'createPeakArrow')
                          .attr("refX", 2)
                          .attr("refY", 7)
                          .attr("markerWidth", 25)
                          .attr("markerHeight", 25)
                          .attr("orient", 0)
                          .append("path")
                            .attr("d", "M2,2 L2,13 L8,7 L2,2")
                            .style("stroke", "black");

    startLineArrowLine.attr("marker-end", "url(#createPeakStartArrow)");
  }

  /* Create the arrow pointing to the rightmost line, or refer to it if itdoesn't exist */
  if (d3.select("#currentLineArrowLine").empty()) {
    currentLineArrowLine = self.vis.append("line")
      .attr("id", "currentLineArrowLine")
      .attr("class", "createPeakArrowLine")
      .attr("y1", self.size.height / 2)
      .attr("y2", self.size.height / 2);

    currentLineArrow = self.vis.append('svg:defs').attr("id", "createPeakCurrentArrowDef")
                          .append("svg:marker")
                          .attr("id", "createPeakCurrentArrow")
                          .attr('class', 'createPeakArrow')
                          .attr("refX", 2)
                          .attr("refY", 7)
                          .attr("markerWidth", 25)
                          .attr("markerHeight", 25)
                          .attr("orient", 180)
                          .append("path")
                            .attr("d", "M2,2 L2,13 L8,7 L2,2")
                            .style("stroke", "black");              

    currentLineArrowLine.attr("marker-start", "url(#createPeakCurrentArrow)");
  }
  else
    currentLineArrowLine = d3.select("#currentLineArrowLine");

  /* Update the position of the rightmost arrow */
  currentLineArrowLine.attr("x1", self.lastMouseMovePos[0] + arrowPadding)
    .attr("x2", self.lastMouseMovePos[0] + arrowPadding + arrowLength);


  /* Create/refer to the text for the approx continuum */
  if (d3.select("#contEstText").empty()) {
    contEstText = self.vis.append("text")
      .attr("id", "contEstText")
      .attr("class", "contEstLineText")
      .text("approx continuum to use");

  } else
    contEstText = d3.select("#contEstText");


  /* Get pixelated coordinates of mouse/starting positions of lines and coordinates */
  var coordsX0 = self.xScale.invert(self.leftMouseDown[0]),
      coordsY0 = self.getCountsForEnergy(self.rawData.spectra[0], coordsX0),
      coordsX1 = self.xScale.invert(self.lastMouseMovePos[0]),
      coordsY1 = self.getCountsForEnergy(self.rawData.spectra[0], coordsX1),
      x0 = self.leftMouseDown[0],
      x1 = self.lastMouseMovePos[0],
      y0 = self.yScale( coordsY0 ),
      y1 = self.yScale( coordsY1 ),
      dy = coordsY1 - coordsY0,
      lineAngle = (180/Math.PI) * Math.atan( (y1-y0)/(x1-x0) );

  /* Update the position and rotation of the continuum text using the pixelated coordinates */
  contEstText.attr("x", Math.min(self.lastMouseMovePos[0], self.leftMouseDown[0]) + (Math.abs(self.leftMouseDown[0]-self.lastMouseMovePos[0])/2) - Number(contEstText[0][0].getBoundingClientRect().width)/2 )
    .attr("y", y0-15)
    .attr("transform", "rotate(" + (!isNaN(lineAngle) ? lineAngle : 0) + ", " + (x0 + ((x1-x0)/2)) + ", " + y0 + ")");


  /* Create/refer to the reference text for creating a peak */
  if (d3.select("#createPeakMouseText").empty())
    createPeakMouseText = self.vis.append("text")
      .attr("id", "createPeakMouseText")
      .attr("class", "mouseLineText")
      .attr("y", self.size.height/5)
      .text("Will create peak Inside");
  else
    createPeakMouseText = d3.select("#createPeakMouseText");

  /* Move the create peaks text in the middle of the create peak mouse lines */
  createPeakMouseText.attr("x", Math.min(self.lastMouseMovePos[0], self.leftMouseDown[0]) + (Math.abs(self.leftMouseDown[0]-self.lastMouseMovePos[0])/2) - Number(createPeakMouseText[0][0].getBoundingClientRect().width)/2 );


  /* Remove the continuum estimation line (lines in this case, we create the effect using a numver of shorter 5px lines) */
  d3.selectAll(".createPeakContEstLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Get the end coordinates of the first (5px) line in the estimated continuum */
  var xpix = x0+5,
      ypix = self.yScale( coordsY0+dy*(xpix-x0)/(x1-x0) );

  /* Stop updating if the y-coordinate could not be found for the line */
  if (isNaN(ypix))
    return;

  /* Create the first 5px line for the estimated continuum */
  if (x1 > x0)
    contEstLine = self.vis.append("line")
      .attr("id", "contEstLine")
      .attr("class", "createPeakContEstLine")
      .attr("x1", x0)
      .attr("y1", y0)
      .attr("x2", xpix)
      .attr("y2", ypix);

  /* Create and update the next 5px lines until you reach the end for the estimated continuum */
  while (xpix < x1) {
    x0 = xpix;
    y0 = ypix;
    xpix += 5;
    ypix = self.yScale( coordsY0+dy*(xpix-self.leftMouseDown[0])/(x1-self.leftMouseDown[0]) );

    contEstLine = self.vis.append("line")
      .attr("id", "contEstLine")
      .attr("class", "createPeakContEstLine")
      .attr("x1", x0)
      .attr("y1", y0)
      .attr("x2", xpix)
      .attr("y2", ypix);
  }

  /* Create the last 5px line for the estimated continuum line */
  contEstLine = self.vis.append("line")
    .attr("id", "contEstLine")
    .attr("class", "createPeakContEstLine")
    .attr("x1", x0)
    .attr("y1", y0)
    .attr("x2", x1-2)
    .attr("y2", y1);
}

SpectrumChartD3.prototype.erasePeakFitReferenceLines = function() {
  var self = this;

  /* Delete the leftmost start line */
  d3.select("#createPeakMouseStartLine").remove();
  
  /* Delete the right most current mouse line */
  d3.select("#createPeakMouseCurrentLine").remove(); 

  /* Delete the arrow definitions pointing to the mouse lines */
  d3.select("#createPeakStartArrowDef").remove();

  /* Delete the estimated continuum text */
  d3.select("#contEstText").remove();

  /* Delete the arrows pointing to the mouse lines */
  d3.selectAll(".createPeakArrow").forEach(function (arrows) {
    arrows.forEach(function(arrow) {
      arrow.remove();
    })
  });

  /* Delete the arrow lines for the previous arrows */
  d3.selectAll(".createPeakArrowLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Delete the all the lines for the estimated continuum */
  d3.selectAll(".createPeakContEstLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Delete the reference text for the create peak */
  d3.select("#createPeakMouseText").remove();
}

// Christian [05262018]: Function hook for real-time peak fitting implementation.
//  Currently, the hook contains Liza's peak fitting code.
//  Liza's code will only run if we include the PeakFit.js and Numeric library in the page.
//  Otherwise, nothing happens.
SpectrumChartD3.prototype.runRealTimePeakFit = function() {
  var self = this;

  if ( typeof peakFit === 'undefined' ) {
    console.warn('Peak fit not found, canceling peak fitting.');
    return;
  }
  
  /*Get the initial energy the user 'clicked-down on' */
  var x0_energy = self.zoominx0;
  /* var y0_energy = self.zoominy0; */
  
  /*Get the current energy the mouse is at */
  var x_energy = self.peakFitTouchMove.length == 0 ? self.xScale.invert(d3.mouse(self.vis[0][0])[0]) : self.xScale.invert(rightTouch[0]);
  /*var y_counts = self.xScale.invert(mouse_pos_px[1]); */
  
  console.log( "x0_energy=" + x0_energy + ", x_energy=" + x_energy );
  
  /*Make sure x0_energy is less than x_energy */
  if( x0_energy > x_energy )
    x_energy = [x0_energy, x0_energy = x_energy][0];
  
  var need_redraw_on_cancel = !!self.current_fitting_peak;
  self.current_fitting_peak = null;

  if ( self.options.allowPeakFit ) {
    /*Get rid of currently fit peak  */
    self.current_fitting_peak = null;
    
    /*Get the bins for the range we're fitting */
    var foreground = self.rawData.spectra[0];
    var bisector = d3.bisector(function(d){return d;}); 
    var lbin = bisector.left(foreground.x, x0_energy);
    var rbin = bisector.right(foreground.x, x_energy);
    
    if( rbin < (foreground.x.length - 2) )
      rbin += 1;
    
    /*Make sure we have at least a few bins   */
    if( rbin < (lbin + 4) ){
      console.log( 'Not enough bins yet: ' + (rbin - lbin) );
      if( need_redraw_on_cancel )     
        self.redraw()();
      return;
    }
                    
    /*Now get the actual energy range we are fitting (the lowere energy of left  */
    /*  bin, and upper energy of right bin) */
    var lbin_lower_energy = foreground.x[lbin];
    var rbin_upper_energy = foreground.x[rbin + 1];  /*FIXME: +1 will cause problem for last bin... */
    
    /*The polynomial continuum should be evalueated relative to a reference energy. */
    /*  Lets pick the middle of the ROI for this. */
    var roi_ref_energy = 0.5*(rbin_upper_energy + lbin_lower_energy); 
    
    /*Get the actual counts in the bins.  Note that energies is one longer than */
    /*  counts, so you can can access the end of the fitting range. */
    var energies = foreground.x.slice(lbin,rbin+1); /*FIXME: +1 dangerous on last bin! */
    var counts = foreground.y.slice(lbin,rbin);
    
    /*Here is where you would fit for your peaks.  As an example, I make a linear */
    /*  continuum based on first/last bin height (to provide an example of how  */
    /*  InterSpec defines the continuum as a density per keV, hence you have to  */
    /*  integrate over a bins width to get the bins continuum height), and then */
    /*  add a peak with an amplitude equal to the difference between the continuum */
    /*  area, and the actual data area.  */

    
    /*A function to integrate the area bellow the continuum between x0 and x1  */
    /*  for a given refrence energy */
    function offset_eqn_integral(coeffs,refEnergy,x0,x1) {
      x0 -= refEnergy;
      x1 -= refEnergy;
      var answer = 0.0;
      for( var order = 0; order < coeffs.length; ++order ) {
        var exp = order + 1.0;
        answer += (coeffs[order]/exp) * (Math.pow(x1,exp) - Math.pow(x0,exp));
      }
      return answer;
    };
    
    /*A function to get linear continuum coeficients using the hights of the first */
    /*  and last bin - this is only an example function!  do not use in real code, */
    /*  it can fail in many ways. */
    /*Function assumes xvals has one more element than the range to be fitted, and  */
    /*  yvals has exactly the number of bins to be fitted */
    function linear_eqn_from_first_last_data( xvals, yvals, refenergy ) {
      var x1 = xvals[0];
      var dx1 = xvals[1] - x1;
      
      var x2 = xvals[xvals.length-2];
      var dx2 = xvals[xvals.length-1] - x2;
      
      x1 -= refenergy;
      x2 -= refenergy;
    
      var y1 = yvals[0];
      var y2 = yvals[yvals.length-1];

      var c = (2.0*x2*dx2 + dx2*dx2)/(2.0*x1*dx1 + dx1*dx1);
      var b = (y2-y1*c)/(dx2-dx1*c);
      var m = 2.0*(y1-b*dx1)/(2.0*x1*dx1+dx1*dx1);
      
      return [b,m];
    };

    function gaus_integral(mean, width, amp, x0, x1) {
        var peak_mean = mean, peak_sigma = width, peak_amplitude = amp;
          /*peak.LandauAmplitude, peak.LandauMode, peak.LandauSigma, */
        var sqrt2 = 1.414213562373095;
        var erflowarg = (x0-peak_mean)/(sqrt2*peak_sigma);
        var erfhigharg = (x1-peak_mean)/(sqrt2*peak_sigma);
        return peak_amplitude * 0.5 * (erf(erfhigharg) - erf(erflowarg));
    };

    function erf(x) {
        /*http:/*stackoverflow.com/questions/14846767/std-normal-cdf-normal-cdf-or-error-function */
        var sign = (x >= 0) ? 1 : -1; /* save the sign of x */
        x = Math.abs(x);
        var a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027
            a5 = 1.061405429, p  = 0.3275911;
        var t = 1.0/(1.0 + p*x);
        var y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
        return sign * y; /* erf(-x) = -erf(x); */
    };

    var fit = peakFit.run(numeric.sub(energies, roi_ref_energy), counts);
    var params = fit.params;
    var polyd = fit.polyd;
    var peakchi2 = fit.chi2;
    var numPeaks = (params.length - (polyd + 1)) / 3;
    var sumdata = counts.reduce(function(a,b){return a+b;}, 0);
    var continuumCoefs = params.slice(0,polyd+1);
    var sumcontinuum = offset_eqn_integral(continuumCoefs,roi_ref_energy,lbin_lower_energy,rbin_upper_energy);

    var poly_type;
    switch (polyd) {
      case 0:
        poly_type = 'Constant';
      case 1:
        poly_type = 'Linear';
      case 2:
        poly_type = 'Quadratic';
      case 3:
      poly_type = 'Cubic';
    }

    self.current_fitting_peak =  { 
        type: poly_type,                       /*options for you are are: 'NoOffset', 'Constant', 'Linear', 'Quardratic', 'Cubic' */
        lowerEnergy: lbin_lower_energy,
        upperEnergy: rbin_upper_energy,
        referenceEnergy: roi_ref_energy,
        coeffs: continuumCoefs,  /*Linear should have 2 coeficients, Quadratic 3, Cubic 4, constant 1 */
        coeffUncerts:[0,0],                  /*you can put in actual values of uncertainties here */
        fitForCoeff: Array.apply(null, Array(polyd + 1)).map(function(){return true}), /*Same number of entries as coeffs; each entry should be true for now  */
        peaks:[]
    };

    for (var i=polyd+1; i<params.length; i+=3) {
      var peakamp = Math.abs(sumdata - sumcontinuum);
      var gausmean = params[i+1] + roi_ref_energy;
      var peaksigma = Math.abs(params[i+2]);
      var gaus_sum = 0;
      for (var j=0; j<counts.length; j++) {
        var x0 = energies[j];
        var x1 = energies[j+1];
        gaus_sum += gaus_integral(gausmean, peaksigma, peakamp, x0, x1);
      }
      peakamp = Math.abs(gaus_sum - sumcontinuum);
      self.current_fitting_peak.peaks.push({
          type:'GaussianDefined',
          skewType:'NoSkew',
          Centroid:[gausmean,0,true],        /*second element is uncertainty, third alsways true */
          Width:[peaksigma,0.00431738,true], /*second element is uncertainty, third alsways true */
          Amplitude:[peakamp,0,true],        /*second element is uncertainty, third alsways true */
          LandauAmplitude:[0,-1,false],      /*always this value */
          LandauMode:[0,-1,false],           /*always this value */
          LandauSigma:[0,-1,false],          /*always this value */
          Chi2:[peakchi2,-1,false],          /*second and third elemtn always 1 and false          */
          forCalibration:false,              /*always this value */
          forSourceFit:false,                /*always this value */
          sourceType:'NotSpecified'          /*always this value  */
          }
      );
    }
  }
}

SpectrumChartD3.prototype.handleMouseMovePeakFit = function() {
  var self = this;

  console.log( "In handleMouseMovePeakFit + " + d3.mouse(self.vis[0][0])[0] );

  self.peakFitMouseMove = d3.mouse(self.vis[0][0]);
  self.peakFitTouchMove = d3.touches(self.vis[0][0]);

  var leftTouch, rightTouch;
  if (self.peakFitTouchMove.length > 0) {
    leftTouch = self.peakFitTouchMove[0][0] < self.peakFitTouchMove[1][0] ? self.peakFitTouchMove[0] : self.peakFitTouchMove[1];
    rightTouch = leftTouch === self.peakFitTouchMove[0] ? self.peakFitTouchMove[1] : self.peakFitTouchMove[0];
  }

  self.zooming_plot = false;

  /* We don't want to redraw the reference lines if we are using touches */
  if (self.peakFitTouchMove.length == 0)
    self.drawPeakFitReferenceLines();

  if (!self.zoominx0 && self.peakFitTouchMove.length > 0)
    self.zoominx0 = self.xScale.invert(leftTouch[0]);

  /* Set the original X-domain if it does not exist */
  if (!self.origdomain)
    self.origdomain = self.xScale.domain();
  
  /*This next line is a hack to get around how D3 is managing the zoom, but we highkacked it for the peak fitting  */
  self.xScale.domain( self.origdomain );
  
  /*If we arent displaying a spectrum, remove the current_fitting_peak and return  */
  /*  TODO: Have peak fitting for other spectra?? */
  if( !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length
      || self.rawData.spectra[0].y.length == 0 || this.rawData.spectra[0].y.length < 10 ) {
    if( need_redraw_on_cancel )     
      self.redraw()();
    return;
  }

  // Do real-time peak fit rendering
  self.runRealTimePeakFit();

  self.redraw()();
}

SpectrumChartD3.prototype.handleTouchMovePeakFit = function() {
  var self = this;

  if (!self.rawData || !self.rawData.spectra)
    return;

  /* Clear the delete peaks mode */
  self.handleCancelTouchDeletePeak();

  /* Clear the count gammas mode */
  self.handleCancelTouchCountGammas();

  /* Cancel the zoom-in y mode */
  self.handleTouchCancelZoomInY();


  var t = d3.touches(self.vis[0][0]);

  /* Cancel the function if no two-finger swipes detected */
  if (!t || t.length !== 2 || !self.createPeaksStartTouches) {
    self.handleCancelTouchPeakFit();
    return;
  }

  /* Set the touch variables */
  var leftStartTouch = self.createPeaksStartTouches[0][0] < self.createPeaksStartTouches[1][0] ? self.createPeaksStartTouches[0] : self.createPeaksStartTouches[1],
      rightStartTouch = leftStartTouch === self.createPeaksStartTouches[0] ? self.createPeaksStartTouches[1] : self.createPeaksStartTouches[0];

  var leftTouch = t[0][0] < t[1][0] ? t[0] : t[1],
      rightTouch = leftTouch === t[0] ? t[1] : t[0];

  /* Cancel the action if the left touch is to the left touch is to the left of the original starting left touch */
  /* or if the left touch goes out of bounds */
  if (leftTouch[0] < leftStartTouch[0] || leftTouch[0] > self.xScale.invert(self.xScale.domain()[1])) {
    self.handleCancelTouchPeakFit();
    return;
  }

  rightTouch[0] = Math.min(rightTouch[0], self.xScale.range()[1]);

  self.isCreatingPeaks = true;
  self.fittingPeak = true;

  self.setYAxisDomain();
  if (!self.yAxisZoomedOutFully) {
    self.redraw()();
  }

  /* Uncomment if you want to have peak fitting animation within touch */
  /* self.handleMouseMovePeakFit(); */

  /* Set the length of the arrows */
  var arrowLength = 25,
      arrowPadding = 7;

  /* Finger touch pixel size = 57 */
  var touchPointRadius = 20; 

  /* To keep track of some of the line objects being drawn */
  var createPeakTouchCurrentLine,
      contEstLine, 
      contEstText = d3.select("#contEstText"),
      createPeakTouchText1 = d3.select("#createPeakTouchText1"),
      createPeakTouchText2 = d3.select("#createPeakTouchText2"),
      createPeakRightTouchPointTop = d3.select("#createPeakRightTouchPointTop"),
      createPeakRightTouchPointBottom = d3.select("#createPeakRightTouchPointBottom"),
      createPeakTouchLineTop = d3.select("#createPeakTouchLineTop"), 
      createPeakTouchLineBottom = d3.select("#createPeakTouchLineBottom"),
      createPeakTouchArrowLineTop = d3.select("#createPeakTouchArrowLineTop"),
      createPeakTouchArrowLineBottom = d3.select("#createPeakTouchArrowLineBottom");

  if (createPeakTouchArrowLineTop.empty()) {
    createPeakTouchArrowLineTop = self.vis.append("line")
      .attr("id", "createPeakTouchArrowLineTop")
      .attr("class", "createPeakArrowLine")
      .attr("x1", leftStartTouch[0] - 12)
      .attr("x2", leftStartTouch[0] - 12)
      .attr("y1", leftStartTouch[1] - touchPointRadius - 20)
      .attr("y2", leftStartTouch[1] - touchPointRadius - 10);

    var createPeakTouchTopArrow = self.vis.append('svg:defs').attr("id", "createPeakStartArrowDef")
                          .append("svg:marker")
                          .attr("id", "createPeakTouchTopArrow")
                          .attr('class', 'createPeakArrow')
                          .attr("refX", 2)
                          .attr("refY", 8)
                          .attr("markerWidth", 25)
                          .attr("markerHeight", 25)
                          .attr("orient", 90)
                          .append("path")
                            .attr("d", "M2,2 L2,13 L8,7 L2,2")
                            .style("stroke", "black");

    createPeakTouchArrowLineTop.attr("marker-end", "url(#createPeakTouchTopArrow)");
  }
  if (createPeakTouchArrowLineBottom.empty()) {
    createPeakTouchArrowLineBottom = self.vis.append("line")
      .attr("id", "createPeakTouchArrowLineBottom")
      .attr("class", "createPeakArrowLine")
      .attr("x1", leftStartTouch[0] - 12)
      .attr("x2", leftStartTouch[0] - 12)
      .attr("y1", leftStartTouch[1] + touchPointRadius + 10)
      .attr("y2", leftStartTouch[1] + touchPointRadius + 20);

    var createPeakTouchBottomArrow = self.vis.append('svg:defs').attr("id", "createPeakStartArrowDef")
                          .append("svg:marker")
                          .attr("id", "createPeakTouchBottomArrow")
                          .attr('class', 'createPeakArrow')
                          .attr("refX", 2)
                          .attr("refY", 8)
                          .attr("markerWidth", 25)
                          .attr("markerHeight", 25)
                          .attr("orient", 270)
                          .append("path")
                            .attr("d", "M2,2 L2,13 L8,7 L2,2")
                            .style("stroke", "black");

    createPeakTouchArrowLineBottom.attr("marker-start", "url(#createPeakTouchBottomArrow)");
  }


  /* Create the left topmost and bottommost touch point */
  if (d3.select("#createPeakTouchPoint1").empty()) {
    self.vis.append("circle")
      .attr("id", "createPeakTouchPoint1")
      .attr("class", "createPeakLeftTouchPoint")
      .attr("cx", leftStartTouch[0])
      .attr("cy", leftStartTouch[1] - touchPointRadius)
      .attr("r", 3);
  }
  if (d3.select("#createPeakTouchPoint2").empty()) {
    self.vis.append("circle")
      .attr("id", "createPeakTouchPoint2")
      .attr("class", "createPeakLeftTouchPoint")
      .attr("cx", leftStartTouch[0])
      .attr("cy", leftStartTouch[1] + touchPointRadius)
      .attr("r", 3);
  }

  /* Create/update the right topmost and bottommost touch point */
  if (createPeakRightTouchPointTop.empty()) {
    createPeakRightTouchPointTop = self.vis.append("circle")
      .attr("id", "createPeakRightTouchPointTop")
      .attr("class", "createPeakRightTouchPoint")
      .attr("cy", leftStartTouch[1] - touchPointRadius)
      .attr("r", 3);
  }
  createPeakRightTouchPointTop.attr("cx", rightTouch[0]);

  if (createPeakRightTouchPointBottom.empty()) {
    createPeakRightTouchPointBottom = self.vis.append("circle")
      .attr("id", "createPeakRightTouchPointBottom")
      .attr("class", "createPeakRightTouchPoint")
      .attr("cy", leftStartTouch[1] + touchPointRadius)
      .attr("r", 3);
  }
  createPeakRightTouchPointBottom.attr("cx", rightTouch[0]);

  /* Create/update the touch lines */
  if (createPeakTouchLineTop.empty()) {
    createPeakTouchLineTop = self.vis.append("line")
      .attr("id", "createPeakTouchLineTop")
      .attr("class", "createPeakTouchLine")
      .attr("x1", leftStartTouch[0])
      .attr("y1", leftStartTouch[1] - touchPointRadius)
      .attr("y2", leftStartTouch[1] - touchPointRadius);
  }
  createPeakTouchLineTop.attr("x2", rightTouch[0]);

  if (createPeakTouchLineBottom.empty()) {
    createPeakTouchLineBottom = self.vis.append("line")
      .attr("id", "createPeakTouchLineBottom")
      .attr("class", "createPeakTouchLine")
      .attr("x1", leftStartTouch[0])
      .attr("y1", leftStartTouch[1] + touchPointRadius)
      .attr("y2", leftStartTouch[1] + touchPointRadius);
  }
  createPeakTouchLineBottom.attr("x2", rightTouch[0]);

  /* Create the leftmost starting point line  */
  if (d3.select("#createPeakTouchStartLine").empty()) {
    self.vis.append("line")
      .attr("id", "createPeakTouchStartLine")
      .attr("class", "createPeakMouseLine")
      .attr("x1", leftStartTouch[0])
      .attr("x2", leftStartTouch[0])
      .attr("y1", 0)
      .attr("y2", self.size.height);
  }

  /* Create/refer the rightmost current point line */
  if (d3.select("#createPeakTouchCurrentLine").empty()) {
    createPeakTouchCurrentLine = self.vis.append("line")
      .attr("id", "createPeakTouchCurrentLine")
      .attr("class", "createPeakMouseLine")
      .attr("y1", 0)
      .attr("y2", self.size.height);

  } else 
    createPeakTouchCurrentLine = d3.select("#createPeakTouchCurrentLine");

  createPeakTouchCurrentLine.attr("x1", rightTouch[0])
    .attr("x2", rightTouch[0]);

  /* Create the text for the touch level */
  if (createPeakTouchText1.empty())
    createPeakTouchText1 = self.vis.append("text")
      .attr("id", "createPeakTouchText1")
      .attr("class", "createPeakTouchText")
      .attr("y", leftStartTouch[1] - 2)
      .text("Keep fingers");
  createPeakTouchText1.attr("x", leftStartTouch[0] - createPeakTouchText1[0][0].clientWidth - 5);

  if (createPeakTouchText2.empty())
    createPeakTouchText2 = self.vis.append("text")
      .attr("id", "createPeakTouchText2")
      .attr("class", "createPeakTouchText")
      .attr("y", leftStartTouch[1] + 8)
      .text("level");
  createPeakTouchText2.attr("x", leftStartTouch[0] - createPeakTouchText2[0][0].clientWidth - 25);

  /* Create/refer to the text for the approx continuum */
  if (contEstText.empty()) {
    contEstText = self.vis.append("text")
      .attr("id", "contEstText")
      .attr("class", "contEstLineText")
      .text("approx continuum to use");
  }

  /* Get pixelated coordinates of mouse/starting positions of lines and coordinates */
  var coordsX0 = self.xScale.invert(leftStartTouch[0]),
      coordsY0 = self.getCountsForEnergy(self.rawData.spectra[0], coordsX0),
      coordsX1 = self.xScale.invert(rightTouch[0]),
      coordsY1 = self.getCountsForEnergy(self.rawData.spectra[0], coordsX1),
      x0 = leftStartTouch[0],
      x1 = rightTouch[0],
      y0 = self.yScale( coordsY0 ),
      y1 = self.yScale( coordsY1 ),
      dy = coordsY1 - coordsY0,
      lineAngle = (180/Math.PI) * Math.atan( (y1-y0)/(x1-x0) );

  /* Update the position and rotation of the continuum text using the pixelated coordinates */
  contEstText.attr("x", x0 + (Math.abs(x0-x1)/2) - Number(contEstText[0][0].clientWidth)/2 )
    .attr("y", y0-15)
    .attr("transform", "rotate(" + (!isNaN(lineAngle) ? lineAngle : 0) + ", " + (x0 + ((x1-x0)/2)) + ", " + y0 + ")");


  /* Create/refer to the reference text for creating a peak */
  if (d3.select("#createPeakTouchText").empty())
    createPeakTouchText = self.vis.append("text")
      .attr("id", "createPeakTouchText")
      .attr("class", "mouseLineText")
      .attr("y", self.size.height/5)
      .text("Will create peak Inside");
  else
    createPeakTouchText = d3.select("#createPeakTouchText");

  /* Move the create peaks text in the middle of the create peak mouse lines */
  createPeakTouchText.attr("x", x0 + (Math.abs(x0-x1)/2) - Number(createPeakTouchText[0][0].clientWidth)/2 );


  /* Remove the continuum estimation line (lines in this case, we create the effect using a numver of shorter 5px lines) */
  d3.selectAll(".createPeakContEstLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Get the end coordinates of the first (5px) line in the estimated continuum */
  var xpix = x0+5,
      ypix = self.yScale( coordsY0+dy*(xpix-x0)/(x1-x0) );

  /* Stop updating if the y-coordinate could not be found for the line */
  if (isNaN(ypix))
    return;

  /* Create the first 5px line for the estimated continuum */
  if (x1 > x0)
    contEstLine = self.vis.append("line")
      .attr("id", "contEstLine")
      .attr("class", "createPeakContEstLine")
      .attr("x1", x0)
      .attr("y1", y0)
      .attr("x2", xpix)
      .attr("y2", ypix);

  /* Create and update the next 5px lines until you reach the end for the estimated continuum */
  while (xpix < x1) {
    x0 = xpix;
    y0 = ypix;
    xpix += 5;
    ypix = self.yScale( coordsY0+dy*(xpix-leftStartTouch[0])/(x1-leftStartTouch[0]) );

    contEstLine = self.vis.append("line")
      .attr("id", "contEstLine")
      .attr("class", "createPeakContEstLine")
      .attr("x1", x0)
      .attr("y1", y0)
      .attr("x2", xpix)
      .attr("y2", ypix);
  }

  /* Create the last 5px line for the estimated continuum line */
  contEstLine = self.vis.append("line")
    .attr("id", "contEstLine")
    .attr("class", "createPeakContEstLine")
    .attr("x1", x0)
    .attr("y1", y0)
    .attr("x2", x1-2)
    .attr("y2", y1);
}

SpectrumChartD3.prototype.handleTouchEndPeakFit = function() {
  var self = this;

  var t = self.lastTouches;

  /* Cancel the function if no two-finger swipes detected */
  if (!t || t.length !== 2 || !self.createPeaksStartTouches) {
    self.handleCancelTouchPeakFit();
    return;
  }

  /* Set the touch variables */
  var leftStartTouch = self.createPeaksStartTouches[0][0] < self.createPeaksStartTouches[1][0] ? self.createPeaksStartTouches[0] : self.createPeaksStartTouches[1],
      rightStartTouch = leftStartTouch === self.createPeaksStartTouches[0] ? self.createPeaksStartTouches[1] : self.createPeaksStartTouches[0];

  var leftTouch = t[0][0] < t[1][0] ? t[0] : t[1],
      rightTouch = leftTouch === t[0] ? t[1] : t[0];

  /* Emit the create peak signal */
  if (self.controlDragSwipe && self.createPeaksStartTouches && self.lastTouches) {
    console.log("Emit CREATE PEAK signal from x0 = ", leftStartTouch[0], "(", self.xScale.invert(leftStartTouch[0]), 
      " kEV) to x1 = ", rightTouch[0], "(", self.xScale.invert(rightTouch[0]), 
      " kEV)");
    self.WtEmit(self.chart.id, {name: 'controlkeydragged'}, self.xScale.invert(leftStartTouch[0]), self.xScale.invert(rightTouch[0]), d3.event.pageX, d3.event.pageY);
  }

  /* Delete all the create peak elements */
  self.handleCancelTouchPeakFit();
}

SpectrumChartD3.prototype.handleCancelTouchPeakFit = function() {
  var self = this;

  /* Delete the leftmost start line */
  d3.select("#createPeakTouchStartLine").remove();
  
  /* Delete the right most current mouse line */
  d3.select("#createPeakTouchCurrentLine").remove(); 

  /* Delete the arrow definitions pointing to the mouse lines */
  d3.select("#createPeakStartArrowDef").remove();

  /* Delete the estimated continuum text */
  d3.select("#contEstText").remove();

  /* Delete the arrows pointing to the mouse lines */
  d3.selectAll(".createPeakArrow").forEach(function (arrows) {
    arrows.forEach(function(arrow) {
      arrow.remove();
    })
  });

  /* Delete the arrow lines for the previous arrows */
  d3.selectAll(".createPeakArrowLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Delete the touch points */
  d3.selectAll(".createPeakLeftTouchPoint").forEach(function (points) {
    points.forEach(function(point) {
      point.remove();
    })
  });
  d3.selectAll(".createPeakRightTouchPoint").forEach(function (points) {
    points.forEach(function(point) {
      point.remove();
    })
  });

  /* Delete the touch lines */
  d3.selectAll(".createPeakTouchLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Delete the all the lines for the estimated continuum */
  d3.selectAll(".createPeakContEstLine").forEach(function (lines) {
    lines.forEach(function(line) {
      line.remove();
    })
  });

  /* Delete the reference text for the create peak */
  d3.select("#createPeakTouchText").remove();
  d3.selectAll(".createPeakTouchText").forEach(function (texts) {
    texts.forEach(function(text) {
      text.remove();
    })
  });

  self.controlDragSwipe = false;
  self.fittingPeak = null;
}

/*Function called when use lets the mouse button up */
SpectrumChartD3.prototype.handleMouseUpPeakFit = function() {
  var self = this;

  console.log( 'Mouse up during peak fit' );

  self.fittingPeak = null;
  
  var keep_peaks = true;  /*Do what you want here to decide if you should keep the peak(s) or not */
  
  if( keep_peaks && this.current_fitting_peak ) {
    self.rawData.spectra[0].peaks.push( this.current_fitting_peak ); 
  }

  if (self.peakFitMouseMove && self.peakFitMouseDown) {
    const x0 = self.peakFitMouseDown[0],
          x1 = d3.mouse(self.vis.node())[0],
          energyx0 = self.xScale.invert(x0),
          energyx1 = self.xScale.invert(x1);
    console.log("Emit CREATE PEAK signal from x0 = ", x0, "(", energyx0, 
      " kEV) to x1 = ", x1, "(", energyx1, 
      " kEV)");
    self.WtEmit(self.chart.id, {name: 'controlkeydragged'}, energyx0, energyx1, d3.event.pageX, d3.event.pageY);
  }  
  
  self.current_fitting_peak = null;
  self.erasePeakFitReferenceLines();
  self.redraw()();
}

/*Function called when you hit escape while fitting peak */
SpectrumChartD3.prototype.handleCancelMousePeakFit = function() {
  console.log( 'Canceled peakfit' );
  this.fittingPeak = null;
  this.current_fitting_peak = null;
  this.erasePeakFitReferenceLines();
  this.redraw()();
}


/**
 * -------------- Peak Marker Functions --------------
 */
SpectrumChartD3.prototype.updateFeatureMarkers = function(sumPeaksArgument) {
  var self = this;

  /* Christian: Just catching this weird error whenever user initially clicks the checkbox for one of the feature markers.
                I'm guessing it is thrown because the mouse does not exist for the vis element, so we don't update the feature markers.
   */
  try { d3.mouse(self.vis[0][0]) }                        
  catch (error) { console.log( "Error thrown: source event is null" ); return; }  /* to catch and log certain error thrown in initial check of feature markers */

  /* Positional variables (for mouse and touch) */
  var m = d3.mouse(self.vis[0][0]),
      t = d3.touches(self.vis[0][0]);

  /* Adjust the mouse position accordingly to touch (because some of these functions use mouse position in touch devices) */
  if (t.length > 0)
    m = t[0];

  /* Chart coordinate values */
  var energy = self.xScale.invert(m[0]),
      xmax = self.size.width,
      ymax = self.size.height;

  /* Do not update feature markers if legend being dragged or energy value is undefined */
  if ((t && self.legdown) || (t && self.scalerdown) || isNaN(energy))
    return;
  if (self.currentlyAdjustingSpectrumScale)
    return;

  var cursorIsOutOfBounds = (t && t.length > 0) ? (t[0][0] < 0 || t[0][0] > xmax) : (m[0] < 0  || m[0] > xmax || m[1] < 0 || m[1] > ymax);


  /* Mouse-edge Helpers: These are global helpers for feature markers that update the mouse edge position.
  */

  /* Mouse edge should be deleted if: 
      none of the scatter/escape peak options are unchecked 
      OR if cursor is out of bounds 
      OR if the user is currently dragging in the graph
  */
  function shouldDeleteMouseEdge() {
    return (!self.options.showComptonEdge && !self.options.showComptonPeaks && !self.options.showEscapePeaks && !self.options.showSumPeaks) || 
    cursorIsOutOfBounds || 
    self.dragging_plot;
  }
  function deleteMouseEdge( shouldDelete ) {
    if ( shouldDelete || shouldDeleteMouseEdge() )
    {
      if ( self.mouseEdge ) {
        self.mouseEdge.remove(); 
        self.mouseEdge = null;
      }
      if ( self.mouseEdgeText ) {
        self.mouseEdgeText.remove(); 
        self.mouseEdgeText = null;
      }
      return true;
    }
    return false;
  }
  function updateMouseEdge() {

    /* If mouse edge could has been deleted, do not update the mouse edge */
    if (deleteMouseEdge())
      return;

    /* Update the mouse edge and corresponding text position  */
    if ( self.mouseEdge ) {
        self.mouseEdge
          .attr("x1", m[0])
          .attr("x2", m[0]);
        self.mouseEdgeText
          .attr("x", m[0] + xmax/125 )
          .text( energy.toFixed(1) + " keV");
    } else {  
        /* Create the mouse edge (and text next to it) */
        self.mouseEdge = self.vis.append("line")
          .attr("class", "mouseLine")
          .attr("stroke-width", 2)
          .attr("stroke", "black")
          .attr("x1", m[0])
          .attr("x2", m[0])
          .attr("y1", 0)
          .attr("y2", self.size.height);

        self.mouseEdgeText = self.vis.append("text")
          .attr("class", "mouseLineText")
          .attr( "x", m[0] + xmax/125 )
          .attr( "y", self.size.height/4)
          .text( energy.toFixed(1) + " keV");
    }
  }


  function updateEscapePeaks() {
    /* Calculations for the escape peak markers */
    var singleEscapeEnergy = energy - 510.99891,
        singleEscapePix = self.xScale(singleEscapeEnergy),

        singleEscapeForwardEnergy = energy + 510.99891,
        singleEscapeForwardPix = self.xScale(singleEscapeForwardEnergy),

        doubleEscapeEnergy = energy - 1021.99782,
        doubleEscapePix = self.xScale(doubleEscapeEnergy),

        doubleEscapeForwardEnergy = energy + 1021.99782,
        doubleEscapeForwardPix = self.xScale(doubleEscapeForwardEnergy);

    /* Deletes the marker for a single escape peak */
    function deleteSingleEscape() {
      if( self.singleEscape ) {
        self.singleEscape.remove();
        self.singleEscape = null;
      }
      if ( self.singleEscapeText ) {
          self.singleEscapeText.remove();
          self.singleEscapeText = null;
      }
      if ( self.singleEscapeMeas ) {
          self.singleEscapeMeas.remove();
          self.singleEscapeMeas = null;
      }
    }

    /* Deletes the marker for a double escape peak */
    function deleteDoubleEscape() {
      if ( self.doubleEscape ) {
        self.doubleEscape.remove();
        self.doubleEscape = null;
      }
      if ( self.doubleEscapeText ) {
        self.doubleEscapeText.remove();
        self.doubleEscapeText = null;
      }
      if ( self.doubleEscapeMeas ) {
        self.doubleEscapeMeas.remove();
        self.doubleEscapeMeas = null;
      }
    }
    /* Deletes the marker for a single forward escape peak */
    function deleteSingleEscapeForward() {
      if ( self.singleEscapeForward ) {
        self.singleEscapeForward.remove();
        self.singleEscapeForward = null;
      }
      if ( self.singleEscapeForwardText ) {
          self.singleEscapeForwardText.remove();
          self.singleEscapeForwardText = null;
      }
      if ( self.singleEscapeForwardMeas ) {
          self.singleEscapeForwardMeas.remove();
          self.singleEscapeForwardMeas = null;
      }
    }

    /* Deletes the marker for a double forward escape peak */
    function deleteDoubleEscapeForward() {
      if ( self.doubleEscapeForward ) {
        self.doubleEscapeForward.remove();
        self.doubleEscapeForward = null;
      }
      if ( self.doubleEscapeForwardText ) {
          self.doubleEscapeForwardText.remove();
          self.doubleEscapeForwardText = null;
      }
      if ( self.doubleEscapeForwardMeas ) {
          self.doubleEscapeForwardMeas.remove();
          self.doubleEscapeForwardMeas = null;
      }
    }

    if (shouldDeleteMouseEdge())
      deleteMouseEdge(true);
    
    if( !self.options.showEscapePeaks || cursorIsOutOfBounds || self.dragging_plot ) {
      deleteSingleEscape();
      deleteDoubleEscape();
      deleteSingleEscapeForward();
      deleteDoubleEscapeForward();
      return;
    }

    var singleEscapeOutOfBounds = singleEscapePix < 0 || singleEscapePix > xmax,
        doubleEscapeOutOfBounds = doubleEscapePix < 0 || doubleEscapePix > xmax,
        singleEscapeForwardOutOfBounds = singleEscapeForwardPix < 0 || singleEscapeForwardPix > xmax,
        doubleEscapeForwardOutOfBounds = doubleEscapeForwardPix < 0 || doubleEscapeForwardPix > xmax;

    if ( doubleEscapeOutOfBounds ) {
      deleteDoubleEscape();

      if ( singleEscapeOutOfBounds )
        deleteSingleEscape();
    }

    if ( doubleEscapeForwardOutOfBounds ) {
      deleteDoubleEscapeForward();

      if ( singleEscapeForwardOutOfBounds )
        deleteSingleEscapeForward();
    }

    updateMouseEdge();

    if (!singleEscapeForwardOutOfBounds) {
      if( !self.singleEscapeForward && singleEscapeForwardEnergy >= 0 ) {  
        self.singleEscapeForward = self.vis.append("line")    /* create single forward escape line */
        .attr("class", "escapeLineForward")
        .attr("x1", singleEscapeForwardPix)
        .attr("x2", singleEscapeForwardPix)
        .attr("y1", 0)
        .attr("y2", self.size.height);
      self.singleEscapeForwardText = self.vis.append("text") /* create Single Forward Escape label beside line */
            .attr("class", "peakText")
            .attr( "x", singleEscapeForwardPix + xmax/200 )
            .attr( "y", self.size.height/5.3)
            .text( "Single Escape" );
      self.singleEscapeForwardMeas = self.vis.append("text") /* Create measurement label besides line, under Single Escape label */
            .attr("class", "peakText")
            .attr( "x", singleEscapeForwardPix + xmax/125 )
            .attr( "y", self.size.height/4.5)
            .text( singleEscapeForwardEnergy.toFixed(1) + " keV" );
      } else {
        if ( singleEscapeForwardEnergy < 0 && self.singleEscapeForward && self.singleEscapeForwardText && self.singleEscapeForwardMeas ) {
          deleteSingleEscapeForward();

        } else if ( self.singleEscapeForward ) {      /* Move everything to where mouse is */
          self.singleEscapeForward
            .attr("x1", singleEscapeForwardPix)
            .attr("x2", singleEscapeForwardPix);
          self.singleEscapeForwardText
            .attr("x", singleEscapeForwardPix + xmax/200 );
          self.singleEscapeForwardMeas
            .attr( "x", singleEscapeForwardPix + xmax/125 )
            .text( singleEscapeForwardEnergy.toFixed(1) + " keV" );
        }
      }
    }

    if (!doubleEscapeForwardOutOfBounds) {
      if( !self.doubleEscapeForward && doubleEscapeForwardEnergy >= 0 ) {  
        self.doubleEscapeForward = self.vis.append("line")    /* create double forward escape line */
        .attr("class", "escapeLineForward")
        .attr("x1", doubleEscapeForwardPix)
        .attr("x2", doubleEscapeForwardPix)
        .attr("y1", 0)
        .attr("y2", self.size.height);
      self.doubleEscapeForwardText = self.vis.append("text") /* create double Forward Escape label beside line */
            .attr("class", "peakText")
            .attr( "x", doubleEscapeForwardPix + xmax/200 )
            .attr( "y", self.size.height/5.3)
            .text( "Double Escape" );
      self.doubleEscapeForwardMeas = self.vis.append("text") /* Create measurement label besides line, under double Escape label */
            .attr("class", "peakText")
            .attr( "x", doubleEscapeForwardPix + xmax/125 )
            .attr( "y", self.size.height/4.5)
            .text( doubleEscapeForwardEnergy.toFixed(1) + " keV" );
      } else {
        if ( doubleEscapeForwardEnergy < 0 && self.doubleEscapeForward && self.doubleEscapeForwardText && self.doubleEscapeForwardMeas ) {
          deleteDoubleEscapeForward();

        } else if ( self.doubleEscapeForward ) {      /* Move everything to where mouse is */
          self.doubleEscapeForward
            .attr("x1", doubleEscapeForwardPix)
            .attr("x2", doubleEscapeForwardPix);
          self.doubleEscapeForwardText
            .attr("x", doubleEscapeForwardPix + xmax/200 );
          self.doubleEscapeForwardMeas
            .attr( "x", doubleEscapeForwardPix + xmax/125 )
            .text( doubleEscapeForwardEnergy.toFixed(1) + " keV" );
        }
      }
    }

    if ( singleEscapeOutOfBounds ) 
      return;

    /* Draw single escape peak if not present in the grapy */
    if( !self.singleEscape && singleEscapeEnergy >= 0 ) {  
      self.singleEscape = self.vis.append("line")    /* create single escape line */
      .attr("class", "peakLine")
      .attr("x1", singleEscapePix)
      .attr("x2", singleEscapePix)
      .attr("y1", 0)
      .attr("y2", self.size.height);
    self.singleEscapeText = self.vis.append("text") /* create Single Escape label beside line */
          .attr("class", "peakText")
          .attr( "x", singleEscapePix + xmax/200 )
          .attr( "y", self.size.height/5.3)
          .text( "Single Escape" );
    self.singleEscapeMeas = self.vis.append("text") /* Create measurement label besides line, under Single Escape label */
          .attr("class", "peakText")
          .attr( "x", singleEscapePix + xmax/125 )
          .attr( "y", self.size.height/4.5)
          .text( singleEscapeEnergy.toFixed(1) + " keV" );
    } else {
      if ( singleEscapeEnergy < 0 && self.singleEscape && self.singleEscapeText && self.singleEscapeMeas ) {
        self.singleEscape.remove();      /* Delete lines and labels if out of bounds */
        self.singleEscape = null;
        self.singleEscapeText.remove();
        self.singleEscapeText = null;
        self.singleEscapeMeas.remove();
        self.singleEscapeMeas = null;

      } else if ( self.singleEscape ) {      /* Move everything to where mouse is */
        self.singleEscape
          .attr("x1", singleEscapePix)
          .attr("x2", singleEscapePix);
        self.singleEscapeText
          .attr("x", singleEscapePix + xmax/200 );
        self.singleEscapeMeas
          .attr( "x", singleEscapePix + xmax/125 )
          .text( singleEscapeEnergy.toFixed(1) + " keV" );
      }
    }

    /* Do not update the double escape peak marker anymore */
    if (doubleEscapeOutOfBounds) 
      return;

      /* Draw double escape peak if not present in the grapy */
    if( !self.doubleEscape && doubleEscapeEnergy >= 0 ) {
      self.doubleEscape = self.vis.append("line")  /* create double escape line */
      .attr("class", "peakLine")
      .attr("stroke-width", 2)
      .attr("stroke", "black")
      .attr("x1", doubleEscapePix)
      .attr("x2", doubleEscapePix)
      .attr("y1", 0)
      .attr("y2", self.size.height);
    self.doubleEscapeText = self.vis.append("text") /* create Double Escape label beside line */
          .attr("class", "peakText")
          .attr( "x", doubleEscapePix + xmax/200 )
          .attr( "y", self.size.height/5.3)
          .text( "Double Escape" );
    self.doubleEscapeMeas = self.vis.append("text") /* Create measurement label besides line, under Double Escape label */
          .attr("class", "peakText")
          .attr( "x", doubleEscapePix + xmax/125 )
          .attr( "y", self.size.height/4.5)
          .text( doubleEscapeEnergy.toFixed(1) + " keV" );
    } else {
      if ( (doubleEscapeEnergy < 0) && self.doubleEscape && self.doubleEscapeText && self.doubleEscapeMeas ) {
        self.doubleEscape.remove();    /* Delete lines and labels if out of bounds */
      self.doubleEscape = null;
          self.doubleEscapeText.remove();
          self.doubleEscapeText = null;
          self.doubleEscapeMeas.remove();
          self.doubleEscapeMeas = null;

      } else if ( self.doubleEscape ) {    /* Move everything to where mouse is */

        self.doubleEscape
          .attr("x1", doubleEscapePix)
          .attr("x2", doubleEscapePix);
        self.doubleEscapeText
          .attr("x", doubleEscapePix + xmax/200 );
        self.doubleEscapeMeas
          .attr( "x", doubleEscapePix + xmax/125 )
          .text( doubleEscapeEnergy.toFixed(1) + " keV" );
      }
    }
  }

  function updateComptonPeaks() {

    var compAngleRad = self.comptonPeakAngle * (3.14159265/180.0)   /* calculate radians of compton peak angle */
    var comptonPeakEnergy = energy / (1 + ((energy/510.99891)*(1-Math.cos(compAngleRad)))); /* get energy value from angle and current energy position */
    var comptonPeakPix = self.xScale(comptonPeakEnergy);

    if (shouldDeleteMouseEdge())
      deleteMouseEdge(true);
    
    var comptonPeakOutOfBounds = comptonPeakPix < 0 || comptonPeakPix > xmax;

    /* delete if compton peak option is turned off or cursor is out of the graph */
    if( !self.options.showComptonPeaks || cursorIsOutOfBounds || comptonPeakOutOfBounds || self.dragging_plot ) {
      if( self.comptonPeak ) {
        self.comptonPeak.remove(); self.comptonPeak = null;
        /* console.log( 'Should emit compton peak closed' ); */
      }
      if ( self.comptonPeakText ) {
        self.comptonPeakText.remove(); self.comptonPeakText = null;
      }
      if ( self.comptonPeakMeas ) {
        self.comptonPeakMeas.remove(); self.comptonPeakMeas = null;
      }

      if (t.length == 0) {        /* if mouse movement (aka not touch movement), then update the mouse edge */
        updateMouseEdge();
      }

      return;
    }

    if( !self.comptonPeak ) {
      /* draw compton edge line here */
      self.comptonPeak = self.vis.append("line")
        .attr("class", "peakLine")
        .attr("stroke-width", 2)
        .attr("stroke", "black")
        .attr("x1", comptonPeakPix)
        .attr("x2", comptonPeakPix)
        .attr("y1", 0)
        .attr("y2", self.size.height);
      self.comptonPeakText = self.vis.append("text")
        .attr("class", "peakText")
        .attr( "x", comptonPeakPix + xmax/200 )
        .attr( "y", self.size.height/10)
        .text( self.comptonPeakAngle + "° Compton Peak" );
      self.comptonPeakMeas = self.vis.append("text")
        .attr("class", "peakText")
        .attr( "x", comptonPeakPix + xmax/125 )
        .attr( "y", self.size.height/7.8)
        .text( comptonPeakEnergy.toFixed(1) + " keV" );
    } else {
      /* update the compton peak edge line */
      self.comptonPeak
        .attr("x1", comptonPeakPix)
        .attr("x2", comptonPeakPix)
        .attr("y1", 0)
        .attr("y2", self.size.height);
      self.comptonPeakText
        .attr("x", comptonPeakPix + xmax/200 )
        .attr( "y", self.size.height/10)
        .text( self.comptonPeakAngle + "° Compton Peak" );
      self.comptonPeakMeas
        .attr( "x", comptonPeakPix + xmax/125 )
        .attr( "y", self.size.height/7.8)
        .text( comptonPeakEnergy.toFixed(1) + " keV" );
    }
    updateMouseEdge();
  }

  function updateComptonEdge() {

    var compedge = energy - (energy / (1 + (2*(energy/510.99891))));
    var compEdgePix = self.xScale(compedge);
    
    if ( shouldDeleteMouseEdge() ) 
      deleteMouseEdge(true);

    var comptonEdgeOutOfBounds = compEdgePix < 0  || compEdgePix > xmax ;

    /* delete if compton edge already if option is turned off or cursor is out of the graph */
    if( !self.options.showComptonEdge || cursorIsOutOfBounds || comptonEdgeOutOfBounds || self.dragging_plot ) {
      if( self.comptonEdge ) {
        self.comptonEdge.remove(); 
        self.comptonEdge = null;
      }
      if ( self.comptonEdgeText ) {
        self.comptonEdgeText.remove(); 
        self.comptonEdgeText = null;
      }
      if ( self.comptonEdgeMeas ) {
          self.comptonEdgeMeas.remove(); 
          self.comptonEdgeMeas = null;
      }

      updateMouseEdge();
      return;
    }
    
    if( !self.comptonEdge ) {
      /* draw compton edge line here */
      self.comptonEdge = self.vis.append("line")
        .attr("class", "peakLine")
        .attr("stroke-width", 2)
        .attr("stroke", "black")
        .attr("x1", compEdgePix)
        .attr("x2", compEdgePix)
        .attr("y1", 0)
        .attr("y2", self.size.height);
      self.comptonEdgeText = self.vis.append("text")
        .attr("class", "peakText")
        .attr( "x", compEdgePix + xmax/200 )
        .attr( "y", self.size.height/22)
        .text( "Compton Edge" );
      self.comptonEdgeMeas = self.vis.append("text")
        .attr("class", "peakText")
        .attr( "x", compEdgePix + xmax/125 )
        .attr( "y", self.size.height/14)
        .text( compedge.toFixed(1) + " keV" );
    } else {
      self.comptonEdge
        .attr("x1", compEdgePix)
        .attr("x2", compEdgePix)
        .attr("y1", 0)
        .attr("y2", self.size.height);
      self.comptonEdgeText
        .attr("x", compEdgePix + xmax/200 )
        .attr("y", self.size.height/22);
      self.comptonEdgeMeas
        .attr( "x", compEdgePix + xmax/125 )
        .attr( "y", self.size.height/14)
        .text( compedge.toFixed(1) + " keV" );
    }
    updateMouseEdge();
  }

  function updateSumPeaks( clickedEnergy ) {

    function deleteClickedPeakMarker() {
      if( self.clickedPeak ) {
        self.clickedPeak.remove(); 
        self.clickedPeak = null;
      }
      if ( self.clickedPeakMeas ) {
        self.clickedPeakMeas.remove(); 
        self.clickedPeakMeas = null;
      }
    }

    function deleteSumPeakMarker() {
      if ( self.sumPeak ) {
        self.sumPeak.remove(); 
        self.sumPeak = null;
      }
      if ( self.sumPeakMeas ) {
        self.sumPeakMeas.remove(); 
        self.sumPeakMeas = null;
      }
      if ( self.sumPeakText ) {
          self.sumPeakText.remove(); 
          self.sumPeakText = null;
      }
    }

    function deleteLeftSumPeakMarker() {
      if ( self.leftSumPeak ) {
        self.leftSumPeak.remove(); 
        self.leftSumPeak = null;
      }
      if ( self.leftSumPeakMeas ) {
        self.leftSumPeakMeas.remove(); 
        self.leftSumPeakMeas = null;
      }
      if ( self.leftSumPeakText ) {
        self.leftSumPeakText.remove(); 
        self.leftSumPeakText = null;
      }
    }
    
    if ( shouldDeleteMouseEdge() ) 
      deleteMouseEdge(true);

    /* delete if sum peak option is already turned off or cursor is out of the graph */
    if( !self.options.showSumPeaks || cursorIsOutOfBounds || self.dragging_plot ) {
      /* delete the sum peak corresponding help text  */
      if ( self.sumPeakHelpText ) {
        self.sumPeakHelpText.remove(); 
        self.sumPeakHelpText = null;
      }

      if ( cursorIsOutOfBounds || self.dragging_plot ) {
        if ( self.clickedPeak ) {
          self.savedClickEnergy = self.xScale.invert( self.clickedPeak.attr("x1") );
        }
      } else if ( !self.options.showSumPeaks )
        self.savedClickEnergy = null;

      deleteClickedPeakMarker();
    }
    

    if( !self.options.showSumPeaks || cursorIsOutOfBounds || self.dragging_plot ) {
      deleteSumPeakMarker();
      deleteLeftSumPeakMarker();
      return;
    }

    if ( !self.options.showSumPeaks ) 
      self.savedClickEnergy = null;

    updateMouseEdge();

    var shouldUpdateClickedPeak = true,
        shouldUpdateSumPeak = true,
        shouldUpdateLeftSumPeak = true;

    if ( self.savedClickEnergy == null && clickedEnergy == null ) {
      shouldUpdateSumPeaks = shouldUpdateLeftSumPeak = shouldUpdateClickedPeak = false;
    }
    else if ( self.savedClickEnergy != null && (clickedEnergy == null || clickedEnergy < 0) )
      clickedEnergy = self.savedClickEnergy;
    else if ( clickedEnergy < 0 ) {
      if ( self.clickedPeak ) {
        self.savedClickEnergy = clickedEnergy = Number(self.clickedPeak.attr("energy")) ;
      }
      else shouldUpdateClickedPeak = false;
    }

    if ( !shouldUpdateClickedPeak && !shouldUpdateSumPeak && !shouldUpdateLeftSumPeak )
      return;

    var clickedEdgeOutOfBounds = false;
    if ( shouldUpdateClickedPeak ) {
      self.savedClickEnergy = null;

      var clickedEdgePix = self.xScale( clickedEnergy  );
      clickedEdgeOutOfBounds = clickedEdgePix < 0 || clickedEdgePix > xmax;

      if (clickedEdgeOutOfBounds) {
        self.savedClickEnergy = clickedEnergy;
        deleteClickedPeakMarker();
      }
      else if( !self.clickedPeak ) {
        /* draw compton edge line here */
        self.clickedPeak = self.vis.append("line")
          .attr("class", "peakLine")
          .attr("stroke-width", 2)
          .attr("stroke", "black")
          .attr("x1", clickedEdgePix)
          .attr("x2", clickedEdgePix)
          .attr("y1", 0)
          .attr("y2", self.size.height)
          .attr("energy", clickedEnergy);
        self.clickedPeakMeas = self.vis.append("text")
          .attr("class", "peakText")
          .attr( "x", clickedEdgePix + xmax/125 )
          .attr( "y", self.size.height/4)
          .text( clickedEnergy.toFixed(1) + " keV" );
      } else {

        self.clickedPeak
          .attr("x1", clickedEdgePix)
          .attr("x2", clickedEdgePix)
          .attr("y1", 0)
          .attr("y2", self.size.height)
          .attr("energy", clickedEnergy);
        self.clickedPeakMeas
          .attr( "x", clickedEdgePix + xmax/125 )
          .attr( "y", self.size.height/4)
          .text( clickedEnergy.toFixed(1) + " keV" );
      }
    }  

    if ( !self.clickedPeak && !self.savedClickEnergy ) { 
      shouldUpdateSumPeak = false;

      if ( !self.sumPeakHelpText ) {
        /* create the sum peak help text */
        self.sumPeakHelpText = self.vis.append("text")
          .attr("class", "peakText")
          .attr("fill", "red")
          .attr( "x", m[0] + xmax/125 )
          .attr( "y", self.size.height/3.5)
              .text( "Click to set sum peak first energy." );
      } else {
        /* update the sum peak help text position */
        self.sumPeakHelpText
          .attr( "x", m[0] + xmax/125 )
          .attr( "y", self.size.height/3.5)
      }

    } else {
        /* delete sum peak help text */
        if ( self.sumPeakHelpText ) {
          self.sumPeakHelpText.remove(); 
          self.sumPeakHelpText = null;
        }
    }

    if ( shouldUpdateLeftSumPeak && energy < clickedEnergy ) {
      var leftSumEnergy = clickedEnergy - energy,
          leftSumPix = self.xScale( leftSumEnergy  ),
          leftSumOutOfBounds = leftSumPix < 0 || leftSumPix > xmax;

      if( !self.leftSumPeak ) {
        /* draw left-sum peak line here */
        self.leftSumPeak = self.vis.append("line")
          .attr("class", "peakLine")
          .attr("stroke-width", 2)
          .attr("stroke", "black")
          .attr("x1", leftSumPix)
          .attr("x2", leftSumPix)
          .attr("y1", 0)
          .attr("y2", self.size.height);
        self.leftSumPeakText = self.vis.append("text")
          .attr("class", "peakText")
          .attr( "x", leftSumPix + xmax/200 )
          .attr( "y", self.size.height/3.4)
          .text( "Clicked Peak" );
        self.leftSumPeakMeas = self.vis.append("text")
          .attr("class", "peakText")
          .attr( "x", leftSumPix + xmax/125 )
          .attr( "y", self.size.height/3.0)
          .text( energy.toFixed(1) + "+" + leftSumEnergy.toFixed(1) + "=" + clickedEnergy.toFixed(1) + " keV" );
      } else {
        /* update the left sum peak line here */
        self.leftSumPeak
          .attr("x1", leftSumPix)
          .attr("x2", leftSumPix)
          .attr("y1", 0)
          .attr("y2", self.size.height); 
        self.leftSumPeakText
          .attr("class", "peakText")
          .attr( "x", leftSumPix + xmax/125 )
          .attr( "y", self.size.height/3.4);
        self.leftSumPeakMeas
          .attr( "x", leftSumPix + xmax/125 )
          .attr( "y", self.size.height/3.0)
          .text( energy.toFixed(1) + "+" + leftSumEnergy.toFixed(1) + "=" + clickedEnergy.toFixed(1) + " keV" );
        }

        if (leftSumOutOfBounds)
          deleteLeftSumPeakMarker();

    } else
      deleteLeftSumPeakMarker();


    if ( shouldUpdateSumPeak ) {
      var sumEnergy = energy + clickedEnergy,
          sumPix = self.xScale( sumEnergy  );

      var sumPeakOutOfBounds = sumPix < 0 || sumPix > xmax;
      if ( sumPeakOutOfBounds ) {
        deleteSumPeakMarker();
        return;
      }

      if (!clickedEnergy)
        return;

      if( !self.sumPeak ) {
        /* draw sum peak line here */
        self.sumPeak = self.vis.append("line")
          .attr("class", "peakLine")
          .attr("stroke-width", 2)
          .attr("stroke", "black")
          .attr("x1", sumPix)
          .attr("x2", sumPix)
          .attr("y1", 0)
          .attr("y2", self.size.height);
      self.sumPeakText = self.vis.append("text")
          .attr("class", "peakText")
          .attr( "x", sumPix + xmax/200 )
          .attr( "y", self.size.height/4)
          .text( "Sum Peak" );
      self.sumPeakMeas = self.vis.append("text")
          .attr("class", "peakText")
          .attr( "x", sumPix + xmax/125 )
          .attr( "y", self.size.height/3.7)
          .text( clickedEnergy.toFixed(1) + "+" + energy.toFixed(1) + "=" + sumEnergy.toFixed(1) + " keV" );
      } else {
        if (!self.sumPeakMeas)
          self.sumPeakMeas = self.vis.append("text")
                .attr("class", "peakText")
                .attr( "x", sumPix + xmax/125 )
                .attr( "y", self.size.height/3.7)
                .text( clickedEnergy.toFixed(1) + "+" + energy.toFixed(1) + "=" + sumEnergy.toFixed(1) + " keV" );

        self.sumPeak
          .attr("x1", sumPix)
          .attr("x2", sumPix)
          .attr("y1", 0)
          .attr("y2", self.size.height);
        self.sumPeakText
          .attr( "x", sumPix + xmax/125 )
          .attr( "y", self.size.height/4);
        self.sumPeakMeas
          .attr( "x", sumPix + xmax/125 )
          .attr( "y", self.size.height/3.7)
          .text( clickedEnergy.toFixed(1) + "+" + energy.toFixed(1) + "=" + sumEnergy.toFixed(1) + " keV" );
      }
    }
  }

  updateEscapePeaks();
  updateComptonPeaks();
  updateComptonEdge();
  updateSumPeaks(sumPeaksArgument);
}

SpectrumChartD3.prototype.setComptonEdge = function(d) {
  this.options.showComptonEdge = d;
  if ( d ) {
    this.updateFeatureMarkers();
  }
}

SpectrumChartD3.prototype.setComptonPeakAngle = function(d) {
  var value = Number(d);
  if (!isNaN(value) && 0 <= value && value <= 180 ) 
    this.comptonPeakAngle = value;
  else {
    this.comptonPeakAngle = 180;  /* default angle is set to 180 degrees */
  }
  this.updateFeatureMarkers();
}

SpectrumChartD3.prototype.setComptonPeaks = function(d) {
  this.options.showComptonPeaks = d;
  if ( !this.comptonPeakAngle )
    this.comptonPeakAngle = 180;
  if ( d ) {
    this.updateFeatureMarkers();
  }
}

SpectrumChartD3.prototype.setEscapePeaks = function(d) {
  this.options.showEscapePeaks = d;
  if ( d ) {
    this.updateFeatureMarkers();
  }
}

SpectrumChartD3.prototype.setSumPeaks = function(d) {
  this.options.showSumPeaks = d;
  if ( d ) {
    this.updateFeatureMarkers();
  }
}


/**
 * -------------- Chart Animation Functions --------------
 */
SpectrumChartD3.prototype.redrawZoomXAnimation = function(targetDomain) {
  var self = this;

  /* Cancel animation if showAnimation option not checked */
  if (!self.options.showAnimation) { return; }

  return function() {
    /* Cancel the animation once reached desired target domain */
    if (self.currentDomain == null || targetDomain == null || (self.currentDomain[0] == targetDomain[0] && self.currentDomain[1] == targetDomain[1])) {
      console.log("Time for animation = ", Math.floor(Date.now()) - self.startAnimationZoomTime, " ms");
      self.handleCancelAnimationZoom();
      return;
    }

    /* Use fraction of time elapsed to calculate how far we will zoom in this frame */
    var animationFractionTimeElapsed = Math.min( Math.max((Math.floor(Date.now()) - self.startAnimationZoomTime) / self.animation.duration), 1 );

    /* Set x-axis domain to new values */
    self.setXAxisRange(
      Math.min( self.savedDomain[0] + (animationFractionTimeElapsed * (targetDomain[0] - self.savedDomain[0])), targetDomain[0] ),
      Math.max( self.savedDomain[1] - (animationFractionTimeElapsed * (self.savedDomain[1] - targetDomain[1])), targetDomain[1] )
    );
    self.currentDomain = self.xScale.domain();

    /* Redraw and request a new animation frame */
    self.redraw()();
    self.zoomAnimationID = requestAnimationFrame(self.redrawZoomXAnimation(targetDomain));
  }
}

SpectrumChartD3.prototype.redrawZoomInYAnimation = function(targetDomain,redraw) {
  var self = this;

  function roundTo3DecimalPlaces(num) { return Math.round(num * 1000) / 1000; }

  /* Cancel animation if showAnimation option not checked */
  if (!self.options.showAnimation) { return; }

  return function() {
    /* Cancel the animation once reached desired target domain */
    if (self.currentDomain == null || targetDomain ==  null || 
      (roundTo3DecimalPlaces(self.currentDomain[0]) == roundTo3DecimalPlaces(targetDomain[0]) && 
        roundTo3DecimalPlaces(self.currentDomain[1]) == roundTo3DecimalPlaces(targetDomain[1]))) {

      console.log("Time for animation = ", Math.floor(Date.now()) - self.startAnimationZoomTime, " ms");
      self.handleCancelAnimationZoom();
      return;
    }

    /* Use fraction of time elapsed to calculate how far we will zoom in this frame */
    var animationFractionTimeElapsed = Math.min( Math.max((Math.floor(Date.now()) - self.startAnimationZoomTime) / self.animation.duration), 1 );

    /* Set y-axis domain to new values */
    self.yScale.domain([ 
      Math.max( self.savedDomain[0] - (animationFractionTimeElapsed * (self.savedDomain[0] - targetDomain[0])), targetDomain[0] ),
      Math.min( self.savedDomain[1] + (animationFractionTimeElapsed * (targetDomain[1] - self.savedDomain[1])), targetDomain[1] )
    ]);
    self.currentDomain = self.yScale.domain();

    /* Redraw and request a new animation frame */
    redraw();
    self.zoomAnimationID = requestAnimationFrame(self.redrawZoomInYAnimation(targetDomain, redraw));
  }
}

SpectrumChartD3.prototype.redrawZoomOutYAnimation = function(targetDomain, redraw) {
  var self = this;

  function roundTo3DecimalPlaces(num) { return Math.round(num * 1000) / 1000; }

  /* Cancel animation if showAnimation option not checked */
  if (!self.options.showAnimation) { return; }

  return function() {
    /* Cancel the animation once reached desired target domain */
    if (self.currentDomain == null || targetDomain ==  null || 
      (roundTo3DecimalPlaces(self.currentDomain[0]) == roundTo3DecimalPlaces(targetDomain[0]) && 
        roundTo3DecimalPlaces(self.currentDomain[1]) == roundTo3DecimalPlaces(targetDomain[1]))) {

      console.log("Time for animation = ", Math.floor(Date.now()) - self.startAnimationZoomTime, " ms");
      self.handleCancelAnimationZoom();
      return;
    }

    /* Use fraction of time elapsed to calculate how far we will zoom in this frame */
    var animationFractionTimeElapsed = Math.min( Math.max((Math.floor(Date.now()) - self.startAnimationZoomTime) / self.animation.duration), 1 );

    /* Set y-axis domain to new values */
    self.yScale.domain([ 
      Math.min( self.savedDomain[0] + (animationFractionTimeElapsed * (targetDomain[0] - self.savedDomain[0])), targetDomain[0] ),
      Math.max( self.savedDomain[1] - (animationFractionTimeElapsed * (self.savedDomain[1] - targetDomain[1])), targetDomain[1] )
    ]);
    self.currentDomain = self.yScale.domain();

    /* Redraw and request a new animation frame */
    redraw();
    self.zoomAnimationID = requestAnimationFrame(self.redrawZoomOutYAnimation(targetDomain, redraw));
  }
}

SpectrumChartD3.prototype.setShowAnimation = function(d) {
  this.options.showAnimation = d;
}

SpectrumChartD3.prototype.setAnimationDuration = function(d) {
  this.animation.duration = d;
}

SpectrumChartD3.prototype.handleCancelAnimationZoom = function() {
  var self = this;

  /* Cancel the animation frames */
  if (self.zoomAnimationID != null) {
    cancelAnimationFrame(self.zoomAnimationID);
  }

  /* Set animation properties to null */
  self.zoomAnimationID = null;
  self.currentDomain = null;
  self.savedDomain = null;
  self.startAnimationZoomTime = null;
}


/**
 * -------------- X-axis Zoom Functions --------------
 */
SpectrumChartD3.prototype.handleMouseMoveZoomInX = function () {
  var self = this;

  var zoomInXBox = d3.select("#zoomInXBox"),
      zoomInXText = d3.select("#zoomInXText");

  /* Cancel erase peaks mode, we're zooming in */
  self.handleCancelMouseDeletePeak();
  /* Cancel recalibration mode, we're zooming in */
  self.handleCancelMouseRecalibration();

  /* Cancel the zooming in y mode */
  self.handleCancelMouseZoomInY();

  /* Cancel the count gammas mode */
  self.handleCancelMouseCountGammas();

  if (!self.zoominmouse)  return;

  /* Adjust the mouse move position with respect to the bounds of the vis */
  if (self.lastMouseMovePos[0] < 0)
    self.lastMouseMovePos[0] = 0;
  else if (self.lastMouseMovePos[0] > self.size.width)
    self.lastMouseMovePos[0] = self.size.width;

  /* We are now zooming in */
  self.zooming_plot = true;

  /* Restore the zoom-in box */
  if (zoomInXBox.empty()) {
    zoomInXBox = self.vis.append("rect")
      .attr("id", "zoomInXBox")
      .attr("class","leftbuttonzoombox")
      .attr("width", 1 )
      .attr("height", self.size.height)
      .attr("x", self.lastMouseMovePos[0])
      .attr("y", 0)
      .attr("pointer-events", "none");
  }
  
  /* If click-and-drag reaches out of bounds from the plot */
  if (self.lastMouseMovePos[0] < 0 || self.lastMouseMovePos[0] > self.size.width) {
    /* Do something if click and drag reaches out of bounds from plot */
  }


  if( self.lastMouseMovePos[0] < self.zoominmouse[0] ) {      /* If the mouse position is less than the zoombox starting position (zoom-out) */

    /* If we were animating a zoom, cancel that animation */
    self.handleCancelAnimationZoom();

    /* Remove the zoom-in x-axis text, we are zooming out */
    zoomInXText.remove();

    self.zoominaltereddomain = true;
    zoomInXBox.attr("x", self.lastMouseMovePos[0])
      .attr("class","leftbuttonzoomoutbox")
      .attr("height", self.size.height)
      .attr("width", self.zoominmouse[0] - self.lastMouseMovePos[0] );

    /*Do some zooming out */
    var bounds = self.min_max_x_values();
    var xaxismin = bounds[0],
        xaxismax = bounds[1];

    var frac = 4 * (self.zoominmouse[0] - self.lastMouseMovePos[0]) / self.zoominmouse[0];

    if( !isFinite(frac) || isNaN(frac) || frac < 0.0 )
      frac = 0;

    var origdx = self.origdomain[1] - self.origdomain[0],
        maxdx = xaxismax - xaxismin,
        newdx = origdx + frac*(maxdx - origdx);

    var deltadx = newdx - origdx,
    newxmin = Math.max( self.origdomain[0] - 0.5*deltadx, xaxismin ),
    newxmax = Math.min( self.origdomain[1] + 0.5*deltadx, xaxismax );

    self.setXAxisRange(newxmin,newxmax);
    self.redraw()();

  } else {  
    /* Set the zoombox (this gets called when current mouse position is greater than where the zoombox started)  */
    if( self.zoominaltereddomain ) {
      self.setXAxisRange( self.origdomain[0], self.origdomain[1] );
      self.zoominaltereddomain = false;
      zoomInXBox.attr("class","leftbuttonzoombox");
      self.redraw()();
    }

    /* Update the zoomin-box x-position and width */
    zoomInXBox.attr("x", self.zoominmouse[0])
      .attr("width", self.lastMouseMovePos[0] - self.zoominmouse[0] );

    if (self.lastMouseMovePos[0] - self.zoominmouse[0] > 7) {   /* if zoom in box is at least 7px wide, update it */
      if (zoomInXText.empty()) {
        zoomInXText = self.vis.append("text")
          .attr("id", "zoomInXText")
          .attr("class", "chartLineText")
          .attr("y", Number(zoomInXBox.attr("height"))/2)
          .text("Zoom In");
      }

      /* keep zoom in label centered on the box */
      /* zoomInXText.attr("x", Number(zoomInXBox.attr("x")) + (Number(zoomInXBox.attr("width"))/2) - (zoomInXText[0][0].clientWidth/2) ); */
      zoomInXText.attr("x", ((self.zoominmouse[0] + self.lastMouseMovePos[0])/2) - 30);

    } else if (!zoomInXText.empty())       /* delete if zoom in box not wide enough (eg. will not zoom) */
      zoomInXText.remove();

  }
}

SpectrumChartD3.prototype.handleMouseUpZoomInX = function () {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  if (self.zooming_plot && self.lastMouseMovePos) { /* Need to add condition if self.lastMouseMovePos exists, or else error is thrown */
    var foreground = self.rawData.spectra[0];

    var lowerchanval = d3.bisector(function(d){return d.x0;}).left(foreground.points,self.xScale.invert(self.zoominmouse[0]),1) - 1;
    var higherchanval = d3.bisector(function(d){return d.x0;}).left(foreground.points,self.xScale.invert(self.lastMouseMovePos[0]),1) - 1;
    
    var yMinAtZoomRange = self.yScale(d3.min(foreground.points.slice(lowerchanval, higherchanval) , function(p) { return p.y; }));
    var yMaxAtZoomRange = self.yScale(d3.max(foreground.points.slice(lowerchanval, higherchanval) , function(p) { return p.y; }));

    /* Get the current mouse position */
    var m = d3.mouse(self.vis[0][0]);

    if( m[0] < self.zoominmouse[0] ) {
      /*we were zooming out, nothing to do here */

    } else {
      m[0] = m[0] < 0 ? 0 : m[0];

      var oldXScale = self.xScale.domain();

      /*This is a big hack, because self.xScale.invert(m[0]) == self.zoominx0 otherwise.  I dont completely understand why! */
      var x0 = self.xScale.invert(self.zoominmouse[0]),
          x1 = self.xScale.invert(m[0]);

      /*require the mouse to have moved at least 6 pixels in x */
      if( m[0] - self.zoominmouse[0] > 7 && self.rawData ) {
          
        var bounds = self.min_max_x_values();
        var mindatax = bounds[0], 
            maxdatax = bounds[1];
        
        /*Make sure the new scale will span at least one bin , if not  */
        /*  make it just less than one bin, centered on that bin. */
        var rawbi = d3.bisector(function(d){return d;}); 
        var lbin = rawbi.left(foreground.x, x0+(x1-x0));
        if( lbin > 1 && lbin < (foreground.x.length-1) && lbin === rawbi.left(foreground.x,x1+(x1-x0)) ) {
          /*This doesnt actually work correctly, it doesnt actually center on the bin, meaning you're always a little off from where you want ... */
          var corx0 = foreground.x[lbin-1];
          var corx1 = foreground.x[lbin];
          var p = 0.01*(corx1-corx0);
          corx0 += p;
          corx1 -= p;
          
          console.log( 'changing x0=' + x0 + ' and x1=' + x1 + " will set domain to " + (x0+(x1-x0)) + " through " + (x1+(x1-x0)) + " m[0]=" + m[0] + " self.zoominmouse[0]=" + self.zoominmouse[0] );
          self.setXAxisRange(Math.max(corx0+(x1-x0), mindatax),Math.min(corx1+(x1-x0), maxdatax));
        } else {
          self.setXAxisRange(x0,x1);
        }  

        /* Update the peak markers */
        self.updateFeatureMarkers(-1);
        
        if (self.options.showAnimation) {     /* Draw zoom animations if option is checked */

          /* Cancel any current zoom animations */
          self.handleCancelAnimationZoom();

          /* Start new zoom animation */
          self.currentDomain = self.savedDomain = oldXScale;
          self.zoomAnimationID = requestAnimationFrame(self.redrawZoomXAnimation([x0,x1]));
          self.startAnimationZoomTime = Math.floor(Date.now());

        } else { self.redraw()(); }   /* Zoom animation unchecked; draw new x-axis range */
      }
    }
  }


  self.handleCancelMouseZoomInX();

  self.zooming_plot = false;
}

SpectrumChartD3.prototype.handleCancelMouseZoomInX = function() {
  var self = this;

  var zoomInXBox = d3.select("#zoomInXBox"),
      zoomInXText = d3.select("#zoomInXText");

  /* Delete zoom in box and text */
  zoomInXText.remove();
  zoomInXBox.remove();

  /* Not zooming in plot anymore */
  self.zooming_plot = false;
}


/**
 * -------------- Y-axis Zoom Functions --------------
 */
SpectrumChartD3.prototype.redrawYAxis = function() {
  var self = this;

  return function() {
    self.do_rebin();
    var tx = function(d) { return "translate(" + self.xScale(d) + ",0)"; };
    var stroke = function(d) { return d ? "#ccc" : "#666"; };

    self.yAxisBody.call(self.yAxis);
    self.yAxisBody.selectAll("text").style("cursor", "ns-resize")
        .on("mouseover", function(d) { d3.select(this).style("font-weight", "bold");})
        .on("mouseout",  function(d) { d3.select(this).style("font-weight", "normal");})
        .on("mousedown.drag",  self.yaxisDrag())
        .on("touchstart.drag", self.yaxisDrag());

    self.drawYTicks();
    
    self.calcLeftPadding( true );

    self.drawXAxisArrows();
    
    self.drawPeaks();
    self.drawRefGammaLines();
    self.updateMouseCoordText();

    self.update(true);

    self.yAxisZoomedOutFully = false;
  }
}

SpectrumChartD3.prototype.setYAxisMinimum = function( minimum ) {
  var self = this;

  const maximum = self.yScale.domain()[0];

  self.yScale.domain([maximum, minimum]);
  self.redrawYAxis()();
}

SpectrumChartD3.prototype.setYAxisMaximum = function( maximum ) {
  var self = this;

  const minimum = self.yScale.domain()[1];

  self.yScale.domain([maximum, minimum]);
  self.redrawYAxis()();
}

SpectrumChartD3.prototype.setYAxisRange = function( minimum, maximum ) {
  var self = this;

  self.yScale.domain([maximum, minimum]);
  self.redrawYAxis()();
}

SpectrumChartD3.prototype.handleMouseMoveZoomInY = function () {
  var self = this;

  /* Set the objects displayed for zooming in the y-axis */
  var zoomInYBox = d3.select("#zoomInYBox"),
      zoomInYText = d3.select("#zoomInYText");

  /* Get the mouse coordinates */
  var m = d3.mouse(self.vis[0][0]);

  /* Cancel the zooming mode */
  self.handleCancelMouseZoomInX();

  /* Cancel erase peaks mode, we're zooming in */
  self.handleCancelMouseDeletePeak();

  /* Cancel recalibration mode, we're zooming in */
  self.handleCancelMouseRecalibration();

  /* Cancel the count gammas mode */
  self.handleCancelMouseCountGammas();

  /* Now zooming in y mode */
  self.zoomingYPlot = true;

  /* Create the reference for the start of the zoom-in (Yaxis) box */
  if (!self.zoomInYMouse)
    self.zoomInYMouse = self.lastMouseMovePos;

  /* Adjust the zoom in y mouse in case user starts dragging from out of bounds */
  if (self.zoomInYMouse[1] < 0)
    self.zoomInYMouse[1] = 0;
  else if (self.zoomInYMouse[1] > self.size.height)
    self.zoomInYMouse[1] = self.size.height;

  if (self.zoomInYMouse[0] < 0 || self.zoomInYMouse[0] > self.size.width) {
    self.handleCancelMouseZoomInY();
    return;
  }

  var height = self.lastMouseMovePos[1] - self.zoomInYMouse[1];

  /* Set the zoom-y box */
  if (zoomInYBox.empty()) {
    zoomInYBox = self.vis.append("rect")
      .attr("id", "zoomInYBox")
      .attr("class","leftbuttonzoombox")
      .attr("width", self.size.width )
      .attr("height", 0)
      .attr("x", 0)
      .attr("y", self.zoomInYMouse[1])
      .attr("pointer-events", "none");
  } else {
    if (height >= 0)  zoomInYBox.attr("height", height);
    else              zoomInYBox.attr("y", self.lastMouseMovePos[1])
                        .attr("height", Math.abs(height));
  }

  if (Math.abs(self.lastMouseMovePos[1] - self.zoomInYMouse[1]) > 10) {   /* if zoom in box is at least 7px wide, update it */
    if (zoomInYText.empty()) {
      zoomInYText = self.vis.append("text")
        .attr("id", "zoomInYText")
        .attr("class", "chartLineText");
      zoomInYText.attr("x", self.size.width/2 - (zoomInYText[0][0].clientWidth/2));

    }

    /* keep zoom in label centered on the box */
    zoomInYText.attr("y", Number(zoomInYBox.attr("y")) + (Number(zoomInYBox.attr("height"))/2) - (zoomInYBox[0][0].clientWidth/2) );

    if (height > 0) {
      zoomInYText.text("Zoom-In on Y-axis");
      zoomInYBox.attr("class", "leftbuttonzoombox");
    }
    else {
      var zoomOutText = "Zoom-out on Y-axis";
      if (-height < 0.05*self.size.height)
        zoomOutText += " x2";
      else if (-height < 0.075*self.size.height)
        zoomOutText += " x4";
      else
        zoomOutText += " full";

      zoomInYText.text(zoomOutText);
      zoomInYBox.attr("class", "leftbuttonzoomoutboxy");
    }

  } else if (!zoomInYText.empty()) {       /* delete if zoom in box not wide enough (eg. will not zoom) */
    zoomInYText.remove();
  }
}

SpectrumChartD3.prototype.handleMouseUpZoomInY = function () {
  var self = this;

  var zoomInYBox = d3.select("#zoomInYBox"),
      zoomInYText = d3.select("#zoomInYText");

  if (zoomInYBox.empty()) {
    self.handleCancelMouseZoomInY();
    return;
  }

  /* Set the y-values for where zoom-in occured */
  var ypix1 = Math.min(Number(zoomInYBox.attr("y")), self.lastMouseMovePos[1]),
      ypix2 = Math.max(Number(zoomInYBox.attr("y")), self.lastMouseMovePos[1]),
      y1 = Math.min(self.yScale.invert(Number(zoomInYBox.attr("y"))), 
                    self.yScale.invert(self.lastMouseMovePos[1]) ),
      y2 = Math.max(self.yScale.invert(Number(zoomInYBox.attr("y"))), 
                    self.yScale.invert(self.lastMouseMovePos[1]) );

  var oldY1 = self.yScale.domain()[0];
  var oldY2 = self.yScale.domain()[1];

  if (self.zoomingYPlot) {
    if (y2 > y1 && Math.abs(ypix2-ypix1) > 10) {  /* we are zooming in */
      if (self.options.showAnimation) {
        self.currentDomain = self.savedDomain = [oldY1, oldY2];

        if (self.zoomAnimationID != null) {
          cancelAnimationFrame(self.zoomAnimationID);
        }
        self.zoomAnimationID = requestAnimationFrame(self.redrawZoomInYAnimation([y2,y1], self.redrawYAxis()));
        self.startAnimationZoomTime = Math.floor(Date.now());

      } else { self.yScale.domain([y2,y1]); self.redrawYAxis()(); }

    } else {  /* we are zooming out */

      if (zoomInYText.empty()) {
        self.handleCancelMouseZoomInY();
        return;
      }

      /* Zoom out completely if user dragged up a considerable amount */
      if (zoomInYText.text().endsWith("full")) {

        /* If zoom animations are checked, animate the zoom out */
        if (self.options.showAnimation) {

          /* Cancel previous zoom animation if there was one */
          self.handleCancelAnimationZoom();

          /* Start new zoom animation */
          self.currentDomain = self.savedDomain = [oldY1, oldY2];
          self.zoomAnimationID = requestAnimationFrame(self.redrawZoomOutYAnimation([self.getYAxisDomain()[0],self.getYAxisDomain()[1]], self.redrawYAxis()));
          self.startAnimationZoomTime = Math.floor(Date.now());

        } else { self.redraw()(); }   /* Redraw the chart normally if no zoom animations created */

      } else { /* Zoom out a portion of the full y-axis */

        /* This represents how much of the y-axis we will be zooming out */
        var mult;

        /* Get the mult value here */
        /* For some reason, setting the mult = 1 leads to buggy behavior, so here I set it to x2, x4 respectively */
        if (zoomInYText.text().endsWith("x2"))  mult = 2; 
        else  mult = 4;


        /* Get the old values of the current y-domain */
        var oldY0 = self.yScale.domain()[0],
            oldY1 = self.yScale.domain()[1],
            oldRange = Math.abs(oldY1 - oldY0),
            centroid = oldY0 + 0.5*oldRange;

        /* Values for the minimum and maximum y values */
        var minY, maxY;

        if( !self.rawData || !self.rawData.y ){   /* Manually set the min/max y values */
          minY = 0.1;
          maxY = 3000;

        } else {                                  /* Get the min, max y values from the data */
          minY = self.getYAxisDomain()[1];
          maxY = self.getYAxisDomain()[0];
        }

        /* Set the values for the new y-domain */
        var newY0 = Math.max(centroid - mult*oldRange,
                             minY),
            newY1 = Math.min(newY0 + 2*mult*oldRange,
                             maxY);

        /* Accounting for bounds checking, making sure new y domain does not reach beyond min/max values */
        if (newY1 < 0 || newY1 > maxY)
          newY1 = maxY;
        if (newY0 > maxY || newY0 < 0)
          newY0 = minY;

        /* Redraw the newly y-zoomed chart */
        if (!(newY0 == minY && newY1 == maxY)) {

          /* If zoom animations are checked, animate the zoom out */
          if (self.options.showAnimation) {

            /* Cancel previous zoom animation if there was one */
            self.handleCancelAnimationZoom();

            /* Start new zoom animation */
            self.currentDomain = self.savedDomain = [oldY0, oldY1];
            self.zoomAnimationID = requestAnimationFrame(self.redrawZoomOutYAnimation([newY1, newY0], self.redrawYAxis()));
            self.startAnimationZoomTime = Math.floor(Date.now());

          } else { self.yScale.domain([newY1, newY0]); self.redrawYAxis()(); }   /* Redraw the chart normally if no zoom animations created */

        } else {  

          /* If zoom animations are checked, animate the zoom out */
          if (self.options.showAnimation) {

            /* Cancel previous zoom animation if there was one */
            self.handleCancelAnimationZoom();

            /* Start new zoom animation */
            self.currentDomain = self.savedDomain = [oldY0, oldY1];
            self.zoomAnimationID = requestAnimationFrame(self.redrawZoomOutYAnimation([newY1, newY0], self.redraw()));
            self.startAnimationZoomTime = Math.floor(Date.now());

          } else { 
            /* If the new y domain reaches the min/max values and we are still trying to zoom out, */
            /*    then we attempt to zoom out again to capture the initial starting point of the chart */
            self.redraw()();
          }
        }
      }

    }
  }

  /* Clean up objets from zooming in y-axis */
  self.handleCancelMouseZoomInY();
}

SpectrumChartD3.prototype.handleCancelMouseZoomInY = function() {
  var self = this;

  /* Set the objects displayed for zooming in the y-axis */
  var zoomInYBox = d3.select("#zoomInYBox"),
      zoomInYText = d3.select("#zoomInYText");

  /* Not zooming in y anymore */
  self.zoomingYPlot = false;
  self.zoomInYMouse = null;

  /* Delete zoom box and text */
  zoomInYBox.remove();
  zoomInYText.remove();
}

SpectrumChartD3.prototype.handleTouchMoveZoomInY = function() {
  var self = this;

  if (!self.touchesOnChart)
    return;

  /* Cancel delete peaks mode */
  self.handleCancelTouchDeletePeak();

  /* Cancel the create peaks mode */
  self.handleCancelTouchPeakFit();

  /* Cancel the count gammas mode */
  self.handleCancelTouchCountGammas();

  var t = d3.touches(self.vis[0][0]);

  var keys = Object.keys(self.touchesOnChart);

  if (keys.length !== 2)
    return;
  if (t.length !== 2)
    return;

  var zoomInYTopLine = d3.select("#zoomInYTopLine");
  var zoomInYBottomLine = d3.select("#zoomInYBottomLine");
  var zoomInYText = d3.select("#zoomInYText");

  var touch1 = self.touchesOnChart[keys[0]];
  var touch2 = self.touchesOnChart[keys[1]];
  var adx1 = Math.abs( touch1.startX - touch2.startX );
  var adx2 = Math.abs( touch1.pageX  - touch2.pageX );
  var ady1 = Math.abs( touch1.startY - touch2.startY );
  var ady2 = Math.abs( touch1.pageY  - touch2.pageY );
  var ddx = Math.abs( adx2 - adx1 );
  var ddy = Math.abs( ady2 - ady1 );
  var areVertical = (adx2 > ady2);

  if (!touch1.visY)
    touch1.visY = t[0][1];
  if (!touch2.visY)
    touch2.visY = t[1][1];

  var topTouch = touch1.pageY < touch2.pageY ? touch1 : touch2;
  var bottomTouch = topTouch == touch1 ? touch2 : touch1;

  if (zoomInYTopLine.empty()) {
    zoomInYTopLine = self.vis.append("line")
      .attr("id", "zoomInYTopLine")
      .attr("class", "mouseLine")
      .attr("x1", 0)
      .attr("x2", self.size.width)
      .attr("y1", topTouch.visY)
      .attr("y2", topTouch.visY)
      .attr("count", self.yScale.invert(topTouch.visY));
  }

  if (zoomInYBottomLine.empty()) {
    zoomInYBottomLine = self.vis.append("line")
      .attr("id", "zoomInYBottomLine")
      .attr("class", "mouseLine")
      .attr("x1", 0)
      .attr("x2", self.size.width)
      .attr("y1", bottomTouch.visY)
      .attr("y2", bottomTouch.visY)
      .attr("count", self.yScale.invert(bottomTouch.visY));
  }

  if (zoomInYText.empty()) {
    zoomInYText = self.vis.append("text")
      .attr("id", "zoomInYText")
      .attr("class", "mouseLineText");
  }

  zoomInYText.text(function() {
    if (topTouch.visY > topTouch.startY && bottomTouch.visY < bottomTouch.startY)
      return "Zoom-Out on Y-axis";
    else if (topTouch.visY == topTouch.startY && bottomTouch.visY == bottomTouch.startY)
      return "";
    else
      return "Zoom-In on Y-axis";
  });

  zoomInYText.attr("x", self.size.width/2 - Number(zoomInYText[0][0].clientWidth)/2)
    .attr("y", Number(topTouch.startY) + (bottomTouch.startY - topTouch.startY)/2);
}

SpectrumChartD3.prototype.handleTouchEndZoomInY = function() {
  var self = this;

  var zoomInYTopLine = d3.select("#zoomInYTopLine");
  var zoomInYBottomLine = d3.select("#zoomInYBottomLine");
  var zoomInYText = d3.select("#zoomInYText");

  if (zoomInYTopLine.empty() || zoomInYBottomLine.empty()) {
    self.handleTouchCancelZoomInY();
    return;
  }
  /* Set the y-values for where zoom-in occured */
  var ypix1 = Number(zoomInYTopLine.attr("y1")),
      ypix2 = Number(zoomInYBottomLine.attr("y1")),
      y1 = Number(zoomInYTopLine.attr("count")),
      y2 = Number(zoomInYBottomLine.attr("count"));

  console.log(y1, y2);
  /*
  This function is a similar method to the redraw function, except without certain actions
  taken out to only acount for redrawing the the zoomed chart by y-axis.
  */
  function redrawYAxis() {
    self.do_rebin();
    var tx = function(d) { return "translate(" + self.xScale(d) + ",0)"; };
    var stroke = function(d) { return d ? "#ccc" : "#666"; };

    self.yAxisBody.call(self.yAxis);
    self.yAxisBody.selectAll("text").style("cursor", "ns-resize")
        .on("mouseover", function(d) { d3.select(this).style("font-weight", "bold");})
        .on("mouseout",  function(d) { d3.select(this).style("font-weight", "normal");})
        .on("mousedown.drag",  self.yaxisDrag())
        .on("touchstart.drag", self.yaxisDrag());

    self.drawYTicks();
    
    self.calcLeftPadding( true );

    self.drawXTicks();

    self.drawXAxisArrows();
    
    self.drawPeaks();
    self.drawRefGammaLines();
    self.updateMouseCoordText();

    self.update();

    self.yAxisZoomedOutFully = false;
  }

  if (Math.abs(ypix2-ypix1) > 10) {  /* we are zooming in */
    if (zoomInYText.text().includes("Zoom-In")) {
      self.yScale.domain([y1,y2]);
      redrawYAxis();

    } else if (zoomInYText.text().includes("Zoom-Out")) {
        console.log("zooming out!");
        self.redraw()();
    }
  }
  self.handleTouchCancelZoomInY();
}

SpectrumChartD3.prototype.handleTouchCancelZoomInY = function() {
  var self = this;

  var zoomInYTopLine = d3.select("#zoomInYTopLine");
  var zoomInYBottomLine = d3.select("#zoomInYBottomLine");
  var zoomInYText = d3.select("#zoomInYText");

  zoomInYTopLine.remove();
  zoomInYBottomLine.remove();
  zoomInYText.remove();

  self.zoomInYPinch = null;
}


/**
 * -------------- Energy Recalibration Functions --------------
 */
SpectrumChartD3.prototype.handleMouseMoveRecalibration = function() {
  var self = this;

  /* Clear the zoom, we're recalibrating the chart */
  self.handleCancelMouseZoomInX();

  /* Cancel erase peaks mode, we're recalibrating the chart */
  self.handleCancelMouseDeletePeak();

  /* Cancel the zooming in y mode */
  self.handleCancelMouseZoomInY();

  /* Cancel the count gammas mode */
  self.handleCancelMouseCountGammas();

  if (!self.recalibrationMousePos)
    return;
  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) 
    return;

  /* Adjust the mouse move position with respect to the bounds of the vis */
  if (self.lastMouseMovePos[0] < 0)
    self.lastMouseMovePos[0] = 0;
  else if (self.lastMouseMovePos[0] > self.size.width)
    self.lastMouseMovePos[0] = self.size.width;

  /* Set the line objects to be referenced */
  var recalibrationStartLine = d3.select("#recalibrationStartLine"),
      recalibrationText = d3.select("#recalibrationText"),
      recalibrationMousePosLines = d3.select("#recalibrationMousePosLines");

  var recalibrationG = d3.select("#recalibrationG");
  var recalibrationPeakVis = d3.select("#recalibrationPeakVis");

  /* Set the line that symbolizes where user initially began right-click-and-drag */
  if (recalibrationStartLine.empty()) {
    recalibrationStartLine = self.vis.append("line")
      .attr("id", "recalibrationStartLine")
      .attr("class", "mouseLine")
      .attr("x1", self.recalibrationMousePos[0])
      .attr("x2", self.recalibrationMousePos[0])
      .attr("y1", 0)
      .attr("y2", self.size.height);
  }

  if (recalibrationText.empty()) {                       /* Right-click-and-drag text to say where recalibration ranges are */
    recalibrationText = self.vis.append("text")
      .attr("id", "recalibrationText")
      .attr("class", "mouseLineText")
      .attr("x", self.recalibrationMousePos[0] + 5 /* As padding from the starting line */ )
      .attr("y", self.size.height/2)
      .text("Recalibrate data from " + self.xScale.invert(self.lastMouseMovePos[0]).toFixed(2) + " to " + self.xScale.invert(self.lastMouseMovePos[0]).toFixed(2) + " keV");

  } else   /* Right-click-and-drag text already visible in vis, so just update it */
    recalibrationText.text( "Recalibrate data from " + self.xScale.invert(recalibrationStartLine.attr("x1")).toFixed(2) + " to " + self.xScale.invert(self.lastMouseMovePos[0]).toFixed(2) + " keV" )
  

  /* Draw the distance lines from the right-click-and-drag line to mouse position */
  if (!self.recalibrationDistanceLines) {
    var distanceLine;
    self.recalibrationDistanceLines = [];

    var lineSpacing = self.size.height / 5;

    /* Create 4 lines that draw from the right-click-and-drag initial starting point to where the mouse is */
    for (i = 0; i < 4; i++) {
      distanceLine = self.vis.append("line")
                            .attr("class", "secondaryMouseLine")
                            .attr("x1", recalibrationStartLine.attr("x1"))
                            .attr("x2", self.lastMouseMovePos[0])
                            .attr("y1", lineSpacing)
                            .attr("y2", lineSpacing);

      /* This is to add the the arrowhead end to the distance lines */
      var arrow = self.vis.append('svg:defs')
        .attr("id", "recalibrationArrowDef")
        .append("svg:marker")
          .attr("id", "rightClickDragArrow")
          .attr('class', 'xaxisarrow')
          .attr("refX", 0)
          .attr("refY", 7)
          .attr("markerWidth", 25)
          .attr("markerHeight", 25)
          .attr("orient", 0)
          .append("path")
            .attr("d", "M2,2 L2,13 L8,7 L2,2")
            .style("stroke", "black");

      distanceLine.attr("marker-end", "url(#rightClickDragArrow)");

      self.recalibrationDistanceLines.push(distanceLine);
      lineSpacing += self.size.height / 5;
    }

  } else {    /* Distance lines have already been drawn */
    for (i = 0; i < self.recalibrationDistanceLines.length; i++) {
      var x2 = self.lastMouseMovePos[0];

      /* If mouse position is to the left of the right-click-and-drag line */
      if (self.lastMouseMovePos[0] < recalibrationStartLine.attr("x1")) {
        self.recalibrationDistanceLines[i].attr("x2", x2);     /* Adjust the x-position of the line */

        d3.selectAll("#rightClickDragArrow > path").each(function(){            /* Flip the arrowhead to face towards the negative x-axis */
          d3.select(this).attr("transform", "translate(8,14) rotate(180)");
        });
      }
      else {
        /* To adjust for the length of the line with respect to its arrowhead */
        if (self.recalibrationDistanceLines[i].attr("x2") > 0)
          x2 -= 8;  /* Minus 8 to account for the arrow width connected to the line */
        else
          x2 = 0;

        /* Adjust the x-position of the line */
        self.recalibrationDistanceLines[i].attr("x2", x2);

        /* Un-flip the arrowhead (if it was flipped) back to pointing towards the positive x-axis */
        d3.selectAll("#rightClickDragArrow > path").each(function(){
          d3.select(this).attr("transform", null);
        });
      }
    }
  }

  /* Draw the line to represent the mouse position for recalibration */
  if (recalibrationMousePosLines.empty())
    recalibrationMousePosLines = self.vis.append("line")
      .attr("id", "recalibrationMousePosLines")
      .attr("class", "lightMouseLine")
      .attr("y1", 0)
      .attr("y2", self.size.height);
   
  /* Update the mouse position line for recalibration */
  recalibrationMousePosLines.attr("x1", self.lastMouseMovePos[0])
    .attr("x2", self.lastMouseMovePos[0]);

  /* Add the background for the recalibration animation */
  if (recalibrationG.empty()) {
    recalibrationG = self.vis.append("g")
      .attr("id", "recalibrationG")
      .attr("clip-path", "url(#clip" + this.chart.id + ")");
  }

  /* Add the foreground, background, and secondary lines for recalibration animation */
  for (var i = 0; i < self.rawData.spectra.length; ++i) {
    var spectrum = self.rawData.spectra[i];
    var recalibrationLine = d3.select("#recalibrationLine"+i);

    if (recalibrationLine.empty() && self['line'+i]) {
      recalibrationLine = recalibrationG.append("path")
        .attr("id", "recalibrationLine"+i)
        .attr("class", "rline")
        .attr("stroke", spectrum.lineColor ? spectrum.lineColor : 'black')
        .attr("d", self['line'+i](spectrum.points));
    }
  }

  if (recalibrationPeakVis.empty() && self.peakVis) {
    recalibrationPeakVis = recalibrationG.append("g")
      .attr("id", "recalibrationPeakVis")
      .attr("class", "peakVis")
      .attr("transform","translate(0,0)")
      .attr("clip-path", "url(#clip" + this.chart.id + ")");

    self.peakVis.selectAll("path").each(function() {
      path = d3.select(this);
      recalibrationPeakVis.append("path")
        .attr("class", path.attr("class"))
        .attr("d", path.attr("d"))
        .attr("fill-opacity", 0.4)
        .style("fill", path.style("fill"));
    });
  }

  recalibrationPeakVis.attr("transform", "translate(" + (self.lastMouseMovePos[0] - self.recalibrationMousePos[0]) + ",0)");

  /* Move the foreground, background, and secondary lines for recalibration animation with relation to mouse position */
  for (var i = 0; i < self.rawData.spectra.length; ++i) {
    var recalibrationLine = d3.select("#recalibrationLine"+i);

    if (!recalibrationLine.empty())
      recalibrationLine.attr("transform", "translate(" + (self.lastMouseMovePos[0] - self.recalibrationMousePos[0]) + ",0)");
  }
}

SpectrumChartD3.prototype.handleMouseUpRecalibration = function() {
  var self = this;

  /* Handle Right-click-and-drag (for recalibrating data) */
  if (self.recalibrationMousePos) {

    /* Emit the signal here */
    if (self.isRecalibrating) {
      console.log("Emit RECALIBRATION SIGNAL from x0 = ", self.xScale(self.recalibrationStartEnergy[0]), 
        "(", self.recalibrationStartEnergy[0], " keV) to x1 = ", 
        self.lastMouseMovePos[0], "(", 
        self.xScale.invert(self.lastMouseMovePos[0]), " keV)");
      self.WtEmit(self.chart.id, {name: 'rightmousedragged'}, self.recalibrationStartEnergy[0], self.xScale.invert(self.lastMouseMovePos[0]));
    }

    self.handleCancelMouseRecalibration();
  }

  /* User is not right-click-and-dragging any more, so set this to null */
  if (self.isRecalibrating)
    self.recalibrationMousePos = null;
}

SpectrumChartD3.prototype.handleCancelMouseRecalibration = function() {
  var self = this;

  var recalibrationStartLine = d3.select("#recalibrationStartLine"),
      recalibrationText = d3.select("#recalibrationText"),
      recalibrationMousePosLines = d3.select("#recalibrationMousePosLines");

  var recalibrationG = d3.select("#recalibrationG");
  var recalibrationPeakVis = d3.select("#recalibrationPeakVis");

  /* Remove the right-click-and-drag initial starting point line */
  recalibrationStartLine.remove();

  /* Remove the right-click-and-drag text */
  recalibrationText.remove()

  /* Remove the peak vis */
  recalibrationPeakVis.remove();

  /* Remove all the arrow defs created */
  d3.selectAll("#recalibrationArrowDef").each(function(){
    this.remove();
  });

  /* Remove the right-click-and-drag end-point line */
  if (self.recalibrationDistanceLines) {
    for (i = 0; i < self.recalibrationDistanceLines.length; i++) {
      self.recalibrationDistanceLines[i].remove();
    }
    self.recalibrationDistanceLines = null;
  }

  /* Remove the right-click-and-drag mouse line */
  recalibrationMousePosLines.remove();

  self.isRecalibrating = false;

  /* /* User is not right-click-and-dragging any more, so set this to null */
  if (self.isRecalibrating)
    self.recalibrationMousePos = null;

  recalibrationG.remove();
}


/**
 * -------------- Delete Peak Functions --------------
 */
SpectrumChartD3.prototype.handleMouseMoveDeletePeak = function() {
  var self = this;

  var deletePeaksBox = d3.select("#deletePeaksBox"),
      deletePeaksText = d3.select("#deletePeaksText");

  d3.event.preventDefault();
  d3.event.stopPropagation();

  /* Cancel the zooming mode */
  self.handleCancelMouseZoomInX();

  /* Cancel the recalibration mode */
  self.handleCancelMouseRecalibration();

  /* Cancel the zooming in y mode */
  self.handleCancelMouseZoomInY();

  /* Cancel the count gammas mode */
  self.handleCancelMouseCountGammas();

  if (!self.deletePeaksMouse)
    return;

  /* Adjust the mouse move position with respect to the bounds of the vis */
  if (self.lastMouseMovePos[0] < 0)
    self.lastMouseMovePos[0] = 0;
  else if (self.lastMouseMovePos[0] > self.size.width)
    self.lastMouseMovePos[0] = self.size.width;

  /* Create the erase-peaks range box and text  */
  if (deletePeaksBox.empty()) {
    deletePeaksBox = self.vis.append("rect")
      .attr("id", "deletePeaksBox")
      .attr("class","deletePeaksBox")
      .attr("width", Math.abs( self.deletePeaksMouse[0] - self.lastMouseMovePos[0] ))
      .attr("height", self.size.height)
      .attr("y", 0);

    deletePeaksText = self.vis.append("text")
      .attr("id", "deletePeaksText")
      .attr("class", "deletePeaksText")
      .attr("y", Number(deletePeaksBox.attr("height"))/2)
      .text("Will Erase Peaks In Range");

  } else {  /* Erase-peaks range box has already been created, update it */


    /* Adjust the width of the erase peaks box */
    deletePeaksBox.attr("width", Math.abs( self.deletePeaksMouse[0] - self.lastMouseMovePos[0] ));
  }

  deletePeaksBox.attr("x", self.lastMouseMovePos[0] < self.deletePeaksMouse[0] ? self.lastMouseMovePos[0] : self.deletePeaksMouse[0])

  /* Move the erase peaks text in the middle of the erase peaks range box */
  deletePeaksText.attr("x", Number(deletePeaksBox.attr("x")) + (Number(deletePeaksBox.attr("width"))/2) - 40 );
}

SpectrumChartD3.prototype.handleMouseUpDeletePeak = function() {
  var self = this;

  var deletePeaksBox = d3.select("#deletePeaksBox"),
      deletePeaksText = d3.select("#deletePeaksText");

  var deletePeaksRange;

  try {
    deletePeaksRange = [ 
      Math.min(self.xScale.invert(Number(deletePeaksBox.attr("x"))), self.xScale.invert(Number(deletePeaksBox.attr("x")) + Number(deletePeaksBox.attr("width")))), 
      Math.max(self.xScale.invert(Number(deletePeaksBox.attr("x"))), self.xScale.invert(Number(deletePeaksBox.attr("x")) + Number(deletePeaksBox.attr("width")))) 
      ];

    console.log("Emit ERASE PEAKS SIGNAL FROM ", deletePeaksRange[0], "keV to ", deletePeaksRange[1], " keV" );
    self.WtEmit(self.chart.id, {name: 'shiftkeydragged'}, deletePeaksRange[0], deletePeaksRange[1]);

  } catch (TypeError) { /* For some reason, a type error is (seldom) returned when trying to access "x" attribute of deletePeaksBox, doesn't affect overall functionality though */
    return;
  }

  self.handleCancelMouseDeletePeak();
}

SpectrumChartD3.prototype.handleCancelMouseDeletePeak = function() {
  var self = this;

  var deletePeaksBox = d3.select("#deletePeaksBox"),
      deletePeaksText = d3.select("#deletePeaksText");

  /* Delete the erase peaks box since we are not erasing peaks anymore */
  deletePeaksBox.remove();

  /* Delete the erase peaks text since we are not erasing peaks anymore */
  deletePeaksText.remove();

  /* We are not erasing peaks anymore */
  self.isDeletingPeaks = false;
}

SpectrumChartD3.prototype.handleTouchMoveDeletePeak = function() {
  var self = this;

  var t = self.deletePeaksTouches;

  if (t.length !== 2) {
    self.handleCancelTouchDeletePeak();
    return;
  }

  /* Cancel the count gammas mode */
  self.handleCancelTouchCountGammas();

  /* Cancel the create peaks mode */
  self.handleCancelTouchPeakFit();

  /* Cancel the zoom-in y mode */
  self.handleTouchCancelZoomInY();

  var deletePeaksBox = d3.select("#deletePeaksBox"),
      deletePeaksText = d3.select("#deletePeaksText");

  var leftTouch = t[0][0] < t[1][0] ? t[0] : t[1],
      rightTouch = leftTouch === t[0] ? t[1] : t[0];

  var leftTouchX = Math.min(leftTouch[0], self.xScale.range()[1]);
  var rightTouchX = Math.min(rightTouch[0], self.xScale.range()[1]);
  var width = Math.abs( rightTouchX - leftTouchX );

  if (leftTouchX > self.xScale.invert(self.xScale.domain()[1])) {
    self.handleCancelTouchDeletePeak();
    return;
  }

  /* Create the erase-peaks range box and text  */
  if (deletePeaksBox.empty()) {
    deletePeaksBox = self.vis.append("rect")
      .attr("id", "deletePeaksBox")
      .attr("class","deletePeaksBox")
      .attr("height", self.size.height)
      .attr("y", 0);

    deletePeaksText = self.vis.append("text")
      .attr("id", "deletePeaksText")
      .attr("class", "deletePeaksText")
      .attr("y", Number(deletePeaksBox.attr("height"))/2);

  }

  /* Adjust the positioning and width of the delete peaks box */
  deletePeaksBox.attr("x", leftTouchX)
    .attr("width", width);


  /* Move the erase peaks text in the middle of the erase peaks range box */
  deletePeaksText.text(width > 0 ? "Will Erase Peaks In Range" : "");
  deletePeaksText.attr("x", Number(deletePeaksBox.attr("x")) + (Number(deletePeaksBox.attr("width"))/2) - Number(deletePeaksText[0][0].clientWidth)/2 );
}

SpectrumChartD3.prototype.handleTouchEndDeletePeak = function() {
  var self = this;

  var deletePeaksBox = d3.select("#deletePeaksBox"),
      deletePeaksText = d3.select("#deletePeaksText");

  var deletePeaksRange;

  try {
    deletePeaksRange = [ 
      Math.min(self.xScale.invert(Number(deletePeaksBox.attr("x"))), self.xScale.invert(Number(deletePeaksBox.attr("x")) + Number(deletePeaksBox.attr("width")))), 
      Math.max(self.xScale.invert(Number(deletePeaksBox.attr("x"))), self.xScale.invert(Number(deletePeaksBox.attr("x")) + Number(deletePeaksBox.attr("width")))) 
      ];

    console.log("Emit ERASE PEAKS SIGNAL FROM ", deletePeaksRange[0], "keV to ", deletePeaksRange[1], " keV" );
    self.WtEmit(self.chart.id, {name: 'shiftkeydragged'}, deletePeaksRange[0], deletePeaksRange[1]);

  } catch (TypeError) { /* For some reason, a type error is (seldom) returned when trying to access "x" attribute of deletePeaksBox, doesn't affect overall functionality though */
    return;
  }

  self.handleCancelTouchDeletePeak();
}

SpectrumChartD3.prototype.handleCancelTouchDeletePeak = function() {
  var self = this;

  var deletePeaksBox = d3.select("#deletePeaksBox"),
      deletePeaksText = d3.select("#deletePeaksText");

  /* Delete the erase peaks box since we are not erasing peaks anymore */
  deletePeaksBox.remove();

  /* Delete the erase peaks text since we are not erasing peaks anymore */
  deletePeaksText.remove();

  /* We are not deleting peaks anymore, delete the touches */
  self.deletePeaksTouches = null;
}


/**
 * -------------- Count Gammas Functions --------------
 */
SpectrumChartD3.prototype.handleMouseMoveCountGammas = function() {
  var self = this

  d3.event.preventDefault();
  d3.event.stopPropagation();

  /* Cancel the zooming mode */
  self.handleCancelMouseZoomInX();

  /* Cancel the recalibration mode */
  self.handleCancelMouseRecalibration();

  /* Cancel the zooming in y mode */
  self.handleCancelMouseZoomInY();

  /* Cancel the delete peak mode */
  self.handleCancelMouseDeletePeak();

  if (!self.countGammasMouse || !self.lastMouseMovePos || !self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  function maxChannelSpectrum() {
    var result;
    self.rawData.spectra.forEach(function(spectrum) {
      if (!spectrum.points || !spectrum.points.length)
        return;
      if (!result || spectrum.points[spectrum.points.length-1].x > result.points[result.points.length-1].x)
        result = spectrum;
    });
    return result;
  }

  function gammaIntegral(spectrum, lowerX, upperX) {
    var sum = 0.0;
    var countGammasBox = d3.select("#countGammasBox");

    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length || countGammasBox.empty() || !spectrum)
      return sum;

    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];

    lowerX = Math.min( maxX, Math.max(lowerX, minX) );
    upperX = Math.max( minX, Math.min(upperX, maxX) );

    if (lowerX == upperX)
      return sum;

    if (lowerX > upperX) {  /* swap the two values */
      var tmp = lowerX;
      lowerX = upperX;
      upperX = tmp;
    }

    var maxChannel = spectrum.points.length - 1;
    var lowerChannel = d3.bisector(function(d){return d.x;}).left(spectrum.points,lowerX,1) - 1;
    var upperChannel = d3.bisector(function(d){return d.x;}).left(spectrum.points,upperX,1) - 1;

    var lowerLowEdge = spectrum.points[lowerChannel].x;
    var lowerBinWidth = lowerChannel < spectrum.points.length - 1 ? spectrum.points[lowerChannel+1].x - spectrum.points[lowerChannel].x : 
                                                                spectrum.points[lowerChannel].x - spectrum.points[lowerChannel-1].x;
    var lowerUpEdge = lowerLowEdge + lowerBinWidth;

    if (lowerChannel === upperChannel) {
      var frac = (upperX - lowerX) / lowerBinWidth;
      console.log("lowerChannel == upper channel, counts = ", frac * spectrum.points[lowerChannel].y);
      return frac * spectrum.points[lowerChannel].y;
    }

    var fracLowBin = (lowerUpEdge - lowerX) / lowerBinWidth;
    sum += fracLowBin * spectrum.points[lowerChannel].y;

    var upperLowEdge = spectrum.points[upperChannel].x;
    var upperBinWidth = upperChannel < spectrum.points.length - 1 ? spectrum.points[upperChannel+1].x - spectrum.points[upperChannel].x : 
                                                                spectrum.points[upperChannel].x - spectrum.points[upperChannel-1].x;

    var fracUpBin = (upperX - upperLowEdge) / upperBinWidth;
    sum += fracUpBin * spectrum.points[upperChannel].y;

    for (var channel = lowerChannel + 1; channel < upperChannel; channel++) {
      sum += spectrum.points[channel].y;
    }

    return sum;
  }
  function needsDecimal(num) {
    return num % 1 != 0;
  }

  /* Adjust the mouse move position with respect to the bounds of the vis */
  if (self.lastMouseMovePos[0] < 0)
    self.lastMouseMovePos[0] = 0;
  else if (self.lastMouseMovePos[0] > self.size.width)
    self.lastMouseMovePos[0] = self.size.width;

  var countGammasBox = d3.select("#countGammasBox"),
      countGammasText = d3.select("#countGammasText"),
      countGammaRangeText = d3.select("#countGammaRangeText"),
      sigmaCount = d3.select("#sigmaCount");
  var countGammasRange = [ 
      Number(self.xScale.invert(Number(self.countGammasMouse[0]).toFixed(1))), 
      Number(self.xScale.invert(Number(self.lastMouseMovePos[0]).toFixed(1)))
  ];

  /* Create the yellow box and text associated with it */
  if (countGammasBox.empty()) { 
    countGammasBox = self.vis.append("rect")
      .attr("id", "countGammasBox")
      .attr("width", Math.abs( self.countGammasMouse[0] - self.lastMouseMovePos[0] ))
      .attr("height", self.size.height)
      .attr("y", 0);

  } else {  /* Adjust the width of the erase peaks box */
    countGammasBox.attr("width", Math.abs( self.countGammasMouse[0] - self.lastMouseMovePos[0] ));
  }
  if (countGammasText.empty()) {
    countGammasText = self.vis.append("text")
      .attr("id", "countGammasText")
      .attr("class", "countGammasText")
      .attr("y", Number(countGammasBox.attr("height"))/2)
      .text("Gamma Counts");
  }
  var ypos = Number(countGammasBox.attr("height"))/2 + 15;   /* signifies the y-position of the text displayed */

  /* Mouse position to the left of initial starting point of count gammas box */
  if (self.lastMouseMovePos[0]  <= self.countGammasMouse[0]) {
    d3.selectAll('.asterickText').remove();
    countGammasBox.attr("class", "deletePeaksBox")
      .attr("x", self.lastMouseMovePos[0]);
    countGammasText.text("Will remove gamma count range");

    /* Move the count gammas text in the middle of the count gammas box */
    countGammasText.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) - 30 /*Number(countGammasText[0][0].clientWidth)/2*/ );

    /* Remove the counts text (we will not be counting gammas) */
    self.rawData.spectra.forEach(function(spectrum) {
      d3.select('#Spectrum-' + spectrum.id + 'CountsText').remove();
      d3.select('#Spectrum-' + spectrum.id + 'AsterickText').remove();
      d3.select("#asterickText"+i).remove();
    });
    countGammaRangeText.remove();
    sigmaCount.remove();

    return;

  } else {
    countGammasBox.attr("class", "countGammasBoxForward")
      .attr("x", self.lastMouseMovePos[0] < self.countGammasMouse[0] ? self.lastMouseMovePos[0] : self.countGammasMouse[0]);
    countGammasText.text("Gamma Counts");

    if (countGammaRangeText.empty())
      countGammaRangeText = self.vis.append("text")
        .attr("id", "countGammaRangeText")
        .attr("class", "countGammasText")
        .attr("y", ypos);


    countGammaRangeText.text((needsDecimal(countGammasRange[0]) ? countGammasRange[0].toFixed(1) : countGammasRange[0].toFixed()) + 
                              " to " + 
                              (needsDecimal(countGammasRange[1]) ? countGammasRange[1].toFixed(1) : countGammasRange[1].toFixed()) + " keV");
    countGammaRangeText.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) - 30 /*Number(countGammaRangeText[0][0].clientWidth)/2*/);
  }
  ypos += 15;

  /* Move the count gammas text in the middle of the count gammas box */
  countGammasText.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) - 30 /*Number(countGammasText[0][0].clientWidth)/2*/ );

  /* Display the count gammas text for all the spectrum */
  var nforeground, nbackground;
  var scaleBackground, backgroundScaleFactor, backgroundSigma, backgroundScaleSigma;
  var nsigma = 0, isneg;
  var asterickText = "";
  var rightPadding = 50;
  var specialScaleSpectras = [];
  self.rawData.spectra.forEach(function(spectrum, i) {   /* TODO: May need to change processing of */
    if (!spectrum)
      return;

    /* Get information from the spectrum */
    var spectrumSelector = 'Spectrum-' + spectrum.id;
    var spectrumCountsText = d3.select("#" + spectrumSelector + "CountsText");
    var spectrumScaleFactor = spectrum.yScaleFactor;
    var nspectrum = gammaIntegral(spectrum, countGammasRange[0], countGammasRange[1]);
    var spectrumGammaCount = Number((spectrumScaleFactor * nspectrum).toFixed(2));
    var countsText;

    /* Save information for the foreground and background (for sigma comparison) */
    if (spectrum.type === self.spectrumTypes.FOREGROUND)
      nforeground = nspectrum;
    else if (spectrum.type === self.spectrumTypes.BACKGROUND) {
      nbackground = nspectrum;
      backgroundScaleFactor = spectrumScaleFactor;
      scaleBackground = nbackground * backgroundScaleFactor;
    }

    /* Get the text to be displayed from the spectrum information */
    if (spectrumScaleFactor != null && spectrumScaleFactor !== -1)
      countsText = spectrum.title + ": " + (needsDecimal(spectrumGammaCount) ? spectrumGammaCount.toFixed(2) : spectrumGammaCount.toFixed());
    if (spectrumScaleFactor != 1) {
      asterickText += "*";
      if (countsText)
        countsText += asterickText;
      specialScaleSpectras.push(asterickText + "scaled by " + 
        (needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed()) + " from actual");
    }

    /* Output the count gammas information to the chart */
    if (countsText) {
      if (spectrumCountsText.empty())
        spectrumCountsText = self.vis.append("text")
          .attr("id", spectrumSelector + "CountsText")
          .attr("class", "countGammasText")
          .attr("y", ypos);
      spectrumCountsText.text(countsText); 
      spectrumCountsText.attr("x", Number(countGammasText.attr("x")) - rightPadding );
      ypos += 15;

    } else {
      spectrumCountsText.remove();
    }
  });

  /* Get proper information for foreground-background sigma comparison */
  if (nforeground && nbackground && backgroundScaleFactor) {
    backgroundSigma = Math.sqrt(nbackground);
    backgroundScaleSigma = backgroundScaleFactor * backgroundSigma;
    nsigma = backgroundScaleSigma == 0 ? 0 : (Number((Math.abs(nforeground - scaleBackground) / backgroundScaleSigma).toFixed(3)));
    isneg = scaleBackground > nforeground;
  }

  /* Output foreground-background sigma information if it is available */
  if (nsigma > 0) {
    if (sigmaCount.empty())
      sigmaCount = self.vis.append("text")
        .attr("id", "sigmaCount")
        .attr("class", "countGammasText")
        .attr("y", ypos);

    sigmaCount.attr("x", Number(countGammasText.attr("x")) - rightPadding + 10)
      .text("Foreground is " + (needsDecimal(nsigma) ? nsigma.toFixed(2) : nsigma.toFixed() ) + " σ " + (isneg ? "below" : "above") + " background.");
    ypos += 15;

  } else if (!sigmaCount.empty()) {
      sigmaCount.remove();
  }

  /* Output all the corresponding asterick text with each spectrum (if scale factor != 1) */
  specialScaleSpectras.forEach(function(string, i) {
    if (string == null || !string.length)
      return;
    var stringnode = d3.select("#asterickText" + i);

    if (stringnode.empty())
      stringnode = self.vis.append("text")
        .attr("id", "asterickText"+i)
        .attr("class", "countGammasText asterickText")
        .text(string);
    stringnode.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) + rightPadding/3)
      .attr("y", ypos);
    ypos += 15;
  });

  /* Hide all the count gamma text when the mouse box is empty */
  if (Number(countGammasBox.attr("width")) == 0)
    d3.selectAll(".countGammasText").attr("fill-opacity", 0);
  else
    d3.selectAll(".countGammasText").attr("fill-opacity", 1);

}

SpectrumChartD3.prototype.handleMouseUpCountGammas = function() {
  var self = this;

  var countGammasBox = d3.select("#countGammasBox"),
      countGammasText = d3.select("#countGammasText");

  var countGammasRange;

  try {
    countGammasRange = [ 
      Math.min(self.xScale.invert(Number(countGammasBox.attr("x"))), self.xScale.invert(Number(countGammasBox.attr("x")) + Number(countGammasBox.attr("width")))), 
      Math.max(self.xScale.invert(Number(countGammasBox.attr("x"))), self.xScale.invert(Number(countGammasBox.attr("x")) + Number(countGammasBox.attr("width")))) 
      ];

    if (self.lastMouseMovePos[0] < self.countGammasMouse[0]) {
      console.log("Emit REMOVE GAMMA COUNT SIGNAL FROM ", countGammasRange[0], "keV to ", countGammasRange[1], " keV" );
    } else {
      console.log("Emit COUNT GAMMAS SIGNAL FROM ", countGammasRange[0], "keV to ", countGammasRange[1], " keV" );
    }

    self.WtEmit(self.chart.id, {name: 'shiftaltkeydragged'}, countGammasRange[0], countGammasRange[1]);
    
  } catch (TypeError) { /* For some reason, a type error is (seldom) returned when trying to access "x" attribute of countGammasBox, doesn't affect overall functionality though */
    return;
  }

  self.handleCancelMouseCountGammas();
}

SpectrumChartD3.prototype.handleCancelMouseCountGammas = function() {
  var self = this;

  var countGammasBox = d3.select("#countGammasBox"),
      countGammasText = d3.select("#countGammasText");

  /* Delete the count gammas box since we are not counting gammas anymore */
  countGammasBox.remove();

  /* Delete the count gamma texts since we are not counting gammas anymore */
  self.vis.selectAll(".countGammasText").remove()

  /* We are not erasing peaks anymore */
  self.isCountingGammas = false;
}

SpectrumChartD3.prototype.handleTouchMoveCountGammas = function() {
  var self = this;

  /* Cancel delete peaks mode */
  self.handleCancelTouchDeletePeak();

  /* Cancel the create peaks mode */
  self.handleCancelTouchPeakFit();

  /* Cancel the zoom-in y mode */
  self.handleTouchCancelZoomInY();


  var t = d3.touches(self.vis[0][0]);

  if (t.length !== 2 || !self.countGammasStartTouches) {
    self.handleCancelTouchCountGammas();
    return;
  }

  function gammaIntegral(spectrum, lowerX, upperX) {
    var sum = 0.0;
    var countGammasBox = d3.select("#countGammasBox");

    if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length || countGammasBox.empty() || !spectrum)
      return sum;

    var bounds = self.min_max_x_values();
    var maxX = bounds[1];
    var minX = bounds[0];

    lowerX = Math.min( maxX, Math.max(lowerX, minX) );
    upperX = Math.max( minX, Math.min(upperX, maxX) );

    if (lowerX == upperX)
      return sum;

    if (lowerX > upperX) {  /* swap the two values */
      var tmp = lowerX;
      lowerX = upperX;
      upperX = tmp;
    }

    var maxChannel = spectrum.points.length - 1;
    var lowerChannel = d3.bisector(function(d){return d.x;}).left(spectrum.points,lowerX,1) - 1;
    var upperChannel = d3.bisector(function(d){return d.x;}).left(spectrum.points,upperX,1) - 1;

    var lowerLowEdge = spectrum.points[lowerChannel].x;
    var lowerBinWidth = lowerChannel < spectrum.points.length - 1 ? spectrum.points[lowerChannel+1].x - spectrum.points[lowerChannel].x : 
                                                                spectrum.points[lowerChannel].x - spectrum.points[lowerChannel-1].x;
    var lowerUpEdge = lowerLowEdge + lowerBinWidth;

    if (lowerChannel === upperChannel) {
      var frac = (upperX - lowerX) / lowerBinWidth;
      console.log("lowerChannel == upper channel, counts = ", frac * spectrum.points[lowerChannel].y);
      return frac * spectrum.points[lowerChannel].y;
    }

    var fracLowBin = (lowerUpEdge - lowerX) / lowerBinWidth;
    sum += fracLowBin * spectrum.points[lowerChannel].y;

    var upperLowEdge = spectrum.points[upperChannel].x;
    var upperBinWidth = upperChannel < spectrum.points.length - 1 ? spectrum.points[upperChannel+1].x - spectrum.points[upperChannel].x : 
                                                                spectrum.points[upperChannel].x - spectrum.points[upperChannel-1].x;

    var fracUpBin = (upperX - upperLowEdge) / upperBinWidth;
    sum += fracUpBin * spectrum.points[upperChannel].y;

    for (var channel = lowerChannel + 1; channel < upperChannel; channel++) {
      sum += spectrum.points[channel].y;
    }

    return sum;
  }
  function needsDecimal(num) {
    return num % 1 != 0;
  }

  var leftStartTouch = self.countGammasStartTouches[0][0] < self.countGammasStartTouches[1][0] ? self.countGammasStartTouches[0] : self.countGammasStartTouches[1],
      rightStartTouch = leftStartTouch === self.countGammasStartTouches[0] ? self.countGammasStartTouches[1] : self.countGammasStartTouches[0];

  var leftTouch = t[0][0] < t[1][0] ? t[0] : t[1],
      rightTouch = leftTouch === t[0] ? t[1] : t[0];

  var countGammasBox = d3.select("#countGammasBox"),
      countGammasText = d3.select("#countGammasText"),
      countGammaRangeText = d3.select("#countGammaRangeText"),
      foregroundCountsText = d3.select("#foregroundCountsText"),
      backgroundCountsText = d3.select("#backgroundCountsText"),
      secondaryCountsText = d3.select("#secondaryCountsText")
      foregroundAsterickText = d3.select("#foregroundAsterickText"),
      backgroundAsterickText = d3.select("#backgroundAsterickText"),
      secondaryAsterickText = d3.select("#secondaryAsterickText"),
      sigmaCount = d3.select("#sigmaCount");

  var countGammasRange = [ 
      self.xScale.invert(leftStartTouch[0]), 
      Math.min(self.xScale.invert(rightTouch[0]), self.xScale.domain()[1])
  ];

  /* Create the yellow box and text associated with it */
  if (countGammasBox.empty()) { 
    countGammasBox = self.vis.append("rect")
      .attr("id", "countGammasBox")
      .attr("width", Math.min( Math.abs( leftStartTouch[0] - rightTouch[0] ) , Math.abs( self.xScale.range()[1] - leftStartTouch[0] ) ))
      .attr("height", self.size.height)
      .attr("y", 0);

  } else {  /* Adjust the width of the erase peaks box */
    countGammasBox.attr("width", Math.min( Math.abs( leftStartTouch[0] - rightTouch[0] ) , Math.abs( self.xScale.range()[1] - leftStartTouch[0] ) ));
  }
  if (countGammasText.empty()) {
    countGammasText = self.vis.append("text")
      .attr("id", "countGammasText")
      .attr("class", "countGammasText")
      .attr("y", Number(countGammasBox.attr("height"))/2)
      .text("Gamma Counts");
  }
  var ypos = Number(countGammasBox.attr("height"))/2 + 15;   /* signifies the y-position of the text displayed */

  /* Mouse position to the left of initial starting point of count gammas box */
  if (rightTouch[0]  <= leftStartTouch[0]) {
    countGammasBox.attr("class", "deletePeaksBox")
      .attr("x", rightTouch[0]);
    countGammasText.text("Will remove gamma count range");

    /* Move the count gammas text in the middle of the count gammas box */
    countGammasText.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) - 30 /*Number(countGammasText[0][0].clientWidth)/2*/ );

    /* Remove the counts text (we will not be counting gammas) */
    d3.selectAll('.asterickText').remove();
    self.rawData.spectra.forEach(function(spectrum, i) {
      d3.select('#Spectrum-' + spectrum.id + 'CountsText').remove();
      d3.select('#Spectrum-' + spectrum.id + 'AsterickText').remove();
      d3.select("#asterickText"+i).remove();
    });
    countGammaRangeText.remove();
    sigmaCount.remove();

    return;

  } else {
    countGammasBox.attr("class", "countGammasBoxForward")
      .attr("x", rightTouch[0] < leftStartTouch[0] ? rightTouch[0] : leftStartTouch[0]);
    countGammasText.text("Gamma Counts");

    if (countGammaRangeText.empty())
      countGammaRangeText = self.vis.append("text")
        .attr("id", "countGammaRangeText")
        .attr("class", "countGammasText")
        .attr("y", ypos);


    countGammaRangeText.text((needsDecimal(countGammasRange[0]) ? countGammasRange[0].toFixed(1) : countGammasRange[0].toFixed()) + 
                              " to " + 
                              (needsDecimal(countGammasRange[1]) ? countGammasRange[1].toFixed(1) : countGammasRange[1].toFixed()) + " keV");
    countGammaRangeText.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) - 30 /*Number(countGammaRangeText[0][0].clientWidth)/2*/);
  }
  ypos += 15;

  /* Move the count gammas text in the middle of the count gammas box */
  countGammasText.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) - 30 /*Number(countGammasText[0][0].clientWidth)/2*/ );

  /* Display the count gammas text for all the spectrum */
  var nforeground, nbackground;
  var scaleBackground, backgroundScaleFactor, backgroundSigma, backgroundScaleSigma;
  var nsigma = 0, isneg;
  var asterickText = "";
  var rightPadding = 50;
  var specialScaleSpectras = [];
  self.rawData.spectra.forEach(function(spectrum, i) {   /* TODO: May need to change processing of */
    if (!spectrum)
      return;

    /* Get information from the spectrum */
    var spectrumSelector = 'Spectrum-' + spectrum.id;
    var spectrumCountsText = d3.select("#" + spectrumSelector + "CountsText");
    var spectrumScaleFactor = spectrum.yScaleFactor;
    var nspectrum = gammaIntegral(spectrum, countGammasRange[0], countGammasRange[1]);
    var spectrumGammaCount = Number((spectrumScaleFactor * nspectrum).toFixed(2));
    var countsText;

    /* Save information for the foreground and background (for sigma comparison) */
    if (spectrum.type === self.spectrumTypes.FOREGROUND)
      nforeground = nspectrum;
    else if (spectrum.type === self.spectrumTypes.BACKGROUND) {
      nbackground = nspectrum;
      backgroundScaleFactor = spectrumScaleFactor;
      scaleBackground = nbackground * backgroundScaleFactor;
    }

    /* Get the text to be displayed from the spectrum information */
    if (spectrumScaleFactor != null && spectrumScaleFactor !== -1)
      countsText = spectrum.title + ": " + (needsDecimal(spectrumGammaCount) ? spectrumGammaCount.toFixed(2) : spectrumGammaCount.toFixed());
    if (spectrumScaleFactor != 1) {
      asterickText += "*";
      if (countsText)
        countsText += asterickText;
      specialScaleSpectras.push(asterickText + "scaled by " + 
        (needsDecimal(spectrumScaleFactor) ? spectrumScaleFactor.toFixed(3) : spectrumScaleFactor.toFixed()) + " from actual");
    }

    /* Output the count gammas information to the chart */
    if (countsText) {
      if (spectrumCountsText.empty())
        spectrumCountsText = self.vis.append("text")
          .attr("id", spectrumSelector + "CountsText")
          .attr("class", "countGammasText")
          .attr("y", ypos);
      spectrumCountsText.text(countsText); 
      spectrumCountsText.attr("x", Number(countGammasText.attr("x")) - rightPadding );
      ypos += 15;

    } else {
      spectrumCountsText.remove();
    }
  });

  /* Get proper information for foreground-background sigma comparison */
  if (nforeground && nbackground && backgroundScaleFactor) {
    backgroundSigma = Math.sqrt(nbackground);
    backgroundScaleSigma = backgroundScaleFactor * backgroundSigma;
    nsigma = backgroundScaleSigma == 0 ? 0 : (Number((Math.abs(nforeground - scaleBackground) / backgroundScaleSigma).toFixed(3)));
    isneg = scaleBackground > nforeground;
  }

  /* Output foreground-background sigma information if it is available */
  if (nsigma > 0) {
    if (sigmaCount.empty())
      sigmaCount = self.vis.append("text")
        .attr("id", "sigmaCount")
        .attr("class", "countGammasText")
        .attr("y", ypos);

    sigmaCount.attr("x", Number(countGammasText.attr("x")) - rightPadding + 10)
      .text("Foreground is " + (needsDecimal(nsigma) ? nsigma.toFixed(2) : nsigma.toFixed() ) + " σ " + (isneg ? "below" : "above") + " background.");
    ypos += 15;

  } else if (!sigmaCount.empty()) {
      sigmaCount.remove();
  }

  /* Output all the corresponding asterick text with each spectrum (if scale factor != 1) */
  specialScaleSpectras.forEach(function(string, i) {
    if (string == null || !string.length)
      return;
    var stringnode = d3.select("#asterickText" + i);

    if (stringnode.empty())
      stringnode = self.vis.append("text")
        .attr("id", "asterickText"+i)
        .attr("class", "countGammasText asterickText")
        .text(string);
    stringnode.attr("x", Number(countGammasBox.attr("x")) + (Number(countGammasBox.attr("width"))/2) + rightPadding/3)
      .attr("y", ypos);
    ypos += 15;
  });

  /* Hide all the count gamma text when the mouse box is empty */
  if (Number(countGammasBox.attr("width")) == 0)
    d3.selectAll(".countGammasText").attr("fill-opacity", 0);
  else
    d3.selectAll(".countGammasText").attr("fill-opacity", 1);
}

SpectrumChartD3.prototype.handleTouchEndCountGammas = function() {
  var self = this;

  var countGammasBox = d3.select("#countGammasBox"),
      countGammasText = d3.select("#countGammasText");

  var countGammasRange;

  try {
    countGammasRange = [ 
      Math.min(self.xScale.invert(Number(countGammasBox.attr("x"))), self.xScale.invert(Number(countGammasBox.attr("x")) + Number(countGammasBox.attr("width")))), 
      Math.max(self.xScale.invert(Number(countGammasBox.attr("x"))), self.xScale.invert(Number(countGammasBox.attr("x")) + Number(countGammasBox.attr("width")))) 
      ];

    console.log("Emit COUNT GAMMAS SIGNAL FROM ", countGammasRange[0], "keV to ", countGammasRange[1], " keV" );
    self.WtEmit(self.chart.id, {name: 'shiftaltkeydragged'}, countGammasRange[0], countGammasRange[1]);

  } catch (TypeError) { /* For some reason, a type error is (seldom) returned when trying to access "x" attribute of countGammasBox, doesn't affect overall functionality though */
    return;
  }

  self.handleCancelTouchCountGammas();
}

SpectrumChartD3.prototype.handleCancelTouchCountGammas = function() {
  var self = this;

  var countGammasBox = d3.select("#countGammasBox"),
      countGammasText = d3.select("#countGammasText"),
      foregroundCountsText = d3.select("#foregroundCountsText"),
      backgroundCountsText = d3.select("#backgroundCountsText"),
      secondaryCountsText = d3.select("#secondaryCountsText");

  /* Delete the count gammas box since we are not counting gammas anymore */
  countGammasBox.remove();

  /* Delete the count gamma texts since we are not counting gammas anymore */
  d3.selectAll(".countGammasText").forEach(function (texts) {
    texts.forEach(function(text) {
      text.remove();
    })
  });
}


/**
 * -------------- Peak Info and Display Functions --------------
 */
SpectrumChartD3.prototype.handleMouseOverPeak = function(peakElem, d, peakIndex, paths, roi, path) {
  var self = this;

  self.highlightPeak(peakElem, peakIndex, paths, path);
  // self.displayPeakInfo(info, d3.event.x);
}

SpectrumChartD3.prototype.handleMouseOutPeak = function(peakElem, d, highlightedPeak, paths) {
  var self = this;

  var event = d3.event;

  /* Returns true if a node is a descendant (or is) of a parent node. */
  function isElementDescendantOf(parent, node) {
    while (node != null) {
      if (node == parent) return true;
      node = node.parentNode;
    }
    return false;
  }
  
  if (self.peakInfo && isElementDescendantOf(self.peakInfo.node(), event.toElement)) {
    return self.handleMouseMovePeak()();
  }

  self.unhighlightPeak(d, highlightedPeak, paths);
}

SpectrumChartD3.prototype.handleMouseMovePeak = function() {
  var self = this;

  return function() {
    const event = d3.event;

    if (self.peakInfo) {
      const x = event.x;
      const box = self.peakInfoBox;
      const translate = Number(self.peakInfo.attr("transform")
        .replace("translate(", "")
        .replace(")","")
        .split(',')[0]);

      const shouldMovePeakInfoLeft = x >= box.x && x <= box.x + box.width;

      self.peakInfo.attr("transform","translate(" 
        + (shouldMovePeakInfoLeft ? (self.padding.leftComputed + 115) : self.size.width) 
        + "," + (self.size.height - 40) + ")");
    }
  }
}

SpectrumChartD3.prototype.getPeakInfoObject = function(roi, energy, spectrumIndex) {
  var self = this;

  // No ROI given, so skip
  if (!roi) 
    return null;

  let peak;
  let minDistance = Infinity;

  roi.peaks.forEach(function(roiPeak) {
    const distance = Math.abs(energy - roiPeak.Centroid[0]);

    if (distance < minDistance) {
      minDistance = distance;
      peak = roiPeak;
    }
  });

  // No peak found, so skip
  if (!peak) 
    return null;

  /*A function to integrate the area bellow the continuum between x0 and x1  */
  /*  for a given refrence energy */
  function offset_eqn_integral(coeffs,refEnergy,x0,x1) {
    x0 -= refEnergy;
    x1 -= refEnergy;
    var answer = 0.0;
    for( var order = 0; order < coeffs.length; ++order ) {
      var exp = order + 1.0;
      answer += (coeffs[order]/exp) * (Math.pow(x1,exp) - Math.pow(x0,exp));
    }
    return answer;
  };

  const coeffs = roi.coeffs;
  const referenceEnergy = roi.referenceEnergy;
  const lowerEnergy = roi.lowerEnergy;
  const upperEnergy = roi.upperEnergy;

  const mean = peak.Centroid[0].toFixed(2);
  const fwhm = (2.35482 * peak.Width[0]).toFixed(2);
  const fwhmPerc = (235.482 * peak.Width[0] / peak.Centroid[0]).toFixed(2);
  const chi2 = peak.Chi2[0].toFixed(2);
  const area = peak.Amplitude[0].toFixed(1);
  const areaUncert = peak.Amplitude[1].toFixed(1);
  const contArea = offset_eqn_integral(coeffs, referenceEnergy, lowerEnergy, upperEnergy).toFixed(1);

  const info = {
    mean: mean, 
    fwhm: fwhm, 
    fwhmPerc: fwhmPerc, 
    chi2: chi2, 
    area: area, 
    areaUncert: areaUncert, 
    contArea: contArea, 
    spectrumIndex: spectrumIndex,
  };
  return info;
}

SpectrumChartD3.prototype.updatePeakInfo = function() {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  const x = d3.mouse(self.vis.node())[0];
  const energy = self.xScale.invert(x);
  let resultROI;
  let spectrumIndex;

  // Find a peak that our mouse energy point is overlapping with
  self.rawData.spectra.forEach(function(spectrum, i) {
    if (resultROI) // we found a peak already, skip the rest
      return;
    if (!self.options.drawPeaksFor[spectrum.type])
      return;

    spectrum.peaks.forEach(function(peak, j) {
      if (!resultROI && peak.lowerEnergy <= energy && energy <= peak.upperEnergy) {  // we haven't found a peak yet
        resultROI = peak;
        spectrumIndex = i;
      }
    });
  });
  
  // No peak found, so hide the info box
  if (!resultROI) {
    self.hidePeakInfo();
    return;
  } 
  
  const info = self.getPeakInfoObject(resultROI, energy, spectrumIndex);
  self.displayPeakInfo(info);
}

SpectrumChartD3.prototype.displayPeakInfo = function(info) {
  var self = this;

  function createPeakInfoText(text, label, value, special) {
    let span = text.append("tspan")
      .attr('class', "peakInfoLabel")
      .attr('x', "-13.5em")
      .attr('dy', "-1em")
      .text(label + ': ');
    span.append("tspan")
      .style('font-weight', "normal")
      .text( value );
  }

  const areMultipleSpectrumPeaksShown = self.areMultipleSpectrumPeaksShown();
  let x = d3.event.clientX;

  self.hidePeakInfo();

  self.peakInfo = self.vis.append("g")
    .attr("class", "peakInfo")
    .attr("transform","translate(" + self.size.width + "," + (self.size.height - 40) + ")");

  var rect = self.peakInfo.append('rect')
    .attr("class", "peakInfoBox")
    .attr('height', areMultipleSpectrumPeaksShown ? "6.5em" : "5.5em")
    .attr('x', "-14em")
    .attr('y', areMultipleSpectrumPeaksShown ? "-7.1em" : "-6.1em")
    .attr('rx', "5px")
    .attr('ry', "5px");

  var text = self.peakInfo.append("g")
    .append("text")
    .attr("dy", "-2em");

  createPeakInfoText(text, "cont. area", info.contArea);
  createPeakInfoText(text, "peak area", info.area + String.fromCharCode(0x00B1) + info.areaUncert);
  createPeakInfoText(text, String.fromCharCode(0x03C7) + "2/dof", info.chi2);
  createPeakInfoText(text, "FWHM", info.fwhm + " keV (" + info.fwhmPerc + "%)");
  createPeakInfoText(text, "mean", info.mean + " keV");
  if (areMultipleSpectrumPeaksShown)
    createPeakInfoText(text, "Spectrum", self.rawData.spectra[info.spectrumIndex].title);

  const width = text.node().getBoundingClientRect().width + 10; // + 10 for padding right
  rect.attr('width', width);

  self.peakInfoBox = self.peakInfo.node().getBoundingClientRect();

  if (x >= (self.peakInfoBox.x ? self.peakInfoBox.x : self.peakInfoBox.left))
    self.peakInfo.attr("transform","translate(" + (self.padding.leftComputed + 115) + "," + (self.size.height - 40) + ")");
}

SpectrumChartD3.prototype.hidePeakInfo = function() {
  var self = this;

  if (!self.peakInfo) return;

  self.peakInfo.remove();
  self.peakInfo = null;
}

SpectrumChartD3.prototype.highlightPeak = function(peakElem, peakIndex, paths, path) {
  var self = this;

  if (self.zooming_plot)
    return;

  if (self.highlightedPeak)
    self.unhighlightPeak(0, self.highlightedPeak, paths);

  var thePeak = peakElem;
  if (d3.event == null || d3.event.touches) {
    if (!thePeak || thePeak.attr("fill-opacity") != 0.6)
      return;
  }

  var thePeakSelected = d3.select(thePeak);
  if (Array.isArray(thePeakSelected[0][0])) thePeakSelected = thePeak;
  if (thePeakSelected.attr("fill-opacity") != 0.6)
    return;

  if (self.leftMouseDown || self.rightClickDown)
    return;

  if (!peakIndex) {
    if (paths.length === 2) 
      thePeakSelected.attr("fill-opacity",0.8);
    else
      thePeakSelected.attr("stroke-width",2).attr("fill-opacity",0.8);

  } else {
    if (paths.length === 2) 
      peakIndex.attr("fill-opacity",0.8);
    else
      peakIndex.attr("stroke-width",2).attr("fill-opacity",0.8);
  }

  if (thePeakSelected[0].parentNode) {    /* if the 'peakElem' pointer is the path for the peak, then declare the highlighted peak to be that */
    self.highlightedPeak = thePeak;
  } else if (peakIndex)
    self.highlightedPeak = peakIndex;

  for (i = 0; i < self.peakLabelArray.length; i++)
    if (self.peakLabelArray[i].path === (peakIndex ? peakIndex : path)) {
      self.peakLabelArray[i].label.attr('stroke', 'black')
        .attr("z-index", 100);
      self.highlightedLabel = self.peakLabelArray[i].label;
    }
}

SpectrumChartD3.prototype.unhighlightPeak = function(d, highlightedPeak, paths) {
  var self = this;

  if (self.highlightedLabel) {
    self.highlightedLabel.attr('stroke', 'none')
          .attr("z-index", 0);
  }

  if (!highlightedPeak && !self.highlightedPeak) {
    self.highlightedPeak = null;
    self.highlightedLabel = null;
    return;
  }

  var peak = self.highlightedPeak;
  if (!highlightedPeak) {
    if (!Array.isArray(self.highlightedPeak)) 
      peak = d3.select(self.highlightedPeak);
    if (paths.length === 2)  peak.attr("fill-opacity",0.6);
    else                     peak.attr("stroke-width",1).attr("fill-opacity",0.6);
  } else {
    if (!Array.isArray(highlightedPeak)) 
      highlightedPeak = d3.select(highlightedPeak);
    if (paths.length === 2)  highlightedPeak.attr("fill-opacity",0.6);
    else                     highlightedPeak.attr("stroke-width",1).attr("fill-opacity",0.6);
  }


  self.highlightedPeak = null;
  self.highlightedLabel = null;
}


/**
 * -------------- Background Subtract Functions --------------
 */
SpectrumChartD3.prototype.setBackgroundSubtract = function( subtract ) {
  var self = this;

  var checkbox = document.getElementById('background-subtract-option');

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) {
    alert('No data specified!');
    if (checkbox) checkbox.checked = false;
    return;
  }

  if (self.rawData.spectra.filter(function(spectrum) { return spectrum.type == self.spectrumTypes.BACKGROUND }).length !== 1) {
    alert('Need only one background spectrum for background subtract!');
    if (checkbox) checkbox.checked = false;
    return;
  }

  self.options.backgroundSubtract = Boolean(subtract);
  self.redraw()();
}

SpectrumChartD3.prototype.rebinForBackgroundSubtract = function() {
  var self = this;

  // Don't do anything if no data exists
  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) return;

  // Don't do anything else if option is not toggled
  if (!self.options.backgroundSubtract)
    return;
  
  var bisector = d3.bisector(function(point) { return point.x });

  self.rawData.spectra.forEach(function(spectrum) {
    // We don't need to generate the points for background subtract for a background spectrum
    if (spectrum.type === self.spectrumTypes.BACKGROUND) return;

    // Initialize background subtract points for this spectrum to be empty
    spectrum.bgsubtractpoints = [];

    const background = self.getSpectrumByID(spectrum.backgroundID);

    // Don't add any points if there is no associated background with this spectrum
    if (!background) return;

    // Get points for background subtract for this spectrum by getting the nearest background point and subtracting y-values
    spectrum.bgsubtractpoints = spectrum.points.map(function(point) {
      const x = point.x;
      const y = point.y;
      const bpoint = background.points[bisector.left(background.points, x)];
      if (!bpoint) return { x: x, y: 0 };
      return { x: x, y: Math.max(0, y - bpoint.y) };
    });
  });
}


/**
 * -------------- Color Picker Functions --------------
 */
SpectrumChartD3.prototype.initializeColorPicker = function() {
  var self = this;

  if (!self.colorPickerTable) {
    self.colorPickerTable = document.createElement('table');
    self.colorPickerTable.id = 'color-picker-table';
    self.colorPickerTable.style.marginTop = '10px';
  }

  document.body.appendChild(self.colorPickerTable);
}

SpectrumChartD3.prototype.setEnableColorPicker = function(enable) {
  var self = this;

  self.options.enableColorPicker = enable;

  if (!enable) self.destroyColorPicker();
  else {
    self.initializeColorPicker();
    self.updateColorPickerItems();
  }
}

SpectrumChartD3.prototype.updateColorPickerItems = function() {
  var self = this;

  if (!self.options.enableColorPicker) return;

  d3.selectAll('.colorPickerItem').remove();

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  const div = d3.select('#color-picker-table');
  let colorTester, color;
  let lineColorInput, peakColorInput;
  
  self.rawData.spectra.forEach(function(spectrum, index) {
    let row = div.append('tr')
      .attr('class', 'colorPickerItem');

    let item = row.append('td').attr('align', 'right');

    // Get the hex-computed line color 
    colorTester = document.createElement('div');
    colorTester.style.color = spectrum.lineColor;
    document.body.appendChild(colorTester)
    color = window.getComputedStyle(colorTester).color;
    colorTester.remove();

    // Add labels and input for line color
    item.append('label')
      .attr('for', 'spec-' + index + '-line')
      .style('margin-right', '10px')
      .text(spectrum.title + ' Line Color:');

    lineColorInput = item.append('input')
      .attr('id', 'spec-' + index + '-line')
      .attr('type', 'color')
      .attr('value', self.getRGBToHexColor(color))
      .style('margin-right', '10px');

    // Get the hex-computed peak color 
    colorTester = document.createElement('div');
    colorTester.style.color = spectrum.peakColor;
    document.body.appendChild(colorTester)
    color = window.getComputedStyle(colorTester).color;
    colorTester.remove();

    item = row.append('td').attr('align', 'right');

    // Add labels and input for peak color
    item.append('label')
      .attr('for', 'spec-' + index + '-peak')
      .style('margin-right', '10px')
      .text(spectrum.title + ' Peak Color:');

    peakColorInput = item.append('input')
      .attr('id', 'spec-' + index + '-peak')
      .attr('type', 'color')
      .attr('value', self.getRGBToHexColor(color));


    // Set on-change listeners for the input fields
    lineColorInput.node().onchange = function(e) { self.handleChangeSpectrumLineColor(spectrum, index, e.target.value) };
    peakColorInput.node().onchange = function(e) { self.handleChangeSpectrumPeakColor(spectrum, index, e.target.value) };
  });
}

SpectrumChartD3.prototype.destroyColorPicker = function() {
  var self = this;

  if (self.colorPickerTable) self.colorPickerTable.remove();
  self.colorPickerTable = null;
}

SpectrumChartD3.prototype.handleChangeSpectrumLineColor = function(spectrum, index, color) {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) return;

  let line;
 
  spectrum.lineColor = color;

  // Update the data line on the chart
  line = self.vis.select("#spectrumline" + index);
  line.style("stroke", spectrum.lineColor ? spectrum.lineColor : 'black');

  // Update the data line on the legend
  if (self.legBody) {
    line = d3.select("#spectrum-legend-line-" + index);
    line.style("stroke", spectrum.lineColor ? spectrum.lineColor : 'black');
  }
}

SpectrumChartD3.prototype.handleChangeSpectrumPeakColor = function(spectrum, index, color) {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) return;

  let peaks = d3.selectAll('.spectrum-peak-' + index);
  console.log('spectrum-peak-' + index, peaks);

  spectrum.peakColor = color;
  peaks.style('stroke', spectrum.peakColor)
    .style('fill', spectrum.peakColor);
}


/**
 * -------------- Helper Functions --------------
 */
/**
 * Returns true if the browser has touch capabilities, false otherwise.
 * Thanks to: https://stackoverflow.com/questions/4817029/whats-the-best-way-to-detect-a-touch-screen-device-using-javascript
 */
SpectrumChartD3.prototype.isTouchDevice = function() {
  return 'ontouchstart' in window        // works on most browsers 
      || navigator.maxTouchPoints;       // works on IE10/11 and Surface
}

SpectrumChartD3.prototype.isWindows = function() {
  return navigator.appVersion.indexOf("Win") != -1;
}

/**
 * Returns true if multiple spectra are showing peaks.
 */
SpectrumChartD3.prototype.areMultipleSpectrumPeaksShown = function() {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return false;

  let numberOfSpectraPeaks = 0;

  self.rawData.spectra.forEach(function(spectrum) {
    if (spectrum.peaks && spectrum.peaks.length && self.options.drawPeaksFor[spectrum.type])
      numberOfSpectraPeaks++;
  });

  return numberOfSpectraPeaks > 1;
}

/**
 * Returns the spectrum with a given ID. If no specturm is found, then null is returned.
 * Assumes valid data, so if there are multiple spectra with same ID, then the first one is returned.
 */
SpectrumChartD3.prototype.getSpectrumByID = function(id) {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length) return;

  for (let i = 0; i < self.rawData.spectra.length; i++) {
    if (self.rawData.spectra[i].id === id)
      return self.rawData.spectra[i];
  }

  return null;
}

/**
 * Returns a list of all spectra title names.
 */
SpectrumChartD3.prototype.getSpectrumTitles = function() {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  var result = [];
  self.rawData.spectra.forEach(function(spectrum, i) {
    if (spectrum.title)
      result.push(spectrum.title);
    else  /* Spectrum title doesn't exist, so use default format of "Spectrum #" */
      result.push("Spectrum " + (i + 1));
  });
  return result;
}

/**
 * Returns a list of all scale factors from all spectra.
 */
SpectrumChartD3.prototype.getYScaleFactors = function() {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return;

  var result = [];
  for (var i = 0; i < self.rawData.spectra.length; ++i)
    result.push(self.rawData.spectra[i].yScaleFactor);

  /* Return a copy of the y-scale factors */
  return result.slice();
}

/**
 * Returns the number of counts for a specific energy value.
 */
SpectrumChartD3.prototype.getCountsForEnergy = function(spectrum, energy) {
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !spectrum || !spectrum.x)
    return -1;

  var channel, lowerchanval, counts = null;
  var spectrumIndex = self.rawData.spectra.indexOf(spectrum);

  if (spectrumIndex < 0)
    return -1;

  channel = d3.bisector(function(d){return d;}).right(spectrum.x, energy);

  if( spectrum.points && spectrum.points.length ){
    lowerchanval = d3.bisector(function(d){return d.x;}).left(spectrum.points,energy,1) - 1;
    counts = spectrum.points[lowerchanval].y;
  }
  return counts;
}

/**
 * Returns the Y-axis domain based on the current set of zoomed-in data, ensuring that all data is visible within that range.
 */
SpectrumChartD3.prototype.getYAxisDomain = function(){
  var self = this;

  if (!self.rawData || !self.rawData.spectra || !self.rawData.spectra.length)
    return [3000,0];
  
  var key = self.options.backgroundSubtract ? 'bgsubtractpoints' : 'points';  // Figure out which set of points to use
  var y0, y1;
  var minx = self.xScale.domain()[0], maxx = self.xScale.domain()[1];
  var foreground = self.rawData.spectra[0];
  var firstData = self.displayed_start(foreground);
  var lastData = self.displayed_end(foreground);

  if( firstData >= 0 ){
    y0 = y1 = foreground[key][firstData].y;

    self.rawData.spectra.forEach(function(spectrum) {
      // Don't consider background spectrum if we're viewing the Background Subtract
      if (self.options.backgroundSubtract && spectrum.type === self.spectrumTypes.BACKGROUND) return;
      firstData = self.displayed_start(spectrum);
      lastData = self.displayed_end(spectrum);

      for (var i = firstData; i < lastData; i++) {
        if (spectrum[key][i]) {
          y0 = Math.min( y0, spectrum[key][i].y );
          y1 = Math.max( y1, spectrum[key][i].y );
        }
      }
    });
  }else {
    y0 = 0;
    y1 = 3000;
  }

  if( y0 > y1 ) { y1 = [y0, y0 = y1][0]; }
  if( y0 == y1 ){ y0 -=1; y1 += 1; }


  if( self.options.yscale == "log" ) {
    /*Specify the (approx) fraction of the chart that the scale should extend */
    /*  past where the data where hit. */
    var yfractop = self.options.logYFracTop, yfracbottom = self.options.logYFracBottom;

    var y0Intitial = ((y0<=0.0) ? 0.1 : y0);
    var y1Intitial = ((y1<=0.0) ? 1.0 : y1);
    y1Intitial = ((y1Intitial<=y0Intitial) ? 1.1*y0Intitial : y1Intitial);

    var logY0 = Math.log10(y0Intitial);
    var logY1 = Math.log10(y1Intitial);

    var logLowerY = ((y0<=0.0) ? -1.0 : (logY0 - yfracbottom*(logY1-logY0)));
    var logUpperY = logY1 + yfractop*(logY1-logY0);

    var ylower = Math.pow( 10.0, logLowerY );
    var yupper = Math.pow( 10.0, logUpperY );

    y0 = ((y0<=0.0) ? 0.1 : ylower);
    y1 = ((y1<=0.0) ? 1.0 : yupper);
  } else if( self.options.yscale == "lin" )  {
    y0 = ((y0 <= 0.0) ? (1+self.options.linYFracBottom)*y0 : (1-self.options.linYFracBottom)*y0);
    y1 = (1 + self.options.linYFracTop)*y1;
  } else if( self.options.yscale == "sqrt" ) {
    y0 = ((y0 <= 0.0) ? 0.0 : (1-self.options.sqrtYFracBottom)*y0);
    y1 = (1+self.options.sqrtYFracTop)*y1;
  }

  return [y1,y0];
}

/**
 * Returns a random color based on hexadecimal value.
 */
SpectrumChartD3.prototype.getRandomColor = function() {
  let hex = '#';
  const letters = '0123456789ABCDEF';

  for (let i = 0; i < 6; i++)
    hex += letters.charAt(Math.floor(Math.random() * 15));
  
  return hex;
}

/**
 * Returns the hexadecimal value for an RGB color.
 * Input takes in an RGB string in the form rgb(INPUT1, INPUT2, INPUT3) where "INPUT#" are the corresponding integer values.
 * If an error occurrs, returns the original RGB color passed in.
 */
SpectrumChartD3.prototype.getRGBToHexColor = function(rgb) {
  if (!rgb) return '#000000';

  rgb = rgb.substring(4, rgb.length - 1);
  rgb = rgb.split(',');

  if (rgb.length !== 3) return rgb;
  
  let hex = '#';
  for (let i = 0; i < 3; i++) {
    let c = Number(rgb[i]).toString(16);
    hex += c.length === 1 ? ('0' + c) : c;
  }

  return hex;
}
</script>
<script>var ondatachange=function(e,t,c){"data"===e.value?t.setData(c,!0):t.setData(null,!0)},onyscalechange=function(e,t){var c=e.value;"lin"===c?t.setLinearY():"log"===c?t.setLogY():"sqrt"===c&&t.setSqrtY()},ongridychange=function(e,t){t.setGridY(e.checked)},ongridxchange=function(e,t){t.setGridX(e.checked)},onrefgammachange=function(e,t,c){console.log(c);for(var n=[],o=0;o<e.options.length;o++){var s=e.options[o];if(s.selected){var a=-1;c.forEach(function(e,t){e&&e.parent&&e.parent===s.value&&(a=t)}),-1!==a&&n.push(c[a])}}t.setReferenceLines(n)},setShowMouseStats=function(e,t){t.setShowMouseStats(e.checked)},setCompactXAxis=function(e,t){t.setCompactXAxis(e.checked)},setAdjustYAxisPadding=function(e,t){t.setAdjustYAxisPadding(e.checked,e.checked?5:60)},setWheelScrollYAxis=function(e,t){t.setWheelScrollYAxis(e.checked)},setShowAnimation=function(e,t){t.setShowAnimation(e.checked)},setAnimationDuration=function(e,t){t.setAnimationDuration(e)},setShowLegend=function(e,t){t.setShowLegend(e.checked)},setShowUserLabels=function(e,t){t.setShowUserLabels(e.checked)},setShowPeakLabels=function(e,t){t.setShowPeakLabels(e.checked)},setShowNuclideNames=function(e,t){t.setShowNuclideNames(e.checked)},setShowNuclideEnergies=function(e,t){t.setShowNuclideEnergies(e.checked)},setComptonEdge=function(e,t){t.setComptonEdge(e.checked)},setComptonPeaks=function(e,t){t.setComptonPeaks(e.checked)},setComptonPeakAngle=function(e,t){t.setComptonPeakAngle(e)},setEscapePeaks=function(e,t){t.setEscapePeaks(e.checked)},setSumPeaks=function(e,t){t.setSumPeaks(e.checked)},showForegroundPeaks=function(e,t){t.setShowPeaks(0,e.checked)},showTitle=function(e,t){t.setTitle(e.checked?"Simple Chart":null)},setXRangeArrows=function(e,t){t.setXRangeArrows(e.checked)},setShowXAxisSliderChart=function(e,t){t.setShowXAxisSliderChart(e.checked)},setSpectrumScaleFactorWidget=function(e,t){t.setSpectrumScaleFactorWidget(e.checked)},setDropDownSpectrumScaleFactor=function(e,t){t.setDropDownSpectrumScaleFactor(e.value)},setSpectrumScaleFactor=function(e,t){t.setSpectrumScaleFactor(e.value)},setMaxScaleFactor=function(e,t){t.setMaxScaleFactor(e.value)},setBackgroundSubtract=function(e,t){t.setBackgroundSubtract(e.checked)};</script>
<style>
body { font: 13px sans-serif; }
rect { fill: #fff; }
label{ margin-left: 5px; }

.referenceGammaSelectDiv { display: inline-block; margin-left: 25px; }
.referenceGammaSelect { width: 200px; height: 130px; }
.yaxis, .yaxislabel { font-size: 1em; }
.xaxis { font-size: 1em; font-weight: normal; }

.xaxis > .tick > line, .yaxis > .tick, .yaxistick { stroke: black; stroke-width: 1px; }
.xgrid > .tick, .ygrid > .tick{ stroke: #b3b3b3; stroke-opacity: 80%; }
.minorgrid { stroke: #e6e6e6; stroke-opacity: 50%; }

.xaxistitle{}
.yaxistitle{}

.touchLine{  stroke-width: 2; stroke: gray; stroke-dasharray: 3;  }

.mouseLine      { font-size: 0.8em; stroke-width: 2;  stroke: black }
.secondaryMouseLine { font-size: 0.8em; stroke-width: 1;  stroke: black }
.lightMouseLine { font-size: 0.8em; stroke-width: 0.5;  stroke: gray }

.peakLine{ font-size: 0.8em; stroke-width: 2; stroke: black;  }
.escapeLineForward { font-size: 0.8em; stroke-width: 2; stroke-dasharray: 2; stroke: black;  }

.createPeakMouseLine { fill: none; stroke: black;  stroke-width: 1.5px; }
.createPeakArrowLine { fill: none; stroke: black;  stroke-width: 1px; }
.createPeakContEstLine { fill: none; stroke: grey; stroke-width: 2px;  }
.createPeakLeftTouchPoint { fill: blue; }
.createPeakRightTouchPoint { fill: black; }
.createPeakTouchLine { stroke-width: 2; stroke: grey; stroke-dasharray: 4; }

.chartLineText {  font-size: 0.8em; font-family: Helvetica, Arial;  font-weight: bold }
.mouseLineText  {  font-size: 0.8em; font-family: Helvetica, Arial;  font-weight: bold }
.deletePeaksText  {  font-size: 0.8em; font-family: Helvetica, Arial;  font-weight: bold }
.countGammasText  {  font-size: 0.8em; font-family: Helvetica, Arial;  font-weight: bold }
.peakText{ font-size: 0.8em; font-family: Helvetica, Arial;  font-weight: bold }
.contEstLineText {  font-size: 0.8em; font-family: Helvetica, Arial;  stroke:grey;  }
.createPeakTouchText {  font-size: 0.8em; font-family: Helvetica, Arial;  stroke:grey; fill: grey; }

.refLineInfo{ font-size: 0.8em; }
.mouseInfo{ font-size: 0.85em;  }
.mouseInfoBox{ fill: white; fill-opacity: 0.85; }

.peakInfo{ font-size: 0.85em; }
.peakInfoBox{
  fill: #ffffcc;
  fill-opacity: 1;
  stroke: #444422;
}
.peakInfoLabel {
  font-weight: bold;
}

.legend{ font-size: 1em; }
.legentry{}
.legendBack{ fill: rgba(245,245,245,0.5); stroke: rgba(185,185,185,0.80); }
.activeLegend > .legendBack{ fill-opacity: 0.85; }
.legendHeader{ fill: rgba(185,185,185,0.80); fill-opacity: 0.55; }
.activeLegend > g > .legendHeader{ fill: #909090; fill-opacity: 0.95; }
.d3closebut{ fill: #909090; }
/* .d3closebut:hover{ fill: #4d4d4d; } */

.scalerwidget{ font-size: 1em; }
.scalerEntry{}
.scalerback{ fill: rgba(245,245,245,0.5); stroke: rgba(185,185,185,0.80); }
.activescaler > .scalerback{ fill-opacity: 0.85; }
.scalerheader{ fill: rgba(185,185,185,0.80); fill-opacity: 0.55; }
.activescaler > g > .scalerheader{ fill: #909090; fill-opacity: 0.95; }
.scaleraxis{ fill: lightgrey; stroke: grey; }
.scalertoggle{ fill: lightgrey; stroke: grey; }

.peaklabelarrow {
  stroke-width: 1.5;
  stroke: black;
  z-index: 100;
}

.leftbuttonzoombox {
  fill: #666;
  fill-opacity: 0.25;
}
.leftbuttonzoomoutbox {
  fill: none;
}
.leftbuttonzoomoutboxy {
  fill: #666;
  fill-opacity: 0.1;
}
.deletePeaksBox {
  fill: #666;
  fill-opacity: 0.5;
}
.countGammasBoxForward {
  fill: rgba(255,255,0,0.605);
  fill-opacity: 1;
}

.sliderBox {
  fill: #666;
  fill-opacity: 0.7;
  stroke: black;
  stroke-width: 0.2%;
  user-select: none;
  -moz-user-select: none;
}
.sliderDragRegion {
  fill: rgba(185,185,185,0.80);
  fill-opacity: 1;
  stroke: #666;
  stroke-width: 0.1%;
}
.sliderDragRegionLine {
  fill: #444;
  stroke: #444;
  stroke-width: 0.08%;
}
.line {
  fill: none;
  stroke-width: 1px;
}
.sline {
  fill: none;
  stroke-width: 0.7px;
}
.rline {
  fill: none;
  stroke-width: 0.5px;
}

.focus circle {
  fill: none;
  stroke: steelblue;
}
.title { font-size: 1.5em; }
.chart {
  background-color: #F7F2C5;
  width: 80%;
  margin-left: auto;
  margin-right: auto;
  height: 500px; 
}</style>
</head>
<body><div id="chart1" class="chart" oncontextmenu="return false;";></div>
<script>
var spec_chart_chart1 = new SpectrumChartD3('chart1', {'title': 'Foreground', 'xlabel':'Energy', 'ylabel':'Counts'});

var data_chart1 = {
"updateTime": "20181229T012215",
"spectra": [

		{
			"title":"Foreground",
			"id":0,
			"backgroundID":1,
			"type":"FOREGROUND",
			"peaks":[{"type":"Linear","lowerEnergy":270.889,"upperEnergy":281.62,"referenceEnergy":270.889,"coeffs":[2243.82,-43.3923],"coeffUncerts":[29.6599,4.33197],"fitForCoeff":[true,true],"peaks":[{"lineColor":"#6666ff","type":"GaussianDefined","skewType":"NoSkew","Centroid":[276.219,0.00350099,true],"Width":[0.604314,0.00307349,true],"Amplitude":[42053.4,224.231,true],"LandauAmplitude":[0,-1,false],"LandauMode":[0,-1,false],"LandauSigma":[0,-1,false],"Chi2":[1.44834,-1,false],"forCalibration":true,"forSourceFit":true,"sourceType":"NormalGamma","nuclide": { "name": "Ba133","decayParent":"Ba133","decayChild":"Cs133","DecayGammaEnergy":276.4}}]},{"type":"Linear","lowerEnergy":377.449,"upperEnergy":389.687,"referenceEnergy":377.449,"coeffs":[496.108,-20.2356],"coeffUncerts":[12.904,1.54773],"fitForCoeff":[true,true],"peaks":[{"lineColor":"#6666ff","type":"GaussianDefined","skewType":"NoSkew","Centroid":[383.496,0.00371281,true],"Width":[0.676377,0.00298646,true],"Amplitude":[38056.9,200.429,true],"LandauAmplitude":[0,-1,false],"LandauMode":[0,-1,false],"LandauSigma":[0,-1,false],"Chi2":[2.1749,-1,false],"forCalibration":true,"forSourceFit":true,"sourceType":"NormalGamma","nuclide": { "name": "Ba133","decayParent":"Ba133","decayChild":"Cs133","DecayGammaEnergy":383.848}}]},{"type":"Linear","lowerEnergy":350.572,"upperEnergy":361.112,"referenceEnergy":350.572,"coeffs":[2127.35,-185.232],"coeffUncerts":[28.3191,3.43452],"fitForCoeff":[true,true],"peaks":[{"lineColor":"#6666ff","type":"GaussianDefined","skewType":"NoSkew","Centroid":[355.74,0.00126624,true],"Width":[0.643735,0.000961283,true],"Amplitude":[284142,540.212,true],"LandauAmplitude":[0,-1,false],"LandauMode":[0,-1,false],"LandauSigma":[0,-1,false],"Chi2":[21.0078,-1,false],"forCalibration":true,"forSourceFit":true,"sourceType":"NormalGamma","nuclide": { "name": "Ba133","decayParent":"Ba133","decayChild":"Cs133","DecayGammaEnergy":356.017}}]},{"type":"Linear","lowerEnergy":296.682,"upperEnergy":307.531,"referenceEnergy":296.682,"coeffs":[2051.05,-65.5127],"coeffUncerts":[27.1324,3.94456],"fitForCoeff":[true,true],"peaks":[{"lineColor":"#6666ff","type":"GaussianDefined","skewType":"NoSkew","Centroid":[302.672,0.00212713,true],"Width":[0.607878,0.00174447,true],"Amplitude":[98156.8,325.9,true],"LandauAmplitude":[0,-1,false],"LandauMode":[0,-1,false],"LandauSigma":[0,-1,false],"Chi2":[5.18465,-1,false],"forCalibration":true,"forSourceFit":true,"sourceType":"NormalGamma","nuclide": { "name": "Ba133","decayParent":"Ba133","decayChild":"Cs133","DecayGammaEnergy":302.853}}]},{"type":"Linear","lowerEnergy":74.7129,"upperEnergy":85.6324,"referenceEnergy":74.7129,"coeffs":[12393.5,-778.615],"coeffUncerts":[74.6628,9.23148],"fitForCoeff":[true,true],"peaks":[{"lineColor":"#6666ff","type":"GaussianDefined","skewType":"NoSkew","Centroid":[79.6988,0.00232863,true],"Width":[0.762508,0.00984498,true],"Amplitude":[43672.8,470.295,true],"LandauAmplitude":[0,-1,false],"LandauMode":[0,-1,false],"LandauSigma":[0,-1,false],"Chi2":[17.2159,0,false],"forCalibration":true,"forSourceFit":false,"sourceType":"NormalGamma","nuclide": { "name": "Ba133","decayParent":"Ba133","decayChild":"Cs133","DecayGammaEnergy":79.6139}},{"lineColor":"#6666ff","type":"GaussianDefined","skewType":"NoSkew","Centroid":[80.9307,0.00131466,true],"Width":[0.490341,0.00108153,true],"Amplitude":[267562,608.16,true],"LandauAmplitude":[0,-1,false],"LandauMode":[0,-1,false],"LandauSigma":[0,-1,false],"Chi2":[17.2159,0,false],"forCalibration":true,"forSourceFit":true,"sourceType":"NormalGamma","nuclide": { "name": "Ba133","decayParent":"Ba133","decayChild":"Cs133","DecayGammaEnergy":80.9971}}]}],
			"liveTime":5025.62,
			"realTime":5119.28,
			"neutrons":null,
			"lineColor":"black",
			"peakColor":"blue",
	"xeqn": [-0.218124,0.188269],
			"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.738782,2.1054,1.90231,0.253507,3.89006,25.7668,128.4,486.467,1118.53,1791.98,2103.51,2203.23,2174.22,2260.06,2314.1,2338.78,2224.71,2249.27,2234.51,2181.7,2241.38,2204.77,2192.51,2140.93,2121.16,2157.03,2089.42,2057.7,2106.06,2065.25,2053.84,1976.73,1982.7,2079.91,1980.33,2027.67,2000.45,1946.73,1970.92,1981.48,1888.96,1890.15,1895.52,1882.24,1871.03,1914.86,1789.41,1849.67,1840.15,1853.24,1844.25,1849.82,1893.67,1845.66,1785.47,1816.8,1799.84,1855.33,1833.98,1834.4,1762.15,1720.74,1808.62,1769.13,1844.37,1728.33,1745.32,1851.46,1814.73,1840.04,1801.24,1794.76,1900.19,1876.12,1801.44,1888.44,1917.8,1913.38,1929.02,1970.7,2035.77,2064.07,1997.76,2093.19,2191.44,2457.05,2923.92,3474.2,4389.92,5339.83,6248.2,6852.94,6790.95,6158.93,5063.75,3908.58,2970.76,2236.62,1721.51,1508.54,1426.35,1437.57,1451,1470.69,1494.19,1483.28,1548.14,1638.47,1819.32,2136.63,2642.96,3295.31,3820.54,4120.72,4029.67,3942.89,3521.56,3024.71,2530.56,2146.93,1775.37,1506.77,1321.36,1167.46,1120.79,1100.47,1039.86,1066.92,1079.49,1028.08,1034.6,1009.66,1028.84,982.775,999.006,1001.27,1033.47,1020.29,994.185,1028.04,988.095,990.273,978.146,995.17,989.642,1012.85,979.806,964.788,953.348,1005.57,1013.54,1014.18,1038.5,971.78,976.221,1025.54,1002.61,1002.25,1033.15,1018.91,1082.72,980.015,1009.14,1012.48,996.376,1034.55,1029.92,1026.25,1055.74,1012.31,999.123,1038.73,1043.58,1057.05,1040.22,1025.84,1002.76,973.924,1026.29,1043.08,1002.07,1038.39,1042.64,1055.79,1103.19,1043.58,1066.24,1069.47,1102.46,1066.75,1032.67,1068.49,1055.56,1073.58,1070.3,1080.47,1095.65,1075.07,1125.54,1115.45,1156.51,1134.15,1134.16,1169.12,1238.21,1384.4,1528.37,1813.49,2284.09,2555.75,2742.44,2730.65,2489.78,2094.66,1740.83,1466.37,1273.2,1186.18,1154.41,1127.44,1132.52,1119.11,1066.55,1109.72,1100.94,1110.33,1097.62,1083.97,1129.92,1116.29,1112.64,1142.55,1135.75,1139.83,1080.48,1124.46,1118.02,1124.38,1185.71,1214.11,1170.94,1221.53,1168.09,1107.05,1148.28,1176.52,1194.9,1253.82,1258.6,1273.49,1339.52,1360.31,1397.13,1449.98,1449.35,1463.64,1550.97,1590.18,1563.35,1596.41,1589.69,1580.44,1625.22,1629.37,1718.45,1668.02,1604.58,1623.36,1638.72,1622.05,1627.17,1616.63,1636.84,1631.8,1583.92,1617.54,1631.62,1657.83,1554.3,1627.28,1698.67,1667.38,1664.11,1640.74,1657.59,1643.17,1631.33,1730.56,1746.19,1710.83,1625.2,1640.6,1620.81,1690.24,1715.86,1677.92,1738.64,1684.97,1732.02,1715.05,1757.87,1714.31,1720.69,1781.16,1810.08,1790.31,1742.14,1782.76,1752.95,1815.8,1815.25,1828.77,1842.41,1826.78,1847.86,1817.88,1942.58,1914.5,1931.99,1854.72,1928.26,1965.37,1918.23,1934.28,1967.36,1936.38,1982.98,2080.97,2059.37,2095.94,2081.2,2129.14,2157.65,2204.42,2145.63,2233.93,2254.44,2243.37,2297.66,2380.11,2253.97,2336.7,2421.39,2445.87,2561.03,2716.71,3009.03,3494.59,4114.72,4930.77,5873.44,6739.32,7982.99,10023.8,14467.6,21258.1,29541.8,37995.3,42895,42245.7,36570.3,27911.1,18507.4,11114.6,5971.86,3208.82,1756.07,1202.84,1004.34,975.967,956.049,925.557,939.455,938.985,916.52,924.063,920.985,937.897,908.53,926.91,954.837,941.271,971.738,965.619,940.76,944.168,975.01,928.866,973.361,981.507,996.345,983.304,1000.87,987.097,967.714,972.5,970.524,981.969,924.007,946.994,959.986,974.411,987.893,1025.91,1030.57,968.461,979.904,992.581,1007.09,977.26,1000.64,962.292,977.346,956.259,977.735,943.256,958.493,997.322,1014.42,1052.15,1067.84,1019.56,1036.46,1018.61,1029.3,1023.97,977.193,1014.25,987.184,954.318,998.104,1023.69,1016.41,1027.99,1009.22,1044.18,1052.08,1045.58,1060.52,996.221,981.98,1013.55,1076.13,1068.89,1040.91,1049.58,1024.34,1070.35,1051,1042.08,1014.87,1021.93,1070.2,1024.68,1045.25,1046.61,1062.22,1048.88,1056.35,1069.18,1036.93,1038.22,1044.62,1069.69,1060.19,1088.42,1076.24,1112.01,1084.09,1125.74,1081.21,1088.17,1038.54,1069.77,1143.5,1102.66,1046,1064.51,1083.34,1069.98,1091.96,1092.78,1110.45,1049.47,1081.09,1097.29,1150.6,1132.95,1085.28,1071.02,1092.83,1133.29,1131.76,1120.6,1114.31,1150.91,1126.58,1113.67,1139.12,1100.9,1129.45,1119.22,1121.42,1110.76,1119.53,1120.82,1109.12,1121.19,1044.02,1092.97,1162.66,1162.7,1130.16,1135.26,1131.49,1139.28,1144.64,1166.04,1111.05,1161.44,1147.02,1135.21,1070.52,1148.59,1159.97,1155.79,1093.42,1126.94,1104.62,1110.65,1112.87,1145.94,1121.6,1102.89,1122.13,1156.43,1129.2,1174.36,1186.03,1126.73,1121.16,1135.04,1171.81,1167.11,1170.74,1152.23,1172.65,1163.77,1169.43,1137.23,1136.94,1146.16,1106.96,1112.09,1142.71,1183.66,1185.8,1180.79,1138.4,1172.7,1167.33,1182.21,1182.78,1130.21,1133.3,1135.01,1170.4,1143.64,1207.6,1161.85,1168.3,1157.2,1214.56,1187.11,1129.11,1163.99,1158.47,1190.26,1182.23,1182.51,1187.05,1152.63,1168.83,1162.25,1163.29,1178.39,1185.62,1144.7,1203.61,1186.05,1215.11,1188.62,1200.46,1169.16,1257.33,1186.93,1218.08,1198.63,1151.26,1149.12,1210.68,1227.35,1226.59,1128.13,1173.18,1182.89,1254.31,1227.82,1131.07,1163.68,1193.16,1174.02,1242.41,1225.59,1199.33,1188.23,1226.84,1222.22,1193.71,1175.2,1201.48,1219.95,1251.36,1251.16,1249.45,1302.68,1262.67,1265.72,1226.27,1212.95,1291.84,1291.29,1248.78,1252.74,1256.97,1247.86,1299.92,1273.65,1295.18,1241.48,1271.2,1267.22,1287.21,1283.11,1257.29,1306.37,1283.87,1283.29,1337,1341.76,1292.92,1308.55,1322.99,1295.23,1267.81,1328.44,1337.98,1304.24,1300.7,1311.42,1320.81,1334.42,1350.39,1303.9,1342,1371.17,1361.82,1378.17,1359.02,1311.51,1318.52,1357.6,1360.6,1350.82,1337.22,1315.08,1299.33,1354.55,1378.4,1350.58,1389.3,1392.5,1337.77,1358.05,1335.88,1332.08,1363.65,1353.66,1308.62,1326.66,1366.31,1356.32,1372.77,1337.43,1314.72,1376.54,1342.46,1378.36,1310.92,1310.18,1398.26,1334.11,1311.16,1312.82,1345.99,1410.56,1372.31,1398.09,1425.25,1413.09,1425.35,1392.57,1364.67,1359.43,1420.84,1424.2,1430.25,1447.69,1486.89,1422.65,1437.85,1482.63,1461.52,1505.48,1566.66,1468.43,1457.3,1497.43,1480.7,1514.75,1503.56,1483.17,1508.79,1490.43,1427.45,1464.06,1490.08,1499.76,1464.12,1508.33,1481.72,1503.78,1480.36,1474.67,1541.19,1517.7,1456.96,1471.91,1483.12,1444.46,1461.81,1436.3,1471.89,1507.32,1533.77,1429.81,1492.65,1460.49,1423.31,1467.75,1473.29,1445.87,1477.93,1484.9,1431.69,1441.81,1456.47,1511.91,1431.9,1416.16,1455.47,1411.07,1435.36,1424.81,1449.1,1520.47,1624.4,1729.4,1959.38,2094.14,2228.65,2166.01,2042.85,1931.45,1646.52,1516.1,1427.38,1345.46,1402.5,1369.62,1335.03,1325.96,1308.78,1343.22,1304.04,1290.45,1299.97,1312.19,1382.76,1274.56,1313.52,1278.59,1248.45,1368.92,1321.4,1291.12,1283.56,1258.69,1309.34,1273.73,1252.17,1243.27,1231.68,1230.28,1266.57,1215.19,1248.87,1206.89,1217.67,1213.39,1195.57,1236.1,1227.38,1215.14,1201.64,1233.68,1230.25,1212.46,1233.43,1222.73,1193.81,1267.85,1178.56,1191.47,1209.47,1215.38,1156.95,1180.35,1173.05,1180.48,1219.9,1205.94,1188.68,1147.45,1183.54,1191.61,1201.35,1140.36,1127.92,1177.95,1162.26,1163.17,1161.66,1191.08,1188.25,1169.09,1169.13,1168.14,1112.35,1132.56,1148.16,1167.84,1182.1,1143.43,1120.31,1151.78,1126.41,1099.03,1077.19,1120.09,1180.91,1168.91,1099.48,1096.97,1112.54,1067.43,1133.47,1116.04,1090.11,1132.75,1073.19,1068.56,1089.68,1113.91,1084.53,1086.82,1066.61,1143.51,1158.52,1168.97,1090.38,1042.99,1079.41,1093.45,1141.95,1138.29,1135.89,1119.31,1104.02,1128.78,1138.71,1130.75,1062.02,1115.34,1089.21,1104.78,1107.14,1092.02,1079.8,1039.48,1079.58,1102.24,1137.18,1065.11,1065.68,1096.07,1064.63,1078.74,1075.75,1081.99,1040.5,1037.74,1055.22,1078.57,1093.9,1085.68,1072.53,1024.04,1037.52,1056.01,1028.28,1062.71,1062.3,1058.61,1054.64,1029.39,1072.19,1038.1,1058.75,1072.65,1051.76,1067.79,1027.87,1101.18,1118.95,1054.84,1072.4,1055.42,1083.75,1092.37,1037.09,1039.93,1063.41,1049.21,1053.88,1066.78,1030.92,1021.25,982.133,1069.27,1044.71,1000.47,1047.97,1057.59,1061.2,1008.98,1024.76,1055.26,1068.99,1055.26,1068.9,1013.28,1018.03,1056.84,1037.89,1030.81,1068.85,1008.35,1007.63,1043.1,988.804,1000.18,1073.09,1064.77,1020.78,1028.35,1011.62,984.39,1031.28,1006.41,1045.2,1018.02,1032.52,971.036,1020,1007.3,988.302,1009.03,1035.61,1018.41,989.719,974.421,969.618,958.602,948.995,943.804,1009.11,1015.13,1011.34,1013.83,954.604,943.755,959.302,1004.07,954.704,950.098,983.314,919.9,967.521,921.452,915.769,903.511,910.866,921.815,900.608,887.859,927.159,907.064,874.156,885.641,890.495,878.774,924.841,838.89,798.488,780.64,851.79,846.546,846.074,821.923,797.656,816.175,820.286,807.795,754.64,775.943,808.644,781.421,788.011,759.784,748.621,747.023,774.866,772.918,749.734,732.035,751.384,716.213,731.84,733.461,743.015,746.869,728.329,722.059,694.303,684.701,714.648,717.149,721.049,687.283,671.763,692.485,685.392,689.242,702.349,687.95,743.104,696.315,640.234,697.05,687.913,727.267,681.566,720.137,731.569,686.776,669.022,651.734,694.641,687.068,686.695,649.245,627.158,686.88,683.949,639.841,664.284,685.227,666.948,657.411,719.825,650.903,681.641,698.517,625.361,649.344,726.286,726.099,744.729,793.245,891.158,908.727,1055.63,1076.07,1047.7,1018.4,928.84,792.936,761.837,736.02,669.62,657.383,614.789,624.3,646.241,645.221,643.729,575.571,637.638,657.678,616.23,597.716,578.554,576.375,586.564,587.489,599.901,587.586,591.79,591.67,600.969,590.898,618.028,610.082,617.446,569.864,566.245,577.171,568.565,557.668,580.876,578.918,574.874,576.428,555.071,540.726,576.67,564.572,568.277,568.061,558.397,552.601,545.901,581.481,572.705,538.551,544.332,535.908,525.67,558.704,555.833,563.455,544.611,544.834,524.771,560.797,537.603,561.733,551.321,561.225,530.262,550.882,534.475,511.832,561.62,521.255,544.172,551.968,546.039,565.634,534.474,591.852,637.762,615.038,632.867,648.602,638.321,623.674,623.77,569.27,554.081,501.967,522.556,518.882,517.597,523.889,522.331,553.244,542.495,521.442,501.68,538.01,542.137,522.887,530.596,537.135,530.498,487.287,466.239,496.884,496.31,488.56,493.537,487.856,509.382,542.154,507.88,509.197,485.379,472.218,517.711,470.701,473.643,474.007,476.209,494.749,507.471,500.288,500.133,488.764,465.047,486.511,488.008,472.373,448.244,442.635,454.049,479.591,446.654,433.094,481.958,485.787,454.751,468.928,482.705,448.751,452.787,451.002,444.142,473.877,489.389,453.274,456.184,456.241,458.793,455.762,467.281,455.844,453.654,444.471,473.93,462.661,443.226,422.946,469.687,456.169,421.106,448.029,440.325,425.762,419.61,468.047,467.183,440.684,423.807,405.98,421.404,474.384,459.056,463.474,433.181,438.863,419.523,408.887,440.421,433.932,430.21,416.583,421.761,434.402,454.12,456.849,428.186,422.306,401.502,427.885,444.25,440.788,456.555,408.879,409.723,420.846,435.335,444.028,444.892,429.839,432.084,429.617,442.365,415.212,424.36,424.429,410.453,410.593,423.887,421.819,426.122,406.083,418.695,405.431,409.996,420.672,411.934,417.078,383.046,389.869,411.528,402.656,412.339,417.8,416.087,433.196,370.722,371.879,405.583,411.982,409.504,393.211,396.77,397.274,414.492,391.504,399.603,387.516,432.64,396.21,391.022,411.12,384.661,406.752,401.758,397.333,409.162,391.437,411.465,436.692,426.089,442.933,414.19,404.195,406.433,420.723,417.409,374.631,381.841,390.896,387.537,402.283,411.495,418.657,411.421,418.046,419.118,414.479,424.98,459.181,490.616,566.926,724.598,991.491,1482.39,2087.74,2922.88,3762.72,4681.58,5411.86,5665.37,5368.58,4608.8,3623.47,2648,1748.36,1119.74,781.333,541.854,435.686,385.201,379.527,370.442,340.492,337.431,352.595,343.511,338.098,357.701,360.342,363.416,357.023,344.834,306.768,346.181,360.52,335.118,343.748,350.377,332.838,346.405,346.823,339.362,368.38,383.152,332.031,356.956,366.683,347.294,333.658,361.465,324.489,352.823,372.698,365.924,360.85,334.868,364.165,354.008,339.035,348.088,347.256,378.706,337.722,362.598,385.209,359.685,355.855,351.121,327.255,345.973,386.139,352.226,349.385,333.575,376.979,375.513,363.78,334.044,348.594,347.256,350.119,331.198,341.924,327.058,357.383,341.902,360.098,366.189,320.566,315.098,332.648,329.705,336.541,345.679,352.563,333.434,304.125,312.455,369.249,376.91,366.475,348.072,344.266,356.077,339.693,359.812,375.965,368.502,381.932,376.859,398.112,364.06,354.605,364.772,387.575,363.477,370.861,338.54,338.414,333.149,317.28,349.371,335.596,340.299,365.928,362.075,362.634,331.381,354.319,357.535,360.914,388.441,411.375,372.509,395.656,375.614,414.366,422.277,464.969,517.906,653.339,924.959,1395.47,2200.68,3444.2,5214.56,7187.17,9413.77,11229.6,12330.4,12213.1,11207.5,9212.44,6771.5,4594.09,2836.96,1668.9,916.57,540.797,391.424,307.16,283.316,258.209,273.967,277.637,268.129,260.282,258.141,275.233,271.052,245.037,258.443,264.601,270.767,268.491,272.848,279.217,261.242,266.407,273.656,265.921,251.258,252.782,254.075,276.835,260.652,254.927,276.074,264.014,243.681,232.792,262.603,269.55,274.651,292.886,292.359,261.174,219.981,234.541,240.605,257.029,265.791,265.607,277.017,270.824,262.628,268.249,280.41,270.736,252.891,260.464,238.056,260.385,266.686,279.377,255.839,251.806,252.407,260.946,248.089,249.641,262.173,255.585,244.511,272.758,258.222,249.795,265.478,261.925,246.971,274.188,275.755,251.786,256.307,261.292,243.45,242.203,255.155,258.235,258.533,246.082,253.957,236.945,246.22,251.077,258.386,250.983,258.539,251.722,254.263,259.363,254.876,247.731,234.15,255.162,251.871,242.43,255.514,264.035,248.656,240.233,253.119,246.281,237.804,255.231,248.261,254.903,230.926,226.834,236.673,226.592,230.988,260.953,243.207,227.846,264.486,236.841,236.612,252.782,265.485,253.871,265.155,251.778,237.049,269.825,258.713,239.037,238.74,220.727,220.453,233.613,250.672,243.512,242.3,219.033,217.44,240.308,245.098,259.201,244.044,241.785,221.74,220.82,253.553,252.329,230.18,231.887,229.707,227.852,247.183,236.409,232.063,251.622,238.535,228.39,249.641,236.976,233.355,232.204,247.773,229.606,230.848,234.073,238.664,228.066,244.071,249.017,259.201,241.027,254.456,232.852,244.29,235.475,236.157,240.929,251.942,279.674,269.836,272.97,280.235,262.325,250.093,250.262,226.248,253.762,252.148,235.199,234.939,249.632,231.183,225.774,237.29,239.572,250.912,232.017,237.026,244.671,221.196,230.038,246.902,241.276,243.092,255.409,247.294,246.551,250.43,233.774,235.293,246.324,232.247,216.336,246.799,260.702,240.942,249.515,227.188,234.651,221.884,229.075,244.822,256.934,259.473,246.017,237.261,261.419,254.332,252.521,226.463,241.053,251.172,243.691,266.437,255.25,259.889,250.34,255.553,263.017,258.485,253.889,272.661,248.727,262.109,284.846,304.615,293.499,329.139,354.79,350.812,358.755,394.206,399.839,342.294,362.771,372.656,370.574,402.728,392.547,381.553,440.59,551.256,647.025,957.379,1545.48,2596.1,4252.22,6894,10609.7,15257.2,20812.9,26279,30934.1,33243.3,32646.2,29949.7,24565.9,18543.2,12861,8107.53,4611.21,2523.44,1183.49,573.815,248.272,134.418,100.935,93.0883,89.4424,84.1418,93.5277,78.0092,68.805,79.1826,81.5906,90.7438,88.1315,84.3296,87.7186,100.176,89.062,78.9174,68.093,88.701,80.5885,87.4609,75.8257,88.8007,85.9337,87.1363,86.0432,76.2684,83.1088,82.0705,70.8534,80.5522,82.6793,80.9145,84.7492,67.4158,85.892,79.9128,88.5285,94.9884,88.2477,75.748,87.0198,74.3025,80.0681,81.9571,84.6435,83.5116,77.3919,88.7532,76.2908,85.0375,74.0479,79.2677,72.546,62.1021,70.8257,76.9967,76.9662,74.6861,66.697,69.4558,72.483,87.2955,81.1756,90.4422,69.9702,69.021,69.8776,76.5779,85.1318,80.5909,78.4471,73.7636,67.1777,69.2236,72.6638,68.8566,69.6847,71.7768,86.9398,74.4014,71.3415,71.7588,79.7884,86.2484,71.9338,61.4804,73.1785,83.4531,81.7938,77.2673,88.1597,88.6617,85.0952,95.3685,99.5414,80.7595,75.2899,76.9947,78.4776,74.3861,74.2665,83.6144,87.3469,81.2199,86.0699,78.3304,73.3645,72.7117,90.0314,98.7624,91.7804,71.7048,82.5686,95.9246,82.5921,88.4315,84.5299,100.962,92.6271,102.994,105.411,90.3189,121.017,139.092,169.911,235.049,371.339,537.209,858.741,1335.58,1856.1,2552.2,3243.12,3796.63,4169.34,4258.01,4097.55,3602.54,2853.95,2166.99,1412.4,887.129,541.174,334.945,204.749,109.264,86.1227,58.486,56.5938,52.9067,62.2693,59.7053,46.3578,51.566,45.5676,41.2124,51.0578,52.4437,51.4871,57.8128,55.1194,57.2357,58.7704,47.9011,51.0155,54.4794,57.8916,52.1375,63.6958,62.2136,47.5082,51.4215,58.5116,45.3166,54.4163,46.309,45.1247,48.0022,53.2466,59.1442,49.4352,54.3902,54.0532,45.6232,52.0376,61.3763,46.7988,57.9495,54.7292,51.3723,52.9601,49.716,49.5895,46.3235,57.6549,54.9017,51.0333,48.9179,50.6005,46.4062,49.5441,49.5242,51.8574,49.0684,50.4162,50.7219,44.5723,49.3861,55.3243,55.4942,59.0957,49.3712,49.8107,47.0811,45.4962,47.1389,49.8295,54.8943,48.4951,45.8936,47.0789,51.6033,51.325,53.8377,55.9931,58.2606,58.2147,58.529,45.2429,40.6251,45.9736,47.9028,42.9332,48.2114,45.8672,48.8497,48.1272,43.847,54.6078,48.5947,64.8065,49.6707,52.8784,54.2009,53.6698,52.9745,43.3543,43.6582,59.1046,53.3919,45.272,60.5698,52.8621,56.1833,58.5129,53.1329,58.0018,47.9751,45.677,54.2873,44.7986,47.8734,49.6643,53.1138,53.3781,55.6818,56.7801,49.9894,46.2976,57.6928,47.9104,45.4154,44.1311,50.5447,39.9133,42.4121,55.2737,47.8025,47.4682,48.2653,43.1033,41.3337,51.591,50.5717,50.3801,46.7642,45.9378,40.8272,41.4278,50.263,41.5722,47.3125,44.052,49.6556,42.4166,52.7373,45.7696,43.2687,50.351,57.9313,49.7946,39.7836,43.3388,44.812,54.847,36.675,45.1514,38.7533,33.8218,42.2014,52.0629,37.385,41.252,51.0329,38.1579,39.2404,40.1702,42.0845,49.0177,47.8947,47.1628,48.1785,48.495,53.6777,54.4815,42.2779,40.9836,46.9434,48.2968,51.2179,41.7137,35.319,54.7294,42.7218,42.571,47.3628,41.9767,51.2328,55.6564,38.298,45.9831,52.4423,42.1011,43.3996,55.7274,47.7973,42.2671,41.5209,35.9352,42.7521,30.6197,34.2356,47.7548,48.1052,45.9737,54.2169,42.6017,38.8382,52.5425,43.6591,62.969,50.3051,37.4222,37.6954,48.661,46.0237,44.5088,49.4129,41.8956,52.8975,40.8292,59.317,51.2351,43.5232,43.6424,39.134,35.2052,42.9459,49.8312,51.7995,50.1756,47.2446,52.319,46.5369,53.5276,42.1098,41.3119,39.9195,35.4122,29.7061,41.6181,39.8541,41.2405,45.3981,48.5287,31.0358,39.9683,41.9358,40.3677,40.7254,40.8043,42.4876,39.7465,45.3214,46.4279,38.1147,31.9602,34.3874,45.3293,41.309,37.1645,44.06,34.6549,37.2392,43.9082,47.8581,43.8814,41.5311,47.9871,50.5579,40.6947,46.6428,43.0917,46.8553,55.5498,54.9894,41.5213,40.1007,41.7476,38.4574,42.4742,39.9577,37.4118,48.4146,35.288,35.5708,41.4225,43.7252,35.743,36.2443,48.0155,46.6731,47.1035,39.5224,32.3682,44.7802,39.82,35.0549,43.1909,42.4066,45.9605,43.3716,37.6697,38.2745,39.3949,40.9358,43.8231,46.9432,45.393,47.9222,46.8715,42.3782,56.0717,40.2691,52.5893,41.9387,34.284,35.6118,36.9166,51.7487,39.7966,34.7489,48.2563,41.4262,25.0691,35.6282,41.377,38.1552,38.8723,40.566,41.001,50.19,46.9498,46.3871,40.4774,38.6696,41.9308,30.0551,38.5584,29.8277,38.5404,42.1929,39.7352,34.0838,35.2459,37.7456,42.5852,38.9833,46.2708,31.829,35.491,42.1746,37.9311,44.138,45.1565,35.717,41.9487,38.0987,38.1809,37.2125,40.3008,45.5028,49.386,43.5081,38.6153,39.2764,42.5472,32.0037,37.8865,43.1909,36.0926,29.6877,28.3518,37.1076,41.4071,42.0638,40.3904,37.4688,33.2784,36.599,35.824,40.6704,43.0886,39.2519,39.2808,38.6619,39.9808,44.0933,38.1682,38.101,37.8252,33.5229,31.9335,37.6647,37.0895,38.2736,37.9851,45.2281,40.4235,42.7854,49.46,57.7347,54.764,47.5719,53.5399,58.2288,42.3311,42.437,35.9807,46.1035,36.9142,37.2829,33.1049,30.6977,34.8116,43.2263,47.6964,38.2385,40.3066,33.678,33.8675,37.6705,36.9288,40.1196,39.0926,41.2492,39.9014,37.4762,41.5091,41.9839,42.9073,35.5967,44.1118,30.8039,38.9186,40.2211,37.4202,38.8126,35.8189,37.0462,27.501,32.2535,35.2442,44.6624,39.0982,27.4327,35.9465,38.8745,43.9545,42.4274,38.7487,39.3212,40.2952,41.5623,36.221,41.7282,44.7819,44.217,32.1422,35.1074,36.2942,39.4089,29.7925,34.3171,28.7134,31.3899,36.8226,40.4096,32.9159,43.9099,40.2756,32.6076,34.3901,34.0176,37.3456,39.3917,36.3212,33.7091,36.3624,40.3184,41.9641,42.7703,39.596,33.614,31.159,37.9012,35.2017,47.456,40.0275,36.9831,34.7102,44.447,33.2569,37.9981,43.087,34.0231,37.6553,31.4992,31.5127,36.9774,38.9427,28.7004,32.3296,30.0251,37.4072,30.0237,31.8549,32.1908,32.9068,41.8797,36.9341,37.7571,31.2859,38.6338,36.0019,33.0696,34.1862,33.7344,32.5886,30.5259,29.0527,40.0842,38.1307,31.886,31.3812,38.1945,35.4914,24.3872,26.3543,31.3573,35.0238,38.0791,39.1452,38.6554,35.5086,37.6953,31.089,33.3542,32.4732,35.6352,35.4363,33.5754,26.3831,32.6991,33.2461,34.0346,31.7144,38.9368,40.3546,33.9087,32.419,40.819,40.4916,36.194,37.9843,45.993,43.2604,33.4586,29.0412,29.1503,26.326,35.2164,29.1264,29.2316,37.2662,36.597,31.8928,30.6883,37.6903,44.4257,36.072,33.6042,28.3608,29.5662,29.2903,31.0107,31.1401,37.9205,40.9517,32.8968,39.4878,33.6531,30.5662,29.3037,32.7323,31.9494,37.1561,26.4603,29.9037,29.3111,34.6057,31.5374,36.9531,27.4501,36.6794,32.3857,32.3843,28.0326,36.0744,32.195,31.9436,34.6126,29.5546,27.6143,29.6733,27.9254,30.9379,30.068,25.7764,27.3248,33.2057,28.5143,34.5446,32.7542,36.3041,39.5407,34.785,31.604,33.3773,35.5252,34.7814,35.5554,32.7341,37.6781,31.4357,36.7047,38.7215,32.1652,33.1598,48.9705,38.5921,31.9159,35.2103,39.6316,33.5439,29.4599,32.5037,33.3413,26.6222,30.4264,38.2778,37.672,41.0675,37.9094,36.37,41.2913,39.1069,44.3964,49.1769,38.7652,50.811,59.7529,68.1373,72.9525,83.1687,85.4204,93.9574,87.3734,96.6047,97.9278,83.4821,82.6705,82.5496,72.5613,67.3698,75.1884,69.1772,69.403,50.3243,41.1296,43.4071,43.8332,38.0926,47.1833,37.4241,34.0289,31.4153,39.5932,34.6307,27.2709,25.8174,26.2126,30.0137,31.1042,39.15,35.7445,26.9776,24.4799,22.6296,25.733,35.4708,28.5955,24.1422,23.5484,29.2548,26.8549,21.4137,34.5519,33.9727,34.7264,29.6744,31.3121,33.5652,32.0729,31.5394,32.0018,32.3731,30.51,34.8955,38.3834,43.2364,35.3604,38.9547,34.3261,27.1953,32.5886,30.6603,22.6888,24.6246,27.0168,26.5717,33.3339,24.9505,32.1638,35.6923,30.9347,34.8113,39.3348,27.6485,31.5602,28.6086,23.1063,30.2905,32.8946,30.037,30.8114,32.8691,35.0465,31.9517,32.3018,29.3783,33.9533,40.0173,35.1023,34.8296,28.5488,38.6635,25.579,28.2498,29.0103,32.2586,34.7225,28.9006,21.3092,35.4105,34.8587,36.9159,24.5861,19.16,30.3542,30.4909,30.4905,26.1007,23.4804,29.5679,34.8554,29.917,34.8999,34.8858,32.3756,32.5515,26.8959,24.2206,25.1596,23.0331,29.9968,32.1844,26.2792,26.0368,18.5921,20.4379,31.7787,26.4765,24.9715,31.7206,29.097,26.2956,35.2916,26.6614,30.2768,18.661,26.1512,26.9001,25.2403,26.9913,24.5249,41.8955,25.3294,27.5812,28.7719,27.2346,29.1362,25.8697,27.2361,38.073,30.7912,43.0507,32.5085,25.8002,29.2819,31.1345,31.299,20.9548,21.841,27.1313,32.4082,19.0933,25.2046,29.7181,34.1817,21.5869,24.7398,28.2703,29.3799,31.6511,26.8278,26.3425,25.2681,32.3243,32.7234,24.0049,24.8898,27.3368,22.2026,21.3912,27.2004,31.7987,22.1793,29.7094,24.0286,25.4309,27.5808,21.0126,27.0785,35.9176,35.7391,24.0935,27.6397,25.8279,27.3736,27.2155,35.2451,26.9219,31.68,30.268,22.6931,28.8085,29.7794,23.7427,33.4409,35.1511,26.21,29.6948,29.2092,18.176,21.0874,25.9886,21.8235,25.9603,25.6769,25.4945,31.5168,31.3834,29.2219,23.6133,25.097,27.8978,38.0515,25.6355,26.3709,21.6346,28.6462,30.5749,21.4987,24.7786,29.625,25.9489,25.5104,26.9863,21.78,25.5839,24.512,26.1708,30.7226,25.2035,23.0765,25.3537,30.406,27.8843,29.227,28.7111,35.6435,32.0842,33.194,31.215,29.9518,22.048,25.6116,27.1864,30.4121,23.9284,24.707,27.9067,33.6052,30.7217,31.5392,25.4164,30.134,33.262,23.5729,25.914,28.6608,26.7946,27.7285,23.9599,21.8657,26.3619,22.7652,24.9857,27.6685,23.1075,25.1794,33.016,27.5868,23.443,35.3111,37.2757,24.7466,23.6243,23.1882,19.9716,21.5718,20.5978,25.1681,21.7091,26.6253,23.0587,28.8749,31.5692,24.3592,29.622,30.4781,28.5373,26.5913,28.9128,29.1308,26.7949,27.2558,32.0035,27.5082,29.8708,24.0805,24.8676,23.7005,27.1895,37.0405,38.1606,34.4401,32.2052,22.5988,23.2817,20.0402,24.6305,29.1982,29.5163,25.9328,25.5702,32.0906,32.279,29.1897,31.2107,29.5872,26.435,25.8377,26.1701,32.758,25.7892,30.3842,27.0393,37.5059,24.4437,29.0756,27.3519,20.2046,24.5848,25.1647,21.786,25.4657,28.949,28.4805,28.7561,21.617,18.2934,27.1174,28.9464,26.0776,25.2354,26.921,24.6349,31.6504,30.6776,25.5686,30.3199,23.7875,25.7403,25.2331,27.2331,31.6105,23.9102,26.7192,29.8184,29.5674,28.0878,25.1735,17.1304,23.746,28.5186,25.5708,26.4779,26.7948,25.9145,25.7871,31.0425,38.6409,40.8939,41.8234,43.4975,47.9729,69.1083,84.2949,72.9222,76.6035,84.7902,90.42,83.4444,89.8322,71.9808,58.9684,55.7047,44.5392,30.9379,28.849,29.1624,27.4576,31.239,25.3586,21.6604,24.5465,24.342,24.5225,23.5964,26.5106,31.4478,30.4916,26.0051,32.7554,28.1495,29.7517,27.58,19.3455,23.8167,25.5053,23.7144,25.7243,21.8271,24.3925,22.5901,22.2754,19.6602,24.2979,22.1971,24.1637,25.8203,24.0528,18.6423,20.4152,17.6586,24.3673,31.1256,22.0902,19.1284,26.4565,28.9061,31.1966,27.4828,25.099,31.0314,28.7445,27.1606,27.7126,21.1882,26.1081,23.4215,20.2404,22.3719,22.2304,17.6644,20.784,28.6417,26.768,22.9773,25.6924,24.898,27.2313,23.7304,24.0991,20.3796,20.3496,18.8564,26.0339,27.8464,31.3256,28.2468,27.7347,27.6415,22.6202,19.5017,23.1054,19.9034,22.0845,26.0183,31.0811,23.0822,18.6894,27.903,25.0023,23.3676,20.3399,21.3222,21.0167,19.9608,25.5739,26.3715,24.9072,25.9213,26.6136,26.6338,25.4377,22.4427,21.2893,25.0486,23.9001,27.7589,29.1641,25.4725,27.5809,25.3516,23.027,22.4475,20.2729,21.1497,21.8297,28.5254,22.8917,22.1239,28.1569,26.909,24.205,19.2495,26.2144,27.4978,34.8342,38.3811,44.7511,34.5675,42.5659,42.4506,62.9291,67.6195,81.7491,87.454,100.414,85.7693,86.3925,84.5804,65.6674,60.5475,56.7634,49.2222,31.0593,25.0071,27.9971,23.5768,21.0059,20.8916,22.2115,22.0386,22.7378,27.3729,25.635,30.176,18.9599,18.5205,24.4978,27.5783,23.8929,14.2739,21.2463,22.6562,26.3166,17.6082,21.1027,24.2019,26.1499,21.5813,25.294,20.3817,21.8742,19.5801,23.2928,17.7047,21.8615,27.21,20.3842,21.7972,18.8763,23.1946,20.3851,21.0794,25.4319,19.2325,24.0245,24.7426,30.602,22.3156,25.6221,21.814,22.9454,19.5169,24.6895,25.2728,21.9615,21.4997,25.6926,24.9638,21.9205,12.51,20.163,22.8302,28.1206,28.0548,21.9286,25.831,19.1924,24.3268,21.491,24.5784,23.6656,27.5068,26.5017,29.9344,16.604,17.4899,19.8742,23.9864,23.2569,19.6418,19.2813,22.0032,21.8606,23.7837,25.3189,18.6398,25.9295,21.5911,15.7971,27.3722,26.1959,28.4604,19.454,20.2432,24.4964,25.0399,28.8886,18.4092,15.1951,21.8609,16.2851,19.3566,12.6741,22.4185,18.6392,15.3302,24.9812,28.6232,22.981,19.244,18.8905,21.5142,19.5486,19.0173,24.3388,28.4732,22.6236,20.9939,22.9098,24.1319,22.8781,23.8099,21.8421,22.985,26.6759,25.2097,22.0999,20.0955,21.7302,21.6043,19.2113,23.0103,19.3568,19.0854,20.2321,21.3689,16.9247,23.377,19.4291,12.083,21.9321,24.6526,18.1794,21.4977,19.5393,19.9579,21.4724,18.1176,22.0121,32.1705,26.6523,23.6173,22.289,26.1889,25.3368,24.3527,29.2081,25.6783,22.4684,16.9461,14.9474,22.1703,20.2489,16.641,18.4873,20.2664,21.8978,20.737,18.065,19.649,24.3597,21.0732,17.06,17.3534,21.3078,23.7053,24.3437,16.3629,21.8372,23.2887,20.1016,19.8146,21.2655,20.8962,24.8732,23.9499,24.7284,17.0428,17.2281,15.3871,13.7586,20.3167,16.1829,18.6215,26.2541,18.339,16.5645,20.7463,16.1655,13.1466,29.8218,19.2401,19.0997,20.4217,16.7777,26.6197,20.6818,16.6284,14.1903,25.7008,24.9735,17.2823,22.6283,29.0725,23.4077,17.9989,15.7299,22.6703,23.5815,29.2132,31.8072,27.6904,15.5233,12.9738,16.5394,18.1706,22.9418,19.9293,22.2499,25.4142,21.5179,17.8352,20.747,23.2603,20.8345,17.8786,16.2281,11.3817,12.7713,21.1211,17.9667,24.6656,16.2175,20.2538,13.5226,23.2282,19.2628,17.6555,22.1009,16.6818,15.1125,27.1402,30.3351,18.6495,24.9617,24.3535,19.7609,20.2953,15.9216,16.577,21.825,22.7046,20.4457,21.2371,29.1942,22.25,20.8101,17.1297,23.6237,13.4709,23.9878,20.95,21.7752,22.9283,14.9577,17.5745,23.1124,27.1054,23.9378,23.3944,23.8267,21.0461,16.456,22.1004,17.3023,14.618,18.1448,23.2626,27.7883,22.8538,17.5556,20.775,27.2775,20.6747,31.8459,23.3013,23.9388,23.1843,24.7158,22.4237,17.2875,12.4054,19.1552,23.331,13.6454,16.4721,22.227,23.2609,23.0295,27.8156,19.9379,18.1764,16.8443,17.6865,17.5073,16.4549,18.286,19.8165,21.1436,24.282,31.3389,18.3651,13.0739,22.1653,24.6398,20.7635,22.659,14.1863,14.8131,16.6157,14.0419,19.4263,19.5183,20.2836,19.4208,19.1326,16.2361,17.2192,23.4812,17.1158,17.7468,19.0735,19.5234,19.8943,18.8304,17.7746,21.1793,18.6159,21.1389,20.6165,20.5639,20.4361,20.6584,18.9804,26.5139,24.2423,18.7681,24.3135,26.6573,22.1364,14.828,10.7428,16.1656,17.6184,19.2054,20.3196,21.3929,19.4387,17.6003,22.1039,25.4988,28.1219,29.9441,22.7989,18.398,19.0579,22.0588,23.3722,19.661,19.247,23.352,23.454,16.8593,25.2392,16.325,18.8346,19.8097,26.312,15.3169,23.4923,15.9983,17.1159,18.5839,20.692,23.7894,21.9232,15.389,10.9369,14.1903,23.4343,18.525,16.7613,16.4363,20.51,13.5335,15.6248,13.3622,21.6098,21.1412,22.16,19.65,18.1421,31.2435,20.8869,23.0483,21.554,24.0677,29.537,21.2094,20.3271,21.4068,23.2863,20.5398,19.1466,20.6785,19.3694,13.9803,21.6554,23.7392,19.0309,22.777,19.1606,17.7233,20.0803,23.4373,18.4146,14.1936,16.5764,20.4785,18.5055,24.0348,23.8994,16.6483,20.2605,17.793,18.4595,23.7263,29.8209,20.9188,24.319,17.6258,19.899,17.5505,15.5308,18.3461,16.9507,18.0331,19.6527,17.0378,17.1968,14.3648,22.5879,25.0706,17.681,20.5759,24.606,21.0142,17.3521,25.7418,20.1062,15.1091,16.1032,20.3032,20.8057,14.1992,12.8913,16.3341,19.1339,15.1496,14.952,19.0466,15.9398,17.0716,23.3255,19.0811,18.8343,21.3017,17.8972,18.6916,20.3001,16.9955,15.4982,18.8144,17.5025,17.5315,17.9774,21.1891,20.7135,22.2649,18.5165,18.2225,23.1108,18.7147,21.0306,20.7227,15.8671,18.9057,18.8198,16.8679,15.9725,13.6299,19.8564,21.3793,15.2458,22.8121,20.3152,14.5941,16.2327,19.8057,23.7242,12.6676,13.6825,17.8734,15.8345,20.0966,19.3709,17.7407,18.1321,9.53309,21.583,24.0163,14.5452,16.9645,24.929,19.4564,16.7905,15.7502,20.3655,19.1198,20.3601,25.6809,19.2028,17.1682,19.7872,24.3608,17.3443,14.8577,11.3343,17.0556,15.9129,26.1603,23.2518,13.9842,18.0111,20.1882,19.5902,16.2777,19.5868,18.8363,14.4541,19.268,22.2268,21.6907,21.7996,16.6724,12.1555,13.3198,21.2285,18.4407,19.5209,15.0505,17.6885,16.4668,14.146,16.4247,27.2061,25.0954,20.7874,27.1617,23.2158,18.7599,20.1542,19.7298,18.4079,16.2663,13.9908,23.4818,17.1695,17.1102,18.0992,19.5268,19.3793,18.4378,16.9347,17.1724,17.044,15.5883,10.5288,8.24159,15.0448,14.8525,14.7472,16.2309,19.2911,27.6372,22.8949,14.8328,18.3328,18.9389,14.6022,20.8448,21.882,25.5205,25.2204,14.3932,16.1397,22.2245,22.3868,29.8573,33.2646,30.9876,33.994,32.8999,29.2601,32.332,28.7061,29.7042,21.8199,24.3719,20.1505,17.5956,21.3654,10.6911,8.50932,12.5482,11.0143,14.879,18.1935,19.6001,11.9893,17.1864,10.374,17.248,21.2638,23.5412,16.7955,17.3259,15.3691,18.393,23.7831,19.4813,17.9974,15.6549,16.2685,18.6603,17.6955,19.8475,18.8633,14.6671,18.3099,18.1435,19.841,19.9622,13.8059,16.2578,15.5526,14.243,12.9871,16.3657,23.4334,20.6797,18.0033,11.4639,15.9106,17.7683,17.4481,19.868,20.8838,20.6468,13.4486,15.1657,22.0131,13.8839,10.7693,17.354,18.9294,20.8799,19.7048,17.4255,12.1063,15.869,20.549,16.3284,17.4008,16.1326,17.2121,19.6561,19.1775,21.6905,14.4034,23.6449,20.2811,19.4461,14.4036,12.8434,16.1465,17.4126,13.6574,13.3921,24.9991,19.4498,10.0724,17.3566,14.0518,12.7167,11.5483,13.4618,15.4762,18.164,16.4853,18.1452,16.8359,18.5992,13.0527,21.8717,16.7088,17.2358,14.2704,17.704,17.7021,13.2274,19.8829,21.4247,15.7868,20.6806,15.9984,18.0631,11.1969,20.6464,16.4587,11.933,16.5004,15.1439,18.6936,22.1236,19.2751,24.4334,20.7884,16.9452,15.6666,10.5544,12.1547,13.6928,21.9987,18.3817,17.9137,24.5338,13.3513,13.9315,14.3803,14.5229,14.3707,16.0182,12.5781,8.21058,10.76,11.9657,17.1377,19.7964,13.5839,21.9233,20.6622,21.4279,22.0743,18.3349,15.3968,18.603,17.1065,14.8677,14.1073,12.3863,15.365,18.864,14.45,18.4382,17.7998,16.9862,16.3855,14.6004,16.5416,18.7455,15.0188,10.6664,18.9104,16.1443,22.2836,18.8256,15.1175,14.3083,15.0003,17.2335,16.9704,16.1975,15.9126,18.2922,19.2577,15.293,18.6115,19.2868,15.0785,16.2838,17.1214,13.9377,25.2221,19.565,17.5508,17.7369,23.3597,19.3481,20.955,20.6085,11.0853,11.6945,16.5444,15.4406,15.1564,12.6292,19.1916,17.6246,17.5083,22.6581,17.4199,16.571,15.6586,17.247,19.7488,23.2703,21.1709,27.0271,18.009,25.486,19.2634,20.3062,20.5693,20.5585,17.5905,19.0933,17.4489,10.5266,9.69174,11.8226,12.6941,17.8319,14.5329,13.454,15.7041,15.7136,20.3084,21.5262,14.3385,19.2657,23.5766,23.1055,13.5257,20.4534,19.2108,12.6598,10.8764,16.3999,12.1775,12.646,13.1157,15.3199,12.8291,13.5676,17.8097,18.2651,17.6651,17.7616,12.4711,14.0899,20.9229,16.576,16.0299,17.84,16.2934,15.0094,17.0856,14.4055,13.7022,12.6519,8.68584,14.393,19.0776,14.6538,15.9533,17.6063,17.4247,14.8379,17.6881,16.8932,12.9158,10.7748,16.6637,12.2627,16.4254,17.8825,13.4963,10.6901,15.9736,17.8215,11.1066,11.5573,16.0702,25.6186,18.2319,16.2911,22.8942,19.8817,18.8251,16.7532,11.9704,15.1885,16.5418,11.4496,7.19236,16.4107,12.9786,12.9886,13.894,13.82,11.8166,19.915,17.6625,22.4702,26.2492,21.1482,20.1948,19.5804,17.6638,18.1979,13.7845,11.8324,15.6899,18.4735,10.215,12.6156,15.4228,18.8057,23.2216,18.5596,20.4506,10.1962,12.8875,17.5922,18.1767,14.3141,16.0596,14.7485,11.3232,12.5991,9.5164,13.1725,17.5205,18.0167,13.9475,12.1082,18.8069,15.5927,13.6212,13.8796,17.4111,11.7774,16.8668,16.0406,11.6221,15.3271,18.0608,23.1745,25.5651,22.2709,28.763,26.3268,17.9348,19.4734,19.6605,20.1918,17.7568,17.5163,13.7778,18.645,18.8695,20.7532,17.2304,13.6645,16.8881,19.2502,15.7568,12.8477,8.7195,13.755,13.7913,18.0454,9.72242,15.9771,21.0675,13.7518,10.8297,11.7517,15.3295,13.3639,10.8632,10.5222,9.30332,15.5952,13.0457,17.0068,15.2773,12.6995,12.4399,18.8455,19.2551,13.5526,14.7936,12.0051,17.8829,17.2791,14.4008,9.65859,7.99477,12.3642,6.32131,14.1162,14.9587,14.8939,12.636,15.0287,15.6308,12.2399,16.9237,14.3527,14.5999,21.4606,15.3026,17.9684,18.9195,21.0963,17.21,16.0406,16.375,10.576,17.4456,13.2978,15.8752,15.1314,10.564,14.2645,17.4038,14.4067,15.1772,12.0128,13.9331,18.1319,18.0388,13.6642,15.3615,7.64944,10.515,15.5845,13.7433,11.5259,12.3503,15.6103,15.5884,9.03348,14.0042,16.686,18.2128,18.3503,15.6432,19.6449,15.4917,13.3226,12.8357,15.9807,14.2286,13.9164,20.4455,19.9433,14.2906,15.4662,12.4426,12.0353,13.6234,18.9971,16.2405,13.8342,12.0175,10.9171,16.6247,18.8072,9.46737,12.5872,9.19241,14.6776,11.9248,13.1144,19.1348,18.9489,14.8468,10.7836,12.1221,15.9056,15.9351,11.3378,18.8555,12.4733,8.27993,9.93541,9.8894,13.0822,8.81369,12.6737,11.5937,12.6453,10.5783,8.36874,12.8508,18.2911,15.9432,10.0246,10.7348,14.1495,12.3631,17.7919,12.4577,13.8655,15.1098,12.4095,13.1138,12.2959,10.213,9.32695,12.3272,14.6115,17.1066,16.1301,7.8681,9.54092,11.1374,15.0675,13.2068,12.0971,13.2336,12.1828,13.3401,10.8756,16.3072,19.0014,14.5065,12.3484,7.50774,11.7409,15.4823,15.2202,14.9447,13.7876,16.5239,14.2233,14.9735,12.895,13.4084,11.8312,16.0792,13.4711,16.1623,13.1769,13.846,14.65,13.186,13.1158,13.6203,15.6241,16.0522,15.7389,12.3463,16.0838,13.6416,12.2266,13.0386,10.5808,16.5379,17.6798,20.6972,25.1487,20.0946,12.0173,14.8314,13.7184,14.1771,17.2389,25.0274,24.6955,14.0691,11.6879,15.3721,16.3174,14.9692,15.1047,14.3934,10.2336,8.51484,9.10871,14.2373,16.31,15.1629,11.5039,19.3021,19.339,14.8955,7.0247,10.8764,14.2807,15.1802,18.715,18.5318,12.2891,12.4545,10.1561,14.8051,17.4711,12.7114,17.3856,11.6355,13.735,17.0132,15.3374,14.0597,15.3963,10.0742,16.0337,14.3043,14.0153,9.54495,14.4706,8.47853,7.98024,15.892,19.0815,15.5194,12.8735,15.4988,14.5307,13.7227,15.9792,14.9283,12.947,10.8196,13.851,19.4469,18.6955,17.6242,14.9029,16.7022,11.4179,13.7275,9.10182,13.3859,18.3222,16.218,14.2069,15.8522,13.0439,9.53876,12.663,12.149,15.9049,13.1583,15.2452,19.4866,10.603,11.4313,13.7116,16.2802,12.1649,12.5613,20.6719,14.1741,13.9093,13.4446,13.5723,12.3909,10.4601,9.50061,13.2375,8.70107,12.6098,16.5054,16.5668,17.9607,13.5215,11.8733,15.8387,14.2201,13.8076,8.74411,11.5074,13.3918,11.3498,15.6374,13.4841,15.7188,22.1366,16.4462,13.9065,14.7256,17.1817,16.1018,11.0588,10.7416,18.5101,13.0274,10.8336,14.591,15.376,16.8452,19.4248,19.4925,18.8393,21.6599,21.4728,21.8598,15.3328,22.5062,18.1488,12.0387,17.6955,16.0418,17.2622,14.6327,17.2609,8.26133,15.3221,15.6785,12.9293,13.8573,10.7692,10.6135,12.2926,14.6999,11.0651,8.72993,14.1782,13.8554,14.8056,11.8541,10.7525,10.5202,13.677,8.41651,15.4747,14.3253,11.8422,12.8384,14.3269,11.6671,12.0106,17.3654,22.6736,13.1842,9.33124,11.7311,12.7567,12.6771,14.223,12.0783,10.6526,11.0091,7.44191,15.267,15.5575,8.92366,9.6789,9.05403,10.3429,12.8571,8.8533,14.2049,14.0018,10.8285,6.8332,9.44,11.1479,12.3838,14.9419,14.7147,16.5129,10.0704,11.7629,17.0919,15.4167,13.4189,16.5437,12.8081,11.3274,11.3489,11.5866,10.6955,9.77822,12.1657,16.7467,12.6383,11.8083,19.5209,14.5873,10.6742,16.6599,18.4218,10.0486,7.38999,9.90871,18.1661,18.6404,9.96306,10.5704,11.0694,15.2843,8.20675,7.94718,11.9096,11.8781,8.6088,9.45899,10.1493,11.2501,12.7844,7.61883,10.1801,14.1471,12.5099,11.3018,12.4674,13.1502,18.202,14.5941,10.4059,12.7001,11.5487,10.5952,10.9714,15.2563,13.5609,10.9986,12.8491,14.3774,11.9326,13.294,13.9596,15.589,13.0082,14.8953,16.7926,13.947,13.4899,8.62627,9.00032,9.64851,8.69074,12.6667,13.9409,17.4167,16.358,10.0506,9.41511,12.2902,12.6196,11.9764,11.8253,10.0065,6.54193,14.6899,14.8809,12.7095,8.8201,11.7278,7.61134,11.2966,13.0182,14.2198,11.21,14.1964,15.2826,11.6772,12.3558,14.1948,14.9562,10.9846,9.84775,11.1505,15.968,12.0128,7.06454,10.3876,17.908,17.8044,15.9304,12.8621,12.0142,11.0554,10.898,10.439,9.96604,10.8013,8.36876,9.9452,14.2038,13.4504,11.0847,10.364,12.7047,11.9604,11.7215,9.84533,11.3216,10.6915,14.3269,12.4468,19.7176,12.5164,8.44431,11.0129,9.25601,11.7378,11.7779,10.0643,13.0231,13.9229,13.9163,15.4007,14.1317,12.8193,10.7778,8.03804,11.1834,16.4387,10.8364,10.9516,12.8206,12.902,13.8584,17.6275,16.4349,8.29938,15.0301,15.2438,9.83985,13.7736,13.9579,11.1933,15.3133,15.4212,16.2273,14.9373,10.8884,13.026,20.7579,19.7234,16.5857,15.9037,13.6362,8.23193,11.7615,14.2393,9.60319,10.6013,12.9724,12.8194,14.4468,7.99063,10.9257,13.8223,16.8611,10.0627,17.3715,15.7337,8.11463,7.66842,11.7051,9.01474,10.6866,16.7899,19.7869,19.6034,37.3414,41.8799,42.0829,44.9161,50.1946,59.8373,50.7486,70.894,56.9934,54.9807,44.2161,41.1092,30.9202,23.7508,21.4636,15.8689,9.84214,13.0538,15.5848,10.1875,12.5431,14.166,16.0602,12.1075,9.20613,13.7741,14.5996,12.5214,11.0451,7.58938,13.3138,17.5244,12.2651,8.92099,8.52041,10.3242,11.2665,13.8506,9.32212,7.99838,10.3516,9.58891,9.89657,10.5827,14.2889,13.1417,13.8389,7.91751,12.1464,12.5741,14.0393,12.2075,15.4871,13.4903,14.7299,10.2726,9.47335,11.2187,13.9428,12.9141,11.1684,11.0866,8.50193,8.54448,10.3382,14.3673,13.4649,11.4095,13.283,11.052,10.6181,8.17323,12.814,12.4378,8.39452,9.61005,11.6112,16.6974,11.4891,12.4053,10.707,9.23584,13.6613,11.863,6.16521,12.591,10.726,14.132,12.8075,15.5261,10.8162,8.9418,12.1601,14.5188,8.0781,10.575,12.4263,16.4292,15.5201,11.2837,8.94436,8.82954,10.6377,14.1283,9.0828,9.84365,13.7069,15.3562,9.27612,11.0962,17.4965,12.7146,7.62927,9.28586,11.3889,9.87185,8.89014,11.2075,10.5143,15.9326,17.658,14.317,14.3963,16.9396,12.7014,19.2393,18.9143,16.1167,11.2631,17.2111,18.8917,15.8192,15.1865,16.3749,11.0331,14.0336,10.8641,10.7127,14.0589,10.0995,7.283,11.0429,11.3443,20.9968,15.1771,9.8315,13.3759,9.3208,11.1048,16.8955,10.4732,11.3652,11.1417,10.3583,11.1006,18.2848,18.6869,16.0816,14.2548,17.8482,10.0404,10.3621,6.84774,9.89144,12.9271,10.2678,7.88135,11.6622,14.303,11.0611,12.7158,12.0896,10.7861,11.9417,9.61697,13.729,13.2639,8.83828,13.4681,9.17335,11.5597,7.04285,9.06408,10.4311,15.2814,11.0936,8.89453,13.7387,9.76652,12.0159,15.5995,12.582,9.93156,10.0661,9.43408,7.07773,9.60927,16.5534,13.9889,12.8794,12.2899,7.79405,14.7385,14.5009,12.8482,12.5499,11.4726,10.7567,18.6446,14.362,12.7001,15.6657,12.4079,10.3986,14.6874,10.1988,14.4615,11.5258,11.3622,9.98395,18.8086,17.3865,11.8726,12.4549,12.6516,3.52127,13.0386,10.2916,5.99778,10.3977,10.6256,11.5064,5.94299,10.0586,9.50528,13.9224,11.9577,11.2771,13.8173,10.6389,12.6243,9.16861,6.16434,11.0467,9.10632,11.7538,11.504,8.28258,11.2963,9.45541,8.28506,11.2071,14.3395,11.9294,7.68042,7.66543,7.62496,7.65272,10.5531,10.4162,13.7416,14.2127,9.77881,10.127,9.87844,14.9574,8.86503,15.5577,17.5794,10.9452,13.8062,14.868,11.3599,10.5589,12.5093,12.4104,14.1523,10.6796,13.5908,10.8272,11.3215,7.13775,15.1414,12.3016,14.0915,12.786,15.9914,24.1981,23.2215,21.7645,21.6062,25.6025,22.1689,21.5177,16.8933,14.1947,18.3362,21.0772,12.7487,12.0218,13.4196,9.51901,11.6421,10.5949,13.1828,12.7567,15.5619,17.2833,26.2123,26.0289,22.9836,35.4532,35.4474,38.3805,40.9801,28.3114,27.3874,26.8369,27.3607,25.2061,20.4615,15.251,15.1778,11.7726,8.07615,10.6368,14.9791,12.2891,12.9382,16.1379,12.377,10.2843,10.6146,9.97411,8.0158,11.6121,14.882,10.5255,12.9907,12.6706,9.89858,11.664,9.29296,11.049,15.5198,9.53438,9.59281,10.5819,10.7848,11.2249,10.6692,8.31494,8.03193,8.12392,9.09226,10.0192,15.8677,9.45237,10.4441,12.9344,8.36143,12.816,9.25113,8.89282,9.40053,12.7379,14.7692,8.18506,9.86968,9.81154,10.618,12.7171,11.1464,12.8749,12.5225,11.2358,8.68045,13.3747,12.5554,12.0107,10.0558,11.4273,11.3239,10.661,13.68,14.0068,13.7486,15.2751,17.1128,9.71182,12.1515,12.028,9.74696,8.91164,10.6812,17.6999,15.7696,9.77648,16.2032,10.9864,10.3223,17.6968,12.8336,9.06057,8.60536,16.9038,13.6414,8.53296,8.62276,10.3162,12.3308,13.14,13.1777,10.7507,12.4764,12.6559,13.9898,9.9518,10.6581,10.4796,10.4312,11.3772,10.2687,12.0896,13.867,16.2469,13.8043,10.2334,9.26511,8.26113,12.5901,9.83991,9.39205,7.5172,10.4647,11.3029,10.7655,8.42465,7.9959,7.68298,17.8379,10.7497,9.91835,11.3773,10.5686,9.27366,7.06208,8.22106,6.43672,6.30161,7.25386,14.6542,16.8216,10.6154,7.55499,6.30774,12.4691,9.71888,9.46712,12.2301,12.7583,11.0797,14.3721,17.0953,10.4769,5.77069,6.53077,8.36467,6.94541,11.0964,7.10904,12.9883,9.68368,9.26666,11.1498,15.9886,10.7833,8.9377,8.59923,8.23051,8.1021,14.7071,18.5309,19.5203,11.8947,11.7453,16.1164,9.39673,11.2087,10.7607,9.8894,10.8752,7.66479,7.13331,9.92399,12.0299,10.1218,10.9942,11.5967,8.9072,12.134,13.9118,13.3738,17.3589,11.2335,12.0502,7.57724,8.37577,11.5707,9.38933,8.97565,5.87482,10.6637,14.0407,8.46169,12.1497,13.1402,14.0882,10.3048,8.89883,9.52335,7.24008,10.7951,8.10442,7.90489,8.48686,8.02899,10.5285,14.1933,13.9897,7.88655,8.3806,9.53058,12.5604,13.0355,7.12641,6.76798,9.03905,7.57516,4.67736,12.1259,15.6872,12.7793,13.7314,9.56329,9.75985,6.77031,7.61643,10.2612,12.0654,8.21081,8.803,12.3275,16.5177,19.0675,13.4626,10.6958,6.83846,10.0162,9.87232,12.4958,9.68427,11.7127,8.14849,8.91559,13.1468,13.0581,8.28667,7.55242,12.4815,12.6711,5.70156,7.76287,10.1528,8.63507,9.9307,12.2645,6.12896,9.72045,12.4388,9.49484,11.3617,10.8668,6.54874,6.31106,12.6329,9.21962,10.0164,11.7441,10.323,9.3859,11.5977,13.3544,11.5551,11.0789,17.4223,9.61345,8.45445,8.07276,16.7636,11.8124,12.1322,14.7939,10.4049,12.2184,6.89167,7.42599,10.1738,11.516,13.2979,9.60029,7.07407,9.16615,11.3995,9.66521,11.8092,16.1577,7.627,6.8437,5.92564,9.95095,8.46865,11.668,13.475,13.6585,9.94422,9.55532,13.9897,5.67503,9.3811,8.1181,10.2161,9.39854,8.08968,12.3488,9.96926,11.4722,10.7991,6.82704,10.6707,9.6652,10.1726,4.67447,9.13253,10.1929,10.627,12.3398,12.8457,8.72144,7.53898,6.70207,11.259,12.7909,9.26929,11.1466,8.86975,6.9773,7.10617,10.7897,9.26118,14.6276,13.9643,12.5044,10.3258,9.91004,12.2449,12.4413,12.4708,7.73192,9.73195,11.1957,11.2595,13.3827,9.43933,10.7425,9.50909,11.3096,14.1413,7.67299,12.7255,10.3229,11.4187,11.9886,13.6002,11.4876,12.8135,11.3147,16.7366,13.7392,6.79158,13.8967,5.41086,10.5285,6.92829,11.8168,10.2924,8.12476,8.52225,6.00569,9.03559,11.0947,17.0058,12.3117,8.25112,10.8874,16.8074,17.3191,12.1896,9.92686,10.2717,8.6254,13.6178,13.7422,10.8905,6.16263,6.77763,10.9035,8.06303,11.4799,7.54038,8.91799,7.63361,9.78088,9.53201,7.8775,8.70829,7.02796,11.2418,11.5385,11.255,9.009,10.0901,9.40365,10.3047,10.1792,7.96994,13.1653,10.1136,10.8652,11.4044,11.2691,7.30143,11.0219,5.78525,10.1132,9.43383,10.9059,10.6583,8.80094,8.87245,12.8433,12.4772,9.9691,10.1804,5.66762,14.2646,11.3227,16.5095,11.9174,11.3607,7.75828,5.06257,9.54589,3.47847,8.12548,11.736,11.7194,8.22378,4.36299,14.7272,8.80225,7.93085,6.48236,9.89532,7.17544,11.8308,7.51692,9.53537,13.1384,8.48301,5.10596,8.20301,10.6502,8.2917,9.20226,11.1104,9.44247,13.6177,9.78477,9.5417,11.5796,10.8182,10.9696,12.0235,12.558,8.19569,10.0045,4.75981,11.4029,11.886,12.1327,10.7047,16.2227,10.7446,13.3823,10.1612,8.12743,9.78951,7.79487,9.44276,6.49829,7.45057,7.97282,9.79313,8.21355,12.3961,11.9617,7.48069,6.08742,7.13518,11.1254,11.6884,10.4418,12.5462,15.3903,11.6451,11.0821,14.5563,11.5772,12.3746,13.5985,11.3829,12.1298,11.8636,13.7367,9.14147,13.3177,9.06712,10.7075,13.1746,10.6694,10.0221,9.366,12.8525,11.5293,6.43488,6.31627,6.94402,11.9736,10.7082,13.8157,8.21558,7.72396,10.1796,15.4601,10.5484,7.31191,12.2361,9.3488,11.7975,9.71692,13.994,8.61715,7.18642,6.6898,9.49896,11.835,13.5445,9.47007,15.4691,8.06876,6.54829,7.00959,8.62592,6.52249,8.68769,8.43976,9.22332,7.85982,10.2775,11.0931,7.73105,11.5826,17.5093,9.41301,7.99229,8.11006,7.77637,16.1447,11.8516,6.86807,9.98453,7.6413,11.437,10.0777,11.3101,11.2243,11.4176,6.57634,8.45982,7.80714,10.1692,11.6238,11.5651,8.63056,10.9035,11.288,10.4019,9.07098,13.4654,14.1649,11.299,10.1773,9.52099,10.4709,8.98226,10.47,6.75527,12.195,13.754,9.36702,9.31843,9.50642,12.1309,12.9068,11.9158,13.6773,10.408,9.8402,7.78087,7.76255,9.70783,9.80732,8.64918,18.1334,18.0113,11.0244,9.81542,12.3578,11.4909,9.61135,8.6394,14.1881,8.63278,5.01015,18.0239,8.99497,7.3116,9.08582,10.7752,8.4066,14.1423,5.62278,6.59633,8.36967,8.49996,7.42827,7.28039,10.783,6.7589,9.29359,10.296,5.89807,8.26307,11.5815,10.1482,11.5335,7.51572,9.17044,13.211,8.36729,10.1119,15.8158,8.48759,12.5129,10.3713,9.92265,7.02592,8.60306,8.79763,13.6656,14.7657,9.70466,7.76197,7.75368,9.93938,14.3008,6.31217,8.7336,9.94974,8.43135,4.33224,4.06595,7.67061,9.66527,9.65133,7.86096,12.8475,12.6058,11.9195,10.3389,6.00148,7.52581,11.8244,6.56882,7.2002,5.22242,9.80516,9.83839,15.6835,12.6053,9.26878,11.3109,9.228,11.9177,11.654,7.99117,5.77516,10.7291,3.62208,11.1061,13.3939,13.1079,8.81531,10.9382,7.35796,11.256,17.4783,15.4816,9.2405,11.2584,15.3948,8.79003,15.5079,14.795,7.94827,7.9533,10.5281,5.9736,10.104,13.601,8.89972,8.44652,8.28456,10.0621,9.37608,5.88275,6.93656,7.75354,13.2031,11.4127,12.9642,9.97874,12.5335,12.3878,10.7288,12.1415,10.7969,14.6698,13.6259,8.96267,14.4146,9.15152,8.33326,8.66435,11.2944,8.58175,13.4978,11.3498,9.56446,8.63956,16.3916,11.5657,8.59244,7.6678,14.9443,11.2668,7.46182,12.6747,12.9839,7.6533,10.962,11.5876,13.5794,10.9476,10.9006,6.85931,11.0154,7.68683,6.58103,6.64946,8.71953,14.0085,11.619,9.39301,8.24222,9.79493,13.3024,12.0534,10.3283,11.4128,8.23798,12.6765,11.4404,11.3603,12.0266,9.39001,12.0353,12.04,18.4789,15.297,20.2256,17.7204,19.8255,26.3325,26.4708,31.4507,32.3354,31.3901,29.2922,41.0077,29.5107,26.7423,17.1633,20.0095,20.6928,12.3456,13.4939,10.114,8.40914,9.96631,6.67078,9.21714,9.3536,14.9996,12.9887,6.90305,10.8803,8.38375,11.9381,12.3657,11.0535,9.1103,8.31324,12.7782,13.6529,11.4634,7.71103,8.75681,6.88208,8.98245,4.48052,7.44926,19.2601,8.87969,11.2999,9.7056,10.3324,6.55741,10.1925,10.1319,7.27672,11.2842,8.23804,13.5446,8.68606,11.9747,6.84844,9.71273,13.7115,12.7572,9.82671,11.6741,9.17257,8.19405,10.1092,10.1362,10.6391,8.23793,12.542,12.0529,11.5094,10.759,8.33678,5.4061,5.22986,7.66931,8.91619,9.8554,13.6425,7.92966,11.0074,14.1501,11.3755,13.2616,11.1259,11.921,13.7096,10.9119,7.99865,6.1882,9.44387,7.94419,9.37369,6.82438,9.96144,7.73838,10.2827,13.6319,6.71571,8.17552,13.3757,15.2583,7.67063,11.2866,8.85372,8.95175,6.16852,10.9928,7.56238,11.7106,11.0443,18.1405,15.6785,10.904,5.2916,8.58932,12.4545,10.6914,8.3337,9.93312,10.7559,9.21329,11.4789,7.77233,10.1445,9.20044,9.1459,9.43633,7.27886,7.75414,9.43319,8.8791,7.5504,14.517,11.6459,11.5535,10.6152,7.36359,16.5303,13.2056,8.13393,8.92867,7.71809,7.73304,9.85017,9.34268,7.86072,6.3971,8.57434,8.72185,8.96819,6.68939,7.66297,10.2875,10.5679,16.8993,8.23932,5.9581,8.56054,5.98293,13.036,10.1123,9.17229,13.2123,10.2036,13.0329,8.32193,9.22196,9.06515,6.56932,9.40767,11.4832,15.4582,13.8513,9.44138,9.72858,11.3154,5.53143,13.0008,9.74012,9.42666,9.78102,9.96826,10.4884,6.63529,8.99951,9.71687,11.604,14.9067,17.5351,15.5956,13.781,14.3547,18.8213,11.9186,15.7398,15.9151,15.9528,10.7464,9.08274,9.81198,8.88868,10.9399,7.80458,9.78973,11.1201,11.3902,11.8116,10.8402,12.6084,12.4235,7.19407,8.39185,6.70023,7.66068,13.0368,10.2716,7.7004,12.2173,9.49789,11.8424,13.4874,15.6744,14.2041,10.4381,10.5145,10.0158,11.4121,7.31303,9.10048,13.2609,15.2164,7.08535,14.344,14.0551,9.91309,11.9328,13.0626,13.9045,5.71026,9.63539,9.12238,7.07933,9.37823,10.8734,9.58712,6.35187,13.2462,9.99803,11.0261,16.1174,15.0456,9.66618,10.6558,6.70001,8.78698,9.16304,9.93876,10.8092,5.90932,5.54002,8.47463,8.97192,9.11259,8.71698,10.0708,9.9604,7.85723,9.57374,9.30949,9.73083,8.64879,11.1556,15.0701,9.08631,8.50307,9.98922,11.1836,10.9137,11.5551,7.78193,9.91403,7.58353,10.7271,8.27899,6.53395,8.73573,6.51868,11.0577,8.93333,8.36056,9.21438,6.58592,8.34531,6.64528,4.84508,10.4074,10.0447,9.12667,9.24228,8.92278,6.30728,12.7353,10.9542,8.08226,6.432,9.4368,10.9508,10.6293,10.8868,9.81201,10.1813,16.6683,14.7149,10.9399,11.0162,13.4082,7.73521,12.1814,6.09728,10.3815,9.26463,8.48768,15.2828,12.2597,10.8935,10.325,12.6494,11.0979,14.0825,5.67958,8.50348,16.0007,18.1007,8.01783,13.6996,14.8443,12.457,12.5372,7.91621,11.7686,16.5804,17.186,11.6031,11.6956,8.87908,8.89647,10.0406,8.44322,7.35338,10.2814,9.1886,10.1896,9.40347,15.5462,14.6751,11.2697,13.679,10.1891,11.1816,13.3704,9.13839,13.5678,10.6728,7.55364,9.6178,15.2202,15.4818,9.99675,9.94138,9.25928,9.02911,9.46863,10.2315,12.4192,15.809,15.3853,10.8836,5.45222,10.2511,8.32746,11.3829,17.0302,10.8398,12.451,15.9653,12.0478,13.0469,12.7593,11.5702,10.979,11.1449,10.9212,10.5977,7.97638,9.62646,8.53375,9.60458,9.00644,15.8192,10.3201,10.0529,10.2439,9.99837,11.5811,12.3877,11.8521,11.8336,10.6358,10.9091,6.19999,5.91799,8.11313,10.2568,10.8848,15.0928,13.8449,13.8108,12.1428,13.0762,8.96055,10.2063,6.74529,6.27402,14.0213,10.3059,7.45192,11.0933,8.69228,6.1717,9.12335,8.91009,7.57849,9.2781,8.19067,11.1096,11.9322,10.3509,8.58675,7.57232,7.67007,13.2179,11.9021,12.6909,12.7292,11.9752,7.96612,12.9497,9.93407,9.25173,8.0258,12.6776,18.0689,9.44693,8.19069,10.5174,9.94086,12.3052,11.593,13.3486,10.9036,9.56036,10.9703,15.6753,13.7231,10.5109,15.1333,10.5719,17.7528,15.7671,10.9225,10.944,10.2135,11.2703,13.7437,12.0409,7.26727,8.69344,12.0393,10.1237,11.2263,11.0245,13.5256,8.90009,9.29883,11.9776,12.102,8.56917,6.25194,8.40419,13.9954,9.23811,10.2895,11.8859,9.54267,8.13048,4.04434,10.1356,10.7442,7.42002,9.45442,11.4733,8.82742,8.71457,8.80131,12.4885,7.53303,10.1168,12.3488,12.4948,9.67134,12.2842,11.5264,14.3258,15.5379,9.41981,9.65921,8.52157,11.1197,9.55435,8.8784,10.7952,14.3628,13.5642,9.12657,6.4963,8.5919,11.092,10.1561,9.584,11.5152,10.0535,8.45286,10.2954,11.1725,11.7926,12.5383,11.8474,7.43952,9.39561,8.38966,6.5087,8.59794,8.04152,11.478,14.386,14.1068,6.25082,7.09452,9.49498,12.3734,12.5202,10.648,13.1395,15.0573,12.5394,12.8172,12.1151,8.52575,11.0208,14.038,6.95131,4.54192,8.2583,9.51049,10.7477,4.31257,7.1238,11.1313,15.9148,7.13915,11.1108,6.05009,13.8184,16.0955,6.43258,4.67387,9.52684,10.0626,11.7995,10.8623,11.9772,10.6701,20.168,15.5463,9.17828,10.6304,8.57371,10.2056,9.71979,13.3711,12.928,11.6508,10.3566,11.8035,14.1774,8.34395,13.1767,12.102,13.6507,11.4183,9.44307,7.09727,8.23446,8.33172,9.59601,6.63376,9.44599,9.8052,12.9844,9.0483,11.7304,12.3374,11.0493,9.29294,8.05941,13.0153,10.5499,7.68724,9.90315,7.59674,10.9175,12.9927,5.84959,8.8134,11.522,15.1112,13.0841,18.5815,27.6813,26.483,17.5571,24.1015,16.2875,20.5587,19.7904,15.8306,12.1164,15.9411,10.189,12.024,8.15469,11.6441,10.543,3.76474,6.52772,7.87684,7.10385,5.37263,14.1811,8.86512,6.83365,5.22437,10.276,10.357,13.5836,10.0232,4.9789,7.2242,3.9622,9.45189,9.51823,6.47097,10.8464,8.87786,7.0238,12.0666,10.823,4.85764,8.04612,9.58406,9.97369,8.54209,7.61062,6.38767,4.74551,10.5006,9.14855,8.39525,5.73993,6.16193,11.6436,9.09285,8.02654,9.58267,7.98114,9.15685,10.4618,8.11363,15.6419,6.5703,8.49916,9.40975,10.811,11.5173,8.76823,7.02417,4.41127,4.59444,5.61298,11.7015,11.7153,7.07891,8.04108,15.483,5.76923,2.73173,8.22498,10.3117,7.99087,9.2226,10.7433,8.76963,7.78617,10.7607,6.20136,6.38938,10.5052,6.59408,7.3228,13.0782,12.6687,9.24085,7.01567,7.65465,7.2748,9.68084,3.90782,5.52778,7.4321,10.0723,9.24438,7.67917,3.84443,6.60531,4.74295,5.45525,7.67584,8.57048,9.73815,6.23131,7.08695,8.4309,7.36195,7.29321,8.89969,10.8364,10.7576,3.56773,4.85836,5.61245,6.67129,7.16055,11.5268,6.84594,11.0853,9.51872,8.16692,8.97099,9.00491,5.8017,10.5387,7.71417,9.35342,7.64134,7.04942,6.81516,7.13077,5.1069,5.20212,9.23412,8.16386,7.3005,3.38251,6.88574,6.87941,5.17743,8.56289,6.52817,8.60688,6.7108,3.27401,3.04518,6.05231,9.53678,9.02588,3.31562,2.97239,8.41896,7.05846,5.70766,4.12368,5.12291,3.73558,7.77604,9.01938,9.59175,8.12074,7.4685,8.95726,6.90613,6.26028,5.52946,8.1071,6.19486,5.94421,9.74432,9.18181,9.22264,8.55217,9.02774,5.96175,8.06102,7.09356,4.98593,7.2501,5.78557,7.67717,4.96706,7.13634,4.97688,7.0216,7.85133,8.05697,6.65875,5.6743,7.71014,11.9685,7.04967,7.91355,9.52618,5.49188,7.64445,5.80984,7.2645,8.49025,9.9159,12.8613,11.3881,8.00155,6.18944,5.22362,9.64575,10.7231,10.3014,10.1565,10.5664,9.10485,3.63656,6.89964,10.2295,9.02988,6.79774,4.48126,8.26237,10.4154,10.2135,9.91941,13.3669,7.973,9.47992,5.17126,12.5159,10.7223,3.99682,11.0543,6.38574,9.07081,10.6462,7.14745,7.71779,6.48124,4.52579,4.81001,8.49625,8.1269,6.01239,7.07451,11.0715,7.59051,6.41808,10.3479,12.8283,7.05656,6.96976,7.26462,10.3446,10.1872,4.74618,5.28779,9.13844,6.78928,5.3937,7.64674,6.92204,6.80044,7.6058,6.78005,3.38609,5.97194,3.13428,4.11966,7.67504,4.57267,6.80689,6.92556,6.34517,3.98361,6.56098,4.84646,7.30537,10.6322,9.76476,9.21556,6.98463,7.58102,2.67735,5.02501,9.67237,6.46061,7.13902,12.0835,5.9645,5.10459,4.44408,5.26873,7.62078,6.67594,8.60609,7.14482,6.49455,4.90316,3.20095,6.22318,4.12646,5.25713,6.51652,10.9108,8.0131,6.75042,5.43209,7.10348,6.8814,6.54876,6.51803,7.58702,9.5963,6.25669,4.58419,6.08945,7.56721,6.99594,7.46984,11.718,9.78545,8.04965,5.74172,8.62884,5.57583,8.29799,7.93165,6.90829,4.81429,13.138,7.77129,5.92719,4.00429,6.15039,9.93365,5.42162,5.20135,2.52437,4.61932,7.14208,8.53083,6.55672,4.05591,6.66744,6.33053,2.903,6.94034,3.74891,7.36977,3.99487,5.46503,10.6565,6.01655,5.3148,6.47381,9.96511,7.28451,6.68156,8.83442,9.63948,9.0245,9.07046,8.11277,8.4299,4.70729,3.8432,6.76075,5.65689,8.14259,5.32998,6.16771,4.76037,11.0693,5.12069,5.87048,5.10466,6.2419,11.2245,5.51116,4.23423,7.83651,9.07994,8.35919,4.29676,4.85364,5.59684,4.34225,6.01187,14.0101,7.92184,9.53309,7.72433,11.0095,8.48892,10.61,8.20851,9.12078,9.48473,6.93251,6.70086,8.9762,9.03281,6.71228,4.22189,2.94631,1.03873,2.22964,7.05895,8.27552,8.09637,5.89645,10.1723,7.15025,2.03165,4.97727,4.21742,3.77122,6.63094,6.67236,5.34125,4.43972,2.9354,4.39728,5.73485,5.57076,7.2365,6.66937,5.16265,5.72165,5.25263,5.06604,4.72699,5.40429,4.5941,4.03839,5.83206,6.72923,6.37902,3.33859,4.91825,5.83398,5.76846,3.73351,6.76626,6.42329,4.06479,7.80076,6.337,10.3493,6.13437,5.48137,7.43766,6.7976,4.48427,5.82405,2.38694,5.05575,7.15465,7.49652,6.633,3.16704,5.25211,4.38752,7.59896,7.70867,3.87164,5.41565,5.76223,5.59089,2.34864,1.62601,3.10404,8.55765,3.96084,3.62495,3.12458,4.93228,5.64421,5.72453,4.24309,6.20289,5.88685,8.38503,7.27347,6.46144,3.65869,8.3956,8.34096,5.48295,3.79086,3.78058,5.55728,7.51745,11.8764,6.85319,5.42822,4.67114,5.67547,7.52629,4.67047,7.45593,7.43849,5.81323,6.06865,6.32592,4.13384,2.16138,3.35713,6.12348,4.04164,2.69026,4.96273,9.52178,5.75435,5.02076,6.50328,4.4118,6.02677,7.62571,3.31141,4.23709,1.73093,5.97618,7.25352,5.34568,6.80788,5.34059,5.46885,3.27314,3.11756,4.9958,4.08433,5.51061,4.04738,4.60951,6.33899,5.52235,3.79418,5.97145,3.992,6.01361,7.61122,4.02131,3.63436,5.2301,4.64095,3.94032,7.24637,9.66705,3.00203,2.27986,2.19169,6.92089,3.96352,3.84726,5.65711,8.23311,4.41335,1.11453,3.5915,5.64146,4.80868,6.13985,2.08744,4.79163,6.69826,5.33955,2.09874,4.25347,6.55117,2.36788,2.59071,1.7356,2.74487,5.77246,6.07093,4.64899,5.8084,7.19405,4.30418,3.14262,3.96281,3.27964,3.91069,4.64963,4.7863,5.80167,4.40489,4.80825,3.99525,4.1081,2.91173,8.03319,9.26169,4.59867,8.18967,7.25325,3.66442,2.1504,2.44441,6.95573,3.82664,5.26303,3.77986,4.20155,3.47341,3.91482,4.49497,6.18111,2.56168,2.31995,1.60505,4.05541,2.33032,4.65913,7.65257,4.62621,3.58108,7.94685,4.53339,4.81141,4.35911,7.6074,7.37554,4.21561,3.72632,3.57852,4.2247,3.52098,3.66265,8.78414,8.29883,4.39358,4.72477,4.91933,4.63746,3.83433,6.26404,5.63841,2.04958,1.55139,4.77613,6.10985,5.29216,3.59355,4.89157,4.21112,3.8432,4.8937,4.81059,4.97668,4.92339,3.82597,3.74508,6.4364,1.74547,4.25113,3.41984,7.75803,7.66933,1.99934,2.83847,1.71982,8.06239,8.14581,1.56156,3.92847,4.72362,2.31973,4.72259,6.04107,3.51437,5.57735,2.16267,5.21817,5.77369,1.26697,2.42887,3.19663,6.15722,2.98145,4.20386,8.06665,4.97925,2.66174,5.07488,3.96675,3.3532,4.52302,4.26149,3.23531,2.43052,6.29178,8.16702,4.18581,4.14545,2.74206,6.30705,4.95963,5.5014,5.43525,7.19726,7.24933,6.40532,4.45075,4.45454,5.08318,3.06269,2.20675,4.8585,6.42047,7.93386,7.05696,3.79522,4.67057,3.9866,5.15584,2.26416,5.01585,6.30067,3.72528,3.37162,4.70054,4.96742,3.63368,4.14682,4.96226,2.26735,5.7107,9.79704,7.52018,6.18683,4.73085,7.05187,5.25515,4.71487,4.592,5.45834,9.58653,13.2412,8.38591,6.68558,10.9765,7.54621,7.58621,5.63439,5.99987,4.08656,2.69728,4.65281,4.32929,3.80648,5.6859,3.32376,4.51643,5.32534,4.22087,1.60359,2.25701,3.07186,3.00972,3.21574,5.14595,1.73672,2.2353,3.69299,4.53561,8.30121,4.64168,7.42519,5.93265,5.90154,6.45504,3.79187,4.61656,3.4952,4.66488,4.64911,3.55221,6.89037,7.70248,3.18103,6.61851,5.56713,4.338,5.44844,2.88108,1.75295,6.39591,2.09416,5.17487,4.16655,0.954281,3.98863,1.54684,3.12833,6.68567,4.03066,4.17422,4.28743,6.43249,2.87812,5.47089,3.75712,5.9202,3.96778,6.11155,4.46035,5.65073,1.54279,1.59465,2.25897,4.57151,5.19615,5.98062,2.51599,3.04156,2.99523,6.00396,6.41977,3.99757,4.44069,4.24308,5.28616,3.22342,7.02995,4.0958,3.06923,5.61388,6.85104,4.11266,5.27462,4.70953,5.29465,8.36987,6.47077,4.49999,3.30094,2.38959,3.53986,3.02694,3.51216,2.05205,2.08473,0.889499,2.64066,4.86588,2.93019,1.00982,0.333909,1.43265,0.509752,1.46402,4.76517,3.59092,3.36572,0.60661,0.610602,1.53874,3.42226,5.92589,2.82973,3.44285,5.14726,3.71373,2.95557,3.1205,9.66052,4.19293,5.50615,2.22748,1.81514,1.58606,5.1816,6.07657,1.83223,3.69888,3.47299,5.47443,6.46446,4.3523,2.54207,4.3873,5.56896,5.82973,4.41209,4.41888,4.17543,4.72937,4.17123,4.50644,3.74855,4.03702,5.21551,6.64908,6.02643,6.90386,4.90805,8.44611,5.98838,7.01046,6.99455,2.99015,7.30664,5.01261,2.22741,5.10014,5.16287,5.02128,5.44607,8.96819,5.38144,3.32109,3.73219,1.98185,4.21391,6.11868,5.85234,4.20117,2.42531,2.70664,6.92826,5.27193,2.32343,1.31844,1.67244,2.29003,4.39905,5.82604,3.73838,3.13593,3.97007,6.00265,6.76597,3.63823,1.32974,2.79805,3.56051,2.38575,2.51525,3.16843,1.68588,1.18717,3.65336,3.74657,5.39265,3.4603,1.53628,5.06748,3.55789,5.37774,5.66786,3.70227,4.93049,4.91563,5.0391,3.76318,4.35321,4.35532,3.88887,1.41896,4.57743,4.13953,5.52756,2.82649,6.17016,7.06566,3.20589,3.49034,6.24887,4.39972,1.35887,2.83625,3.71442,4.23477,4.23458,3.38113,0.761171,2.23791,5.04627,3.00114,2.47122,6.22696,2.78706,1.9425,1.28693,2.61858,3.89777,2.90389,3.13053,2.65931,3.40081,4.04146,2.55746,5.68043,7.08727,4.69927,3.48467,5.03094,4.19938,4.09013,4.12732,5.80453,4.36619,4.85346,4.20235,4.76617,4.24661,5.31304,3.04077,2.83316,1.94496,0.882302,4.70192,6.4078,4.70519,4.34877,2.95282,1.90162,5.73217,3.83534,3.42361,2.37885,2.4521,5.72588,6.35788,4.40194,7.12798,3.61298,4.03593,1.88515,5.25148,2.16699,0.935272,4.10928,5.10567,1.55983,1.09506,3.25324,3.81326,2.7208,2.80981,3.848,3.58817,3.96866,1.99656,4.70332,3.19269,3.52824,7.13608,2.01349,1.72153,2.04198,7.15006,3.15825,2.7036,6.08373,2.49426,1.52093,4.15871,1.44439,4.90006,2.80192,3.12545,2.04853,1.13436,2.5537,3.23956,5.11527,2.50609,2.32085,3.32295,2.85131,3.838,4.53368,5.57919,3.95228,4.82076,3.52547,4.50257,3.21303,5.19344,4.03771,2.91323,3.78935,4.98259,6.04569,3.65962,6.70132,4.7778,5.18216,4.19614,4.48021,6.12763,4.91242,2.15139,3.20487,6.74146,4.7876,2.41536,5.32882,4.73147,3.44907,2.85799,3.14978,4.64082,2.2094,1.32377,4.78073,3.3432,3.36131,5.54338,4.19372,1.56463,6.29326,6.39688,7.72206,8.31379,1.73232,2.24602,5.77755,7.13517,3.82949,4.52289,4.50688,3.12852,2.65658,3.70913,1.97778,2.94156,4.69327,2.04467,3.33098,3.28756,6.32565,4.46799,6.9251,9.30447,5.28214,3.16122,2.84689,2.84655,4.27571,4.05075,7.05103,11.4344,3.50562,5.97812,6.9421,7.36476,5.46168,6.15573,8.81132,6.56367,5.6102,9.95182,11.6998,8.48624,8.19337,13.8994,11.9532,8.25664,7.03002,8.20136,16.9786,12.1404,13.1871,16.8102,21.6174,20.9911,27.3101,38.5527,59.5393,76.3729,93.1379,124.407,165.665,200.233,224.347,249.992,294.366,320.495,336.147,329.011,288.034,233.007,183.778,151.001,112.835,84.1701,66.3249,44.6858,29.6811,18.1871,6.12467,6.35908,4.04702,3.67775,2.78677,2.60948,2.54559,1.1969,1.70642,3.52817,3.09919,2.99389,1.56904,3.81896,1.83525,2.34929,4.70008,2.61498,1.70394,0.991141,0.667316,1.19697,2.46727,2.76791,1.91028,2.29601,1.88346,1.12394,1.58058,2.33928,1.34837,0.76185,3.17155,1.08028,3.05056,2.65992,2.39814,1.91147,3.81629,2.54483,3.32576,0.936292,2.88238,0.631319,2.70219,2.21312,0.673629,0.818518,2.28888,4.43322,1.90367,2.37827,2.38797,1.58095,1.62315,2.05311,2.11971,1.58172,3.10027,1.57161,1.98782,2.16525,1.7151,3.2167,3.1891,1.30258,1.57673,0.332036,0,0,1.26249,0.810205,2.20991,2.81098,1.94833,2.18336,4.37585,4.14447,1.17042,3.42391,2.4898,4.97947,1.85812,2.20128,3.67817,2.99726,2.50633,4.54397,5.39995,2.25714,2.36458,2.95779,2.39622,1.90924,3.75048,5.39939,2.77979,2.39958,2.01229,2.21414,2.49479,0.0977098,2.05457,5.68716,3.50592,2.64076,1.46505,2.69335,2.18247,3.20533,3.05326,2.87923,2.69269,5.64919,2.5184,4.41231,2.84194,3.47945,5.11294,1.83379,2.13162,1.48125,1.99123,2.35443,1.47914,3.80125,2.59498,4.56141,2.86969,2.83053,2.68291,1.28635,0.558804,1.67131,1.76988,0.910805,1.59539,4.87574,4.14835,1.00521,1.57988,2.02879,1.85582,0.664721,0.335279,0,1.01166,1.39043,2.36027,1.90193,1.50965,1.69508,1.0104,0.72188,2.66969,3.05866,1.81814,3.10963,2.69152,2.68062,0.855469,1.59218,2.56524,1.34707,1.09638,0.923256,2.84929,4.11733,2.54439,1.87969,3.38661,3.05602,2.21484,4.09664,5.9314,6.42421,5.21928,1.39948,1.53464,2.13257,1.20444,0.168304,1.5685,2.29915,3.82654,1.1375,1.15013,1.43108,2.46434,1.82914,1.40461,2.40276,2.56876,2.0096,2.32759,1.7075,0.704499,1.35121,2.80487,3.83408,2.69453,3.31468,1.00063,3.55893,3.88374,2.67078,4.0468,3.90414,3.80122,1.99824,1.19888,2.58913,4.50844,2.92736,2.47426,1.54077,2.60373,7.03035,3.61224,2.96743,1.47745,2.78532,2.14786,4.49409,2.28978,2.36669,1.82001,3.54793,0.754455,0.851731,2.45677,4.17711,0.514388,0.662127,1.34712,1.75684,0.692251,3.24368,6.24825,5.44988,4.30671,5.0292,5.62285,5.42557,2.12199,5.45321,5.09729,6.24496,5.40227,4.29984,5.47741,3.82192,3.29532,2.62746,2.26973,2.86499,1.23914,2.19416,2.9113,1.89454,1.28232,4.13109,1.9255,3.72546,1.70256,3.84009,4.96991,2.83301,0.590053,1.23933,2.42215,2.66253,3.06368,1.45496,1.9701,4.02047,1.32072,3.16693,1.84677,1.79572,3.53985,3.82961,1.53205,2.3452,2.48093,1.53036,4.91446,1.56493,1.53436,1.66727,2.46455,2.76336,2.43028,2.6979,0.741536,0.267927,3.28308,3.05134,2.06694,4.56191,2.42985,1.2383,0.882799,1.65902,1.55883,0,0.829077,4.0364,2.15323,3.14805,5.18706,1.64618,1.46409,3.07072,1.31728,3.50558,2.15641,1.67814,2.45468,3.25359,2.13751,3.09427,1.80924,0.855355,3.20426,2.62179,1.37707,1.07923,3.21725,1.70352,0.431922,3.22141,1.58755,3.24537,1.47995,1.33291,1.54788,0.152995,0,1.8347,2.72043,1.44487,1.35305,4.30672,4.0273,3.6712,5.03529,2.34944,2.85624,4.14065,2.56221,2.74233,1.64188,3.51363,1.85105,2.49883,1.48273,1.96743,0.682768,1.2765,1.83784,1.45667,2.69479,0.452427,4.7222,4.33315,4.61652,2.95964,1.66723,3.24462,1.78211,1.27352,0.888528,5.52303,2.32118,1.37008,2.69562,1.01238,2.67189,2.19438,1.32292,0,0.837467,0.162533,0.659533,1.47396,2.54613,3.90268,1.90821,0.509496,0.945132,1.55552,1.88313,1.78421,1.19825,2.01313,4.22355,4.23717,2.00722,2.85491,2.83749,1.12025,3.02741,3.07746,4.17768,4.1733,2.66529,2.35523,3.79006,1.19115,2.35004,1.39961,3.97925,3.7826,2.23646,1.13451,0,0.13264,2.48924,0.378122,2.37028,2.80981,0.963506,3.1623,3.19192,2.9036,2.37341,2.08634,0.138834,0.880157,3.36115,2.35565,3.976,3.00472,0.650694,3.39098,3.31159,3.00994,2.05911,1.11225,2.87205,0.970104,1.54653,1.74243,1.77891,0.977734,1.78925,1.06392,2.39751,2.58238,0.537561,3.48407,3.0241,4.19644,0.924775,0.78658,1.84119,2.50742,1.18687,1.01149,1.33574,1.51526,1.03976,1.86507,2.73199,0.178618,0.071708,0.928292,0.643186,2.2747,2.32237,1.56495,3.01877,3.1179,1.44158,0.616536,0.391672,0.608328,1.13996,0.992944,1.23205,0.897564,1.54448,1.19301,1.56839,0.702568,2.24456,1.91909,0.565387,0.450557,1.08304,1.40647,1.01805,1.99107,1.50198,0.757307,3.16132,2.42599,1.8644,2.30024,2.93088,1.9412,2.1675,2.59569,2.21425,1.81539,4.29453,3.08014,0.015625,2.28568,1.02012,1.13895,1.01079,1.24505,1.91074,2.3355,1.67813,1.96491,1.92495,0.53335,0.936198,1.29989,3.53968,1.50006,3.32931,1.33106,0.765166,0.855659,0.379175,0.641126,0.358874,0,0,0,0.391531,1.27344,3.67122,3.22581,2.24466,1.85416,0.33917,0.424381,1.55371,2.02191,2.06223,2.25898,0.678793,1.99212,3.31291,2.46555,2.10846,1.16026,2.28762,2.36469,0.719049,2.40192,3.14633,0.961253,1.35086,3.17945,0.972259,0.577273,0.971185,0.557153,1.99439,1.65136,2.48697,2.00052,2.99926,1.28361,1.61647,1.72087,1.78899,1.59006,0.644508,0.794858,1.46597,3.09931,1.76131,1.57321,0.466515,3.2724,1.3878,2.96486,2.83988,2.92925,2.46226,1.78392,1.89312,0.240838,0.759162,0.66083,3.42689,1.91228,0.878003,2.65443,2.99181,3.38239,2.75391,1.33945,0.748551,2.57441,1.20257,0.474476,0.390564,1.63738,1.48829,1.05641,1.59719,3.72605,2.37767,1.38815,0.338302,1.19265,1.33952,0.467836,1.1726,2.21334,3.35606,4.11215,4.19391,2.42007,2.97326,3.35242,1.20619,1.58789,2.02311,2.04763,2.4278,1.75266,0.160912,1.87925,3.65289,4.51218,3.85253,1.81298,3.7223,2.63137,3.48041,3.37886,1.10718,1.03776,3.95397,2.40375,2.88339,3.30794,4.37337,3.10533,2.05818,2.50769,3.05211,4.48955,4.22706,4.2651,3.23782,3.61955,1.53992,2.39034,5.76031,3.96544,5.79691,4.07659,4.95571,5.37328,5.52292,6.32668,5.40279,1.72836,2.76136,1.67633,4.04267,4.66571,5.61667,2.69876,3.57684,2.56987,2.17319,4.38843,2.63784,2.96705,5.57898,5.82808,6.06913,6.50038,5.98689,8.36597,7.30937,4.11738,7.15485,6.86639,6.36788,2.81847,4.20395,8.97256,8.48244,4.21076,3.41494,6.40112,4.21815,0.965794,1.03278,3.21755,2.58963,3.30258,3.90672,2.35152,2.22453,1.8989,2.07984,0.610928,2.45396,2.36657,3.16111,2.53714,0.996318,1.26992,0.325309,0.674691,0.747423,1.25258,2.70342,3.28504,2.02667,3.14794,1.4797,2.99223,3.0516,1.61328,1.42443,1.68276,0.674483,4.29255,3.05426,1.67276,1.57533,2.90689,1.75869,0.680782,1.00454,0.972656,0.898015,1.10198,0.853611,1.31219,1.62595,0.208251,0.884115,1.11589,0,0.806515,2.52682,1.6948,1.06106,2.81574,5.41417,1.58266,1.7884,2.75123,0.820825,0.737769,0,0.667057,3.76928,0.563665,0.813284,1.18672,1.53676,4.13055,1.33754,1.443,1.55214,1.44196,3.40277,2.16295,2.46343,1.63046,3.22439,2.67404,0.943579,2.80886,1.86515,2.92245,1.04226,2.6457,4.02937,1.00947,0.733159,0,1.77258,0.22742,0.613281,0.386719,0,0,0.96796,2.20152,2.16644,0.951369,0.712704,0.295765,1.94379,3.06513,1.98222,1.09514,1.73486,2.3691,0.840821,3.35942,1.31376,1.69444,3.38252,2.31457,2.24275,1.30269,1.48016,2.19409,1.70335,3.97263,4.13488,2.97392,1.87295,2.1272,5.50772,3.87789,1.8113,1.57893,2.66632,2.75935,2.78635,3.78843,2.9758,3.78634,3.99772,3.03651,4.18915,3.51121,6.2286,3.9989,4.70287,1.20448,3.41648,8.98256,3.44292,3.301,6.31789,2.43097,2.15154,0.152587,0.86706,1.68881,4.68264,2.62442,2.77989,1.25035,0.10684,1.81494,1.21038,1.90347,1.07121,0,0.925733,2.84454,2.04994,4.89063,1.30814,0.981021,1.50006,2.17891,4.09989,3.24567,2.89996,1.16577,2.89281,1.18082,2.92325,3.23232,2.34076,3.93096,2.12025,2.30421,1.13826,0.846103,0.971373,0.839417,4.84092,4.41173,3.42245,6.09276,4.10996,1.3101,2.33051,7.04379,2.61819,2.60048,4.78467,4.6359,5.62568,4.03589,0.465591,4.10877,2.06319,4.05342,0.759663,1.65095,2.40938,2.81524,0,1.75414,2.24586,0.0762215,0.923778,0.167318,1.64739,2.12253,1.06277,0.185668,2.75837,2.39958,2.83505,3.02463,3.85348,1.50512,2.26522,4.18224,4.147,2.00989,0.833766,1.96156,1.45807,4.59397,4.4657,2.1971,1.918,3.7577,1.60756,2.61688,1.60499,1.10726,1.00568,2.19735,1.3814,1.5247,4.17228,2.63258,2.68658,1.11064,0.552299,2.27404,0.173657,1.94789,2.25829,2.11587,2.54777,2.38047,0.749705,0.534595,2.72747,1.73012,0.0078125,1.92403,1.96534,1.08634,2.00137,1.39964,4.1259,2.42458,3.73215,0.642729,1.60691,2.53111,1.73525,3.1956,2.30824,3.32081,0.842601,2.1574,1.22812,2.11302,0.796379,1.09037,3.09891,2.70888,2.06725,1.00449,1.85876,2.44256,1.6164,1.71523,0.259622,0.343676,2.33617,0.320156,0.948014,1.35718,1.7874,0.907407,0.311688,2.74656,3.75389,2.01633,2.92193,1.622,2.27478,2.43298,2.6451,2.16089,1.44589,1.12565,0.980719,1.46547,1.98523,0.110894,1.13792,1.77076,0.538968,1.72289,1.18164,0.647823,0,0,0,0.27474,2.37772,2.32079,0.0267449,0,0.61886,1.69311,1.68802,1.03322,1.62558,1.7419,0.922863,2.52568,3.12129,2.06876,1.69501,3.85941,3.5871,1.58921,0.98913,1.04786,1.59909,2.01824,3.42969,4.10217,2.94232,3.59367,2.67151,2.87806,2.19318,3.27603,2.90028,4.47381,3.68432,3.67766,2.97406,4.14646,0.632428,0,3.50537,3.13486,5.58748,1.45841,0.778373,2.11161,2.00874,0.672826,1.91942,2.70625,0.60787,1.07496,2.35956,1.55494,2.57467,2.00225,3.8383,1.10411,0.666841,1.33316,0,0.710449,1.28955,0.489929,0.991929,1.51814,0.496426,0.503574,1.16574,1.77401,1.92044,1.64599,0.493827,0.510071,1.7816,2.99731,2.55746,2.76359,3.12259,3.56709,3.2105,2.17915,0.597751,0.712884,1.14091,0.859085,0,0,2.24168,1.74142,2.55245,1.87428,1.13923,1.13193,0.31901,0.41034,0.58966,0.718672,1.28133,0,0.458115,1.23255,0.309339,1.1654,4.48869,3.26317,0.0827362,0,0.929036,1.51507,1.49274,0.822917,1.68151,2.51759,2.93025,2.04681,2.44929,2.98367,2.97691,1.45016,0.204042,0.693056,1.04911,1.86535,2.59605,1.88817,1.67669,1.23157,0.781189,0.953759,0.280017,0.985036,0.806789,0.245295,4.4076,1.36615,0.211929,1.87891,2.80764,0.275693,1.50715,1.38536,0.518527,1.58896,0.42862,5.14295,4.24029,0.268878,0.919271,1.94032,1.60625,4.06833,0.882103,1.59926,1.00982,1.00975,0.884162,0.682911,0.866194,3.12802,2.12744,1.19543,0.463329,2.99401,3.39014,1.36877,1.59669,2.53782,3.12185,0.527379,0,0,0,0,0.16372,0.83628,1.42052,0.579479,0.548229,1.66264,0.854233,2.0112,1.65746,1.20776,2.30581,0.752668,0,2.02406,3.01981,1.83069,1.12543,0.865879,1.80428,2.02977,1.99981,3.54679,2.02478,0.728692,0,0.147883,2.4006,1.99545,2.51956,0.93652,0.170573,1.10797,2.62301,4.3719,4.5249,1.99113,0.536698,1.00369,1.00347,1.57994,1.4242,1.00758,2.29655,2.06073,0.297665,1.77664,3.5445,2.68214,0.996728,0.255208,2.32771,2.77059,2.58873,1.72684,0.330935,1.95296,2.16651,2.03483,1.25716,1.42805,0.160494,0,1.91079,4.39767,0.691538,0.960052,0.0399476,1.0235,1.8342,1.1423,0,0,1.57118,0.42882,1.81698,2.48489,4.13898,2.32156,0.237599,1.79058,0.712278,1.49714,1.00861,2.77344,1.62181,2.11653,0.479612,0.52474,1.37401,2.25154,2.0624,2.40002,2.24205,2.04367,2.97291,3.7404,1.94844,1.35735,1.71302,2.36944,0.235602,3.38796,1.95912,0.563356,0.853962,1.35174,1.58462,0.0636364,0.586771,1.42821,2.43206,2.41895,2.6666,0.467405,3.98072,3.88283,0.846569,1.05407,2.19683,1.25289,0.786094,0,1.68021,0.901553,1.12965,2.41834,1.76319,0.920023,1.89909,0.681917,2.75709,2.56099,3.05385,2.22629,0.00779727,1.1624,1.47627,0.509211,0.852117,0.713173,0.286827,0.508841,1.19034,3.01483,0.285992,0.218328,3.53574,1.02519,1.25662,1.54893,1.93227,0.566974,1.91595,0.623691,1.16579,1.67566,1.53485,0.242345,1.55896,1.76122,1.69416,0.96154,3.49727,0.794905,4.44689,2.04272,0.0597791,0.940221,0,0.298828,4.8004,3.64362,2.11207,0.145088,0.823838,0.176162,0.797822,3.69359,0.849951,1.52971,0.846826,1.51314,3.42409,2.84932,2.65403,1.69689,1.28361,2.91318,2.73418,0.213658,0.938762,2.04684,0.847304,1.78046,2.38663,0,1.47213,2.67935,3.39423,1.41459,0.731741,3.33492,1.65279,2.04073,0.639455,1.4784,1.16166,0,1.3574,1.05294,0.740958,2.00075,3.23754,0.610414,1.0228,1.16113,3.20481,4.8242,6.09794,3.7711,3.65889,4.51365,9.52891,6.53638,4.88401,3.55184,2.45158,4.56546,3.21277,5.64649,2.07026,3.99505,2.88134,1.21288,1.20852,1.75267,3.32746,1.00521,1.61715,1.02254,0.848212,2.87812,0.548638,0.111401,1.73164,1.82036,1.90278,2.51734,2.64345,0.50484,2.41455,0.589502,1.62155,1.14258,1.72757,2.11782,2.71569,1.43892,1.34465,1.10148,1.94971,2.54006,1.06411,0.209635,0.790365,0,0.701375,1.77901,3.69978,1.10779,2.48794,0.737234,1.72645,1.55064,1.67206,3.53771,1.66079,2.0468,3.89763,1.39478,0.275862,2.46535,0.704827,1.85546,0.990362,1.31067,2.29008,1.57138,2.62144,0.914572,0.958754,3.60576,3.61132,2.12467,2.40173,2.62779,2.65756,1.21202,1.80041,0.317169,1.0644,1.61843,1.09592,1.26122,1.89854,4.86475,0.879572,0,0.385417,0.692209,2.20678,1.7156,0,0,1.39164,1.02047,0.587891,0.37232,2.25046,1.37722,0.98031,1.01969,0,1.8402,3.5892,2.45107,2.39392,1.51327,2.21233,0.452608,1.85977,0.687623,0.469917,2.93554,1.41132,1.67602,1.5072,0.0924479,2.00529,2.71953,2.30668,1.87604,1.30046,1.65757,1.04197,0,0.884346,3.90203,2.13553,1.65817,0.419922,1.65908,2.49131,2.04781,2.40376,2.6109,2.58052,2.67887,1.26966,0.882455,0.375651,2.55389,1.65705,1.72474,2.70949,2.05214,4.62036,2.82389,2.18788,2.30217,2.31168,1.05673,0,0.0635232,1.42672,0.509753,0.277344,2.40196,2.43269,3.39092,3.32729,4.12654,2.51493,2.47933,2.36343,0.685547,0.883429,1.52653,3.03995,1.66747,3.2788,3.18482,3.49297,1.84024,2.47878,1.9742,2.32361,4.3259,5.22223,6.84141,8.16798,12.2713,18.572,19.6029,22.7561,16.6437,20.1581,24.9135,21.5103,18.2675,14.0339,18.157,12.7082,7.24516,9.79718,9.38054,2.97057,4.35221,4.96084,4.94804,1.42627,2.7844,2.88255,1.51783,1.46951,1.33863,0.928339,0.155049,3.40531,1.45146,2.69442,1.05765,2.0181,0.373061,1.80759,3.11424,2.76344,4.0775,2.69347,2.01383,2.05672,2.15457,3.49332,3.32968,1.44673,0.054132,1.63482,1.28641,0.0735677,2.13954,0.860463,0.63151,1.77832,2.19501,0.411467,3.30559,1.6781,1.49136,1.87982,2.93143,1.69393,1.67467,1.3939,2.28081,1.65408,0,1.46149,1.30117,1.28187,2.0006,3.39774,2.57667,0.980469,0.278068,1.72193,0.244467,1.89755,1.72737,1.13061,0.897852,1.87088,1.15603,1.57141,3.54863,2.13229,1.6151,0.431055,0.776762,1.45549,0.787329,1.85844,3.9171,2.19466,0.893021,1.88225,1.30639,0.705305,0.315445,0.684555,1.71726,1.97169,1.68336,3.25763,1.12899,0.241066,0,0,0,1.13013,1.41056,1.45932,1.33586,2.763,2.60962,1.29152,0,2.36889,1.63111,0.948501,1.91629,2.01928,2.07877,0.0371578,0.8,0.968482,2.40806,4.37248,1.45098,0.99544,0.987696,1.01686,0.769131,1,0.929522,2.52331,1.6319,1.85538,1.53214,1.5289,0.229721,0.835608,0.164392,0.771077,1.60184,1.41739,0.517441,0.692258,0.401097,3.22313,0.375773,0.638145,1.13423,0.227626,2.22678,1.78037,1.60775,3.63829,3.12531,1.53319,1.92635,1.93628,0.225681,1.56666,2.4996,2.8121,0.121643,0.890188,1.27905,1.72426,0.295947,1.6158,3.5184,1.67635,0,0.185986,2.59028,2.79797,2.09854,0.763423,4.03667,5.39777,4.77846,3.12846,3.38746,1.80783,1.02715,1.53752,0.462476,0.279479,1.89125,2.62639,0.982387,0.220493,1.69666,2.67097,2.94029,2.00773,1.54822,0.136126,0.518229,1.44278,1.5283,1.04063,0.470052,1.6964,1.24343,1.06017,1.3364,3.55952,3.19152,1.69532,1.46728,3.51119,1.72633,0.512451,1.54105,2.73236,0.726591,1.20527,1.22041,1.17458,1.7886,1.39583,0.33544,1.87986,0.454368,0.675528,2.45337,3.23171,1.00403,0.337545,1.51203,1.33141,0,1.79237,2.36801,1.68923,0.390424,2.4301,0.594916,0.779161,0.955787,0.780616,2.23899,0.980394,0.549186,1.06109,2.28875,0.100977,2.21998,1.78002,0.380236,2.06167,1.9573,2.12288,4.04858,1.83041,2.59892,0.791829,1.16099,0.133602,1.96283,0.950751,0,0.639505,1.85275,1.30022,0.207523,0,1.07154,3.03567,0.897999,1.57529,1.09439,4.61209,1.40423,0.427781,2.41826,2.13709,1.36605,0.959609,1.28267,1.61317,1.10417,1.11778,3.1337,2.77852,2.32086,3.74937,2.65742,0.242345,0.551567,2.62311,3.28952,3.11522,1.21889,2.36624,1.73584,0.696868,2.73869,1.66405,1.23288,1.63484,0.132286,0.887361,0.912899,1.295,2.47649,1.2758,0.340877,0.9893,1.50373,1.2769,0.0416396,1.57746,1.39261,1.88979,0.14014,0,1.41365,2.37772,1.83831,2.36836,0.0732296,3.91452,1.81835,0.19585,0,1.19204,1.80796,0,0,2.4696,2.30145,1.88607,1.58541,0.757477,0.247563,2.43077,2.54301,0.778651,0,0.0755208,2.07277,1.1807,0.67101,0.860367,1.40799,0.731644,1.245,1.96267,0.792332,0.278103,1.07726,1.72331,2.92133,0.809987,0.190013,0,1.38761,1.01148,1.58585,0.876267,2.55679,2.42205,6.70059,2.62853,1.8153,1.06642,0.949119,0.44385,3.17074,1.38541,0.779318,1.53822,1.68246,1.00637,2.32437,1.26416,0.405105,0.815175,0.741857,3.7095,1.20352,1.74817,0.781782,0.237721,1.36446,1.39782,0.785427,2.68598,1.76963,1.86943,3.14919,2.82514,3.83459,1.08061,1.15095,2.74286,4.06004,3.61256,2.50222,2.75056,1.01448,0.483397,1.50331,1.31185,3.65571,3.47877,2.40735,2.14697,0.804639,2.03738,2.15863,2.15939,1.78508,1.23387,0.414174,0.954555,1.61818,0.392242,1.04412,1.40044,1.64856,2.52772,0,4.03129,4.26752,1.70119,1.14469,1.373,1.48232,0,0,1.60446,1.84808,0.547464,0,0.908967,1.44729,3.40619,1.90056,2.58228,3.34376,2.65317,1.47124,4.36406,3.61529,4.40661,7.07757,8.53608,6.69018,3.69905,4.75542,3.5144,1.62787,2.5815,2.97159,0.446906,0,0,1.07779,2.4068,1.53311,1.56824,1.2474,0.166667,0.519481,1.08613,0.394394,0.712141,0.287859,2.34658,1.90487,3.74993,2.27997,2.54099,2.6968,1.31668,0.935067,0.229112,0,1.88021,0.745036,1.05554,0.319218,0.958306,1.31975,1.28558,2.76985,1.80232,1.57867,1.27054,0.911095,1.94306,2.03355,1.38352,1.42345,0.693593,0.626719,1.00117,4.91621,2.84286,0.239768,1.64239,2.16835,0.18926,0,0.722005,0.277995,2.43821,1.42885,0.13294,0.843061,0.23897,0.917969,0.555046,0.444954,0.933901,0.0660995,0.59594,3.86537,1.53869,0,2.35288,1.64712,0,0.936198,1.95312,0.110677,1.50532,0.602387,1.21652,2.33357,0.429904,3.15156,0.940433,1.78118,3.9578,2.75234,1.00173,0.529096,1.65365,1.68236,0.462172,1.73438,1.15388,1.32337,1.63857,1.9634,1.18641,0.850843,1.32073,2.00449,3.59079,2.34851,1.59094,1.26486,2.57302,2.3355,3.87868,4.11735,2.16881,3.55722,2.64259,1.44777,1.95611,3.99197,1.68143,0.678385,0,0.850781,3.43042,2.38054,1.44633,1.72417,2.90393,0.263832,0.126384,1.86254,2.01368,1.3763,1.43131,2.20412,1.57065,1.83428,2.00874,1.572,0.859274,0.615885,1.56713,0.95771,0,0.784276,1.11653,2.94852,2.9897,2.02223,1.13874,0.862516,0.936185,0.201299,0.239896,1.50831,0.833391,1.28157,0.136835,0.108073,2.66418,1.22775,0.508519,1.31344,2.50046,0.67758,2.03794,0.962063,0.30684,1.89824,1.68636,0.108568,0,0.49349,2.1365,2.32767,1.99191,1.11716,0.933267,0,0,0.744125,1.11812,0.755167,2.19812,2.21983,2.35559,0.609051,1.74935,0.250649,0.792403,2.70215,1.38857,0.228867,1.71634,1.26157,0.910098,0.863785,0.29666,1.51187,0.327687,1.55516,1.72088,3.4028,0.321162,1.62096,2.86016,1.51888,0,0.919428,1.07599,0.00458415,1.46141,1.73417,0.804414,0.877432,1.09387,1.00651,0.0221932,1.63899,1.30318,0.164645,1.36481,2.68205,3.34338,2.50294,1.03796,1.8007,1.21092,1.33169,0.618738,0,1.67714,2.55206,1.67576,1.09503,1.66684,1.60298,1.01048,1.36336,0.356352,0.881544,1.2587,3.32528,1.52667,0.969814,2.81708,1.39311,1.713,1,0.516882,1.97272,2.04758,0.789091,0.788512,0.706152,2.24661,3.52147,3.52577,1.67704,1.09274,1.23022,1.29781,2.44872,1.53658,1.00652,0.710372,0.0415584,1.26699,0.691455,0.604849,0.395151,1.79622,0.75651,0.447266,2.81048,2.24995,3.66504,0.274531,0,0.838331,1.72055,1.02927,0.486565,0.925276,0.757695,0.327396,4.0812,2.728,0.752375,1.97207,0.381262,2.44477,2.45082,0.19816,1.39058,1.51483,1.89772,1.09835,2.01146,2.82432,1.30401,3.99094,0.87403,0,0.956352,0.0436482,0.899481,0.228441,1.84796,0.885902,2.36524,3.70307,1.33186,2.63817,0.161474,1.08274,1.30244,2.01157,1.64446,2.50515,3.69797,0.694064,0,0.751302,2.06838,2.34666,1.22921,1.37138,0.233073,0.0755208,1.64231,0.544709,0.82671,1.27592,1.63483,2.30718,2.40107,4.10646,2.28566,2.01173,0.8879,0.789817,1.03582,0.531041,1.45154,0.399708,2.17209,2.16528,2.30366,0.151042,1.48134,1.51866,2.8637,1.32535,0.810952,0,0.683246,0.316754,0.639088,2.5785,0.78241,1.12646,0.873539,1.12058,1.69739,1.18204,0,0.600524,0.399476,0.523924,2.29348,0.182592,0.265107,1.65124,3.70499,3.31974,3.20749,1.12695,1.43747,1.20526,0.0817651,0.321615,1.00498,1.93033,0.743077,1.88162,0.413184,2.29817,1.40702,0.309958,2.88973,0.800317,0.374349,1.0044,1.49617,0.157634,1.83422,1.17294,1.72474,3.66512,2.16985,4.68175,2.02916,2.987,1.36803,2.10603,4.03029,1.41633,0.781984,0,1.12699,1.06182,1.8112,1.33009,2.02362,1.57431,0.0719844,1.19573,2.16619,0.763728,1.17702,0.697326,0.516949,1.02653,2.13165,1.00506,1.6612,0.869487,2.7781,2.01103,0.392272,0.997591,1.00234,2.01671,1.59109,1.09046,3.52407,1.58091,1.54202,1.82072,2.44182,1.17472,2.18874,2.18794,1.06945,1.14803,0.702744,3.14642,2.38196,0,1.44081,1.49563,0.829373,3.87376,2.63121,3.03712,1.37026,0.321824,0,0,1.18809,4.48561,3.42284,1.77756,1.1259,0.940337,0.921642,0.604255,2.99429,2.88587,0.653608,0.474675,1.9203,1.28414,2.7218,1.29785,0.301244,0.351562,0.648438,2.78428,1.21572,0,0.705614,1.57584,1.65995,0.783137,1.20538,1.00921,1.00978,1.01527,0.0358073,0.516905,0.483095,0.521767,1.26166,1.11899,3.49888,0.598701,0,0.88266,0.11734,0,2.03009,0.996603,0.973307,0.0345502,0.96545,0.468445,1.45664,0.552132,0.522786,0.938802,1.95783,0.10337,0.953125,0.046875,0.333988,1.66601,0.511386,1.49554,2.99307,3.44293,2.83176,2.2288,1.08521,3.28827,1.34176,0.78127,0.595579,0.404421,0.528296,2.4717,0.604031,0.556125,1.16818,3.03067,1.30758,2.94809,1.00195,0.570215,1.17399,1.71946,0.919707,1.00099,1.96139,1.1642,2.05135,2.76901,1.62919,2.40946,2.41794,2.56079,0.279316,2.05349,1.20646,1.00982,2.10845,1.03527,2.58817,0.754683,0.736493,2.59468,3.00227,1.0846,2.18746,0.394495,0.968872,1.38785,1.61215,0.0311284,0.735602,0.547873,0.716525,0,0,1.79674,4.01384,2.18942,2.20156,1.86608,0.932364,1.51464,1.24643,1.71736,0.890133,1.99613,0.635315,0,0.974708,0.0252918,0,0.97599,1.86087,0.59022,1.91722,1.09536,1.49158,0.0687623,1.09643,4.18428,1.55078,0.16851,1.02051,0.982108,1.75486,1.09288,1.61325,0.536393,2.1425,2.92102,0.936477,0.77193,1.6288,1.52425,1.63833,0.436684,0.98249,0.0175097,0,0.983139,0.231661,2.2267,3.47582,1.06841,0.231041,1.68054,2.47885,1.56069,1.84282,1.80627,1.90598,0.508084,0,0.819363,0.180637,1.02849,3.49184,0.828292,1.3707,1.2644,0.948549,3.0508,0.854589,1.00249,0.159844,1.43641,3.79055,1.44014,2.4449,0.887996,0.855101,0.144899,1.21824,2.33587,2.7119,3.1444,2.77161,0.817981,0,2.4352,1.28941,0.883773,0.391618,0.627374,0.372626,0,0.644168,0.355832,0,2.57909,0.420908,1.59857,0.401431,0.782269,3.4055,3.25001,3.2415,1.083,0.970446,1.04447,0.222805,0.817708,0.182292,0,0,0.835831,0.164169,1.6203,2.94514,2.30981,0.307167,0.81759,0.908972,1.0371,0.0539311,1.87488,1.00981,1.07663,1.03868,1.11503,1.72914,1.15583,0.857487,2.11002,0.0415677,1.49184,3.49908,0.983986,1.02575,0.990266,1.06039,1.97978,1.05793,1.18553,1.71637,1.24852,0.751484,0.28776,1.87432,0.839867,0.998051,0.995443,1.46929,1.53527,0,0.245741,1.70884,3.37225,0.673177,0.974609,0.322051,0.72085,1.31321,1.35635,3.62097,1.01022,0.681729,0.0188067,1.35996,0.994687,1.88309,4.76421,1.40223,1.67991,2.89711,0.160657,2.26101,1.06959,1.50874,0,0,0.0701754,1.35403,1.01398,4.39321,3.78216,2.38644,0.52945,0.495858,1.50683,1.63713,0.830729,0.463542,0.71875,0.817708,0,0.551859,0.448141,1.04979,2.59484,1.00959,1.17883,2.16694,0.916814,2.82909,1.30278,3.34767,2.32485,0.278796,0,1.70912,1.29088,1.05451,1.60759,0.3379,0.280599,0.719401,0.0343709,1.86002,3.15501,1.79735,0.460533,0.692708,1.55943,2.61074,0.829838,0,0.913556,0.086444,0,0.3125,1.49918,3.16383,2.60962,0.779694,0.635179,0.81201,0.310712,1.91813,2.25211,0.707031,0,0,1.03627,1.78342,1.34468,1.71838,1.11725,0,0.896867,0.726265,1.37687,0.153897,0.846103,0.25557,1.15536,2.02519,1.49207,2.36867,1.39975,1.30339,0,0.489583,1.72005,1.03744,1.80029,2.24078,1.15053,2.8761,1.68522,1.02684,1.78447,1.45316,0.735543,1.30503,1.2425,0.725378,0.727096,0.277453,0.722547,0.991879,1.81802,0.476004,1.27892,0.435179,0.131201,0.868799,0.600651,1.23734,0.912432,1.93049,1.93733,0.381759,0,1.17192,0.828082,0.62671,0.37329,1.0261,1.03421,1.22846,2.03742,1.56639,0.107422,0,0.681433,1.67623,0.642333,0.807466,0.599391,1.59314,0,0,0.858453,0.853411,1.0709,2.0126,1.20464,0.731596,1.22739,1.00328,1.74916,1.04558,0.31109,2.44802,2.84384,2.02945,0.611256,1.47904,2.41363,0.138764,1.35777,1.01261,2.52885,0.0686723,1.03476,1.78218,1.41014,2.14857,2.45563,0.16873,1.92288,2.54047,2.0448,0.491846,0,1.13674,1.86326,0.215969,0.784031,0.881433,0.364801,0.753766,0,1.29589,1.98184,3.16671,0.555556,0,0,0.0798183,1.97219,0.947996,0,1.40177,2.5539,0.775118,2.26921,0.420052,1.05233,1.4983,0.029316,3.13521,1.56845,1.45768,1.01509,2.53578,2.28779,1.7498,1.99807,1.44822,1.37645,2.75705,2.69842,1.63827,2.42192,2.21874,2.75296,0.940104,0,0.516569,0.483431,0.909065,1.76656,0.575192,0.749186,0.537001,0.462999,0.0950521,1.02156,1.75186,2.29537,0.83616,0,0.787819,0.835217,0.376963,0.854875,3.1804,0.964728,0.944517,0.055483,0.0979248,1.4684,0.697729,2.30645,0.4295,0.179805,1.12645,1.69375,0,1.90119,2.07065,0.623863,1.4043,0,0.245443,0.978662,1.62014,0.844162,2.80703,1.50457,0,0,0.611039,0.905278,2.09942,0.384265,0,0.307492,0.799512,1.03921,1.83774,2.42011,2.37284,1.55838,1.02268,1.98731,0.654723,0,0,0.13089,2.23784,0.63127,0,0,0.77171,1.809,2.08141,0.337882,0.91563,2.40587,1.6785,0,0,0.527995,1.15188,1.22098,1.66083,1.88848,1.45928,1.64199,0.448568,0.745888,1.75771,0.496398,0.374429,0.744896,0.880674,0.707602,0.413669,0.878729,0.413185,1.78145,1.52401,0.281352,0.122078,2.27506,1.60286,0,1.98326,1.52586,1.22578,1.46743,2.1478,0.775685,0.874189,1.89972,1.10028,1.20833,2.84689,2.21718,0.856001,3.0255,0.846095,0.685306,2.03884,1.27586,2.13207,0.867934,0,0,0.652687,3.30896,1.03836,1.48309,1.51691,3.21839,2.51859,2.4538,0.809224,0,0.702738,2.1051,2.56151,2.22698,1.40368,0.707572,2.04248,3.48042,1.52873,2.06028,0.180519,0,0,0,0.140078,1,1.69607,1.86205,1.28322,1.2073,4.12674,2.36332,3.00291,1.3183,0,0,0,0,0,0,0.782269,1.06799,0.14974,0.795573,1.34729,0.857139,3.02254,1.97746,0.89974,0.10026,0.807339,2.10423,0.0884265,1.07104,1.77401,0.154948,0.852865,0.622266,1.38685,0.138021,0.507208,1.43934,1.88799,1.11989,0.962456,0.0831169,0,0.156939,0.843061,0,0.988281,1.0052,0.0848479,3.8749,1.04677,0.94026,0.747725,2.1045,1.92375,2.93168,0.512909,1.83532,1.00385,0.891939,1.35964,2.74842,0.963589,0.0364109,0,0.883092,1.18071,0.936198,0.976623,0.0233766,1.53868,1.59939,2.73742,1.11152,0.012987,0.167315,1.10416,1.72852,0.0585938,0.941406,0,0.00390117,1.07162,1.9132,1.19547,2.32887,5.66555,0.985397,2.00719,0.828794,0.0848847,2.27412,0.640992,0.121601,2.09585,0.956352,1.18422,2.78521,1.68269,0.174084,0,0,0.713187,3.54757,0.739244,0.179688,1.77549,2.04482,0,0,0.264744,1.21411,2.10894,1.7199,1.97674,1.16146,1.81761,2.10226,1.98155,0.652687,0.0896104,1.14033,2.11747,1.65259,0,0,0.0943644,1.00967,1.27488,0.729026,1.47365,2.00101,1.89105,1.52635,0,0,0.191099,1.35018,0.458716,0.801486,1.7705,0.42801,0,0.902478,2.09752,0.622543,1.01048,0.515024,1.6992,1.15275,0.743155,0.256845,0,0.658438,1.34156,0.724771,0.657929,0.6173,0,1.12011,2.4862,1.39369,0,1.0108,3.46936,2.70685,0.812987,0.766142,1.69219,1.41061,0.131062,0.889908,1.01048,1.06315,2.32667,2.27524,0.434555,0,0.61849,1.51855,2.42872,2.65501,2.29486,0.484375,0.478697,3.17234,0.348958,1.58103,1.96715,0.996094,0.876508,1.82141,0.862662,1.7018,1.40476,1.07574,2.41558,1.14295,1.74806,0.989583,0.416667,0,1.46284,1.34882,1.28364,1.97472,1.7895,1.41711,1.21688,3.04109,0.465403,0.848107,2.85312,0.29877,0,0.217899,0.782101,0.678385,1.78751,1.65156,1.57395,0.837276,1.47132,1.0978,1.61276,1.36396,1.85219,1.53725,1.45574,1.0803,0.704427,0.295573,0.225681,0.898665,1.96529,2.57073,2.98125,1.522,2.3442,3.13263,2.69938,3.95928,2.62278,2.14697,6.37133,5.18105,3.56877,4.66193,6.73197,7.48488,5.3245,6.09294,6.88579,7.63816,4.00696,5.61578,6.68167,2.93137,4.64797,3.59764,4.46174,1.67579,1.37092,1.29512,1.5929,2.08785,4.1373,1.77751,2.27835,3.54228,0.288687,1.83224,1.50956,1.58658,1.44438,2.58268,0.582519,0.462042,0.860858,1.3833,0.755844,0,0.90625,1.48144,1.61231,1.10938,1.33868,3.5207,0.684391,0.346859,0,0.120577,1.47135,2.10964,0.298429,0.719895,0.450485,2.28458,4.26509,0.99442,1.26339,1.28043,0.741703,0.243137,1.50393,0.252934,0,0.492208,0.80137,0.706422,0,0.0989583,0.901042,0.506494,0.604328,0.925637,0.963542,0,0.838331,0.161669,1.2214,1.48105,2.29755,0,0,0.00917431,1.07015,1.2488,1.67686,2.59402,1.66429,0.92445,1.18492,2.7328,1.15947,0.735065,0.208605,1.1664,1.22709,0.620562,1.34171,1.13989,1.29575,0.653141,0.883824,1.46303,0.211009,0.977654,1.81134,0,0,0.276042,0.723958,0.636478,1.95857,1.37355,1.0314,0.470052,0.734109,1.75893,2.35331,0.683594,0.494792,2.0013,1.97475,3.28832,0.755161,0.485677,0,0.711724,1.28828,0.255208,1.20744,0.537353,1.6097,1.05507,1.72326,1.11674,1.49524,0.922213,2.72784,1.34994,0,0,1.48196,2.40871,1.70619,0.403141,0.435647,2.16566,1.39869,0,0.780784,2.22611,1.33816,1.33641,1.31854,0.355469,0.644531,0.720243,1.27976,0.5,1.8849,1.57388,1.73523,0.711995,1.38326,0.210733,1.24349,0.75651,0.722656,2.47961,1.79774,0,2.42558,3.30039,1.10551,3.73932,2.49183,1.7043,1.45677,1.28675,2.32982,1.15973,1.80338,1.19662,0,0.992147,0.627645,0.942138,1.46897,3.11114,1.16406,1.33713,1.712,1.31047,1.3343,0.0876963,4.02722,2.74819,0.771362,0.492499,0.873037,0.30869,0.69131,0.701571,0.608819,1.94612,0.74349,0,0.911781,1.3995,1.83195,1.64052,1.51987,0.696385,0,0,0,0.758801,0.241199,0,0,0,0,2.6505,0.3495,2.553,1.447,0.803129,0.837027,1.12436,3.25635,2.15086,0.828275,2,0.859558,1.00148,0.138961,0.324254,1.52842,1.85448,2.20146,0.0913838,1.24721,1.07963,1.64206,1.60103,0.430065,0.328145,0.671855,0,0,0.315065,1.68494,0,0.330739,0.669261,0.487449,2.51255,0.266055,1.68049,0.969039,1.80837,1.31536,0.960682,0.752618,0.247382,0.798468,3.20153,0.569892,1.43011,0.811271,0.588467,1.65537,1.9449,0.946684,1.82451,0.590755,1.66539,1.86009,0.112565,0.907068,0.0929319,0,0.522251,0.477749,0.955439,0.0445609,0.973822,0.964934,2.06124,2.18675,0.813251,0,0,0,0.454511,1.89309,1.99094,0.903642,1.75781,0.921875,0.436665,1.35968,0.281782,0,0.710502,1.2895,0,0.391927,0.608073,0.960938,0.0390625,0.39928,1.66314,2.29426,1.06835,1.08087,2.4074,1.52738,0.559322,0,0.454308,0.545692,0,0.928702,2.31218,0.759115,0.476501,1.49418,1.02932,0.387435,0.880795,1.23894,0.566951,1.20713,1.61065,2.1081,0,0,0.0883117,1.02164,0.890052,0.0936281,0.994914,1.58685,3.04602,1.38015,0.898438,0,0,0.853389,2.14661,0.361979,1.12257,2.1682,0.97684,0.991019,0.3794,0.149545,1.22578,1.0013,0.623377,0,0.822698,1.34918,1.29482,3.93784,1.53912,3.14942,4.19067,3.04346,2.41069,2.26211,1.3597,2.09973,0.754118,1.00391,1.38653,2.62419,0.94716,0.824675,0,1.28705,2.20905,1.50391,0,0.190909,1.0013,1.07342,1.20001,2.42209,0.112272,0,0.205462,1.59792,1.08094,1.92793,0.883682,0.304063,0.827901,0.566392,1,1.83984,2.70202,1.39067,1.06877,1.46491,1.27882,1.20443,2.06179,1.59446,0.356307,0.890767,1.64732,0.105606,0,0.831435,2.16857,0.902969,3.01981,0.0772251,0,0,0,0.683181,1.00562,1.00481,0.306389,0.282185,2.3936,0.324219,0.362565,0.637435,3.1445,1.1503,1.40986,1.74846,1.48194,1.36923,1.44068,1.41739,1.83764,0,0,0.239896,0.760104,1.57406,5.04052,2.71052,0.740092,1.73429,0.754911,0.445609,0.813802,0.806082,1.38012,0.342857,1.1923,1.12192,3.0531,2.28983,0.77056,1.35721,0.872229,1.7932,3.7742,2.13247,0.722959,0.577173,0.370611,1.03854,1.48408,0.106771,0.18099,1.97852,2.5386,2.33385,1.91432,3.8196,2.66344,1.74533,1.88309,0.942265,1.30343,1.69657,0.431907,1.21653,0.351562,2.38097,2.84302,3.29491,2.90637,3.06067,1.51406,1.96725,0.607161,1.4308,2.15536,0.847275,2.1473,3.49515,1.79127,0.558442,1.16818,2.15994,0.671875,0.0850785,1.06385,1.90967,0.941406,1.60064,1.83587,2.56349,0,0.900524,0.806965,2.29251,0,0.772135,0.227865,1.36694,1.11811,1.91252,1.04991,1,2.08495,1.91765,0.585322,1.01037,1.90476,1.85105,1.0302,1.96746,2.54385,1.79689,3.40465,2.20242,2.69277,3.1248,4.18949,5.64134,5.69481,3.17625,6.41031,5.16012,5.69127,8.0792,5.97043,7.09736,5.07099,3.42768,2.07742,1.65495,2.14798,2.6304,2.44747,0.8679,1.26916,0.730837,0,1.49879,1.50121,0.695277,1.30472,0.994139,1.00586,0.786959,1.68187,0.582083,0.949086,0,0,0.654498,1.02853,2.33476,2.5796,1.83464,1.92306,1.21105,2.8155,2.23214,2.06037,2.68771,2.34478,1.00429,0.289062,0,0.217903,2.51257,0.269531,0,0,0.496094,4.51175,1.99216,0,0.648052,0.995897,2.35605,1.50428,1.49572,0.00131062,2.05853,2.42453,1.42969,1.08594,0.671001,1.00173,0.834444,0.571363,0.921466,0,0,0,0.931848,0.558424,1.3634,2.86791,3.12316,0.707043,2.19397,1.25425,0,0,0.578125,1.71522,0.706655,0,0.981261,1.01874,0.209909,1.39947,0.88868,0.501945,0,0.499352,0.500648,0.500648,0.499352,1.10984,0.890157,0.387435,0.612565,0,0,1,0.777977,1.98306,0.238961,1.22889,1.94571,1.8254,0.0364583,0.963542,0.344241,1.43469,0.221066,0,2.41751,2.3682,1.59961,2.03014,0.584535,0.512322,0.487678,1.44538,1.93602,1.97407,0.644531,0.807792,1.81249,0.379714,1.34328,1.35305,1.10705,0.582031,0.765822,1.42936,1.01048,0.408912,0,0.835938,0.164062,1.31432,1.53294,0.995599,1.67605,1.69094,0.790153,0.705111,0.739622,1.40794,0.147327,0.868146,0.368833,2.50898,1.62253,2.06503,1.09566,1.41715,0.8728,1.06009,1.00244,0.650112,2.27899,2.12934,0.567048,1.02592,1.30538,3.04382,0.430633,1.00522,1.74473,2.45077,0.486376,1.51078,1.4801,0.923301,0.0858257,0.369867,1.67446,0.991058,0.964613,0,0,0,1.1404,1.17415,2.19266,1.89696,2.19356,2.5186,1.88367,1.37116,1.64989,1.27384,0.705111,0,0.410953,1.58905,0.174935,0.825065,0.549935,1.42019,0.0298701,0.390052,0.733646,0.876302,0,1.48716,3.07266,2.46717,1.52814,0.444877,0,0,2.20051,0.799493,0.292428,1.23306,0.47451,0.203111,1.79689,0.0155844,1.54473,0.439689,0.904102,1.0959,0.025974,1.56985,1.39276,1.86266,2.14876,0.768229,1.8669,1.36487,0,0.0454545,1.00136,1.94296,1.80607,0.204161,0.804688,0.650332,0.54498,1.48722,1.18944,0.323338,0.572727,0.427273,0.747051,1.84903,1.50267,0.90125,0.716146,1.16904,1.99716,0.117647,0.576623,1.33437,0.550168,4.09821,0.440625,0,0.105195,0.894805,0.897269,1.02672,0.0760157,0,0.410691,2.1638,2.59282,2.74144,1.21459,1.07241,2.64029,1.16396,0,0.209424,1.79058,1.83296,1.16704,0.615503,2.7298,2.62605,2.08916,1.93948,0.783848,2.70053,0.515625,0,0,1.51302,0.486979,0.911458,0.617188,0.649276,2.19862,1.6495,0.973958,1.29332,1.70668,1.45324,1.85082,0.695937,0.250788,3.69491,1.50234,1.61706,1.73097,2.70665,2.08972,0.840807,0.566754,0.926893,0.691099,0.479664,1.57526,2.50505,0.852017,1.1198,2.08398,0.88717,1.8647,0.536612,0.609259,0.86849,0.140625,2.78321,1.15559,1.60547,0.824195,1.74709,1.88257,3.48772,1.64537,1.34424,1,0.653098,0.730819,0,0.103133,1.60591,0.290957,0,0,0,0.289987,0.880586,0.829427,1.58115,0.418848,0,0,0.626459,0.622239,0.751302,0.867801,1.63364,1.49856,0.227451,2.90722,1.69345,0.7778,2.32985,1.01048,1.86074,1.75159,2.07899,1.66711,0.695312,0.311198,1.00391,0.712419,0.972477,0.352406,1.00214,0.645455,0.0706806,1.98268,3.52737,1.41927,0.333333,1.04476,1.4766,3.42309,1.52545,1.19676,1.11286,1.30359,1.17242,1.41113,0,0.397135,3.19402,1.05476,0.354086,0,0.263434,0.736566,0.418514,1.50205,1.07944,1.91305,2.52575,0.978623,2.0846,1.84922,0.648755,0.653247,0.346753,1.2838,1.7162,0.922773,2.40302,1.67421,0.442133,0.557867,0.890909,1.69112,1.50521,1.5725,0.34026,0,1.5493,1.4507,0,0.119792,1.43387,0.446335,0.685379,0.314621,2.05912,1.54298,0.397906,0.718383,1.00616,1.84837,1.42708,0.744125,0.836604,0.916673,1.59179,0.910806,0.195312,1.58798,0.21671,1.25214,2.00988,1.62989,1.87381,0.234293,0,0.234681,1.40287,1.85494,1.33212,1.84293,0.332461,2.04582,3.12672,1.36901,0.458442,1.44624,0.553762,0.910995,0.0890052,0.739583,1.80908,2.01051,2.34806,0.794596,1.56884,2.28525,0.444087,0,1.41844,2.02799,1.59148,5.97554,3.67527,0.673263,1.45028,1.1484,1.03935,0,0.249795,2.13692,1.38281,1.43723,0.793238,0.607282,0.392718,0.096732,0.903268,0.201571,2.49223,3.01198,2.85495,1.43927,0,0.781016,3.1021,2.11688,0,1.68905,2.15079,0.575078,0.585079,0.20235,0.79765,0,0,0,1.62284,1.25216,1.00391,2.01933,2.24809,0.853678,0.99349,1.25834,0.748166,1.37697,0.623033,0,0.33548,1.66452,0.715584,0.284416,0.694408,1.63194,0.673657,0.0559896,2.24427,2.37142,0.328328,0,0.964844,0.74907,0.921735,1.08217,2.97771,2.66753,1.36125,0.275683,1.17376,1.82494,0.00130208,1.39049,1.34813,1.47882,3.00723,1.0778,2.59923,1.8483,0.25,0.933159,0.10981,0.957031,0.0494792,1.71156,1.08824,1.14549,1.00524,0.785845,1.21415,0.775325,0.224675,0,2.36867,2.31822,1.31311,0.789062,1.96651,0.244431,1.38076,0.759292,1.77792,1.35843,0.723598,0.805195,0.679132,2.53783,1.94529,2.99219,2.61633,1.16949,0.254545,0,0.825974,2.99619,2.66077,2.51707,0,0.710515,2.28948,1.53035,0.469654,0.408892,1.59111,0.977401,1.25851,1.61993,1.45405,1.36979,3.96829,1.35202,0,1.76273,1.99472,0.734023,1.26598,2.00641,2.1152,0.120936,2.26122,0.738784,2.41461,0.585385,1.4779,2.88577,2.40126,0.235065,0,2.52881,2.42723,2.33263,2.22241,0.488918,0.520833,0.479167,1.62842,0.371581,0,1.11258,0.944714,1.29427,2.16589,2.01055,1.77156,2.27556,0.424881,0.936994,4.70972,3.77029,3.38817,0.971742,1.81747,1.5202,0.885417,0,0.963589,0.0364109,0,2.88784,0.112165,2.17233,1.80556,0.0221066,0.980519,1.26952,1.63001,1.11995,0.725114,1.27489,0.923775,1.54367,1.23529,0.297262,0,0.931925,1.06807,0.133683,2.44868,0.804063,2.11813,0.495449,0.971204,1.00916,0.595108,1.4531,0.971429,0.238532,2.3568,2.08398,2.03836,3.62384,1.72524,2.53819,1.19635,0.571406,1.73332,2.1388,3.67102,2.44589,1.6208,1.01747,0.440678,0.559322,0.856584,1.00409,0.139323,1.33263,3.15695,1.67277,2.83764,2.0178,3.25937,3.12648,1.59635,0.393229,2.06429,1.16028,2.86501,1.54821,1.54958,1.08476,1.00304,0.444586,1.84753,1.03949,0,0,0,1.29166,1.73057,2.42149,0.68875,1.57847,2.29037,1.48299,0.526123,0.989583,1.22561,2.4316,3.69626,1.38872,0.257812,0.314286,1.84436,2.50872,1.75043,0.582201,0,0.545573,1.17663,1.35982,2.85926,2.14997,1.27237,1.63636,1.17221,2.63248,0.90081,1.81574,1.47877,0.820312,1.1395,1.93049,2.14635,1.73691,1.06561,0.228982,1.77341,1.03834,0.942094,2.55678,0.842006,3.30976,1.66217,1.03516,0.772135,1.11558,0.884418,1.08332,1.81135,1.29041,0.814918,0.849546,1.10726,1.14339,1.15208,1.6696,1.18774,1.62088,2.12275,0.463922,2.98229,1.70054,0.950521,1.07582,0.973654,0.0614379,0.938562,1.05042,0.949584,0,0.980469,0.807292,0.21224,1.7888,0.380272,0.830931,0.436155,2.06712,1.31704,0.179688,0,1.69714,0.85987,0.832819,1.64321,0.966962,0.608717,2.25124,2.75734,1.98591,2.27049,0.775057,0.351245,0,0.251958,2.43379,2.66016,1.0026,1.77469,2.93449,2.44737,4.89207,1.4037,1.41791,2.27147,2.36834,2.50945,0.63199,0.128906,0.871094,0.137841,2.35431,1.85127,2.42312,0.233463,1.21027,2.3379,0.451823,2.454,1.28037,3.90835,3.42389,1.90455,0.918587,0.696948,2.23515,2.07036,1.68297,1.94108,3.89111,2.51383,2.07879,0.648895,1.35111,1.12657,1.30589,0.807116,3.27583,2.16309,1.97905,1.34024,2.06858,0.933628,0,2.95902,1.04098,0.59322,1.09649,5.46388,2.13548,1.17717,2.79935,1.73442,0.72526,0.27474,1.9554,1.78549,1.97176,2.77406,4.25974,2.25356,0,0.767927,0.728177,0.503896,2.61186,0.448427,0.939712,1.49823,2.3789,2.68114,1.19891,1.92352,1.73683,2.00337,1.7257,0.853403,0.797386,1.00679,1.16567,2.29559,0.734563,1.45621,1.3806,1.3349,0.828288,1.44143,2.88395,0.948185,1.60242,0.124021,1.61674,0.383263,0,0.331152,0.668848,0.352094,1.93073,2.01932,0.697851,1.7899,2.40093,1.18466,1.12581,2.29458,2.11579,1.52291,0.565411,3.93671,3.00104,0.0622568,0.993447,1.42843,0.61072,0.984355,1.59373,0.389323,0.0325945,1.03277,0.934641,0.078329,2.10647,0.815203,0.948052,1.11054,1.4212,1.46833,0.706447,1.56062,2.51515,1.55213,4.46282,1.25472,1.46764,0.532365,0,1.39666,0.603339,0.175623,0.824377,0,0.786649,1.82284,3.21466,1.17585,0.498034,1.75099,1.77123,0.979749,0.186198,0.813802,0,0.321101,0.678899,0.964935,0.956531,1.06006,1.01847,0.706493,0.862085,1.43142,0,0.248698,1.47042,0.280884,2.06863,1.65604,0.313283,1.69061,0.32902,1.45093,1.25841,0.233073,0,0.655169,1.65513,0.6897,0,0.752604,0.850279,0.397117,1.15355,1.60619,0.982111,0.258149,0,0.983139,0.0168612,0,0.837027,0.942193,0.220779,0.783117,0.216883,0,0,0,0,0,1.6112,0.991145,2.46932,1.81505,1.00391,0.109375,0.406291,1.47591,2.73323,2.11291,0.271662,1.47787,0.986792,3.00719,1.48365,2.20212,1.34566,0.496723,1.89596,1.10404,0,0,0.741176,1.71184,1.08805,0.458931,0.00648508,1.5495,0.44401,0.0077821,4.23598,0.756243,0.806789,0.860751,0.332461,0,0.879064,0.314907,0.806029,0,0,0.0364583,1.75882,1.20472,0,0.0181582,0.981842,0.0247396,0.97526,0.917755,0.0822454,2.25391,2.6472,1.17173,1.92717,0.921977,0.0780234,0,0.412844,1.57149,0.0156658,0,0.723598,0.74167,2.22495,2.5232,1.78657,0,0.0078534,0.992147,0,0.152344,0.984375,1.64062,1.35166,0.870999,0,1.15595,2.00832,0.835724,0,0.191656,1.62866,0.179688,0.887258,1.11274,1.35069,1.86546,0.783854,0,0,1.23147,0.768531,0.00650195,0.993498,0,0.887875,1.0521,1.95716,0.102865,0.253264,1.65819,1.00391,0.707529,1.65872,0.752193,0.96619,0,1.03887,2.90478,1.01048,1.0042,0.0416667,1.34999,2.96769,0.682317,0.529646,2.28989,1.18046,0.0650195,0.934981,0,0,0.0898438,1.91016,0.529011,1.96216,2.17124,1.33759,0.597386,1.24069,2.16193,0.407552,0.761186,1.83126,0.656619,0.446112,1.57178,0.32549,0,0,0.104167,1.42386,0.887425,1.58454,0,0.657929,1.79259,0.628597,1.64172,1.4263,1.43903,0.413838,0,0,0,0,0.86911,0.804551,1.32634,0,0.0881971,1,0.911803,0.516927,1.42941,0.0536649,0,0,0,0.242188,0.757812,0.253906,1.35684,0.389253,0.266927,0.733073,0.927778,1.64384,0.428385,0.291123,0.708877,0.63151,1.1651,1.31616,1.02728,0.859948,0,2.42628,1.73767,2.05972,1.34606,2.10736,0.430569,2.40686,2.04988,1.43561,0,0,0,1.55007,0.449927,0.501299,2.22396,0.27474,1.61834,1.33075,1.02133,2.02959,0.69757,1.30243,0.761719,1.22523,0.0130548,0,0,0.783854,0.216146,0.12192,1.00146,1.16791,0.818804,1.43057,2.45934,0,0,0,0,0.0928105,1.85294,3.05425,0,0,0.606536,0.393464,0.138381,0.861619,0,0,0,1.2557,0.744304,0.588542,0.411458,0.138781,1.06487,0.796345,0,0.617992,1.28385,1.09815,0,0,0.700897,1.89784,3.09303,0.308232,2.68665,3.64599,2.66735,0,1.42941,1.57059,0,0,1.03907,2.67669,3.32224,2.67647,0.307692,2.63157,1.28116,0.0651042,1.1235,4.49226,2.38424,1.15991,1.25446,1.7115,1.30101,0.573107,0.500561,1.49944,0.0860495,1.89963,1.51714,3.41943,1.65019,1.53578,0.891786,0.158377,1.00938,0.832241,0,0.839844,0.620494,0.539662,0.901704,1.03076,1.1118,1.42716,1.05523,2.02308,1.62627,1.79909,1.96998,1.05492,0,0.33377,0.66623,0.719572,1.28043,0,0,0.181818,0.908614,0.909567,0,0.184176,1.50552,0.3103,0,0.162516,0.837484,1.97616,2.01212,0.820925,1.19079,1.06195,1.47541,1.22536,0.962835,1.27445,0,0.585845,0.414155,0,0.196104,0.803896,0,0,0.065189,0.934811,0,0,0.364583,2.03513,2.40998,1.76898,0.421326,0.24349,1.89844,0.858073,0.58961,0.41039,0.207523,1.82786,1.23675,0.727865,0.279584,0.720416,0,0,0,0.214008,0.785992,0.832468,1.16753,0,0.31901,0.68099,0.630689,1.32344,0.0458716,1.31367,1.25013,1.4362,0,0.0117801,1.00919,0.97903,0,0.789267,0.695252,1.51548,0.225681,0.774319,0,0,0,0.568448,1.31491,1.10445,1.0122,1.33028,0.669721,0,0,0,0.780396,1.2196,0.928466,1.77244,0.29909,0.264398,1.00916,0.72644,0.712614,0.287386,0,0.0812582,0.918742,0.723017,1.0026,0.274382,0,0,0,0,0,0,0.196592,0.803408,1.16603,0.833968,0,0.730117,0.269883,0,0,0,0.782022,1.21798,0.866912,1.64611,1.0638,0.423177,0,0,0,0,0,0,1.23194,1.85633,0.911732,0,0.530026,1.85481,0.615164,0.550914,0.449086,0,1.14099,1.67719,0.181818,0,0,0,0,0,0,0.276265,0.723735,0,0,0.666232,0.333768,0,0.68099,1.02543,2.14079,0.152787,0.941406,0.0585938,0,0,0.72846,0.995499,0.276042,0.752604,0.247396,0,0,0.853211,0.146789,0.787206,0.212794,0.785156,0.214844,0.792969,0.207031,0,0,0.296104,0.703896,0,0,0,0,0,0,0.925974,0.074026,0,0,0,0.858073,0.141927,0,0,0.883963,0.116037,0,0.126302,1.77722,0.283898,0.812582,0,0,0,0,1.90889,0.0911103,0.976593,0.023407,0.0496084,0.950392,0,0.987013,0.211162,0.801825,0,0,0.216146,0.783854,0,0.411486,1.58851,0,0.0221643,0.977836,0,0,0.480996,0.548891,1.97011,0,0.333333,0.688802,0.977865,0,0,0,0,0,0,0,0,0.0624187,0.937581,0,0.287206,0.712794,0,0,0,0.345006,0.654994,0.332898,0.667102,0.347601,1.54638,1.19264,0.913383,0,1.86667,0.686648,1.44669,0,0,0,0,0,0.160156,0.839844,0,0,0,0,0,0,0,0.0981675,0.901832,0,0.803413,1.19659,0,0,0,0,0,0.326823,0.673177,0,0,0,0,0,0.559896,0.440104,0,0,0.628422,0.553632,0.817945,0,0,0,0.360784,0.639216,0,0,0.694517,0.509644,1.81128,0.984554,0,0.904824,1.09518,0.34375,0.65625,0,1.53103,1.97616,0.49281,0.231771,1.30357,0.46466,0,0,0.57536,0.42464,0,0,0,0,0,0,0,0,0,0,0.571802,0.428198,0.441406,0.558594,0.591146,1.00468,1.33377,0.772894,0.29751,0,0.621094,0.789296,0.58961,0,0,0.837484,0.659265,0.503251,0,0,0.314694,0.685306,0,0.418182,0.581818,0,0,0.701823,0.298177,0,0.893229,0.66276,0.44401,0,0,0.427273,1.4933,0.0964651,0.982962,0,0,0.160574,1.78734,0.0520833,0,0,0,0,0.206266,0.793734,0,0.163827,0.836173,0,0,0,0,0,0,0,0,0.865711,0.134289,0.876302,1.10742,1.4337,0.582575,0.330275,0.669725,0.352556,0.647444,0.914062,0.0859375,0.435065,1.42126,1.14367,0,0,0.447334,0.552666,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.182292,0.817708,0.488312,0.511688,0.535854,0.464146,0,1.22688,0.773123,0,0,0,0.588005,0.411995,0,0,0.205729,1.79427,0,0,0,0,0,0.286458,0.713542,0,0,0,0.911573,0.0884265,0,0,0,0,0,0,0,0,0,0,0,0.494163,0.505837,0,0.380704,0.619296,0,0.985677,0.0143229,0,0.407552,1.59245,0,0,0.605982,1.00311,0.390909,0,0,0,0,0,0,0,0,0.235602,0.824294,1.25465,0.685452,0,0,1.0572,1.59039,0.352406,0,0,0,0,0,0,0,0,0.420573,1.25173,0.327698,0,0,0,0.527273,1.02305,1.44968,0.48822,0.51178,0.601043,0.398957,0,0.701299,0.298701,0,0.727114,1.98328,0.28961,0,0.692005,0.502258,1.51871,0.287025,0.664928,0.335072,0.542153,1,1.14103,1.49715,2.51108,0.308594,0,0,0,0,0,0,0,0,0.552529,0.447471,0.290365,0.709635,0.943644,0.0563565,1.92932,0.0706806,0,0,0.666232,0.333768,0,0.0380079,1.30053,0.661458,0,0,0,0,0,0,0,0.815345,1.02971,0.154948,0.174312,0.825688,0.195282,1.31516,0.489556,0.100785,0.899215,0,0,0,0.556136,0.443864,0,0.310209,1.12989,0.559896,0.821149,0.178851,0,0,0,0.584955,1.36817,0.046875,0.284404,0.715596,0.304063,1.18682,0.509115,0,0,0,0,0,0.908735,0.0912647,0,0,0,0,0.598701,0.401299,0,0,0.0521512,2.55362,1.56115,0.900788,0.932292,0,0,0.605982,0.394018,0,0,0.85248,0.14752,0.0182292,1.09781,0.883963,0.125,1.76795,0.10705,0.664482,0.335518,0.855832,0.144168,0.618182,1.32038,1.00661,0.0548303,0.174707,0.825293,0,0,0.678385,1.00391,0.317708,0,0,0,0,0,0,0,0.0642202,0.93578,0,0,0,0,0,0,0,0.159895,0.840105,0.180865,0.819135,0,0,0,0.2346,0.7654,0,0,0,0.725876,1.27412,0,0.269883,0.730117,0,0,0,0.294271,0.705729,0,0,0.846354,0.153646,0,0,0,0,0,0.419271,0.580729,0,0.661479,0.338521,0,0,0,0,1.30129,0.698709,0,0,0,0,0.412304,1.24084,0.346859,0,0.451571,0.993019,0.555411,0,0,0.899115,1.10089,0,0,0,0,0,1.37933,0.620666,0,0.184655,1.57863,1.42657,1.49586,0.314286,0.196104,0.803896,0,0.925295,0.0747051,0,0.705497,0.294503,0,0.732984,0.849806,0.41721,0.0209699,0.97903,0,0.314804,1.6852,0,0,0.0930537,0.906946,0,0.826451,1.81892,0.354628,0,0.255844,0.744156,0,0.760784,0.968382,0.270833,0,0.787484,1.21285,0.999664,0,0,0.283485,0.716515,0.313237,1.41949,0.267275,0.19401,0.80599,0.366972,0.633027,0.303896,1.67655,1.01956,1.54275,0.457249,0.912647,0.0873533,0,0,0,0.200524,1.61458,1.82505,1.18514,0.174707,0.731517,4.24776,3.75449,1.11519,0.738198,1.49935,1.22213,3.29621,1.13315,0.261997,0.740597,1.50414,2.01342,1.06215,1.37169,0.7791,1.5289,3.23704,4.5282,6.46653,5.46895,5.29261,7.98829,10.8638,13.3884,17.6953,23.358,28.5171,29.4235,33.3172,40.3027,46.0495,44.3446,49.0199,44.8203,37.9379,43.3227,39.7921,39.4156,29.0194,22.1209,14.5407,17.1701,9.63307,6.81307,7.06984,3.24947,2.09874,3.54373,1.49221,1.77566,0.922775,0,0.7654,0.2346,0,0,0,0,0,0,0,0.196335,0.803665,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.790909,1.00027,0.20882,0,0,0,0,0,0,0,0,0,0,0,0,0.533421,0.466579,0,0.805195,0.757143,0.437662,0,0,0,0,0,0,0,0,0,0,1.07406,0.925939,0,1.09896,0.901042,0.394531,1.42259,0.182879,0.785059,0.214941,0,0,0,0,0,0,0,0,0,0,0,0.830091,0.169909,0,0,0,0.802083,0.197917,0,0.509149,1.49085,0,0,1.05085,0.949153,0,0,0.540365,0.459635,0,0,0,0,0,0,0,0,0,0.850649,0.149351,0,0,0,0,0,0,0,0,0,0,0,0,0.942708,0.0572917,0,0,0,0,0.864935,1.10516,0.029909,0.867532,0.886694,0.245774,0,0,0,0,0,0,0,1.51499,1.16653,1.31848,0,0,0,0.785156,0.214844,0,0,0,0,0,0,0.318573,1.68143,0,0,0,0,0,0,0,0,0,0,0,0.837451,0.162549,0,0,0,0,0.430628,0.569372,0,0,0.906128,0.996596,0.0972763,0,0,0,0,1.90747,0.0925261,0.557012,0.442988,0,0,0,0,0,0,0,0,0.28534,1.71466,0.908973,0.0910273,0,0.015625,0.984375,0,0,0,0,0,0.046875,0.953125,0,0,0,0,0,0.948052,0.0519481,0,0.867801,0.132199,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.220339,1.1768,0.602865,0,0,0.245111,0.955671,1.05346,0.745763,0,0,0,0,0,0,0.959792,1,0.0402075,0,0,0,0,0,0.287903,1.7121,0.287025,1.0101,0.70288,0.0598179,0.940182,0,0,0,0,0,0,0,0.951507,0.0484928,0,0,0,0,0.981818,0.0181818,0.983139,0.0168612,0.448501,0.551499,0,0.39974,0.60026,0,0,0,0,0,0,0,0,0,0,0,0,0.904761,1.09524,0,0,0,0,0,0,0,0,0.7654,0.2346,0,0,0.803665,0.196335,0,0.833552,0.166448,0,0,0,0,0.197403,0.802597,0.0168612,0.983139,0,0,0,0.599739,0.400261,0.979058,0.0209424,0,0,0,0,0,0,0,0,0,0,0.095675,0.904325,0.249351,0.750649,0,0,0,0,0,0,0,0,0,0,0,0.85733,0.14267,0,0.0454545,0.954545,0,0,0.0492866,0.950713,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07393,0.949508,0.976562,0,0,0.0403121,0.959688,0,0,0.690695,0.309305,0,0,0,0,0,0.0313316,0.968668,0.0808344,0.919166,0,0,0,0,0,0,0,0,0,0,0,0,0,0.440832,0.559168,0,0,0,0.972513,0.0274869,0,0.19296,0.80704,0.202086,0.797914,0.212516,0.787484,0,0,0,0,0,0,0,0,0.115584,0.884416,0,0,0,0,0.891361,0.108639,0.340731,0.659269,0,0,0,0,0,0,0,0,0.53446,0.46554,0,0,0,0,0,0.136364,0.863636,0,0,0,0,0,0,0,0,0,0,0,0,0,0.584416,0.415584,0,0,0,0.586162,0.413838,0.60078,0.39922,0,0,0,0,0,0,0.674084,0.325916,0.404948,0.595052,0,0,0,0.477184,0.522816,0,0,0.644993,0.355007,0,0.651495,0.348505,0,0,0,0,0,0,0,0,0.505208,1.18509,1.3097,0,0,0,0.849869,0.150131,0,0,0.698309,0.301691,0,0.798429,0.201571,0.192208,0.807792,0,1.5671,0.432895,0,0,0,0,0,0,0,0.738622,0.261378,0,0,0,0,0,0,0,1.44334,0.556663,0,0,0,0,0,0,0,0,0.717277,1.28272,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00651042,0.99349,0.845254,0.154746,0.858257,0.141743,0,0.864759,0.135241,0,0,0,0.383812,0.616188,0,0.91276,0.0872396,0,0,0,0,0,0,0,0.932292,0.0677083,0,0,0,0,0,0,0.516971,0.483029,0.971391,0.0286086,0,0,0,0.0222513,0.977749,0.274968,0.725032,0.0403646,0.959635,0,0,0.0586701,0.94133,0,0,0,0.258149,0.741851,0,0,0,0,0.688396,0.311604,0,0,0,0,0,0,0,0.148631,0.851369,0,0,0,0,0,0,0,0.373698,0.626302,0,0,0,0,0,0,0.30869,0.69131,0,0.239583,0.760417,0,1.01672,2.51277,0.53293,1.00252,0.935065,0,0.319481,0.680519,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.109091,0.890909,0,0,0,0.119636,0.880364,0,0,0,0.743119,0.256881,0,0.345006,0.654994,0,0,0,0,0,0,0,0.453716,0.546284,0,0,0,0,0.173177,0.826823,0,0,0,0.503259,0.496741,0,0.417969,1.30954,1.00522,0.315768,0.951507,0.368353,0.631647,0,0,0,0,0,0,0,0,0.584635,0.415365,0,0,0,0,0,0,0,0,0,0.454308,0.545692,0,0,0,0,0,0.391699,0.608301,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.32987,1.00173,0.686653,0.981747,0,0.694626,0.305374,0,0,0,0,0,0,0,0.424675,0.575325,0.778068,0.221932,0,0,0,0.731771,1.14356,0.124672,0,0.748698,2.9295,0.321801,0,0,0,0,0,0,0,0.786458,0.213542,0.22051,1.77949,0.462719,1.53728,0,0,0,0.43173,0.667747,0.900524,0,0,0,0,0,0,0,0,0,0.208115,0.791885,0.463636,1.0007,0.535668,0,0,0,0.31848,0.68152,0,0,0.360419,1.11101,0.528571,0,0.35854,0.64146,0,0,0,0,0,0.514955,0.485046,0,0,0,0,0.484416,0.515584,0,0,0,0,0,0.614679,0.385321,0,0,0.306789,0.693211,0,0.498054,0.501945,0,0,0,0.0572917,0.942708,0,0.706422,0.293578,0,0,0,0,0,0,0,0,0,0.110677,0.889323,0,0,0,0,0,0,0,0,0,0.52549,0.47451,0,0,0,0,0,0,0,0.188802,0.811198,0,0,0,0.617493,0.382507,0.71224,0.28776,0,0.457031,0.542969,0,0,0,0,0,0,1.23986,0.760139,0,0.505867,0.494133,0,0,0,0.378768,0.621232,0,0,0,0,0.833116,0.166884,0.462647,0.537353,0,0.370904,0.629096,0,0.849673,0.89708,0.253247,0,0.568807,0.431193,0,0,0,0,0,0,0.929688,0.0703125,0,1.63166,0.368336,0,0.674055,1.8822,0.443741,0,0.979167,0.0208333,0.709656,1.29034,0,0,0.0326797,0.96732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.796875,0.203125,0,0,0,0,0,0,0,0,0.5625,0.58222,0.85528,0,0,0,0,0.591146,0.408854,0,0,0,0,0,0,0,0,0,0.558155,1.44184,0,0,0,0,0,0,0,0.669271,0.330729,0,0,0.289062,0.710938,0,0,0,0,0,0,0,0,0,0,0.35733,0.64267,0,0,0,0,0,0,0,0,0,0,0,0,0,0.503277,0.496723,0,2.3617,0.638297,0,0,1.3897,0.610302,0,1.33721,0.662789,0,0,0.0416125,0.958387,0,0.679637,0.509165,1.50009,0.311111,0,0,0,0,0,0,0,0,0,0,0,0,0.914012,1.17441,1.60677,0.304799,0,0,0,0,0,0,0.180865,1.01048,0.80865,0,0.223097,0.776903,0,0.926988,0.0730117,0,0,0,0,0,0,0.715584,0.305249,0.979167,0,0,0,0,0,0.0494792,0.950521,0.414602,0.585398,0,0,0,0,0,0.446615,0.553385,0,0,0,0,0,0,0,0,0.492829,0.507171,0.172324,0.827676,0,0,0,0,0,0.218016,0.781984,0,0,0,0,0,0,0,0,0,0.838794,1.12569,1.03552,0,0.761039,0.238961,0,0.615385,1.00522,0.3794,0,0,0,0,0,0,0.772727,0.227273,0,0,0,0,0,0,0,0.30039,0.69961,0.469974,0.530026,0,0,0,0,0,0,0,0,0,0,0,0,0.562663,0.437337,0,0,0,0.327654,0.672346,0,0.0091623,0.990838,0,0.377604,0.622396,0,0.724634,1.27537,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.824675,0.606493,0.568831,0,0,0,0,0,0,0,0,0.342037,0.657963,0,0.984355,0.0156454,0,0,0,0,0,0,0,0,0,0.590377,1.36269,0.895185,0.151751,0,0.851948,0.148052,0.993473,0.00652742,0,0,0,0,0.625654,0.374346,0,0.053455,0.946545,0,0.119792,0.880208,0,0,0,0,0,0,0,0,1.25969,0.740308,0,0,1.64136,0.358639,0.262123,0.737877,0,0,0,0,0,0,0.6206,0.3794,0,0,0,0,0,0.892348,0.107652,0.794271,0.205729,0,0,0,0,0,0,0,0.0955497,1.0093,0.895151,0,0,0,0,0,0,0,0,0,0,0,0.776042,0.223958,0.709043,0.290957,0,0,0,0,0,0,0,0,0,0,0,0,0,0.867628,0.132372,0,0,0.713914,1.16875,0.11734,0.937662,0.0623377,0,0.622715,0.377285,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.793507,0.206494,0,0.0572917,1.25857,1.49064,0.193506,0,0,0,0,0.976654,0.0233463,0,0,0,0,0,0,0,0,0,0.14974,0.85026,0,0,0.026178,0.973822,0,0,0,0,0,0,0,0.998701,0.0012987,0,0,0,0,0,0,0.00519481,0.994805,0,0,0,0,0,0.852865,0.147135,0,0.301173,0.698827,0,0,0,0.889908,0.110092,0,0,0.218301,0.781699,0,0,0.975098,0.27686,0.748042,1,0.958442,0.0415584,0,0,0,0,0,0,0,0.331593,0.668407,0,0,0.870372,1.12963,0,0.0467532,0.953247,0,0,0.651376,0.348624,0,0,0.0544747,0.945525,0,0,0,0,0,0,0,0.368283,0.631717,0,0,0,0,0,0,0,0.588542,0.411458,0,0,0,0,0,0,0,0.638854,1.36115,0.0844156,0.915584,0,0,0,0,0.670143,0.41687,0.912987,0.677588,0.322412,0,0,0,0,0,0,0,0,0.74837,0.25163,0.101167,1.64753,0.251302,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.71708,1.28292,0,0,0,0,0,0,0,0,0,0,0,0.782552,0.217448,0,0,0,0.802083,0.197917,0,0,0,0,0,0,0,0,0,0.967405,0.0325945,0,0.25,0.75,0,0,0,0,0,0,0,0,0,0,0.158442,0.841558,0,0,0,0,0,0,0,0,0.400988,1.9033,0.695709,0,0,0,0,0,0,0.132812,0.867188,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0364583,0.963542,0,0,0,0,0,0,0,0,0,0,0.387013,0.612987,0,0,0,0,0,0,0,0,0.327225,0.672775,0,0,0,0,0,0,0.851369,0.745237,0.403394,0.165365,0.834635,0.442133,0.557867,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.63827,0.36173,0,0,0,0,0,0,0,0,0,0,0,0,1.04167,1.61153,0.346806,0,0,0,0,0,0,0,0,0,0,0,0.291829,0.708171,0,0,0,0,0,0,0.625974,0.374026,0,0,0,0,0,0,0,0,0,0,0,0,0,0.298177,0.701823,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.605469,0.394531,0,0,0,0,0.427261,0.572739,0,0.954427,0.0455729,0.426893,0.573107,0,0,0,0,0,0,0,0,0,0,0,0,0.35668,0.64332,0,0,0,0,0,0,0,0.364462,0.635538,0,0,0,0,0,0,0,0,0,0.81039,0.18961,0,0,0,0,0,0,0.929227,0.0707733,0,1.14559,0.854414,0,0,0.390402,0.609598,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.731771,0.268229,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.36849,0.63151,0,0,0,0,1.3722,0.627803,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.39493,0.605067,0.516297,0.483703,0.709043,0.290957,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.925393,0.0746073,0,1.86638,0.506726,1.6269,0,0,0,0,0,0,0,0,0,0,0,0.686198,0.313802,0.48961,0.51039,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.789062,0.210938,0,0,0,0.514286,0.485714,0,0,0,0,0,0,0,0,0,0,0,0.175325,1.35325,0.471429,0,0,0,0,0,0,0,0,0,0.332464,0.667536,0,0,0,0,0,2.04396,1.32713,1.00391,0.625,0,0,0.74574,0.737332,0.516927,0.407552,0.592448,0,0,0,0,0.89309,0.364387,0.742523,0,0.884666,0.115334,0,0,0,0.0848564,0.915144,0,0.487614,0.512386,0,0,0,0.0235911,0.976409,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.589309,0.410691,0,0,0,0,0,0,0.172324,0.827676,0,0,0,0,0,0,0,0.715776,0.284224,0,0,0,0,0,0.278068,0.721932,0.751625,0.248375,0,0,0,0,0.735677,1.00391,0.890767,0.36965,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.672775,0.327225,0,0,0,0,0,0,0,0,0,0,0,0.799738,0.200262,0,0.548892,0.451108,0,0.511053,1.1595,0.329442,0,0,0.522757,1.15299,0.324254,0,0,0.0942408,1.44212,0.463636,0,0,0,0,0,0,0.0104167,0.989583,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.230668,0.769332,0,0,0.712987,0.287013,0.896732,0.103268,0.478375,0.521625,0,0,0,0,0,0,0,0,0,0.647135,1.08144,0.438095,1.48873,0.344603,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.273794,0.726206,0,0,0,0,0,0,0,0,0.918848,0.362402,0.71875,0.00260756,0.997392,0,0,0,0,0.741222,0.258778,0,0,0.328999,1.42393,0.247074,0,0,0.888743,0.111257,0,0,0,0.334204,0.665796,0,0,0,0.368146,0.631854,0,0.398438,0.601562,0,0.407843,0.592157,0,0,0,0,0.801299,0.387503,0.811198,0,0,0,0,0,0,0,0,0,0,0,0.849155,0.150845,0,0,0,0,0.302356,0.697644,0.823377,0.176623,0.604194,0.395806,0,0,0,4.6055,2.3945,0,0,0,0,0.680157,1.23727,1.08257,0,0.908973,0.0910273,0,0,0,0,0,0,0,0,0,0,0,0,0.798956,0.201044,0,0.858442,0.141558,0,0,0,0,0,0.866234,0.133766,0,0,0,0,0,0,0,0,0,0,0.87808,0.12192,0,0,0,0,0,0,0,0.887728,0.125309,0.986962,0,0,0,0.654376,1.34562,0,0,0,0,0,0,0,0,0,0,0,0,0.977865,0.0221354,0,0,0,0,0.720052,0.279948,0,0,0,1.49086,0.509138,0,0,0,0,0,0,0,0,0,0,1.86458,0.135417,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.997406,0.00259403,3,0],
			"yScaleFactor":1
		},

		{
			"title":"Background",
			"id":1,
			"backgroundID":0,
			"type":"BACKGROUND",
			"peaks":[],
			"liveTime":4779.93,
			"realTime":4799.57,
			"neutrons":null,
			"lineColor":"green",
			"peakColor":"blue",
	"xeqn": [-0.218124,0.188269],
			"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.754201,1.00385,6.68779,32.3397,79.9762,133.619,157.556,169.237,177.393,183.579,211.933,175.043,172.862,180.606,200.319,198.904,175.348,183.338,195.748,179.958,172.939,174.897,185.583,187.193,163.957,177.759,178.69,176.098,196.332,194.577,190.555,171.773,183.935,191.809,182.171,183.954,174.246,152.153,183.828,198.19,194.534,188.076,193.362,167.899,167.805,176.127,201.498,191.997,216.465,202.538,169.386,171.395,154.894,166.786,185.318,165.176,175.771,186.755,186.994,179.753,173.728,193.309,193.02,174.954,179.075,198.605,205.204,192.187,180.668,178.707,181.87,179.171,192.127,170.068,186.156,199.136,193.509,161.474,187.817,182.008,177.942,197.208,191.006,170.608,192.433,188.008,185.543,186.154,177.863,171.414,205.599,189.115,177.798,163.507,193.348,184.243,201.484,155.596,157.668,170.118,186.994,159.325,191.556,173.031,163.475,175.178,180.063,190.685,197.677,171.46,171.825,198.773,175.239,184.958,189.695,158.282,174.946,166.27,155.679,175.216,170.454,167.371,181.926,168.994,170.943,186.854,166.723,176.663,177.944,184.114,203.815,169.398,170.457,175.536,161.995,186.354,164.723,180.269,190.123,173.193,183.699,191.115,167.611,177.509,180.544,174.275,179.926,168.783,188.412,186,175.033,167.99,172.671,186.739,199.865,193.249,172.93,175.12,194.094,180.926,180.4,173.982,178.11,186.449,187.516,177.195,183.764,182.987,200.599,188.225,186.686,201.526,181.882,206.07,211.496,196.114,195.405,202.933,189.82,180.483,186.503,185.615,190.578,198.629,179.674,192.717,206.3,207.08,202.28,200.273,219.848,212.458,196.115,194.205,211.923,208.183,207.402,237.69,229.362,193.745,192.396,206.594,205.882,202.883,218.045,235.472,227.884,215.076,212.679,211.315,224.079,201.629,208.3,221.673,233.814,238.314,237.279,237.642,241.983,237.271,232.828,213.564,209.126,233.814,249.129,240.983,233.562,219.695,256.675,250.009,224.221,238.919,253.403,260.814,245.738,240.032,245.132,248.741,248.582,246.242,215.265,241.113,256.172,264.573,264.627,229.715,243.013,271.805,266.32,262.13,255.081,246.718,262.173,224.151,243.186,259.631,247.564,262.795,263.918,270.745,254.138,266.869,263.392,282.687,268.058,263.092,260.835,280.724,283.924,264.32,259.261,259.19,253.441,267.002,264.092,256.539,246.831,265.18,291.554,285.625,263.757,273.533,298.741,302.418,285.004,258.052,276.661,270.543,275.95,277.346,272.54,290.129,291.24,278.455,278.589,280.486,281.703,279.335,300.039,297.529,282.616,258.823,299.192,300.832,290.012,272.43,277.007,271.839,293.23,290.715,308.907,304.104,287.329,285.52,260.91,286.918,315.134,322.449,306.668,312.245,307.305,301.786,314.334,314.642,265.51,307.65,304.729,323.047,326.959,279.151,292.128,311.052,335.75,377.274,311.614,337.414,332.335,331.972,312.606,312.072,307.14,316.771,304.383,327.164,324.146,306.984,281.843,269.409,299.569,296.604,312.875,281.18,313.05,305.723,308.646,316.065,303.296,324.306,298.644,286.176,321.057,306.212,283.659,316.723,313.291,304.622,314.029,293.175,328,291.867,295.352,305.616,313.509,314.314,315.166,305.031,317.15,318.379,316.663,327.744,307.312,328.78,322.952,294.567,298.628,313.562,351.025,333.612,325.074,333.162,326.498,316.038,304.967,303.518,310.537,287.225,309.913,314.437,342.388,349.705,313.576,327.755,329.171,327.086,318.167,321.522,342.057,332.003,327.444,312.838,300.982,298.095,328.715,334.852,362.602,357.368,349.008,351.125,336.23,327.543,322.274,330.263,336.62,331.825,342.169,322.417,321.589,304.355,294.287,306.262,305.624,324.25,316.823,334.759,323.52,313.423,323.261,315.202,325.542,320.498,335.65,300.967,336.476,332.606,345.875,330.776,327.037,336.092,331.851,338.822,308.092,347.166,320.453,308.864,336.72,347.947,355.064,323.461,318.134,326.002,338.301,309.746,311.066,333.435,324.758,339.375,320.444,344.336,351.278,339.773,325.743,347.891,338.929,340.714,331.072,317.59,324.228,317.405,339.119,317.8,336.467,334.139,349.152,358.82,334.462,337.79,375.349,349.59,327.326,316.482,335.681,323,326.632,358.526,350.538,335.6,334.381,317.604,337.899,354.805,327.021,329.544,332.934,330.357,327.014,341.193,324.251,323.039,320.65,314.279,345.092,320.74,317.483,339.745,327.817,335.642,339.803,326.994,338.642,348.307,334.194,322.043,334.919,320.013,324.342,360.882,351.662,318.79,330.998,337.046,337.223,308.202,349.291,353.005,358.396,327.398,312.697,316.911,318.821,351.571,339.315,320.055,290.594,350.786,335.07,364.094,333.366,323.507,326.094,316.188,310.084,304.594,306.915,363.352,322.979,312.8,303.98,325.617,287.176,332.662,336.239,322.837,308.193,328.063,325.302,333.006,311.818,315.587,327.584,326.091,348.723,323.348,326.012,324.467,322.87,344.659,327.783,323.721,299.848,318.62,341.774,321.11,315.05,301.837,311.661,307.849,319.842,357.277,325.299,331.015,337.345,335.399,337.498,343.456,352.735,310.908,347.015,330.534,324.647,355.806,333.557,294.302,317.21,316.745,294.013,320.888,300.543,339.299,354.73,333.532,288.944,320.636,316.306,309.71,318.741,318.882,320.897,323.999,304.839,322.985,334.362,338.306,346.88,327.25,299.142,325.207,321.385,311.637,308.924,324.499,322.341,317.731,313.529,331.3,321.714,299.32,295.648,314.289,312.634,312.727,339.999,318.803,301.23,300.554,277.904,301.371,315.436,321.929,299.906,286.08,321.622,298.722,301.341,318.191,321.455,335.817,338.174,348.414,332.205,297.508,299.366,318.069,294.102,302.48,289.485,289.422,307.549,320.945,323.822,314.558,331.349,314.486,287.566,287.317,309.293,304.669,291.597,305.951,307.724,296.951,282.194,288.867,306.91,322.656,335.469,292.661,310.605,266.082,284.187,292.432,267.98,272.511,279.333,322.341,307.74,270.485,316.815,304.449,303.258,297.534,295.16,325.04,294.671,304.165,290.082,274.978,292.531,282.921,296.387,279.938,296.761,282.833,303.677,313.898,309.396,294.425,276.29,290.86,307.122,284.76,290.435,284.768,295.874,279.558,265.467,252.117,271.439,284.287,313.767,282.403,283.853,292.265,287.922,275.664,272.465,298.948,296.944,295.407,291.021,260.597,285.788,288.825,274.148,278.264,289.281,263.898,275.867,288.813,279.441,299.267,273.816,302.179,292.291,282.63,256.963,268.352,291.312,282.883,281.682,285.831,274.361,278.346,276.143,270.929,274.708,271.225,271.232,275.998,290.73,268.689,284.741,282.547,283.319,262.365,255.245,265.02,271.421,243.215,237.336,260.497,264.926,252.866,259.797,250.11,238.156,271.943,266.74,271.508,256.589,281.536,248.784,288.776,251.832,260.566,229.436,260.982,251.719,256.992,249.45,243.578,237.058,239.526,266.2,256.115,243.384,217.25,237.007,262.071,257.112,242.725,266.035,276.686,228.415,257.904,237.522,261.579,239.707,228.122,259.336,259.209,251.28,227.03,242.228,233.349,251.186,236.649,218.887,221.74,238.091,251.119,228.265,241.982,218.986,233.967,241.376,250.074,236.26,236.457,246.857,252.499,244.257,243.926,244.527,232.833,221.16,235.013,257.03,240.356,229.519,235.433,221.742,224.48,246.778,226.759,217.629,234.626,236.147,228.586,241.015,218.984,230.737,228.373,220.098,236.148,240.756,227.931,224.812,228.85,214.334,234.455,242.768,237.799,214.949,220.189,217.526,225.621,232.135,220.989,231.76,216.579,233.917,228.436,246.596,245.661,254.02,237.248,236.081,236.381,211.216,223.109,230.801,206.502,233.92,227.357,206.061,223.442,223.278,215.04,217.684,226.713,205.911,217.171,214.186,225.12,240.512,226.598,239.582,225.331,260.717,250.163,235.531,247.09,239.548,223.975,245.603,231.841,228.733,241.216,216.576,216.692,226.357,232.714,218.022,212.627,216.672,212.338,213.101,219.632,224.177,216.806,228.044,189.292,207.637,207.077,210.444,214.322,218.482,205.931,198.195,191.435,206.139,216.014,214.254,207.47,199.196,210.459,210.454,206.722,209.53,195.978,217.663,211.012,225.046,210.019,189.979,195.96,200.185,212.286,205.652,194.287,214.994,208.475,208.19,187.558,194.642,203.59,213.707,203.674,208.276,218.303,206.514,212.344,170.364,194.592,207.988,172.662,195.045,218.193,194.248,206.995,207.797,203.873,188.311,183.435,200.49,201.67,193.599,198.262,214.704,178.993,185.625,205.307,196.158,196.396,197.823,208.829,209.302,203.066,208.564,185.368,197.888,183.257,192.169,214.37,171.092,188.561,187.071,196.395,178.003,196.243,184.711,182.238,185.594,185.697,187.959,170.961,204.572,194.2,183.574,191.725,189.365,182.466,184.357,203.48,187.244,188.635,193.236,186.044,185.316,187.2,191.061,178.711,177.449,202.66,208.927,183.994,180.88,180.899,197.556,190.607,191.829,182.349,172.561,180.418,179.563,176.291,170.971,165.292,187.192,164.629,183.642,189.288,168.494,173.694,167.418,165.166,177.134,168.62,159.027,179.342,166.992,188.347,163.699,185.955,152.147,158.192,190.183,185.65,151.426,180.404,170.561,186.388,164.108,163.755,182.756,175.435,175.352,167.864,168.725,189.532,186.372,184.729,183.939,168.195,165.409,170.436,172.415,170.891,179.562,169.64,158.728,177.492,172.79,152.826,158.362,150.469,157.183,176.222,160.751,155.945,167.896,175.842,199.069,185.973,156.44,171.924,159.42,177.759,167.031,173.994,160.654,168.162,171.542,156.192,140.476,156.777,178.84,172.487,164.157,151.835,171.838,163.056,155.257,164.225,170.106,153.139,142.319,152.517,145.258,153.272,152.6,146.341,155.786,163.781,167.796,172.688,179.787,158.499,149.739,156.551,164.022,150.813,150.969,142.837,143.189,148.211,147.915,163.316,159.789,153.331,151.385,148.981,161.606,128.416,138.556,150.888,146.899,139.439,150.75,165.78,170.008,163.194,162.41,149.494,146.623,144.551,149.184,160.561,155.661,159.334,155.904,151.002,138.475,136.162,156.523,151.481,142.502,151.896,139.092,128.746,135.333,132.352,146.838,155.654,149.5,159.431,178.105,197.711,227.682,234.591,266.428,291.507,288.164,265.017,228.571,202.847,176.047,159.474,144.261,138.829,144.505,146.175,136.66,141.746,160.009,170.566,148.209,157.524,174.738,150.251,130.231,135.502,125.774,126.5,127.308,130.295,134.777,133.234,132.477,141.188,125.599,133.837,111.836,123.277,123.377,130.969,145.03,136.55,124.781,135.991,127.309,143.096,139.1,140.526,146.857,124.366,144.733,133.94,125.534,130.215,127.123,124.968,128.699,138.633,127.016,119.137,114.982,119.543,132.544,127.112,130.571,120.823,123.578,127.463,122.117,116.964,110.898,127.037,123.837,117.632,128.72,119.162,119.871,122.483,115.966,126.576,131.792,136.252,130.617,131.926,132.904,109.989,117.69,113.091,130.595,112.489,109.528,110.164,119.889,128.096,122.89,122.512,124.919,119.218,113.155,130.016,130.893,127.048,130.839,125.084,127.583,116.035,114.975,128.501,117.566,101.369,119.162,117.439,116.478,109.52,122.9,112.338,126.391,112.992,103.082,97.2929,109.736,116.52,116.336,113.96,109.393,106.952,114.867,121.221,110.341,103.08,106.349,111.507,112.508,114.286,110.393,119.292,110.954,105.769,114.222,116.921,123.608,107.222,101.874,93.7459,113.073,134.188,104.413,101.024,99.6841,100.161,105.464,104.601,106.629,109.725,107.48,104.747,118.019,108.851,99.8903,102.19,110.7,113.647,131.528,113.777,114.702,116.75,118.7,117.311,125.715,106.092,109.681,104.73,115.788,109.988,123.853,125.59,123.108,114.723,115.989,89.8416,96.069,111.471,100.935,89.9341,111.469,105.543,109.118,113.549,106.108,103.335,99.6118,101.369,91.6971,104.008,111.701,102.609,105.804,95.9462,95.0852,94.2815,102.032,99.7194,117.686,110.779,104.644,99.0118,83.7766,100.351,104.956,104.115,109.932,131.62,115.017,110.351,100.463,100.705,94.5502,108.616,99.6648,105.415,117.039,102.949,90.2093,90.6471,95.8294,103.904,107.846,100.855,97.2457,88.6599,79.8623,95.4764,100.481,104.764,97.2448,93.7122,113.554,104.286,115.815,98.7506,97.9717,90.7319,97.6701,107.235,110.507,98.7711,94.7579,93.9226,90.8316,105.976,109.712,112.802,101.075,96.9371,89.5447,88.9041,80.6231,94.2606,94.5677,85.317,92.3347,88.7155,95.1275,93.1205,98.9474,79.6662,92.0389,102.052,105.766,102.305,74.37,78.4713,98.4114,95.0131,100.58,95.4269,86.6484,82.1662,87.1711,96.385,86.0087,100.962,107.448,93.8831,77.9048,84.1895,78.1202,95.534,92.9855,94.0018,86.1841,77.3996,102.565,98.5447,96.728,109.869,84.8632,81.266,90.6749,103.038,100.317,113.222,100.335,100.717,113.041,124.087,126.374,103.151,118.271,119.184,103.668,89.9986,82.4732,100.288,80.5933,78.1524,85.5194,78.9474,79.8394,77.572,86.3974,85.7872,84.701,85.9983,83.7351,91.5459,82.9207,77.496,72.1487,99.8601,97.9553,95.8062,93.3613,110.177,92.9838,91.6266,87.6737,92.1953,84.5574,93.0756,80.602,76.6925,83.9974,72.1621,80.9855,85.3588,88.8957,79.059,81.3231,73.3384,84.5591,79.0016,74.8026,96.2674,75.5504,80.6984,78.699,81.1189,73.5658,75.8675,78.702,82.0525,80.0521,80.6203,86.0997,78.179,87.2142,83.9573,82.8122,81.3169,82.3242,73.4986,87.2215,91.7042,94.205,75.6731,84.314,82.487,77.6543,79.0292,81.5076,84.111,83.0722,87.8754,83.6638,79.149,67.5117,72.1396,68.8825,71.2836,75.22,85.6281,83.8802,73.6423,70.5034,74.4074,77.5899,74.1024,72.5753,77.9873,90.6306,85.8897,83.2891,82.1708,75.8987,81.5579,73.9877,67.8631,67.7391,75.1158,85.8127,72.815,77.4044,77.04,83.041,76.7148,68.5174,78.1566,81.1857,69.8947,73.3979,78.1512,66.6893,74.2106,74.4279,75.2365,78.4052,87.0508,77.7361,80.4818,79.4382,88.7399,77.1796,88.8909,64.1186,61.9342,69.8753,68.9079,66.8793,87.4778,68.6122,76.922,75.7148,68.2901,67.7959,66.4766,75.5943,67.6775,86.5053,82.3248,71.1761,82.16,85.9974,76.5799,78.9637,68.8688,70.7321,78.005,77.7076,63.9126,79.284,75.5353,82.7751,85.6017,76.9346,65.6884,66.915,78.1357,77.8977,62.8845,70.9163,89.3207,83.7806,71.9429,67.3357,60.3187,66.2284,78.3677,65.4408,67.9894,85.9528,78.1665,65.6712,77.643,75.6491,81.7063,74.7123,79.7449,78.3798,79.1063,78.653,58.3931,72.7187,77.8619,63.6677,68.9673,79.3372,70.8645,66.7856,84.0628,71.2114,54.3536,80.3808,75.4213,68.3919,73.1264,82.7238,74.9777,72.8438,73.8587,72.2305,71.7927,70.4819,73.4306,65.3309,63.1471,58.9756,64.3846,67.9118,76.4407,73.7424,67.7217,63.0649,62.5299,67.1006,66.8259,74.2364,61.5273,63.782,77.9891,87.5188,81.4224,87.0655,105.802,100.576,108.226,111.535,82.8856,78.6328,77.0264,74.1741,72.1872,68.0215,71.8505,57.9219,67.2933,62.8919,53.2789,60.8055,61.2508,56.0857,62.4,65.2811,68.6278,62.2458,75.4713,65.264,75.2361,74.1204,62.504,69.3506,58.3961,58.0165,70.5415,61.3431,64.5776,69.5935,77.4961,75.3118,68.0276,67.4036,62.5128,59.324,63.3934,68.4458,62.0623,73.0597,66.6105,63.8324,53.5791,60.1797,61.1965,61.091,68.7915,65.975,63.1065,61.3553,70.6079,57.9721,58.937,66.5901,68.4582,59.9752,65.2301,60.9381,63.0579,59.8159,59.8706,62.2226,69.2348,69.6496,83.2461,93.95,105.321,110.351,129.065,134.768,131.332,113.821,115.902,102.128,93.4876,77.8728,61.5951,72.8849,62.8481,60.7625,62.1011,56.305,54.0568,60.2837,64.4096,63.5587,58.7792,63.5246,58.7108,58.7979,57.7867,45.5914,45.4637,44.7724,51.2866,55.5005,57.2693,58.5075,51.3976,62.6572,66.2225,64.1879,59.6571,60.8333,59.86,61.5481,67.9711,67.2479,56.7528,50.0764,68.6327,66.2121,54.519,48.1151,52.4543,54.3527,55.8946,56.4992,59.2829,54.4704,53.3213,52.5066,61.0285,52.5178,64.2018,65.7866,59.1709,49.0838,57.5904,58.3635,48.874,54.8522,58.0354,58.0468,52.4894,53.1787,64.7886,62.5225,58.5927,64.1536,62.033,60.1069,53.5719,61.6861,65.0652,58.2888,52.5519,57.7514,61.316,50.5722,49.8371,57.858,52.2909,49.9017,49.1106,46.2705,42.9722,53.015,58.4107,61.6539,55.4822,45.9696,46.1004,58.0009,55.0032,54.9932,41.0931,55.493,53.4129,54.7182,46.1254,54.2388,45.6451,53.8791,50.9519,57.5359,59.1269,50.1658,61.3684,70.9187,56.6114,57.9107,53.2854,61.3848,60.1797,51.8481,51.3679,41.8871,54.9233,54.1136,52.8367,64.2594,61.3396,58.5457,47.5653,48.4374,49.2991,46.2707,52.9535,47.2272,62.8103,49.6664,51.2399,50.0613,52.3977,51.8593,60.2823,53.7315,49.6974,50.9405,59.0632,49.5388,46.9265,49.4715,43.0342,58.9216,46.6473,44.4959,51.8226,48.9089,61.1199,52.6008,56.4476,53.4785,54.6382,51.5389,45.2011,43.2014,50.6325,47.6195,53.8906,43.9715,55.9775,59.3123,52.1315,56.8467,52.8245,57.9221,47.881,57.3012,64.0912,57.2338,53.5022,43.7531,52.2669,46.5779,54.484,52.1252,53.287,56.6906,53.3227,40.296,46.8371,50.526,58.9082,50.2915,49.4192,54.3875,57.8095,46.0607,56.3392,60.0495,55.8408,50.445,48.4896,56.2892,57.1403,41.3531,55.885,51.6665,46.7053,56.32,64.6368,51.1811,48.5148,49.9833,39.4072,42.9521,51.7178,53.8101,57.6987,57.3355,50.1942,48.7842,45.5204,56.3076,55.0704,50.9499,43.7626,53.3223,44.9231,41.2122,52.5618,50.3966,55.5242,60.9558,43.755,42.7818,39.7117,45.9193,51.2152,41.2448,41.6218,44.9876,44.9434,42.3095,52.9806,52.0752,47.8889,48.9884,40.4369,45.7441,44.7295,43.3812,46.1802,50.6554,51.4694,58.4677,51.7926,49.4823,49.6096,48.1498,53.9015,56.3496,51.3566,58.421,52.2828,53.5362,50.0427,52.2819,42.1014,44.7144,41.9287,43.561,47.4931,56.7573,48.2077,48.6046,47.4566,49.1203,42.2241,51.6764,49.2093,46.5765,43.3257,55.2949,48.5122,57.9147,42.0411,40.6786,41.3398,53.9528,44.9983,48.2999,46.1002,49.4661,47.686,49.1645,55.0612,49.8979,56.2649,39.7536,43.4967,34.5986,50.2487,49.3654,42.2037,51.5321,47.3679,63.5173,48.3565,50.9002,56.0161,57.193,49.2423,45.2023,46.3676,56.7565,52.0774,48.5347,53.4742,50.2421,42.4228,44.1035,36.1814,41.5621,40.0978,46.9612,47.3437,37.1337,31.8079,43.1106,43.9184,45.5136,46.7541,50.5526,51.4437,52.1005,50.5386,41.667,39.8193,50.0229,42.8732,51.0208,43.8019,46.9485,37.4988,57.8792,49.1472,49.7474,49.4608,53.5751,45.7312,44.5623,49.1304,43.8093,41.7074,44.2976,39.5342,42.7319,39.5389,42.3788,50.1871,42.662,37.9478,49.3497,43.9593,38.6637,31.7362,46.9064,46.6401,47.582,49.8599,36.4672,43.655,47.3145,46.9796,38.7387,39.9789,32.902,41.1416,32.6779,31.8021,39.5147,39.8299,44.8059,46.2089,47.2124,47.5954,42.1033,41.1959,42.2618,40.6895,41.4031,48.3168,37.9487,38.2685,34.3283,39.9661,46.5163,40.4719,37.8422,39.4253,35.1909,32.9132,37.7419,46.2451,45.3503,44.97,35.1553,38.4246,39.1224,38.7616,33.3997,38.7108,40.1969,45.1417,46.0727,37.367,45.5557,47.9233,48.1895,40.0973,38.0574,36.7346,47.9567,43.7548,45.3453,46.1526,44.3568,47.2676,41.23,41.132,46.8654,33.7807,34.3022,33.7969,34.8938,41.6835,35.6655,41.9744,35.0073,35.2964,38.3122,37.1973,35.7706,36.9296,40.153,49.473,43.3202,42.9051,50.9949,44.4818,36.1512,43.9424,41.1035,43.9659,40.3276,39.4705,41.0398,49.3144,53.6333,41.1466,34.4779,32.5839,35.5654,36.0792,50.0598,48.3539,44.4022,36.8498,42.2335,49.7209,46.7339,44.9962,46.5763,45.3504,36.6473,34.1863,44.7676,44.919,34.0191,40.1129,32.5146,31.1441,36.8713,39.9167,44.8614,46.5482,51.3776,50.856,39.4872,47.384,48.1769,43.533,37.7718,34.9108,45.4632,45.417,27.3715,35.5657,41.2432,31.6918,43.1781,47.0917,42.3637,44.7318,38.7218,34.8558,42.6539,50.8919,37.6905,42.5371,30.5557,38.6325,44.0787,45.5969,37.5118,40.0601,35.0071,39.7199,29.8352,36.987,49.5266,38.9441,29.4977,23.6362,42.5734,30.9432,33.1247,36.8177,38.8581,41.4641,45.5814,43.9305,32.412,29.6372,30.8503,35.3167,27.8188,33.0362,34.3137,37.7186,32.2078,28.6235,35.3826,48.6082,42.1678,39.6228,40.8657,39.509,38.6314,41.988,40.5175,36.1535,37.5206,37.2862,47.3098,34.5293,41.6503,27.9871,29.5846,30.9579,39.593,46.0185,40.7341,42.4712,37.6806,35.9209,31.7346,39.6926,27.9553,35.9746,37.0583,37.8655,35.2333,34.7993,35.3184,42.899,40.6425,31.6866,42.0876,40.3454,31.9083,27.861,35.9529,43.4047,26.3717,36.2804,38.0859,36.2439,37.9421,38.0167,32.847,27.3078,32.1772,46.7596,43.2785,46.0438,44.0107,33.8347,37.4745,39.5885,34.7609,44.5769,41.4988,41.9948,36.7797,38.4354,38.5749,34.5271,32.8078,41.8072,31.0881,38.2099,36.8846,39.6951,35.9787,41.4267,34.0239,39.538,39.7289,33.5395,26.3193,37.5863,34.6342,43.1467,37.7568,32.3664,37.2278,33.0339,32.866,32.6853,33.1656,30.8642,34.8047,36.4711,40.2731,47.0698,33.8656,30.0289,37.6002,39.4709,29.0363,34.3711,37.9436,36.3168,35.6777,31.5907,30.9009,34.8913,32.1657,35.6836,40.2008,38.2255,35.7922,29.991,33.7517,34.3521,30.178,33.6061,36.5804,35.2645,40.1975,40.8066,36.9869,33.2321,34.2293,41.0864,42.0828,32.8283,40.8048,37.86,37.6656,41.0141,36.563,39.8586,32.1847,37.0086,31.9201,37.3302,30.2782,31.9738,27.6794,34.1558,30.9757,31.3538,36.0209,36.5974,38.6078,27.8334,36.2614,39.0893,39.8198,33.5803,24.5215,26.7533,30.8604,34.1024,36.6098,31.3282,33.7052,34.7853,30.3315,27.8801,33.4095,32.2012,33.1148,36.5035,28.1502,36.0936,32.624,24.5278,33.6365,39.8155,36.0663,30.1028,35.468,32.2556,34.0428,30.731,31.3144,36.6052,31.0821,38.7963,38.3215,34.9492,35.0997,33.2557,37.9197,37.8366,26.6221,35.4083,40.1329,44.4348,30.3887,35.3158,36.3162,43.4453,35.3352,28.9055,34.4974,34.6649,31.8012,38.736,27.3608,32.1981,30.1141,44.7431,37.1518,32.8956,25.9194,25.7348,31.5465,34.7835,35.2915,35.9054,39.0329,40.3505,29.4425,34.9005,41.7246,31.6398,27.7117,22.815,29.1447,29.7358,33.0207,30.1196,30.4017,36.4729,34.4936,33.3218,33.7188,36.2293,39.5876,32.2196,29.5033,28.8107,36.9932,37.8028,36.9879,38.1723,37.6481,27.4184,29.0161,29.5269,31.8384,42.4913,32.3919,28.6899,28.2579,30.7567,34.7973,23.9109,28.3753,36.5676,29.1873,26.0415,31.3253,25.5644,28.197,28.3332,33.8304,37.4389,36.1454,30.1676,31.0934,37.25,35.298,31.7765,31.4992,33.2787,28.0434,33.0513,29.6899,24.693,38.2156,29.4115,27.5157,39.5633,35.1912,32.1655,27.6479,31.6476,25.5555,26.4134,31.8327,31.3301,31.8269,35.0752,35.1935,29.1694,33.6788,33.9212,33.6628,30.6081,35.8749,39.1978,41.1932,35.8993,50.3795,38.6641,46.0984,52.8377,54.459,65.3395,56.035,77.2413,67.9158,84.1996,76.7949,83.9836,80.0407,99.2259,82.2514,74.2275,63.0852,63.1522,68.1887,64.5869,61.2353,58.0243,48.8519,35.3041,47.6498,45.9377,38.1089,37.9254,34.7394,39.1221,36.7198,28.2651,32.4356,30.2372,29.079,23.8163,29.4458,30.412,27.9215,26.2817,31.0551,33.7218,33.7417,27.5345,28.6926,24.6393,22.6881,26.8073,28.4344,30.2699,28.8528,32.9577,30.5655,30.4549,30.8384,32.2045,28.3271,26.5572,26.973,26.5767,28.1268,30.0474,34.6334,22.8987,31.4253,32.692,38.4494,36.1778,30.4881,24.1933,27.6342,32.5508,30.6656,35.2021,33.5982,40.0926,30.7209,28.0107,31.241,22.7642,28.7121,26.9462,23.6831,23.6798,28.1153,33.2053,29.635,32.6272,27.5363,27.659,31.5091,28.7465,22.7069,22.576,26.0226,34.4745,30.0193,30.1318,27.9446,24.7515,30.1535,39.1219,21.9451,25.4305,25.7463,25.8699,19.5593,27.9537,26.532,27.3334,29.2438,26.2189,28.5875,24.5547,23.8033,27.9954,25.92,30.5497,30.4068,27.7424,21.9873,26.4663,23.7247,26.0802,30.9234,23.0406,30.4384,35.8046,24.8094,27.998,36.5006,32.7814,30.3961,31.3844,25.9239,40.9678,34.5779,24.7999,30.536,27.1396,28.1208,25.171,24.3702,23.4944,27.2213,24.7144,28.799,29.4886,26.3031,22.0017,24.2162,25.831,25.411,21.3442,19.3856,26.1166,27.899,20.2573,27.2057,23.7515,29.0455,25.3699,31.531,24.0944,31.0757,25.566,27.0803,29.9804,32.9605,30.0654,27.7044,24.8574,27.7701,30.3793,25.2091,32.1528,21.3873,22.6147,24.8936,27.261,23.2676,26.0688,24.981,25.9096,19.4974,18.9828,23.435,28.6325,28.5367,25.791,27.5806,32.8015,21.1441,18.1675,20.5114,28.6011,27.2018,28.088,21.9254,27.1949,29.7212,37.7404,35.9854,29.4483,26.2333,32.033,26.586,30.7199,20.3057,24.522,23.4712,22.0846,26.0735,27.479,29.5757,28.8074,22.6779,28.2267,27.5208,32.1543,29.2553,28.5602,31.4541,26.1818,30.4629,34.3423,34.3014,24.9727,27.3564,29.2922,27.1839,27.4098,26.4168,25.2898,24.8749,30.4715,24.6549,22.4787,19.9025,23.9582,23.8714,23.5232,23.902,25.7177,26.5446,17.4017,18.6501,27.0831,28.2701,31.5211,30.8287,36.2474,22.9281,24.248,30.2093,22.1978,16.8887,19.9783,20.1994,19.127,30.887,27.0894,33.0976,28.0066,26.4196,24.2521,26.855,21.3768,23.5733,28.7737,27.8039,21.7406,25.6596,31.2395,31.3355,27.6095,29.777,29.65,21.9623,22.1714,19.9002,23.9126,24.4046,21.2972,18.7372,23.3905,26.3819,27.8925,25.2544,26.1891,20.149,26.2314,24.1583,21.7044,27.6556,21.526,19.7668,24.5529,24.4194,27.712,27.2223,20.418,26.8629,22.8793,28.6191,23.3058,26.8823,21.059,26.0123,27.2655,18.087,25.642,19.7175,31.8739,32.7336,25.2077,22.7194,22.2188,21.9086,25.1775,25.003,29.2814,30.099,21.0786,26.4035,23.6631,29.1277,30.2549,32.9087,30.3072,30.3182,21.1069,24.8107,31.6283,25.9916,24.5066,25.6543,28.2766,24.1042,28.0931,26.4012,28.4584,22.5725,17.3973,19.0451,27.1589,31.198,19.7249,22.1608,23.9951,27.1898,27.9464,22.8564,25.0335,28.3244,25.7073,27.7652,26.775,23.1544,24.8811,26.8112,25.5106,27.822,24.1027,21.3069,30.6082,23.969,25.139,24.702,29.7978,26.0489,22.8163,24.5722,24.5781,28.0426,26.7268,23.8875,28.8811,27.4463,28.875,24.4561,27.8986,28.9221,32.0283,29.2046,28.6003,28.6263,28.1791,34.5485,39.0169,42.0636,57.3656,73.8842,66.2752,86.6906,82.6027,80.7787,82.6212,70.1388,58.983,61.315,45.1418,37.3307,39.3043,29.636,21.7476,24.6371,23.1742,23.6398,22.4799,24.3891,22.6811,20.6554,17.4818,22.6558,26.3173,27.8196,29.6844,22.8995,20.1495,23.6487,19.7326,19.5573,29.0875,25.1711,18.882,17.4692,17.6878,21.2431,28.9272,30.4389,26.9849,27.5647,27.7649,27.0497,20.1464,20.6206,22.8814,17.0874,22.4242,19.3361,14.6259,23.0497,26.083,27.9486,21.045,23.2636,26.4595,20.283,20.608,24.2419,25.5178,28.4544,23.7698,22.8716,20.2177,22.1401,23.0553,20.3632,21.7352,22.6524,26.0486,27.3388,26.1459,29.4626,26.6079,21.5334,31.2061,29.6971,22.5642,27.0466,26.0944,23.3124,21.3021,22.3102,20.2748,27.876,22.078,22.5369,20.0154,22.7634,23.7196,27.0031,28.2803,24.597,22.3593,25.9105,23.5621,25.1675,24.5972,20.3233,29.9324,23.6094,18.1946,20.3826,23.0955,18.4931,25.1909,20.2273,21.8883,23.2914,19.4693,27.3515,27.2701,31.6066,23.5692,25.1842,20.5796,17.6987,17.7931,18.2495,17.23,23.2768,14.5902,19.6136,31.6153,20.2243,17.8701,20.5855,22.0546,29.8118,21.9245,25.8971,24.756,23.9208,32.0096,27.8813,32.558,46.0122,48.5496,72.6695,69.9375,82.2677,84.9035,77.9129,82.009,80.6632,85.7259,66.6572,60.6747,47.1246,34.8841,30.2579,31.5205,24.529,18.972,22.8334,18.0888,22.0921,19.4248,19.5925,21.9412,21.6324,19.912,29.2245,19.7231,20.8554,25.0714,14.2813,15.5989,22.6006,18.888,21.833,21.8335,15.1497,18.9698,22.5528,21.1107,17.5994,21.8238,26.1425,25.5819,21.7086,20.5297,17.0501,24.7423,25.1914,23.7086,23.345,28.281,24.4605,18.3764,20.2516,18.0723,14.5668,14.5946,18.4707,21.0486,23.4681,16.8234,18.9549,18.5905,25.3947,23.7337,21.2427,17.1761,19.4343,20.5978,21.7708,23.3622,27.6949,24.8008,17.3514,16.4141,23.7691,23.4993,28.9751,17.0009,20.4425,24.3353,22.1576,18.4045,21.5719,21.527,26.0562,27.7471,24.9336,14.7331,22.8402,23.4168,17.7085,19.6886,17.3077,19.8156,22.8061,25.4896,25.3399,17.4581,12.1033,20.4933,19.4519,21.4381,12.6065,14.5174,15.9382,17.0702,25.269,22.8236,10.9487,14.2587,21.8131,21.3854,16.6135,13.0882,12.1514,16.7101,18.8461,11.9348,17.8819,17.6957,15.7025,17.6574,21.4305,17.3894,18.3605,21.0975,22.6512,15.0736,15.553,17.5085,15.6173,19.3462,22.7956,26.9796,24.3194,17.9214,18.0939,18.5893,20.1781,14.7132,16.3154,16.8027,23.7599,17.4078,17.0964,17.8449,12.1319,14.7923,18.6695,21.4361,19.5296,23.335,19.5049,16.0731,20.2939,16.8431,16.4167,25.347,23.3833,21.7736,23.3732,27.8882,15.153,12.8759,16.3974,18.6825,16.1827,18.1089,27.6046,17.2907,26.253,13.4181,17.2793,18.9938,21.2035,12.5532,19.7843,21.861,23.2592,23.9195,15.1549,12.6272,22.6282,24.7963,22.5231,19.0311,16.6231,22.1384,22.579,26.9432,16.4328,24.5331,22.4695,20.1711,17.6056,19.3621,16.332,15.8268,18.2088,24.0604,15.951,19.8647,13.8449,28.3049,16.041,22.0241,18.1223,20.394,19.8309,22.5291,15.9834,17.4992,9.57685,18.7583,19.6994,15.1732,14.2313,18.2701,23.721,19.5133,26.2125,16.9999,19.4405,22.7616,15.6789,15.5941,17.9781,19.8067,22.3523,28.3157,18.8284,15.0176,12.096,17.4485,28.9338,19.1103,14.8186,13.0694,14.0457,23.7647,20.9905,20.3965,17.0252,18.8985,14.9435,15.1494,20.2792,16.7466,19.0001,18.836,19.7532,20.8611,20.7102,17.0462,24.3556,19.7987,22.1504,19.6956,15.3829,15.1504,20.6371,17.522,21.2635,16.7675,22.1474,31.049,26.267,17.6815,14.1628,15.653,19.123,12.9303,17.1165,15.1401,16.3304,10.6222,13.8464,12.7952,19.5172,16.8453,12.1313,19.1831,15.5078,21.091,25.0352,22.4932,19.9556,13.1177,17.1162,14.0763,25.7747,16.3055,19.363,27.8432,24.2779,18.0061,22.5546,20.1962,19.7957,21.1288,14.3915,19.4717,31.6719,23.7304,17.0492,18.977,22.451,29.5724,23.5557,19.7773,16.5421,20.434,20.6989,16.4416,17.234,19.0252,18.3043,19.9561,15.7276,23.0978,24.3749,17.8296,20.8104,22.9686,16.733,21.984,20.6172,16.3169,21.046,24.774,17.5169,18.6571,8.49187,15.7608,17.852,15.3527,18.4447,19.7877,13.6328,20.1116,25.5083,20.6593,16.3453,19.8009,13.9844,19.3556,14.046,20.2008,19.2348,12.691,19.8545,19.621,15.0155,20.823,22.7536,23.1993,19.6271,17.7669,16.534,16.5787,20.3652,18.3909,13.0099,16.6978,17.5946,16.6225,26.3509,25.1488,21.557,14.5102,17.219,18.6353,17.9684,20.3863,17.0701,12.9173,13.8363,23.0012,20.1629,20.5435,21.9942,20.2305,19.1308,17.7078,17.7274,17.7371,18.4506,17.95,18.0088,17.1419,14.0285,15.945,22.893,19.9259,19.4072,13.4381,12.6492,15.7361,16.619,23.2792,14.4071,16.0238,17.6366,15.0904,18.2921,13.9432,17.4511,20.1953,24.4789,25.5676,21.1023,19.5443,23.7591,18.1668,17.7913,14.4404,13.3419,16.0607,18.6308,14.6095,14.4404,22.843,17.2243,13.1362,16.1012,18.3986,11.8024,19.1554,22.914,18.1451,15.5728,17.0578,25.4267,23.8637,22.1872,12.7898,10.5563,17.6009,16.3078,11.4513,19.6544,22.1976,27.6028,21.5284,17.5695,15.5551,19.7221,18.7228,17.8818,16.9879,24.9807,23.8949,17.2464,19.2398,15.8312,14.2965,19.8173,17.9634,19.9927,18.3715,20.23,24.8787,12.9487,14.3452,20.9573,22.5209,22.1159,24.3836,16.3193,18.8903,15.1296,15.8532,17.3087,15.4586,12.3487,21.51,24.5311,19.8009,20.9875,18.975,14.4764,17.6756,18.1938,15.8169,18.2268,19.4663,14.1902,13.522,14.6313,18.0666,17.403,20.3957,16.1108,18.9718,20.5992,18.0471,11.4413,20.018,19.7825,19.2784,16.2132,16.15,18.1628,20.8927,18.1837,15.8114,16.8441,16.0071,13.2185,17.8271,17.3214,19.7217,20.9812,12.819,17.8878,17.4743,17.37,20.8936,15.5526,13.6995,13.3187,17.3228,18.2665,17.37,18.2872,23.6595,19.2474,11.9249,23.3283,25.7526,16.8082,16.8666,19.8857,13.3738,13.7874,13.263,16.9228,23.5998,16.0712,17.4669,17.9684,17.4705,7.92266,8.16575,19.435,15.3839,10.2971,16.4784,17.1264,19.7567,16.9207,17.4483,22.0137,17.5071,11.3106,10.1503,14.9615,13.8796,14.7563,17.2109,17.3837,15.2352,21.3,19.0734,14.5815,15.8445,20.1727,13.6538,18.5921,16.8377,16.7049,13.581,18.342,13.5244,18.4809,11.724,13.8756,14.8803,14.7247,21.4923,14.0175,12.7426,17.9765,12.9295,15.5856,19.4264,16.3604,16.7179,18.4357,13.2911,11.836,12.7074,17.6903,18.0118,18.1053,17.6127,15.4937,17.8675,11.8312,11.6116,16.1901,15.9125,21.5542,11.7435,19.323,24.7201,19.9299,18.1126,16.7986,23.7707,21.0346,12.827,16.1095,20.2532,18.6745,15.7991,16.0364,10.909,17.7916,20.2756,13.2578,18.765,18.7614,10.9289,13.0219,18.7803,18.607,26.0005,16.4392,16.5716,30.1238,27.4958,27.8955,31.3309,25.0052,27.9482,29.0709,17.4173,21.1023,21.2359,16.5885,13.9419,22.8531,22.5875,22.5234,15.8676,14.48,11.0915,12.9603,12.2216,14.6357,18.8227,18.7483,13.9368,15.6246,16.8531,14.8051,14.488,15.9388,17.2374,11.8048,17.2421,16.6831,13.2568,13.7742,18.8439,17.212,13.3547,11.3964,18.4254,20.1856,16.245,16.4793,17.0122,12.6917,12.7577,15.7783,25.4564,18.7767,9.38141,17.8319,18.8429,15.0089,10.9707,14.9402,11.9787,14.6632,16.0918,15.7224,16.858,16.821,23.2076,21.0187,15.3144,12.2172,15.5469,21.7315,15.1332,9.40273,13.5834,15.2194,17.4657,15.9413,18.2071,15.7341,9.12624,13.6026,9.96987,22.2473,14.7953,18.22,17.5468,14.7897,23.3447,28.577,24.2297,19.748,18.2738,16.8573,16.5664,13.9984,16.6478,19.8063,13.0802,14.4658,16.5438,22.5365,13.564,17.6638,18.0876,14.8754,13.0112,14.0717,11.8302,14.0825,12.0613,15.6325,16.3083,16.3307,19.9192,16.3725,15.7173,14.3709,22.768,19.6708,12.294,22.2952,13.9236,17.1475,14.4224,13.4907,12.901,17.1164,21.5044,13.5946,11.2747,13.1963,15.107,16.028,12.1054,13.6738,17.2039,12.7366,15.6276,18.5584,16.549,14.7914,12.8199,12.625,12.7941,13.0764,11.0386,16.5253,14.0681,17.8128,14.5612,17.6925,16.4503,17.3896,13.9103,17.4484,16.6758,17.5636,18.8074,19.0158,15.673,11.6066,14.3146,20.3302,16.3962,18.7637,13.0957,11.4589,14.8251,13.7259,11.0583,14.6059,17.7269,17.7508,13.6162,17.8031,14.8582,11.6717,13.1331,18.2145,17.5793,16.1288,16.175,15.8294,15.5429,14.1508,18.6805,14.9368,10.7941,15.3659,11.6493,18.3752,15.4157,24.9206,14.4251,15.6608,16.763,20.1519,14.318,14.452,15.5174,14.835,14.0106,9.68775,10.8197,19.1123,14.7929,20.1366,17.1761,20.9403,16.4788,14.5642,15.2667,17.1474,19.0934,21.9762,18.9944,9.83155,17.7184,18.8,19.3061,17.2066,15.4499,24.5869,19.1155,22.0877,21.1173,20.8796,23.5914,22.2989,20.2325,11.4597,13.4968,18.6151,16.2547,18.7584,11.8388,15.425,13.5095,12.9625,17.3521,13.0495,18.0707,22.9005,23.9464,16.6633,11.832,14.491,19.193,16.9923,19.2912,18.5814,13.3586,16.3302,18.1908,12.2764,8.29731,15.8326,18.851,10.4675,11.9017,11.6657,12.7479,15.1366,15.9678,17.3975,11.9126,12.6437,11.6037,16.1718,13.2685,18.1451,13.2635,19.0029,13.3177,14.2921,17.5622,21.1856,16.1291,12.2724,16.9154,15.1493,18.7097,15.9963,11.2772,19.1425,15.0075,16.835,17.4785,15.4692,13.2145,14.8171,16.1789,10.4748,17.8899,14.8534,18.1572,14.4491,19.021,18.8108,20.0226,18.0242,16.8885,9.60353,10.038,17.8617,15.0911,22.7004,16.0536,12.8186,12.7918,18.5274,12.5782,14.845,16.4695,16.9274,13.7013,15.7807,13.0789,12.4405,19.9176,22.4466,17.3062,12.4961,16.5225,11.9687,13.9221,18.0364,18.2439,14.7957,14.2223,14.0017,8.24042,8.65899,15.0895,16.668,18.9864,16.3722,12.4451,12.8928,16.2307,16.5205,17.7732,10.8605,10.026,11.7327,14.6206,15.9268,14.7614,13.4031,15.2365,15.2097,15.6016,13.1638,15.6698,16.2741,12.2301,15.4263,18.0246,15.6105,12.2484,13.5303,17.4426,21.0983,20.2662,23.0668,26.1889,20.6772,16.6692,15.282,19.7875,17.2915,13.5151,12.2151,13.52,16.6422,10.2653,9.57657,13.1538,16.4868,13.3284,16.1605,12.2048,13.9459,10.8296,9.95001,12.2402,15.8372,10.8863,10.7042,10.5903,19.7405,17.5397,13.2887,16.1591,12.0828,14.8018,10.6014,9.97528,10.1832,10.5028,12.129,13.2029,11.1351,12.5031,12.8664,11.1746,10.5142,10.0519,10.3084,17.0261,14.9261,17.2427,14.202,11.6211,20.9247,19.4424,9.84976,13.293,14.5801,14.8026,16.1201,18.4437,14.0755,15.2099,10.3217,12.1428,18.4364,13.5334,17.1571,19.9507,15.6468,19.2778,15.0329,13.2823,14.1934,10.8468,12.4567,15.5228,16.2219,12.7864,18.9034,16.0109,14.279,11.7997,14.8232,11.3877,12.4106,17.3302,15.4674,11.4021,10.6707,16.1485,13.9091,12.3939,12.2438,10.8154,12.1885,15.0339,17.2667,11.8681,10.9908,10.6975,14.2838,15.2466,14.9142,17.6061,14.393,14.8665,16.176,15.7085,13.7383,15.6654,17.9456,14.4594,13.4039,12.8834,12.8639,14.3009,16.2154,13.6386,11.1355,11.004,12.7452,11.8514,9.54159,15.0253,11.2646,9.16743,7.72372,12.5879,19.6994,14.814,9.28769,9.13609,10.7966,19.0036,13.1863,14.2924,11.4327,11.2266,15.4446,15.9063,16.1361,13.7651,9.21447,7.40554,10.3113,14.2867,12.8644,10.9111,12.1765,7.81446,12.2935,10.3758,15.8956,22.1982,12.581,15.2159,19.2236,9.97845,14.8508,18.5807,8.07247,9.97969,10.3847,12.6518,11.8837,11.0148,15.7052,12.7324,14.1434,13.7012,17.7422,17.6969,17.5244,15.4106,9.64765,11.5625,9.9467,6.6221,8.5454,11.4685,13.5024,16.0651,14.5791,12.2966,12.0427,10.1791,12.2034,16.7629,8.9902,12.7658,10.2975,16.2408,21.9694,17.6735,14.8516,16.6579,19.5093,17.6585,14.6828,10.7649,9.78419,15.8273,11.086,14.2974,12.9997,10.6868,17.0752,14.7994,15.0775,16.0404,13.357,13.4705,15.4632,15.0758,17.2028,15.3,11.2928,6.97776,11.4209,14.3323,20.854,16.4304,20.3739,17.0556,14.8014,12.7118,14.2284,15.279,17.9078,13.519,12.3074,7.98735,11.0884,10.1767,11.0326,17.821,12.8594,18.4982,15.4328,9.34241,8.51262,17.7408,13.0697,12.5962,15.5864,15.5691,19.8634,16.9395,18.0839,22.3898,20.2493,16.302,8.84504,8.65063,12.5747,14.5005,9.76705,10.4557,13.6585,11.2901,10.6908,12.198,6.49039,11.4024,12.4789,15.1038,13.7628,10.2434,10.5827,11.6304,10.6765,12.623,13.6992,16.9547,17.5575,18.8706,13.4202,18.6931,15.7887,14.5401,10.6014,11.2949,18.2427,13.2879,14.236,13.2668,11.1812,13.0647,12.6938,16.1435,6.67297,9.98073,12.6207,13.4407,14.8618,10.7796,12.7891,11.6121,8.30216,7.02586,11.6554,16.6121,9.20917,10.6654,13.6583,11.2427,12.1884,13.3142,10.3891,17.1057,11.0538,8.21291,13.2028,19.5049,15.3765,11.0869,18.5974,10.7384,8.90384,13.3782,13.5994,10.0311,7.18208,10.7851,12.8994,13.2927,9.29587,9.27915,12.8051,13.8153,13.7375,10.6757,16.1527,16.9798,12.6391,9.94041,9.52554,15.563,13.2465,14.2117,13.7111,13.9632,10.1683,13.7014,10.8777,20.9343,16.7708,10.0948,20.1183,18.1016,17.9532,25.8271,22.3578,21.5556,23.8375,26.8549,23.5353,21.5365,13.5402,18.7063,17.0836,14.4215,12.2794,17.3542,11.2264,13.9107,12.2211,14.0437,8.90189,10.6308,17.8198,9.20122,5.55026,9.97822,15.208,15.561,12.4664,8.35234,12.2232,6.99854,19.8409,16.2988,15.1152,8.80416,11.2049,17.0246,11.387,12.1769,11.0487,17.5839,15.2744,9.32341,11.2418,12.1791,10.9528,8.21165,9.29843,12.8555,12.9504,14.5605,12.6772,8.67727,9.42464,10.9649,15.5363,9.65245,6.55147,16.507,15.6747,9.25051,11.5144,10.3742,13.0205,12.0327,11.5355,13.3143,12.4897,10.0482,12.1703,9.00278,12.0001,14.2054,12.2279,16.5625,16.2177,15.057,15.2891,16.8468,20.2694,14.3169,11.3475,12.5138,11.1233,13.0428,8.06274,13.4603,12.4502,15.0453,11.6447,11.3915,12.332,15.1662,13.6644,11.1064,8.84791,9.92304,13.6601,12.9815,7.28609,10.75,15.2552,11.9248,9.8918,6.10744,10.5154,13.5226,13.8263,16.2361,19.3448,11.9791,10.6564,13.0971,12.6617,9.93952,14.756,10.3417,13.4522,14.8082,12.7732,14.6184,19.3704,15.7328,11.3615,9.38968,13.6276,15.767,11.2532,9.86583,10.0242,14.8339,14.1674,12.5259,9.89236,12.3128,9.79092,14.5423,12.4453,10.165,16.0027,13.5777,16.1105,14.2659,6.38388,10.3117,10.5346,10.9538,14.8889,16.7599,13.8172,9.65174,18.0348,17.9259,11.4187,6.0265,8.78766,10.1602,7.2514,11.152,10.4968,15.3271,8.47015,6.19458,10.19,10.7617,10.0953,14.2898,13.8132,11.3643,8.74498,9.18081,12.6711,16.5198,10.3647,12.0265,10.8131,9.96128,9.89251,12.0803,13.4473,12.1231,8.66299,9.44155,9.27646,8.79459,10.1882,11.5465,10.7732,13.9305,9.91294,8.05242,9.77219,10.6769,9.51236,7.48775,14.4564,13.1499,14.3661,13.9852,12.0615,13.0561,13.1159,14.8215,11.9397,15.6825,15.5355,11.8484,9.47173,14.6212,14.7652,16.6508,12.8121,13.0657,9.38765,7.35978,13.4101,13.5352,13.6332,15.2058,10.8632,8.45262,11.177,13.2316,10.4592,8.33579,10.5434,11.0026,8.20228,10.6241,12.4231,9.21262,7.99674,14.3131,14.3244,11.418,11.5079,14.4436,9.97763,16.822,10.9575,12.5521,9.83735,7.57825,6.38068,8.32889,7.93442,11.7847,10.8612,8.86544,9.26488,8.7596,7.41385,9.85151,10.8821,13.7931,9.18595,10.2752,9.55616,15.2739,13.16,15.7118,18.2075,10.9227,14.8048,16.5121,20.9872,25.3858,19.4942,29.2702,40.0199,50.8108,51.1872,50.9729,57.645,58.5539,51.2273,44.4139,38.7324,30.2283,27.5773,19.7868,16.7254,15.3308,15.3304,12.2273,12.3032,14.1328,12.5926,9.67214,13.4871,14.8734,18.3141,14.4952,11.1724,11.7415,11.6568,9.01619,10.8256,13.1363,11.388,11.2212,9.34611,8.05034,12.1503,11.6168,9.39607,13.3587,9.0589,6.53696,10.1459,11.702,9.80559,9.36361,14.2172,11.4039,16.3981,9.39067,9.77666,14.0366,9.61697,9.75913,11.092,12.0161,10.6569,12.5489,6.87916,11.1603,13.8859,8.95831,13.7633,13.9704,8.81811,8.07012,7.86404,10.5564,12.0756,12.6818,11.5792,14.8229,11.4274,10.9921,9.30875,10.5021,8.60099,8.27728,11.1922,12.0918,7.52393,8.76331,8.10774,5.35471,10.8198,10.4133,8.86551,7.91634,13.4654,14.0765,14.3239,10.744,11.3109,13.9898,12.4176,11.8936,7.72514,11.7457,10.3226,10.2371,10.641,10.7531,12.7583,10.087,15.2656,11.9618,11.3108,11.2281,10.8879,10.2457,9.56786,11.4478,12.1141,10.4775,6.53532,9.6514,8.4623,7.07428,9.53053,7.4678,11.6272,13.9991,15.085,10.9247,9.77453,17.1861,13.7603,22.2812,19.3497,11.5564,16.2654,20.2687,21.0313,14.018,15.5289,14.6959,10.9706,9.14296,10.688,10.3801,11.7809,6.27711,5.84059,9.00518,10.008,11.3891,7.25191,9.98896,11.1834,13.2461,10.4287,8.5731,7.76033,9.58895,9.58533,6.68891,5.27568,10.481,14.0028,10.1438,7.97362,8.20789,14.8817,12.5399,10.5694,10.8929,14.4618,11.7046,10.7421,12.1348,12.3472,16.4173,9.59083,12.2615,9.32236,10.85,11.4051,14.8166,6.92621,7.95826,9.46938,8.93689,10.2308,15.3461,14.7138,14.5572,11.2511,7.53221,8.58633,13.5236,5.66502,8.26762,10.1913,9.19704,12.9187,9.56875,10.9162,9.48548,14.4646,10.7285,7.35961,9.10011,12.2584,15.0572,11.2973,8.59852,15.9775,7.67031,8.30321,12.6498,15.4374,10.3351,13.5251,10.9755,9.7245,16.7347,13.2471,11.505,11.3189,10.7209,9.51561,13.5907,9.70209,10.8451,10.6345,7.76994,8.06157,12.9872,9.51128,14.814,8.36197,5.91975,6.611,12.6264,8.82147,14.83,8.23273,10.8249,12.8978,9.19916,9.66191,5.87459,11.1632,12.7651,7.94142,5.92606,14.3634,12.6893,16.4868,8.77663,10.0528,8.14608,13.0559,10.411,7.61373,11.156,8.3956,7.67551,11.3425,8.92855,8.62248,15.4452,14.4103,15.4684,9.04884,10.1295,9.31114,16.3001,9.64747,9.58546,11.2933,11.2914,6.25327,7.54049,15.1965,11.7281,9.52466,6.54986,10.496,11.3022,11.6985,14.2691,12.193,17.53,14.7658,14.3012,13.2108,15.7757,14.7299,19.7557,16.6837,16.8867,17.5837,15.6091,13.2641,14.5312,8.02579,13.2376,15.1804,8.7356,9.20258,10.2927,15.7917,14.2567,15.5294,13.4868,19.1777,25.1201,23.1911,33.216,30.9003,36.7753,37.7088,42.6561,34.893,29.1072,24.7732,23.1985,23.5859,20.7619,13.8277,12.5572,16.6613,9.16462,12.4277,10.1797,11.1503,14.1707,10.2253,8.53533,15.241,15.6602,12.7626,16.0665,11.5918,11.6824,13.9747,11.6433,9.92252,16.1592,12.0837,9.96468,11.0664,16.0363,13.3928,9.70979,14.002,12.1089,14.5093,11.2384,9.93694,12.6053,10.6054,13.4365,10.6132,9.25474,11.216,6.22798,6.68131,8.81498,8.76622,7.6013,5.85277,9.07903,11.005,11.6587,9.13409,12.8765,7.42016,18.1827,9.42556,9.59655,9.9933,10.0505,9.58127,11.7473,12.7284,10.9353,11.0482,12.5996,14.8399,10.434,8.63368,9.64943,15.2542,16.667,9.26228,9.19844,8.72965,13.6054,13.555,9.12581,6.54775,10.8256,9.60095,9.04509,3.32489,11.217,7.3682,9.02983,11.9447,14.0041,8.8419,9.99599,6.37789,9.64349,12.3642,10.8922,9.57968,18.2113,12.1278,13.3492,10.4762,7.14103,12.7593,4.75907,7.68751,11.9935,9.79712,7.66758,8.71183,11.2021,7.52005,10.4816,12.6542,7.16772,7.39622,8.50789,12.1507,11.0559,10.1421,14.104,4.65371,6.34203,12.8871,9.28207,10.4382,12.9284,10.6088,8.79328,5.82859,8.10878,9.66503,11.5482,12.3552,11.2417,10.3478,12.6078,10.2024,10.6045,9.18033,9.58774,13.1682,11.4207,8.81849,11.0667,11.9635,9.50498,11.0174,12.3571,14.623,8.03575,7.21747,11.4362,13.0335,13.3958,9.81338,17.381,12.2364,9.72203,7.77534,12.744,11.4238,9.15408,14.4853,12.4324,10.3112,14.8231,12.24,12.0178,17.6501,15.7676,8.5331,8.48872,8.39737,9.65212,9.45442,10.3958,7.60785,11.9796,8.64103,10.0692,8.80431,9.10266,11.7592,14.0573,11.1474,11.0799,10.3164,9.27964,15.3577,11.8001,12.8615,8.71329,8.2482,9.44503,6.67799,6.16426,9.73506,11.6996,10.2829,8.69847,11.5078,11.6494,10.7349,13.3966,9.15178,13.5906,10.1248,7.98926,6.67145,9.34309,6.47009,6.41229,6.0127,9.43002,9.32248,9.91579,9.16441,10.9172,13.8706,11.2547,8.17498,11.1762,8.64679,9.39767,10.5875,10.5046,6.16878,10.6805,9.84359,8.24814,6.58814,8.93085,9.12312,10.6362,10.9968,12.7752,10.3772,8.01947,5.1002,9.08492,17.0414,15.5318,9.31173,8.01817,9.5066,8.91093,10.1397,6.71761,8.32463,7.75137,11.8277,13.011,12.2027,9.30257,7.50547,8.42429,6.03292,10.1663,10.6026,8.69934,8.22931,10.5093,5.98439,6.86701,8.51625,13.2721,17.6689,13.6974,9.65061,9.57919,10.8018,10.6683,5.41186,9.54066,10.001,9.89377,10.0654,8.97387,7.71314,11.098,10.3625,8.35596,11.2379,10.2516,9.69516,10.0367,4.45497,8.21152,11.3008,12.5237,10.9124,7.52586,10.5038,7.98804,10.1469,11.2065,9.36355,11.7371,7.7221,3.5571,6.62641,7.35414,5.66093,6.41933,6.59675,10.099,3.2784,8.2727,7.33214,5.59473,8.30739,11.9827,10.6728,8.79659,12.1266,7.99415,13.6856,10.6318,11.949,12.8675,14.7986,11.1209,4.59238,13.2527,13.4384,10.1145,13.8578,8.05124,9.37082,9.22695,8.13796,9.66267,13.5829,13.9952,7.27103,9.52817,8.97626,11.0797,12.5041,11.4837,12.2892,16.0014,16.6431,10.8723,10.121,10.4723,3.76331,5.7094,5.09796,6.4828,10.42,11.3723,10.7035,10.1342,13.4262,10.8556,13.5335,10.0269,8.25394,8.25243,9.45708,14.3128,6.87377,10.041,9.84708,7.89947,12.4802,10.6519,15.0408,11.0634,10.4079,10.4808,16.6219,11.9428,9.03958,10.5374,9.76243,5.80069,13.5512,12.6405,11.0808,4.71727,11.688,10.3015,7.43379,9.68453,9.78956,8.55269,8.08732,10.6687,8.65232,9.87572,10.6321,11.5862,11.4454,7.09519,7.74031,3.03779,8.31579,10.7061,13.0977,11.5631,10.0243,10.7388,8.05936,8.31045,9.57917,10.8819,11.5429,8.72534,12.2202,13.8192,5.93292,12.2046,5.42944,9.90688,13.3726,9.8204,6.54376,9.79197,8.66692,14.3274,4.34048,13.1079,13.6724,10.8777,12.2036,6.62886,8.78923,12.938,8.66166,5.93431,10.8466,7.54947,9.47758,8.28503,8.27543,7.47127,5.99516,12.5512,9.49389,8.28221,10.94,5.56499,11.5581,10.2299,7.49425,11.599,8.44413,12.727,14.1326,7.58759,8.17492,10.3438,11.9069,13.8031,7.73325,9.14668,5.98424,9.82971,6.96221,7.57038,10.8029,7.8245,7.76921,11.1947,8.45074,8.41119,8.95202,7.37654,10.7246,11.1143,12.9425,14.6059,10.3955,14.1142,9.83749,7.89266,6.71707,6.66093,9.82972,11.231,11.3767,9.85596,9.15337,9.64128,13.1167,9.53052,6.01356,11.0394,7.3931,10.7319,10.0996,11.2232,7.59105,5.95468,10.3302,9.51217,8.0463,7.77336,11.6575,11.1403,9.41391,6.72042,11.4203,5.70612,7.63983,11.9472,9.14711,14.0099,10.2354,5.62264,9.01441,12.7299,12.4078,6.34859,5.7532,11.3879,9.7935,11.4569,11.0551,10.5091,8.01534,5.04028,10.3228,8.82115,8.96045,7.45975,7.47246,8.86942,4.82871,10.2432,14.032,11.9248,5.03044,8.97612,9.9779,10.5665,9.08195,11.2425,7.56485,9.57882,16.4629,14.3328,9.03112,6.3948,19.2238,17.576,11.9238,8.5098,14.4012,13.9405,8.19112,7.42848,5.15035,6.91017,9.24288,9.4299,3.98,4.87971,10.0768,6.535,6.08917,10.3413,8.05898,8.50555,4.33555,8.57059,11.3045,12.1892,10.1439,12.1995,11.1928,10.4444,10.4696,10.9126,12.5267,6.85259,5.30862,7.27208,9.6514,10.1734,11.1856,9.46459,9.31402,11.9523,10.7364,7.43286,10.7112,8.57258,10.488,10.6163,7.96151,7.96841,9.67029,12.6196,11.8138,9.21835,10.2239,8.19773,9.53025,10.9954,8.73895,9.70599,10.5462,11.4682,11.3119,8.3531,10.4563,9.62379,9.82787,12.6418,10.3846,12.793,7.20077,10.9094,7.91822,15.0157,10.3718,12.0078,8.6713,6.82817,9.49044,7.96103,6.78073,10.3804,10.1628,6.59538,7.64924,7.30477,8.6615,11.2786,7.5131,5.63282,7.83989,8.57708,11.8374,11.8894,11.4305,8.87396,5.23273,8.57787,7.41883,5.43012,10.4108,10.6405,8.62457,9.50393,6.94448,7.70302,9.25503,8.1507,8.12691,10.2406,12.0236,11.9418,4.07144,7.7283,9.1376,8.16235,8.4444,14.8273,14.6759,9.61208,8.79189,12.1849,6.66953,7.99001,7.89258,10.6816,12.5422,9.4506,9.34062,9.61369,9.84933,7.802,8.90069,5.55881,5.16433,8.13321,4.03523,5.31855,12.3404,7.45395,5.78826,6.306,9.97752,9.77472,5.45416,12.6414,10.0324,8.55391,10.5123,10.5885,9.30726,7.07775,7.10969,6.20755,9.45226,13.5659,10.7299,12.9905,6.75012,9.36907,9.22911,11.8582,5.27929,6.62719,8.55588,6.36072,12.2839,7.67599,11.0497,11.9142,6.53322,9.29471,10.8283,7.28664,11.5052,15.8858,8.03679,9.00798,7.38222,5.33068,5.62378,11.8203,10.5844,5.6834,14.3158,7.31243,8.11573,10.3755,8.06954,9.3092,10.9519,10.1328,6.7734,6.68812,14.1965,8.81616,8.36559,11.2692,9.56427,11.2076,9.42253,7.21102,10.9545,16.6635,12.768,9.68879,6.66123,8.73972,7.16667,9.54593,7.5425,7.93018,8.29112,8.93399,7.13513,13.1882,6.22332,7.60349,12.8321,9.86774,7.3829,8.28898,10.0636,10.0767,10.2967,10.7328,7.37561,10.7091,7.51501,6.85411,5.74337,12.6037,10.5252,9.08781,9.28699,7.29907,9.57846,11.2364,8.11553,12.2497,11.0667,17.8655,10.1688,8.97642,11.0379,9.85543,10.1193,8.57147,11.5696,18.2887,16.075,10.0982,10.1378,9.54601,10.2231,20.1086,20.6685,21.6591,23.9903,31.4993,28.8627,31.8718,28.7907,32.0055,22.3833,17.7879,22.2909,16.8863,16.8828,9.37467,7.35759,9.88783,12.3325,12.4134,7.55626,7.19034,9.68162,12.3102,10.9207,8.75076,5.9501,5.2468,7.58532,8.84423,10.1962,8.28244,9.90773,8.87072,10.6031,16.1621,11.999,10.5041,12.8092,9.89276,7.20831,6.31952,3.51951,7.63712,4.89721,12.3982,6.81596,6.22268,7.64361,9.29077,7.58791,6.40895,11.5106,9.24003,7.30976,6.48199,6.38949,7.96509,10.8107,11.3648,10.3424,8.85612,8.99205,12.5643,8.52221,7.83784,8.3494,11.9113,7.40078,5.68539,7.04395,8.13224,7.05187,10.7165,13.6031,6.91555,9.38465,9.58997,8.52774,11.3981,11.3407,9.97388,8.84465,7.80533,7.73063,13.8849,12.1906,10.9424,16.1377,11.4456,11.943,13.5938,11.5863,9.89604,5.55915,9.71884,11.2121,7.55943,7.41994,8.06463,8.05251,16.1342,9.87373,11.6966,11.0229,5.49405,6.60284,8.76205,13.2128,6.38114,5.92661,10.8954,9.89463,9.68469,11.5767,11.5185,9.88133,8.13172,11.1719,6.57902,7.91895,8.53025,8.88176,7.19757,8.8811,6.27331,5.35979,9.34565,7.32519,12.5701,5.96256,7.18865,7.26975,8.92733,7.55631,8.09944,10.1164,7.53769,8.94595,13.2957,9.85523,7.27035,9.51976,6.33551,13.3733,6.372,6.10748,5.39404,9.6682,10.2915,12.752,7.55383,11.2702,15.2549,4.14129,6.10211,9.20578,11.2978,12.0299,9.13916,6.96908,7.05059,10.201,5.24946,13.6571,10.7463,8.01311,7.95909,14.3936,6.94447,6.61896,16.3028,18.4621,9.45649,7.41424,9.07345,6.56376,6.36474,6.74358,9.42332,11.2831,12.5773,9.03588,10.4476,14.6038,10.6869,14.6239,7.69109,7.88794,6.77774,14.3669,16.4027,15.6402,16.1296,9.38408,13.2693,7.11309,8.00689,11.206,11.0894,8.03132,8.76483,9.87328,7.94116,12.6438,7.82282,11.4431,6.12426,6.04255,9.0156,8.71734,12.5652,8.04377,10.5813,9.35197,12.0367,8.69186,7.87054,10.2535,9.77508,11.2056,10.2781,10.9998,7.90842,10.6784,12.0287,11.3517,11.6991,9.76464,6.71797,8.2174,10.8654,7.53469,12.14,9.67927,13.79,9.66445,6.77768,7.05142,6.32934,12.1571,12.0376,10.206,8.0436,9.89148,8.16109,7.50322,8.66984,8.8657,6.7935,5.66745,8.0227,8.4733,9.68264,13.7141,9.07935,8.8196,16.7482,11.5012,8.29094,10.8106,13.8169,9.46056,15.0039,9.06845,8.86633,11.4876,7.91178,8.42511,7.5548,13.7632,11.9314,12.6264,10.5657,10.0039,9.77364,6.18339,9.61641,6.40207,7.99241,9.04836,8.21175,7.72809,7.2003,8.58451,9.55198,14.8933,12.297,6.94029,9.21203,11.0374,1.47839,5.95714,10.5728,10.5401,12.552,10.4257,10.7239,9.81868,9.29429,8.44616,9.0981,9.1236,8.60164,8.32678,8.08761,10.197,9.12624,10.0588,7.51675,8.96143,7.65974,8.3582,7.04249,14.6706,11.276,12.3178,11.5553,10.356,10.266,6.49209,13.5295,12.4552,9.41186,10.7028,8.8705,11.9374,12.8133,10.8288,10.2211,11.9859,14.0379,11.6401,9.88481,6.85083,7.77516,9.3023,10.6992,10.7644,9.34692,6.17651,14.4729,10.4647,9.63479,10.8425,9.84133,7.77985,6.78773,11.0965,7.41426,12.8416,6.93438,8.67505,15.1964,12.6379,13.475,16.9014,7.73598,10.6951,5.2315,7.08212,4.32618,9.72626,10.4695,12.6359,10.0631,9.32333,8.95646,10.0349,11.2951,12.0577,11.8206,6.87148,6.97829,10.119,11.0935,4.41702,5.58437,11.3181,8.39007,11.1223,10.6335,8.21565,10.7255,9.62825,6.47968,8.49486,8.02534,9.41413,10.4938,8.87226,13.7902,11.8162,15.5712,11.8176,11.8799,15.2495,8.35253,6.01613,12.4003,14.9019,9.89445,7.70572,12.1807,12.8484,10.8267,9.53361,9.14944,10.1493,6.56368,12.3556,10.6143,7.94346,10.2465,8.35752,10.232,8.88552,8.23585,8.69403,13.1362,15.3103,11.2723,9.45526,8.67075,8.21543,14.3035,10.9132,8.94098,11.5576,11.5782,13.9837,12.7776,10.9039,9.05918,9.60371,10.9907,9.90351,8.46529,8.89876,12.4612,10.5113,6.88545,9.00215,13.8869,11.1609,12.0603,10.4094,8.42322,9.69454,9.94957,9.53799,15.6499,15.1762,8.14035,11.8218,11.1768,10.055,11.8181,7.21756,10.4951,6.8902,8.28907,12.1654,11.6497,8.75567,9.61137,9.40475,9.54385,6.73366,11.2922,7.94912,6.00686,5.46378,10.0083,9.16981,12.4233,8.3703,12.9434,9.48857,11.8132,9.47251,9.86173,7.56226,10.1359,11.7135,6.77347,8.75371,9.15895,12.8282,9.21151,9.68005,11.3707,6.96315,8.2542,8.08514,10.1349,9.24101,7.39581,9.55461,9.42115,14.0875,9.17193,7.20609,13.3464,11.1373,6.49181,7.86793,8.26506,7.5,14.2641,12.8236,9.42328,11.508,10.0604,11.5673,13.8842,11.7861,12.2121,12.8214,10.2144,9.04189,10.4506,11.8426,13.8281,12.5802,11.3348,8.67318,10.5865,8.09229,8.91184,12.3383,6.53059,11.0221,11.5265,10.8034,14.1594,8.85532,8.79785,10.6825,10.5688,13.2619,10.5579,6.65929,8.96189,6.32601,11.0853,10.9075,10.2129,5.2403,5.58367,6.4651,7.95074,9.07419,13.2734,7.53461,10.1642,13.0177,2.22229,10.6098,8.07118,8.4916,15.0785,11.8355,5.87163,8.44174,7.34148,5.85012,10.7869,8.9924,15.2122,13.0572,11.3426,15.9332,6.50075,11.9589,13.9929,10.3937,11.0963,6.08673,5.94509,13.4601,12.9023,11.2332,14.494,8.43348,7.74818,10.3511,6.98335,11.6453,8.39812,5.9426,9.93569,10.3384,9.96175,9.98907,7.96,8.39288,9.07793,11.1048,6.85922,11.7933,11.4497,11.6993,19.2733,20.8372,7.62076,6.94473,7.34985,8.33515,5.97067,5.16751,11.0937,9.94563,8.16434,8.64029,8.63223,14.6564,11.4279,12.661,10.3504,12.0322,12.9251,9.88526,10.0996,7.04529,9.71766,11.1715,13.7591,20.7793,14.7403,16.1241,16.2175,16.993,13.7411,19.0173,20.2684,15.035,20.6161,15.9949,19.2058,10.6661,9.56711,10.9994,10.6739,14.6237,8.58594,8.07338,9.19756,15.1964,13.3441,6.73803,6.45571,10.7009,7.74893,7.34308,8.4984,10.5922,9.29613,6.91035,5.97028,12.9691,8.53911,8.12685,12.1489,13.3649,4.8259,11.081,9.6474,8.55026,4.37582,5.94446,8.3998,6.78847,6.86556,6.73679,8.27081,7.45162,13.431,10.7433,2.61357,7.48517,7.93433,8.3831,7.86971,6.44302,9.79728,10.1083,7.74139,6.87163,6.94306,7.65502,12.1686,7.02163,7.03772,3.72107,10.3147,10.799,10.9798,7.84021,15.1329,8.81335,9.1426,11.254,9.06111,7.35161,9.07853,7.67524,7.18706,8.49973,7.36296,10.8724,13.2631,12.2648,8.76781,9.54774,6.99195,8.13556,8.84826,8.08402,8.78674,8.36968,7.28624,5.65599,5.99321,10.0895,6.56735,7.07252,7.86763,7.74247,6.01888,9.12271,7.86529,5.44234,5.67221,7.56549,5.35028,6.99982,4.94775,3.69893,2.17034,6.36552,5.28675,7.55825,9.48636,13.111,8.80313,3.69462,4.74667,7.14999,11.6506,5.27127,6.46772,6.67885,5.56126,6.57375,8.21287,10.668,8.81838,3.32206,5.30539,4.81303,4.72705,7.03998,6.04285,10.0443,10.7238,8.56137,7.33776,6.65065,10.5978,8.16897,5.65607,8.2555,7.61296,9.25307,10.8718,7.58538,6.71781,3.37492,10.0107,9.15264,8.05353,8.38263,7.36813,8.21427,4.42023,5.80802,5.25183,4.41089,8.4841,7.52183,8.5333,9.53641,6.36356,5.52432,5.83531,5.97808,5.81516,6.66039,9.48716,6.46428,6.374,4.98826,6.1034,4.45022,3.36905,1.73562,5.78601,6.45065,6.39296,5.41334,6.52961,4.09751,10.048,8.91002,8.73281,6.18335,5.60417,6.90796,3.72971,6.86724,5.09891,4.16769,4.71938,7.66432,7.2015,11.3258,8.58178,8.54592,9.44045,6.18004,4.64695,8.92175,8.39701,7.49781,8.27238,5.59716,5.55544,7.22858,5.21135,7.72727,9.9635,3.54733,4.14406,5.21987,6.4705,6.60203,6.62248,9.89687,6.08577,5.10128,6.26108,7.67064,9.51246,5.60303,7.73628,6.68741,9.09654,10.0545,4.34749,7.85394,9.40056,5.59449,7.47705,8.765,6.75218,4.58345,8.36091,8.91505,6.12018,5.86059,8.55761,9.45337,7.23417,7.84362,6.24521,7.85984,8.08226,8.66191,10.7494,6.2704,4.98726,7.57661,5.47506,5.91817,7.26079,6.63336,7.18258,7.38452,7.09281,9.73878,7.42186,3.196,6.46466,6.85721,5.64398,1.72763,4.91302,6.20265,6.55141,4.89455,6.40984,7.00442,1.97854,6.60675,5.72388,7.47017,6.65734,5.20087,10.1264,9.35844,9.93256,6.10152,6.61071,3.42059,10.2514,10.6643,7.19822,4.96992,8.62377,8.92464,5.96035,1.72675,1.70186,2.75682,4.42476,6.3424,7.30123,5.45911,4.07464,6.41601,5.44769,5.26424,4.83752,7.5878,8.8988,8.42143,4.5486,6.54995,6.48342,4.27473,6.57988,6.64385,6.541,6.93178,5.33658,7.17475,5.30333,5.22803,7.37053,5.97177,9.21603,7.22686,5.35982,5.49337,7.47907,4.08809,2.42061,6.97147,5.80061,5.24545,7.08824,4.3359,8.09971,6.17704,9.05111,6.14198,4.30224,6.37673,3.11924,2.4083,6.90859,6.71357,4.72542,8.54162,5.14414,4.24545,7.14954,4.14305,4.95971,5.83558,7.27295,6.6776,6.3271,6.77904,6.75057,6.4351,5.58432,7.06596,6.17316,12.1575,10.111,7.45497,10.543,7.86674,5.6616,5.55727,3.13076,3.84171,3.95768,8.54834,9.44388,6.47531,3.9594,4.25008,5.31111,3.40359,2.08365,8.5893,6.62152,4.65301,5.07534,4.02596,7.84644,5.56895,3.17934,4.87677,3.40717,10.1283,13.7415,4.40435,4.95017,5.73357,5.70099,6.58449,6.92345,9.32071,4.88386,4.97486,8.32649,7.72332,10.3997,6.19146,2.78071,5.26434,3.78346,5.2584,4.37238,4.24064,6.42556,5.11686,5.94337,5.85066,5.60469,6.65457,4.51564,6.32087,8.53919,5.72962,4.62008,7.3159,7.08441,6.14552,8.90429,9.76852,6.74082,5.90969,5.59285,5.4023,5.69248,5.29919,4.93225,5.42167,5.81849,4.27998,2.64611,5.61079,5.23721,4.47995,9.37431,10.8313,8.64387,6.08857,4.96745,6.6918,3.72305,2.4651,5.67022,6.39471,4.29477,4.63897,3.6905,5.713,6.04162,7.42281,7.21268,4.14181,2.35153,5.11949,6.15948,5.66839,4.51564,4.77245,3.40899,1.95581,2.72124,4.60513,2.93476,5.16584,3.89978,5.45566,4.01077,2.74339,4.3978,2.64062,2.24374,6.15478,5.94904,3.66659,3.14471,2.22489,3.68036,7.39076,5.15884,5.81874,4.95713,5.72994,4.03083,7.17409,5.68577,1.87436,4.23286,7.74038,4.02645,5.71516,4.47139,2.88601,1.34899,5.9689,6.64192,5.55253,4.43799,5.37311,4.20484,3.90424,2.97487,7.12481,4.70089,3.78916,4.71613,3.59056,5.49621,3.90761,5.3793,3.01026,5.2767,6.04058,3.89809,7.38737,7.46679,6.94896,3.1224,7.23945,4.47282,6.02813,4.26653,6.45183,3.55759,4.38888,2.3314,4.09005,4.09618,7.01807,7.92332,2.57594,1.4516,3.80139,2.85153,4.526,2.95957,0.891917,1.0067,5.48831,6.3892,3.36219,3.49763,3.81318,6.9569,3.97287,4.08503,5.31586,3.98773,2.8194,2.63317,3.24586,2.18096,5.64115,7.67459,2.7333,6.74019,5.48565,5.21671,4.93793,4.00125,8.55235,5.1438,7.6802,2.27811,4.07799,4.38379,7.92439,4.55979,7.96389,7.65612,2.22813,6.39424,4.09565,6.5597,5.64355,4.51623,4.98047,2.55992,4.57418,5.25715,7.7982,4.74611,5.16195,4.4971,5.35797,3.2785,2.76785,6.69122,1.86167,3.46838,3.87942,3.7766,3.15953,2.64568,4.49304,4.96133,6.29196,2.92465,4.77175,7.19847,4.31114,4.92086,5.50869,5.89188,7.38513,6.39024,4.20076,6.35917,7.07936,6.02679,2.98483,4.5333,9.57666,7.57373,2.88024,4.41503,5.14872,7.39333,7.94239,5.09759,3.31118,1.81625,2.13669,3.73446,2.84688,4.60102,4.64702,4.07116,4.7873,4.8208,5.50202,4.97798,3.42483,2.55241,3.78577,6.33527,2.98949,1.89233,5.0369,3.34188,2.82989,4.37083,4.97218,5.98388,4.91195,3.29528,3.18162,5.6862,4.0546,2.80444,1.66403,2.46611,2.83708,2.22815,2.80492,4.99011,5.04649,2.78082,3.84468,2.62264,4.14183,6.71105,4.57126,6.10901,3.34258,2.17876,1.8002,4.18783,4.94411,6.04478,4.97926,2.82013,6.10121,3.1533,2.5981,3.23868,3.45975,2.02776,3.15258,3.61058,3.95272,2.40478,2.76241,4.17867,3.1206,6.97257,6.81,3.64165,1.86523,4.35899,6.44826,3.29651,5.96474,4.49595,2.19964,2.94123,6.08003,5.63898,2.34999,2.90852,3.83743,3.85751,3.3709,3.2459,3.39337,2.21082,4.09279,4.36655,2.48551,4.01989,2.88159,2.40516,2.28697,5.87099,5.57557,5.26123,5.69587,3.68892,2.32512,3.41914,1.59037,2.0925,2.30139,4.09491,4.02689,3.60761,3.04243,6.86295,5.53672,5.11506,4.23825,5.33723,3.2759,4.94201,8.48675,9.07346,8.41049,11.052,11.049,9.49398,8.56326,9.10299,10.7885,5.78585,4.60545,6.28185,5.0151,3.69126,4.23896,5.86491,2.7305,1.52857,4.36393,4.34081,4.68105,6.37566,5.55671,4.66543,3.34962,3.83194,2.30857,5.17639,4.23606,2.10939,5.70856,2.50909,3.30461,3.62528,3.81264,7.86005,3.10399,5.05582,5.0648,5.33477,8.70802,7.86224,7.95147,1.71855,4.37082,4.72174,5.74562,4.57924,3.69789,2.31999,4.75632,5.59123,3.87357,3.66039,1.79389,2.40969,2.81075,2.78657,1.60301,3.35522,3.78535,4.99335,5.73241,6.1046,3.3138,1.18342,5.93315,7.05748,5.68774,4.25111,2.76285,6.9565,6.31012,0.593006,3.93676,4.24328,2.10463,3.68645,4.32665,6.349,6.54876,5.62976,3.56726,4.05139,2.32953,5.03664,2.70445,4.27804,6.05513,3.65883,4.59198,3.09992,6.17784,7.59432,2.03606,3.93356,2.51633,3.44219,2.69127,4.09566,2.97072,2.95892,1.16486,4.25932,3.76783,4.89511,4.6052,3.24418,2.26026,4.27185,5.27855,4.32425,3.26968,2.90223,4.80536,3.51211,4.51102,8.09556,4.42316,4.21117,1.28184,0.905271,5.65112,6.6285,5.31595,5.56678,6.65157,7.60275,6.48263,7.99729,6.27936,4.66327,3.67761,6.26551,2.57128,4.00942,3.4527,1.73149,3.6607,1.65956,2.88996,5.35587,6.76921,6.24535,4.62759,5.27938,4.25923,5.31215,4.71602,2.93102,4.23432,6.27722,3.2306,1.89294,2.36962,2.73078,5.73944,2.79531,2.86627,5.54974,4.99433,6.4444,3.46813,6.12451,6.22002,4.65624,6.93031,5.75454,5.77549,10.0704,6.04268,6.53714,8.13457,5.81748,2.57319,2.55584,1.53656,4.03284,3.16789,4.03213,2.58079,3.04766,3.84378,3.96085,3.63279,3.56325,3.51812,3.9435,3.78212,2.87555,2.55801,4.55247,3.89822,5.43473,3.16254,2.94143,5.5056,4.25464,2.96913,3.75055,1.55882,5.35765,5.52134,3.70258,2.52365,3.64302,3.59222,2.5162,3.43081,6.12775,5.67141,4.30312,4.69744,6.37733,5.40692,2.4095,2.90842,3.40334,5.00626,3.37969,1.96894,2.31495,0.399567,3.68094,4.53177,2.39427,6.24833,6.92641,5.11117,3.27608,4.05986,4.11696,2.23617,2.23498,3.25,4.88989,3.93025,7.48516,6.00469,5.19731,5.06005,3.42611,2.32436,3.72241,0.890872,2.66531,3.41812,2.89915,4.17983,0.857177,3.88207,3.96423,1.69852,4.12363,2.99699,3.85513,3.71432,4.96203,1.61763,2.00978,4.57537,4.26649,1.31723,2.89247,2.68373,6.20565,3.62179,4.97313,0.620216,2.93692,3.21843,6.00204,3.3585,2.33529,3.31856,8.74514,3.08512,0.74918,2.41809,2.25741,5.1002,1.74608,1.71675,1.02401,2.67072,2.26967,2.67674,4.37115,0.885074,3.13983,4.09246,3.10848,2.81976,1.68632,4.97049,3.50616,5.48869,2.81663,6.23871,4.41928,5.73806,3.69503,1.9877,1.70395,2.50376,2.54697,5.40169,2.77169,4.4853,2.21199,2.16459,0.617397,2.9998,1.96897,1.97439,5.53859,5.13435,2.04989,4.18505,3.77529,4.95124,5.42558,2.99617,2.18791,3.35113,3.20227,4.93556,6.7939,5.34761,3.25748,5.33288,5.42873,3.47854,4.61631,4.1511,3.53743,1.58905,1.57646,5.22408,6.64122,5.44494,3.22233,3.12046,1.96836,4.26906,5.03294,2.20341,3.82518,3.33317,1.07472,3.35721,3.47957,2.88963,7.42076,3.13463,2.04794,3.23409,3.43115,1.21245,2.9704,3.97954,4.98247,2.78718,6.15262,6.99282,5.9967,3.65083,5.8232,5.49422,3.1579,2.45931,1.98421,2.96004,5.96366,6.742,6.01284,5.39094,2.14616,3.00006,4.12488,4.7844,1.64067,3.04163,3.04925,4.52939,3.66231,4.1719,4.62271,4.74459,5.01177,6.21445,5.06189,3.78788,5.66321,5.81487,4.6735,9.08263,5.88116,5.68472,3.65272,4.8185,3.3076,3.38876,4.1171,1.85716,7.82327,6.18089,6.70288,6.11771,4.50413,2.624,3.61356,7.18937,4.9517,4.74551,5.43031,5.79681,3.39481,8.2241,5.45034,5.79424,7.63409,6.14411,6.16683,8.95472,9.03897,9.81863,6.23561,8.60805,9.45003,16.2352,13.6814,13.431,17.4363,14.1037,17.3037,30.0307,39.6465,47.9994,70.9297,90.6553,118.004,181.968,203.621,238.34,274.642,286.228,302.806,316.485,318.075,278.98,243.248,197.544,144.252,103.083,68.9739,59.7864,38.1249,24.0986,15.0077,8.77654,7.13294,4.27093,2.06529,1.35392,1.96073,1.85261,4.25382,1.38762,1.69872,2.63299,1.58103,2.08467,2.28836,2.60142,3.57346,2.48744,2.26178,0.0327439,0.499674,1.49574,4.17598,2.16756,3.74134,2.45138,2.3609,1.39174,1.61666,1.00456,0.46682,1.98242,3.58107,1.72952,2.64949,2.17641,2.17865,0.330091,0.671774,2.27741,0.743072,0.307742,0.753247,1.45108,1.55802,1.9328,2.30487,1.82314,3.65729,2.3006,1.21897,0,0.828009,1.29903,1.40556,2.75738,2.44272,2.69395,1.24132,0.332036,0.930339,2.71079,3.13109,5.82321,4.65038,4.12332,0.630859,0.427273,1.38095,0.939825,2.12709,3.0673,2.8741,0.851005,0.83116,1.35454,0.813438,1.02012,2.13916,4.31185,2.41558,1.33892,1.23138,0.876327,0,1.2055,2.89717,5.46561,3.72293,3.59031,1.29177,2.97291,3.089,0.764803,1.98356,1.99817,0.684499,1.00087,4.61008,5.06416,2.59944,2.4992,2.56002,2.5786,2.65643,1.60386,1.96282,0.867811,4.70667,6.75286,3.30957,3.07744,1.40508,1.07887,0.878272,0.62271,3.6845,3.2337,0.877042,2.16003,2.22072,1.63247,1.00436,1.70695,3.86477,3.44952,2.94024,2.72602,2.52395,1.95813,0.724701,2.16362,2.87115,2.47972,1.89673,2.26309,1.92862,1.90935,0.279633,0.653513,2.84857,3.23029,2.4393,1.49261,0.746133,1.80403,2.57702,2.01375,2.19478,1.02358,1.31301,1.5227,1.09887,3.06142,2.07979,2.16829,3.57993,3.04716,1.72884,2.50059,3.48967,3.05079,1.99126,2.49369,2.26681,0.761971,3.07158,2.77284,2.05918,2.29375,4.32311,4.23933,4.27588,5.8164,4.10229,3.25522,2.49639,3.1291,4.30569,3.1942,2.22724,2.59572,2.89863,2.01311,1.49446,0.847992,1.00429,1.99621,3.35235,3.15677,2.7689,3.06627,2.40521,0.659512,1.20038,2.72381,2.39382,1.78863,3.03902,2.35872,3.33161,2.4646,2.89338,0.806016,2.18359,2.90199,4.43203,4.67445,3.85399,1.73406,3.32316,2.06989,1.63575,0.191099,0.883388,1.7592,3.01448,4.70634,4.39717,2.8951,2.75034,1.72683,2.67462,3.3581,1.76469,0.0697523,0.770182,3.75053,3.10559,3.43064,1.92276,1.776,1.3497,1.65484,2.09482,1.1267,0.67972,1.09125,3.29895,3.21603,4.75863,5.60586,3.06914,3.01442,2.0368,3.22975,6.3702,5.09531,5.44083,2.22424,4.4028,2.00227,1.74401,2.39885,2.92939,3.02552,3.30953,3.87433,2.29025,2.46566,5.75738,3.57938,1.66308,2.32557,2.36352,4.56382,2.01838,1.69129,5.01964,4.95455,3.83073,1.93581,4.14569,5.89497,2.28932,3.84879,0.562593,0.66083,2.39222,1.13522,1.47213,2.19424,4.36607,4.95415,1.87272,2.51394,4.81706,1.27442,2.20492,3.25048,2.43056,0.716279,2.75256,4.31147,1.34091,0.936941,1.01231,1.75575,2.26087,0.670087,2.25948,1.69723,1.11167,1.46034,1.48067,1.70033,2.6957,1.0289,0.269531,1.06744,1.63271,3.54268,2.48429,3.19425,1.5561,2.80606,1.88113,1.37191,1.46343,0.776838,0.223162,0.937662,0.452963,1.00416,0.805994,2.5462,1.60954,1.33417,1.72793,1.75855,2.43882,1.34115,0.870982,0.171875,0.928485,1.91081,1.0038,0.156901,0,1.30346,2.67187,0.0587067,1.83316,1.39534,3.99795,3.17935,1.96004,3.14595,2.23543,1.76624,3.61138,1.97006,2.10154,2.32306,3.05932,2.2869,3.02689,2.75915,1.86156,2.94981,2.88901,2.67272,3.19924,1.69044,0.30405,3.90647,2.44446,3.05598,0.340467,0.611328,0.467626,2.58015,1.62583,2.10828,2.77027,2.26229,2.51765,3.10664,1.33541,2.32824,3.36985,0.916435,0.835378,1.62491,0.539714,0.504535,1.49547,0.863014,2.48848,4.80703,2.79369,3.08105,2.4625,3.40242,2.21725,4.26681,1.13598,0.572739,0.909032,0.0948668,0.905133,2.21867,4.98418,2.79715,0.77575,0.22425,0.109162,1.6712,2.12619,2.68791,4.84156,4.19854,4.66977,4.0324,4.13012,4.59109,2.47573,6.88706,6.16518,1.54991,3.15453,3.33703,0.907447,3.67362,3.92002,3.81111,1.17468,1.5453,0.340467,1.52854,2.71857,2.57088,1.18201,0.823496,1.1765,1.09968,2.93404,3.59514,1.96618,1.3349,1.07007,0.179987,0.820013,1.95958,0.0404172,0,0,1.25324,2.36512,2.10269,3.48561,4.22959,3.65412,2.7732,2.09805,2.70534,1.46009,1.99688,1.74895,2.05901,0.727179,2.64879,3.31368,0.716347,1.47852,0.62436,2.55923,1.25465,1.98634,1.68721,2.15779,1.2825,0.63151,0.417482,1.24205,1.54429,3.77606,1.13868,1.53133,1.73616,1.61395,0.867123,3.16591,4.76893,0.617316,0.580729,0,0.42212,0.852733,2.00136,3.13669,2.86826,1.2583,0.460535,0.198697,1.08999,1.68687,3.86918,1.15526,0.883105,3.17302,3.52096,0.422922,1.75968,3.62074,1.92887,2.28953,3.02755,1.79471,0.897095,2.29896,2.04496,1.34795,2.52185,1.9569,2.05061,1.70296,2.18955,3.14277,3.35378,3.61245,1.20449,0.914763,0.339818,1.15575,1.94149,2.7834,4.92172,1.47865,0.821273,2.32358,0.947019,2.27493,1.01237,0.339818,0,0.621745,1.03909,1.68868,1.06091,2.89434,4.60084,2.0944,1.20292,1.96581,1.49145,2.05434,2.27828,0.00719895,0,0.66083,1.65665,1.49083,1.24142,1.64187,1.00466,2.79461,0.509126,0.230469,2.16029,1.03029,1.95256,0.626389,0.950646,1.04935,0.855479,2.68233,1.34328,2.11891,1.24921,3.50486,1.56466,0.736759,0.944517,0.0811518,1.49865,0.420195,0,0,0.660402,1.10742,1.56377,2.5464,1.122,0.650227,3.51873,4.03091,1.83465,2.81007,2.15542,0.481795,2.00875,0.509456,0.27112,1.38993,0.33895,0,0.620825,3.60287,2.93746,1.07564,1.96939,2.17363,2.04923,2.04898,2.9558,1.08015,1.38388,3.17537,4.78218,1.88923,0.255375,0,1.13298,1.52914,1.10595,2.43718,3.21583,4.02799,3.28312,3.91552,3.6066,2.87552,0.870174,2.0862,2.83631,2.1614,3.60889,3.53279,6.29085,1.48355,1.21414,1.44799,2.47631,2.43448,3.4401,3.51613,0.470859,2.56696,3.3144,2.07481,1.54482,1.25934,1.13929,1.31914,2.36481,2.39917,3.22166,2.04821,3.80443,1.94297,2.35375,2.07857,1.17692,1.05397,0.928178,1.24858,4.70977,1.42095,2.03674,2.59663,2.42259,4.78725,5.13502,5.78008,5.75398,8.26702,4.40401,4.21138,4.3452,5.48988,4.22238,2.20361,4.52783,2.23944,0.978448,2.64452,2.55398,2.54982,2.12117,5.07175,6.00978,7.20912,7.22257,8.2054,5.32945,9.58793,1.99547,5.85784,7.11611,5.90435,8.59048,6.04374,6.69074,4.67605,6.79195,3.26885,1.18674,1.28901,3.18368,2.57285,2.38292,2.82664,2.09811,2.36044,0.781783,1.42495,1.48133,1.53172,0.0665796,2.63344,2.49106,3.17795,2.60008,3.88545,1.87739,0.999569,2.77173,2.49823,1.22514,0.839967,0.551702,1.86367,1.46128,3.47675,0.93259,0.714007,0.659268,1.34073,2.27996,4.90826,4.72934,1.83505,1.2422,1.68691,1.43266,1.5512,0.334413,1.78999,1.87559,0.830361,2.25585,0.914217,1.26405,2.51853,2.44472,1.90526,0.653252,1.54818,0,0.403257,1.44874,0.148003,1.0361,3.5423,0.848685,1.47468,0.0982318,1,0,1.43452,0.565484,0.459935,1.13802,2.74643,2.20597,2.44964,1.24095,2.42636,1.81661,3.63061,0.885471,0,0.853801,1.02125,1.12495,0,0.180747,1.3824,2.17856,2.82888,1.00428,1.51401,1.35282,3.2451,1.54368,3.07185,3.56074,2.48743,3.35525,2.4248,2.13507,1.40299,1.2177,2.08139,1.66185,1.86671,1.50373,0.514025,0.485975,0,0.533594,0.466406,0.660156,0.339844,0.66276,1.71477,1.54574,0.076723,0,0,0.453176,2.21973,1.79961,3.30837,2.15869,0.0604289,0.561518,0.814133,2.61387,1.74337,1.60667,2.56816,0.0922677,2.33721,5.27784,2.34664,0.69495,2.89923,3.76446,3.86476,5.31901,4.7779,2.434,0.967041,1.77238,1.28722,2.67736,3.40891,4.29859,3.93629,5.99594,4.1647,1.54899,1.71681,1.00522,4.00778,1.31392,2.88451,1.16814,3.57572,1.55449,2.59389,2.09421,2.3797,2.35377,2.43737,2.93118,3.04657,1.15566,3.59357,1.08573,2.31761,2.55811,0.461807,1.89253,1.00391,1.32218,2.75538,1.66652,1.35032,1.94531,0.238924,2.87356,2.86539,0.150298,3.97206,1.17654,2.7838,1.95051,0.059255,1.65733,2.00019,0.326848,1.92576,6.51406,3.73058,4.09272,1.83153,2.06121,4.0657,7.43685,4.93137,5.42064,2.06604,1.92354,0.646715,3.37933,1.29834,2.08249,0.593129,0.6738,0.810837,1.51536,0.120858,1.27443,1.36773,0.454342,2.45296,2.25936,1.75439,2.22561,2.13052,1.4349,0.524902,2.24383,3.71734,2.03883,0.782082,2.03877,1.05912,1.67501,1.27901,0.901324,2.91088,1.8511,1.83517,1.81011,2.10775,1.7653,1.80422,1.18015,0.676394,3.15073,3.69861,2.8431,3.4107,2.10665,3.18062,1.78252,1.15068,0,1.12149,1.64029,0.23822,0.321824,1.48433,0.414547,1.53753,3.06114,1.35273,1.78946,0.716337,1.1989,0.123198,1.65684,0.598849,1.12281,1.52595,0.717988,1.61423,2.93961,2.76678,0.464103,1.24796,1.59049,1.95204,1.79253,0.897162,3.42111,2.46054,3.62031,1.6107,0,0.325309,1.59781,1.62221,1.45468,0.272255,2.67505,2.53999,1.21843,2.92426,2.37002,0.679637,1,0.491941,1.52977,2.54342,2.05069,0.952252,1.26834,2.10754,1.37641,0.553231,1.60237,1.40727,2.27354,2.49103,2.24669,1.74361,0.682261,0.83105,1.85063,4.1287,4.39717,3.85416,2.05614,2.50145,2.28042,3.32193,1.66746,1.92069,3.31191,2.15084,1.72744,0.45776,1.2037,1.80114,2.92883,2.10431,2.13698,3.70132,1.66596,0.973255,0.0267449,1.05455,1.93728,2.95377,3.6349,1.41892,3.32832,2.02398,1.65351,1.38203,2.51344,3.14541,1.95389,1.86722,1.48239,1.40417,1.9417,1.00936,1.44695,1.63799,0.210216,0.380859,2.23797,4.65627,1.56446,1.4305,1.99297,1.82826,2.57148,1.19364,1.78422,3.81298,7.16901,4.66866,4.21345,1.4455,0.714484,1.65326,2.46595,1.13093,0.549629,2.38645,2.40036,0.810213,2.62481,0.313675,2.15544,2.30915,1.53541,2.38289,2.65282,2.23477,2.20515,0.655342,1.34825,0.588188,1.89611,1.77732,1.61402,1.94021,4.53522,2.93078,1.88153,1.99934,1.75101,0.60705,0.261468,0.738532,0.0201954,0.979805,0,0.438356,0.561644,0,0,0.689364,0.835652,1.4791,1.76702,1.22887,2.15735,3.55713,1.93526,2.27588,2.07438,2.17036,2.73736,2.11155,2.21904,0.761684,0.690661,0.876941,1.69775,1.26741,2.89868,2.16282,2.20131,0.204427,0,0,0,0.73355,0.844747,1.00195,1.72556,2.58114,2.39111,2.62624,1.77281,1.11876,3.49048,1.71365,1.65596,1.96421,4.53821,1.84162,0.80013,0.808707,1.92486,1.4663,0.958402,2.62538,4.4164,4.14498,2.95043,2.19319,3.02749,0.68372,1.43772,1.25619,1.11811,2.01382,0.211929,1.28862,0.673616,0,0,0.0572917,2.15062,1.67068,0.481019,1.33514,0.674631,1.6177,2.34149,1.6436,1.02783,0,0.69585,1.94324,2.14708,2.1676,2.52712,2.5191,0,0,0.988251,0.147078,1.79624,2.3238,1.74464,0.216252,1.24759,0.731055,3.21549,0.845836,0.743775,0.0247396,0.97526,0,0,0.887248,1.16028,1.75333,2.41426,3.82819,2.55906,3.42945,1.96818,0.793129,1.94566,0.678366,1.51516,2.21232,2.09609,2.20906,3.57764,1.45109,2.63875,2.31687,1.56586,0.760884,0.843677,2.46461,2.55784,2.37298,2.5512,3.22253,1.2446,2.28165,1.14991,1.679,1.8711,0.314453,2.65745,1.52515,0.502947,1.31086,1.42084,1.2683,0.545157,0.454843,1.36766,1.72498,0.907356,0,0,0.723127,2.06029,1.94931,1.00473,1.08527,1.83102,0.767646,0.578604,2.81282,3.88126,1.75276,1.44314,0.11002,0.466406,1.377,2.66616,3.23849,2.443,3.31041,1.49854,1.32934,0.670661,0.342671,1.11566,0.541667,1.71266,3.00179,1.17486,2.98268,0.128005,0.897906,1.00976,1.46627,3.09769,1.46424,0.672747,1.34689,1.45825,1.56071,2.27526,1.39127,1.96458,1.29501,0.121667,0.977749,1.58006,1.64827,1.47919,0.292477,0.560182,1.35735,0.0824675,0.1074,2.44141,1.37712,0.811843,0.262231,0,0,0,0.709468,0.290532,1.14561,0.854391,1.89781,1.36319,1.9805,1.46862,0.289883,0.907003,2.6915,2.40149,1.46656,0.601188,2.69151,3.09588,1.22695,0.917915,1.47673,0.523275,3.15948,1.53965,2.90156,1.11138,1.02369,1.3881,0.876141,3.01707,0.982928,1.91514,1.99486,2.95515,1.84802,0.286827,0,0,1.41293,0.768062,0.835894,1.56121,2.8177,1.67596,1.97002,0.958225,0,0.836173,1.66038,2.08241,2.85211,1.36137,0.449892,1.55896,0.244181,0.954516,1.38547,4.61453,0,1.72924,2.28846,2.52839,2.98685,0.467064,0.84375,0.15625,0.901856,1.09814,0.0740741,2.46701,0.786386,2.28545,1.38707,0,0.345928,1.33695,2.50024,1.81688,0,0,0,1.93752,2.39471,0.667772,0.921224,0.798154,1.26622,1.50707,2.22652,1.03146,2.61616,2.30117,0.887768,2.5981,2.03572,3.21974,2.31184,2.22287,0.446982,0.609008,2.47395,1.66835,1.1475,2.6672,0.349414,1.86058,2.5681,2.28704,2.17355,2.27091,5.17798,5.72736,4.55305,4.48774,3.26692,8.92722,3.99789,7.17682,6.94226,6.36548,1.31468,4.24872,3.95357,6.27541,4.3748,4.55681,1.272,0.914714,1.07974,2.68184,2.3146,1.44292,1.48091,0.826723,1.28981,1.09645,0.911362,0.875651,0,0.35764,2.28355,1.35881,1.32961,3.39737,0.273022,0,0.701892,1.17613,1.12198,0.829677,3.1998,1.57654,0.393979,1.65178,3.37106,1.97716,1.17699,2.596,0.227006,0,0.691956,1.76642,0.541622,1.94303,1.82831,0.228665,0,0,0.281169,0.971922,0.74691,0.260417,1.00373,1.88128,3.82786,2.02671,0.99379,3.15225,0.853962,0,0,0,1.79075,0.209248,0.216765,0.783235,1.19935,1.76801,1.26324,1.09472,1.01582,0.945691,1.95789,1.40854,1.6639,1.0644,1.65445,1.69792,0.643014,1.74915,1.8739,0.349578,1.38518,0.439205,1.82604,0,0.0901372,0.909863,0.507363,2.22757,1.62241,1.63378,2.44703,0.936524,1.05343,1.3086,0.418546,0.866261,1.44363,0.790089,0.744764,0.391163,1.83398,1.77486,0.466797,0.533203,0,0.403509,1.00195,2.28478,1.30976,0.864317,1.63373,1.95226,0.821232,1.7837,2.6015,1.76755,1.45776,2.08865,2.29853,1.76369,2.58138,2.50289,2.06235,2.00158,0.978363,2.66129,2.33741,1.29079,1.37739,1.91503,0.258587,0.394651,0.605349,0.932547,1.21569,0.851766,0.742709,1.32989,1.91037,0.246492,0.770535,0,0,0,2.60067,2.1428,1.25653,0.999606,1.00039,0,1.20047,2.98808,4.08922,2.46737,1.8459,2.01913,1.94626,1.07248,2.72341,0.842306,2.07048,1.48133,1.78293,2.35611,3.34696,2.02297,1.98692,2.00971,1.48234,6.51793,4.94829,9.30513,9.59467,8.63221,14.0975,15.3227,11.4354,11.6883,22.1649,14.8454,19.3909,16.7478,17.1559,13.067,14.5388,13.7557,11.0453,7.38811,3.88667,6.89367,3.13015,2.23052,2.02344,1.28029,1.90216,1.18034,1.34755,2.66749,1.08138,0,0,0,0,0,0,0.874021,1.34119,4.11793,1.56047,0.106397,0.334424,1.85846,2.13969,1.65833,3.88365,3.40639,0.719057,0.754864,2.00065,1.05386,1.19062,0.617188,0.382812,0.627119,1.12904,1.84282,0.410806,1.48726,1.53951,3.73522,1.26409,1.62884,1.93645,0.398837,0,1.65885,0.34115,0,2.8317,2.02099,1.85434,0.978479,1.21748,2.09701,0.744398,1.31847,2.31234,1.31282,0.311969,1.00865,2.89224,1.19287,2.64233,0.462677,2.05043,2.86677,3.55744,1.53678,0.789817,0.723197,1.25295,1.02386,0.762152,1.05348,0.946362,2.91694,3.58999,3.90445,0.826625,0,0,1.04897,1.19517,0.755859,1.98729,1.01271,0,0,1.96857,0.0314342,1.76738,1.00145,0.996905,0.406138,1.60345,0.990564,1.39921,0.834898,2.21437,1.71092,1.59207,1.24918,0.233463,0.957682,1.15022,0.892098,0.891085,2.8774,1.21264,0.627263,0.391618,0.768483,0.477611,0.977074,0.776832,0.0143322,2.48609,2.43457,3.65935,0.405658,0.829649,1.00238,1.45312,0.714844,0.0572917,2.55224,0.457566,1.77695,0.307184,1.84876,0.820446,0.179554,0.840864,0.358484,1.80065,0.335286,0.664714,0,0.866797,0.810096,2.0658,2.0423,5.32201,3.68762,3.90373,0.301647,0.161564,2.16119,2.94774,2.38866,1.34085,0.185016,0.814984,0.606021,2.80916,0.584817,0.843183,1.15682,0.799608,1.43622,0.764175,0.133595,0.866405,0,1.09902,2.62106,1.51502,2.55062,0.21428,0,0.224623,2.19202,1.22528,0.612821,2.27648,3.88382,0.584953,0.664495,0.335505,0.315652,1.62691,0.384477,1.35012,1.65922,1.44508,0.218547,2.87071,1.2787,2.39225,1.43234,1.00132,0.398617,1.40816,2.18151,1.02014,0.585535,1.21476,1.5771,0.638855,0,0.583151,1.49518,0.921671,0.784695,1.0967,2.55863,1.11662,2.25128,1.79098,2.4011,0.629339,0.839371,0.552719,1.15843,0.820144,0.16906,1.52073,1.68059,2.35816,2.12107,0.352088,1.26193,2.39965,0.897531,0.239187,0.876873,1.2455,1.66948,1.20815,0.259791,1.08206,2.28298,1.7362,1.42951,0.277045,2.57761,0.354818,0,0.59648,0.727933,0.675587,0,0.752115,1.0044,1.66113,0.58236,0.494764,1.47983,0.408566,0.616841,0,0.103247,0.950453,1.74136,2.2431,1.54235,0.626272,1.90889,1.57555,1.22285,2.2483,0.961667,1.56385,1.79254,2.2003,1.31928,0.79572,1.85026,1.05933,0.520629,0.774067,0,0.146199,0.853801,0.27654,2.39127,2.10823,0.33138,1.32094,1.57164,0.79544,1.27444,1.76902,1.57102,0.728187,2.77431,1.08758,0,0,1.63804,0.361956,0.925393,0.247897,1.77723,0.851036,0.198444,0,0.982973,1.1871,2.00895,1.917,1.91528,0.988706,0,1.23489,4.5415,3.47996,1.7495,2.93443,3.86386,0.303179,1.54362,0.57907,1.00195,0.768031,0,1.13411,2.24043,5.10583,2.51963,0.450576,3.29081,0.815617,2.87604,1.56696,0,1.60445,0.665357,1.55326,0.176933,0.0325733,1.23756,2.45613,0.547943,0.725796,0,0,0,0.809987,2.35702,0.96646,1.39518,2.84893,0.860926,3.1428,1.6187,2,0.162004,1.68191,1.27799,1.48096,1.39714,0,0,0,0,0.779318,1.22068,0.759556,2.34292,1.21815,2.27426,0.527088,2.49509,2.19875,0.525307,1.36278,1.94835,0.347741,0,1.7471,1.2529,0.527995,1.20561,3.08416,1.20974,1.18529,1.60562,0.938781,0.242801,1.17422,2.39386,2.74445,2.0673,0.62017,0.383117,1.91421,2.33679,1.36589,0.766042,4.02134,2.21262,0,1.16151,0.838494,1.37029,4.24405,2.20733,1.12049,1.05785,0,0.788899,1.62993,1.34805,3.71087,2.73374,2.03902,0.749494,1.06448,2.48805,3.09599,0.862737,1.48875,0.53376,2.73624,2.8715,1.68406,0.174449,0.967463,2.80577,4.15328,1.90099,1.56808,2.24964,3.56089,3.33768,3.17939,2.5771,4.40197,4.11545,2.82316,4.1527,3.33311,3.52759,4.31435,2.62736,2.2399,1.16414,0.543974,1.31706,2.28993,0.849035,1.81626,1.01513,0.168612,0.859421,1.97316,0.680094,1.0026,0.48473,0.519481,1.15489,1.93566,0.389974,0.81749,1.18251,2.23791,0.762091,2.86551,1.96912,0.16537,0.835821,1.4503,2.26069,1.78652,3.51272,2.95042,0.203523,0.240995,1.44976,1.00436,0.304886,1.29688,1.541,0.162127,0.998035,2.4378,1.43175,2.76771,2.45514,2.17145,3.35155,3.13918,1.79552,1.45187,1.39844,0.601562,0.851417,2.14858,0.785528,0.214472,1.44401,1.40471,1.37025,0.849431,4.503,1.4286,0.0820312,1.82373,2.51757,1.2011,0.375569,0.944335,0.824695,0.230969,0.845006,0.154994,0.784505,0.284685,2.60391,1.12378,1.23586,2.66641,0.30085,0.903583,1.00521,0.910984,0.180221,0.828125,0.171875,0,2.64117,4.4865,2.20808,4.54756,4.32308,0.79362,0.964844,0.0351562,0.870527,1.10864,0.0208333,0,0.899804,1.09889,0.00521258,2.6028,1.39329,0.967178,1.3017,1.70229,0.0288336,0.853437,0.18823,1.88737,0.122429,2.1021,1.20999,3.91797,2.51767,3.05609,1.95496,1.92334,1.077,3.69301,4.28756,2.20884,0.979818,1.98875,2.03143,1.74202,0.87663,3.37027,1.01368,1.52353,2.6198,1.7127,0.906654,0.257492,2.2378,1.5107,1.77618,1.31246,0.140078,0.315652,1.43849,1.29986,1.46263,2.68687,0.796497,0.216428,1.64544,0.138132,1.64913,2.21339,0.137484,0,1.11316,0.886835,0.490234,1.37358,1.95929,1.67526,1.32165,0.179987,1.46771,0.664447,0.867839,1.42154,1.41136,0.1671,0,1.59422,3.3283,1.92088,0.491449,1.53285,0.876323,1.25597,0.968566,0.217632,1.36742,1.44638,0,0,0,0.868096,0.524086,0.607818,0,0.78258,0.21742,0,0.102161,0.897839,0.954734,1.04527,0.439739,0.560261,0.710409,2.16313,0.584792,0.541667,2.26382,1.7054,1.31398,1.19953,2.5037,3.50843,1.38119,0.625248,0.773567,0.725131,0,0.927225,0.0727745,0.322855,1.26805,1.40909,0.75651,2.8227,1.45988,0.960908,0,0,0.137525,1.6501,0.212378,0.628747,2.33034,0.921584,0.720369,0.46745,0.931507,2.24727,1.72414,0.433274,1.43125,2.05504,3.36982,0.739205,0.562173,2.07695,2.08726,0.273616,0.992203,1.76866,0.239132,0,1.6394,0.360602,1.07712,2.28746,1.63542,0.43222,0.56778,1.17521,1.82479,1.89529,1.99187,0.605964,1.95154,0.555339,0.752934,1.58237,1.9478,1.00652,2.12487,2.29598,0.822723,2.03944,0.748953,1.53761,1.10191,1.03889,0.668039,2.33196,0,0.0623782,0.937622,2.56806,1.65906,1.80871,2.89354,0.0706344,0.672426,2.76506,2.53862,1.97807,1.04582,0.0314342,1.49624,2.09472,1.30024,3.34799,0.729372,0.674767,2.42758,1.81622,2.6365,1.57255,1.53059,1.2613,0.210139,1.53984,0.330514,0.677083,0.470052,0.852865,0,0,0.593381,1.40662,1.21238,2.20282,3.62657,0.958222,0,1.11132,1.88868,1.05132,2.43359,4.16806,0.38419,0.962842,0,0.0508475,1.70892,0.408416,1.43955,3.09742,0.294847,0.176088,0.909198,1.16013,1.1032,2.55735,0.281168,2.4553,4.07017,1.25074,1.23224,0.932023,1.69466,0.315104,0.86263,1.99342,2.00658,0.1557,1.26823,1.57607,0,0.218324,1.6417,0.324339,0.815635,0,0.848098,1.1519,0.207818,1.41046,3.20089,0.180834,0.39544,0.60456,0.560288,1.35052,0.0891927,0.843194,1.75733,0.826559,0.572917,0.977169,0.849402,2.65284,2.36585,1.15474,0.916991,2.0313,1.37291,2.98675,0.692057,0,0.742633,1.24606,1.01131,0,0,0.971185,3.28604,2.1278,2.2448,2.37935,1.36021,1.55215,1.25342,1.36707,0.771821,0.68616,0.992808,2.00719,0,0,0,0.577474,1.52329,0.899237,0,0.59544,0.622576,1.91441,1.86758,1.07286,1.94934,1.9778,0,0.92732,1.06547,1.85391,2.44128,0.71201,0,0.507161,1.00424,0.859619,1.27993,1.82931,1.51974,1.13049,1.23339,1.01767,1.94789,1.83919,0.83138,1.4228,0.577199,0,0,0,0.608242,1.98394,1.00521,0.402606,0.497708,2.04852,2.14865,0.688886,0.616241,0,0.777705,1.2717,1.19327,1.44837,2.83861,1.47034,1.28,0.719998,0.937743,0.97422,1.53313,3.53642,1.95817,0.89246,2.19021,1.55336,1.00151,2.57066,0.852117,0.601435,1.00627,2.74559,2.11745,1.47089,1.47752,2.14486,3.0881,0.347883,4.34713,1.65287,3.9198,3.02443,0.843255,0.905075,1.00607,2.27009,1.03128,1.58219,0.922036,1.44195,0.444451,1.43934,0.170033,2.21959,2.15905,0.621365,0.521767,3.17823,0.721875,0.578125,2.03471,1.49711,1.05723,2.29767,0.942151,1.76769,1.946,0.45744,0.546814,1.00254,0.450649,1.47576,2.05484,1.52669,3.47006,1.47265,0.949153,1.10024,1.03003,2.06157,1.82645,1.11834,2.9527,3.39285,1.55563,0.968939,0.0440986,1.0013,1.53776,1.05223,0.408707,0.332024,0.667976,0.958495,1.24488,1.16728,1.29772,3.90546,0.735913,0.690242,0,0.960441,1.37435,2.2864,0.945034,2.52329,4.01461,0.89588,0.616536,3.6701,3.37896,1.3344,0.690662,3.09358,1.21576,0.88776,1.251,1.65508,2.31958,2.07064,0.815941,0.82163,1.17837,0,1.61591,1.26751,1.11657,0,0,0,0.311198,0.688802,2.21322,4.0609,3.15745,0.568426,0.691358,0.308642,0,1.45609,1.24371,0.659804,0.640391,0.706303,1.00149,0.292208,0.281433,1.69261,1.13282,1.18891,0.704235,1.37901,2.5726,1.4557,0.592689,0,0,0,2.05912,1.92583,1.00916,0.00589005,1.57341,1.76064,1.64825,0.0176933,1.7369,3.08935,0.173747,2.59493,0.405066,0,0,0.944528,1.05547,0.137525,0.967256,0.895219,2.02892,3.66059,1.89367,1.2037,0.830023,1.3831,1.96885,0.782296,1.24885,0,0,1.25798,0.742016,0.582031,1.72791,1.00137,1.64116,0.727891,0.659517,0.660118,0.717277,1.28272,2.0789,1.5474,1.09955,2.2547,0.0194553,1.58309,0.983313,0.433594,0,1.76415,1.23585,0.590228,1.40199,0.0077821,0.635159,1.36484,3.24683,0.753174,0,1.70361,0.296392,0.995457,0.0045425,1.75309,0.246914,0,0.882391,0.783841,2.68425,2.64693,0.00259403,0.675393,0.999346,1.32461,0.899999,2.09935,0.00129702,2.52057,0.479426,0.873511,1.88877,0.237721,0.736979,0.265615,0.997406,2.93784,3.06216,0.0189172,1.81691,0.33397,2.93454,1.6795,2.09312,1.01294,0.110092,0.944156,1.00191,0.0539311,0.934512,1.01809,0.0474026,0.828013,1.00402,2.11133,0.185886,2.68267,0.329729,1.82847,0.0298895,0.201722,1.91093,2.13996,1.6379,1.10949,0.889831,1.09653,2.26349,0.750148,0,0.153997,0.846003,0,0,0.493911,1.50609,1.21611,1.78389,0.315104,0.970144,1.17841,1.53635,0.0162127,2.55287,3.74815,0.682768,0,0.6777,1.3223,0,0.365286,2.0006,0.651716,0.982399,0.0468313,1.95317,0.0207523,1.40885,0.647067,1.97477,1.0077,1.00146,1.00517,1.12444,1.8325,1.10686,1.4389,2.45491,1.16438,2.32273,0.928982,1.57533,1.07093,0.914286,0.455433,1.63249,0.912072,0,0.141927,0.858073,0.102014,1.59932,1.32721,0.971447,0.169922,1.87402,2.95605,0.22671,1.18187,2.59142,1.58418,3.85823,1.53844,2.01341,1.75574,1.01031,0.239686,2.15735,3.38957,2.91037,3.06927,3.16188,1.26296,1.88554,0.465345,1.27454,0.423177,0,1.44223,2.72216,2.97219,0.863418,0.338542,0.69972,2.87253,2.08921,0,0.971185,0.0288147,0.6311,1.5645,1.8044,0.866035,1.13396,0.842053,4.9785,2.44664,1.93541,0.797403,1.58486,1.58933,0.825802,0.213125,0.786875,0.542546,1.94389,3.34646,0.330714,2.47452,1.6284,1.00982,1.65244,2.79238,0.278827,0.968037,0.999386,2.52216,0.510417,0,0,0,1.30333,3.19692,2.75771,0.74204,0.792495,1.9829,0.224609,1.56641,0.486771,2.122,0.824822,0.0538262,1.4921,1.82957,0.729526,1.00652,1.45327,0.895912,0.539267,0.829967,0.170033,0.588542,0.411458,1.4432,0.556801,0,1.02188,2.34773,1.63039,0,1.33978,1.89264,0.767578,0.785917,2.74529,2.12374,0.924319,2.08567,2.39578,2.20691,2.39619,3.64558,0.690606,1.21645,1.77419,2.06252,0.946841,2.43655,1.56345,0.954285,1.04571,0,1.10133,1.25703,2.13174,1.50991,0,1.81598,0.184021,0.985677,0.788264,1.00456,1.11482,1.75326,1.78329,0.570124,0.0713359,0.928664,0.0416667,1.95833,0,0,0.989529,0.0104712,0.841042,0.177294,1.95849,2.09775,0.925422,0.0569372,1.47735,0.465709,1.03317,2.85022,0.116612,0.89316,0.10684,0.277014,2.65558,1.17086,1.34266,0.553896,0.0797665,1.03872,0.88151,0.934853,0.0651466,1.89967,0.100326,0,0,0,1.44634,0.637315,1.67063,3.24952,0.996191,0.481651,1.00276,1.82677,2.17776,1.00228,0.508772,0,0.755715,0.647035,0.59725,0.421466,0.578534,1.39296,0.607035,0,0.469548,1.78899,4.21726,1.11433,1.40987,0,0.777968,1.22203,0.546466,0.453534,0,1.15438,2.77777,2.4062,2.66165,0,0,1.70212,1.29788,0,0.983423,1.01658,0,0,0.70072,0.397204,2.37297,0.704351,0.824756,0.344401,0.655599,0.56901,2.59668,0.834308,1.39599,1.60401,0.815445,0.184555,0,0.631839,1.60188,0.945054,2.0901,1.12995,0.601171,0.819994,3.0916,2.26988,2.9392,0.879322,0,0.960052,0.326406,1.69194,0.455843,2.12002,2.19955,1.24619,0.10902,1.35257,0.538411,1.00525,0.994747,1.57702,1.53452,1.28204,2.86381,1.74261,0.250653,1.40375,1.34559,0.407166,1.77447,0.818365,0.854349,2.24747,0.898178,0.968383,1.25086,0.897491,0.883268,0.462999,1.08843,0.931868,2.24026,2.40201,1.17024,2.37198,1.33221,0.324607,2.21087,2.17426,1.71419,1.08747,1.68126,1.61643,1.91104,1.29199,2.69645,2.06124,1.23019,1.58688,2.65535,2.07434,3.07701,0.606418,0,1.39486,1.34336,1.60044,1.41297,0.914132,4.31028,3.42234,1.36137,1.05022,0.190039,0,2.25985,1.35402,1.08756,0.298566,0.650587,3.75822,2.37301,2.3886,0.829582,0.691099,0.442493,1.65862,0.342682,1.66225,0.202861,0.674935,0.977409,1.00476,0.480378,1.58481,0.323577,1.01041,1.72894,4.42782,3.39188,0.533865,0.861219,0.760417,0.239583,0,1.58358,1.23152,0.908854,1.0651,0.210938,0,0,0,0.994611,1.00539,0.760417,0.239583,0.270942,0.729058,1.63838,2.9671,0.394522,0,0.146753,1.73736,1.37092,1.63704,0.481458,1.67223,3.77172,0.182529,0,0,0,0.301299,2.66611,0.223444,1.28428,2.45063,1.95306,0.628385,0.73232,1.0235,1.99516,0.741809,0.557592,0.442408,0,2.04354,3.07694,0.879519,0.989859,3.08326,0.929487,2.09459,0.902803,0.00911458,0.990885,0.276873,2.67118,0.789654,1.85432,1.55158,2.04847,1.78577,1.00394,0.0182292,0.966234,0.0337662,0,0.194771,1.78052,0.0377282,1.85056,1.13642,0.0833333,1.15165,0.765013,0.367988,1.88561,0.746405,0,0.141927,0.858073,0.11849,1.12443,3.7348,1.0105,0.0247671,0.987013,0,0.0181818,1.31994,0.66188,1.49738,0.757826,2.86474,1.05278,0.859782,1.00256,1.35658,1.46513,1.14323,0,0.352789,1.64721,0.232587,2.02899,1.79304,1.12507,1.36188,3.11174,3.85785,1.48885,0.501724,1.49828,0.357131,1.64287,0.725564,1.49738,1.03713,0.922801,1.35176,0.465359,0.182879,0.817121,0.374756,1.98071,0.644531,0,0,0,0.606655,2.39335,0,0,0.398438,0.601562,0,0.120779,1.29643,1.53863,2.04416,0,0,0.581152,0.418848,0.192208,0.807792,0,0.933976,2.06602,0.879116,2.23218,1.75823,1.28653,0.843953,0,1.58076,2.7089,2.1244,0.585938,0,0.527344,0.472656,2.17997,2.54091,1.27911,0,1.74177,1.71265,1.11068,0.434896,0.507853,0.962199,0.529948,0.203632,1.27814,0.723691,0.794538,0,0,0.960733,0.039267,0.507812,1.96781,2.15706,0.36732,0.964752,1.21405,1.72501,1.09618,0.791184,2.20882,1.24026,0.75974,0,0.0234987,0.976501,0.0365059,0.963494,0.155963,1.5572,0.545609,0.741222,0,0.731421,0.699864,1.56871,1.0948,2.76907,0.136126,1.6446,0.976489,1.2842,1.0947,0,0.217899,2.08939,0.692708,2.58008,2.44409,1.63339,0.342448,0.61039,2.05888,0.330729,0.925832,1.97824,1.53964,0.613799,2.09825,0.844234,0.0850785,1.95857,4.20183,1.62953,2.08665,2.08274,0.955614,1.79167,1.94308,3.69923,2.65237,2.04197,5.94674,5.7874,3.646,1.12982,2.78317,4.71343,3.26177,5.14403,5.04357,8.04176,6.39263,8.42371,3.90875,3.1753,8.63753,7.75062,4.5254,2.25677,4.18357,3.51847,3.52524,5.71396,3.67213,3.52739,0.195143,1.20606,1.16784,1.73841,1.81604,1.03906,1.44876,1.29183,1.25941,0.0755208,1.87992,0.0445609,0.571056,0.986536,1.43979,0.351924,2.83315,0.817549,0,0.986121,2.01388,0.629243,0.370757,0.451235,0.548765,1.76804,2.23196,1.1213,2.82922,0.0494792,0,0.960988,1.00386,0.0351562,0.916307,3.03942,0.0442708,0.23329,0.76671,0.487013,0.512987,0.331033,2.67287,1.72817,2.04729,0.220627,0.828514,1.17149,0.261719,1.6924,3.38267,2.66321,0.344044,3.05307,0.91437,1.68851,0.346276,3.17908,1.14708,2.32756,1.8962,2.90551,1.51788,3.58381,0.703816,4.7965,2.68719,1.99784,3.6612,2.55995,2.16927,1.52083,0,0,1.61802,4.87662,2.66898,2.47468,0.765882,0.595828,0.25,1.32792,0.422078,1.11942,2.04855,0.832031,0.588312,1.15776,0.253927,0.475458,1.81881,0.705729,2.19449,2.217,0.795544,0.792969,0.609091,1.00209,0.388817,0.944159,2.39568,0.660156,1.57726,1.84627,1.49663,0.0798429,0,1.23296,1.31151,2.29741,1.15812,0.56193,0.43807,0.646753,0.637293,0.715953,0.653646,1.28624,1.06011,2.18553,1.81447,0.664499,0.335501,0,0.923861,1.71096,0.365183,0.336375,0.663625,0,0.581064,1.7705,1.33545,1.36428,0.948709,0.731675,0.268325,1.62989,1.87792,1.19478,0.703408,1.30141,0.292588,0,0.402344,1.42488,1.25248,1.76846,0.569801,1.13932,1.16868,0.839867,1.48813,1.43755,1.4234,1.268,1.59413,0.964505,1.59992,1.62056,1.37343,1.66453,1.27933,2.0867,0.633968,0,0.0301047,2.43817,1.17495,0.356771,0.597641,1.66566,1.3545,1.56178,1.82042,0,0.783117,0.216883,1.46722,3.92583,2.15121,1.12936,2.50057,2.11239,1.71733,2.55071,0.75665,0.9217,0.767016,1.68664,1.31336,1.05997,1.84505,1.09498,0,1.27871,1.54726,1.14665,0.811693,0.215686,0,2.53332,3.59971,1.86697,0.635891,0.364109,0.0143416,0.985658,0,0,0,0.664062,0.335938,0,0,2.42834,0.571662,1.78134,2.13818,2.69615,3.63941,2.30586,2.0302,0.505334,1.49199,0.411533,0.892068,0.726543,0.381389,2.00952,2.79048,1.45512,2.004,1.67317,0.99768,3.10388,0.966146,1.20223,0.797766,0.825589,2.13791,1.57066,0.465848,0,0,0,0.962274,2.03773,2.4405,1.5595,0.22526,0.77474,0.0182292,1.80859,1.05145,0.121728,0,0,0.262402,0.737598,0.614548,1.38545,0,0,0.143229,2.43138,1.3043,3.56294,1.86976,1.036,3.29729,1.35511,0,0,0,0,0.0891219,1.39412,1.51676,0,0.128272,0.871728,0.900911,1.45317,0.991012,0.693914,2.35734,0.96788,2.78608,1.84836,1.00134,0.420573,0.579427,0.629987,1.80621,1.91397,0.649836,0.510635,3.60293,1.89294,1.50905,1.9538,1.48608,0.395346,2.10085,0.548368,0.0338983,0.966102,0.364462,1.07273,1.65155,2.19251,1.08451,0.714761,1.44951,0.769844,0.70013,0.308594,1.35076,1.4704,1.28708,2.46179,3.88049,2.84141,0.399478,1.19641,0.803595,0.737503,1.38359,0.878906,0,0,0.752604,1.38802,1.36833,2.97824,1.64415,1.18116,2.01253,2.08412,0.59085,0,0,0,1.1314,1.99276,1.62552,0.404871,1.0028,1.73353,1.6524,1.45672,0,0.217448,0.782552,0.72751,0.27249,1.31473,3.56485,1.00916,0.294612,2.3754,2.44125,2.84337,1.92686,1.0045,2.52786,1.22803,0.469361,0.594298,1.4057,0,0.807292,2.7429,0.449804,0,0,1.8026,1.27061,0.926797,0,0.995587,1.00441,0.336801,1.13393,2.39889,0.130378,1.4987,1.51048,1.62103,0.369792,2.69427,3.30573,0,0,0.0704961,1.3321,1.07158,2.58044,2.34252,1.85113,0.75173,1.09068,2.91707,1.27184,0.720416,0.141176,1.72211,2.13671,0,1.42511,1.96546,2.60683,1.19035,1.62938,1.18288,0.411154,0.727771,0.861075,1.67378,3.44812,1.8781,0.591906,2.40809,0,0,0.065189,1.47931,0.529716,0.925781,0.791107,1.62653,0.582361,0,0,0.732554,3.07179,1.74253,0.453125,0.659686,1.43082,1.04639,2.09393,2.0631,2.30273,3.28455,0.846548,0.272251,0,0.469201,0.711789,1.24443,0.574578,2.01092,2.89955,2.08953,1.07995,2.78125,1.1388,1.14286,1.949,1.7323,1.17584,0.431907,3.0241,1.07141,1.80834,1.08037,1.56695,0.0169271,1.23641,0.763593,0.705111,0.730686,1.94441,1.3523,2.71278,1.62503,2.76168,2.94519,0.222805,0.672697,1.3273,0.451948,0.548052,0,0.795147,2.87329,1.33156,0,0.772632,2.82502,0.66496,1.73739,0.966447,2.03355,0.777344,1.29793,2.19493,1.71276,0.771927,0.245111,0.507923,2.42112,1.07096,0,0.815104,0.184896,1.13296,2.65714,3.02104,1.18886,1.01977,5.30583,5.35671,3.81611,5.79715,5.46249,4.75011,1.68057,5.17549,7.05013,5.62332,7.26902,6.44467,7.02996,2.44417,5.06542,3.60142,3.82918,2.53301,1.52005,2.24751,2.46503,2.07596,0.436931,0.992167,0.604187,0.403646,0.945312,1.30859,2.00657,0.739521,0.625,3.40491,3.5571,1.8539,0.621752,1.00644,1.47815,1.45275,1.2026,0.797403,1.5071,1.4955,2.14464,1.86446,0.988297,0,0,0.767806,1.85427,1.25334,1.12458,0,0,1.3678,1.26762,0.364583,0.74837,1.37438,0.947559,1.00381,1.4077,0.975809,0.542373,0.0898438,0.910156,0.749759,2.21907,1.58803,1.44314,2.28474,3.01805,0.697212,1.92635,2.95308,0.208273,0.912304,1.08152,4.22642,1.69207,0.272608,1.72739,0.370757,1.32625,0.478384,0.824607,0,0.492866,1.21455,0.292588,0,0,0,0,0.271298,0.728702,0.290576,0.709424,1.4459,1.50462,1.50326,0.546221,2.05159,1.1893,0.759115,2.01242,1.49018,0.497403,0.406291,0.834547,1.18455,0.574607,0.69401,1.30599,0.291885,0.995876,1.41107,1.4057,1.67021,0.738349,1.55823,0.928686,0,0.551047,2.02524,3.57381,0.849898,0.169271,2.51822,1.31251,0.68366,1.11894,0.197403,0.889031,1.11097,0.365885,0.634115,0,1.33569,1.94645,3.28961,0.428248,1.12752,1.77609,1.09639,2.397,0.602995,0,1.64053,0.359472,0.814621,0.185379,1.24001,4.57787,1.62353,0.558594,0,0,0.868146,1.00539,0.126467,0,0,0,0.260417,2.0892,1.18087,1.44593,0.0235911,0.783572,3.21643,0.945241,0.566478,0.488281,0.959583,0.0404172,0,0,0,0.332464,0.667536,0.990874,0.00912647,0.998698,1.27485,0.726456,0,0.924675,1.57542,0.499905,0,0,0,1.03549,0.964513,0.0533854,1.7466,1.20002,1.37116,1.05722,0.853968,2.34265,0.375,0,0,0.0989583,0.901042,1.77134,1.22866,1.35485,1.155,1.70295,1.45518,1.31385,1.12254,0.895639,0,0.151042,1.53906,0.470261,1.83704,0.0025974,2.11543,0.884565,1.10038,2.64181,1.99087,1.27994,3.36367,4.50576,3.43136,0.686198,1.16574,1.58426,0.25,1.14162,1.40884,1.21386,0.235677,0.566796,1.11383,1.35843,1.74479,0.216146,1.51156,1.21715,0.271298,0.913731,2.08627,1.48004,0.582383,1.3059,2.88596,1.50214,2.07561,0.242091,2.60296,2.0103,2.31262,0,2.05599,1.6069,1.33711,0.0922078,1.26847,0.639323,1.40186,2.91596,2.42537,2.25681,0.106494,1.8057,0.865155,3.81845,0.40421,2.32951,0.791267,0.91587,1.94762,1.53113,0.484598,0,0.13394,1.45231,1.94985,1.74218,2.69128,1.03044,0,0.153342,2.32996,2.97503,0.541667,0.192408,0.807592,2.57711,0.422888,2.02234,2.97766,1.08809,2.82337,0.0885417,0.278796,0.721204,0.793313,1.93502,2.76255,1.0638,0.782141,0.663172,0.600519,0.596884,0.802597,0.987437,2.87946,0.133105,0,0.423329,1.44316,1.34937,0.784135,0.313231,1.68677,0.829084,1.17092,1.71649,3.24957,1.24029,0.839281,1.65749,2.24038,3.0565,0,1.05827,1.95998,1.66232,0.319426,0,0.299258,2.6584,1.04234,0,1.5275,1.54943,0.923077,0,0.0966057,3.92051,3.21971,2.76318,0,1.06155,3.85382,2.62854,1.1912,3.51003,1.55816,2.7981,2.41814,2.8196,2.16087,1.73023,1.26977,0.213542,0.786458,0.814621,0.641996,2.17244,0.933652,1.43729,0,0,1.80049,0.199509,0.279739,1.32964,2.94894,2.62137,1.47957,1.71417,1.66589,0.960681,0.635538,0.364462,0.338542,1.00391,0.657552,0.364935,0.635065,1.00957,1.72562,1.40355,1.79615,0.0651042,0.168848,0.831152,0.384416,0.615584,0,0,0,0,0.730812,2.09471,1.17448,0.403896,1.00183,0.594278,1.48027,2.02823,0.491503,0,0.0247396,1.85172,1.66591,0.918565,0.539062,0.560052,0.872978,0.56697,0.0625,0.9375,0,0,0.60705,2.02009,1.37286,1.51425,2.07817,2.68323,1.72434,2.07423,2.58681,0.338961,0,0,0.5625,1.00539,0.982896,1.19603,3.14369,2.34172,0.767775,1.19271,1.2982,1.25322,2.69861,4.08323,1.66023,0.813802,0,0,0,0,0.748362,1.06129,0.864378,0.325974,0.674449,1.97693,0.348624,0.849673,0.150327,0.53316,0.46684,1.53113,0.468867,1.32812,1.9036,2.31373,2.32205,2.4019,1.72013,2.23919,2.20748,1.24863,0.876214,0.438961,0,0,1.1481,2.42463,0.427273,0,0.114024,0.885976,0.582575,0.417425,0.587776,0.412224,0,0,0,0.509755,2.54977,1.95313,2.98734,1.95958,2.17414,2.50015,2.97992,2.67497,0.711242,1.05307,0.946929,1.47437,1.52563,0.903646,1.16166,2.2598,2.59959,1.37373,1.10655,0.59502,2.31005,1.8923,0.79765,1.40662,0.958568,0.634817,0.705577,0.689711,0.604712,0.664499,1.97066,2.07393,0.826065,1.46354,0.464653,1.21545,0.321196,0.91276,1.63852,2.1617,1.66722,0.619792,0.694408,2.18059,0.125,1.77589,2.29094,1.70468,1.60757,2.1034,1.51752,0,1.12454,3.33627,3.47784,2.72714,0.334207,0.685452,0.314548,0,1.18266,0.81734,0.0234375,1.99219,1.13151,0.852865,0.993481,1.75652,0.25,0.0390625,2.61161,0.349325,0,0,1.2751,1.92019,3.96895,0.83577,0.912336,2.40402,0.683643,0.0576671,2.32598,2.00884,1.22239,1.37018,2.08507,1.0404,2.43197,1.4575,0.153337,2.64796,0.198701,0.285528,0.714472,0.295958,0.704042,0.148438,2.13049,1.72108,0.841146,1.90674,4.85684,2.14333,1.08312,0.168831,0.348958,1.35938,1.29167,0.750973,1,0.249027,0,0,1.02788,0.972125,0.420157,1.89755,2.19202,1.80327,1.61799,1.12982,1.8793,1.14065,0.919244,0.876623,0.882131,1.90091,2.0643,1.27604,0.276042,0.723958,0.283854,0.716146,2.16042,2.62565,2.56418,0.649748,3.40633,0.593669,1.49153,0.508475,0.520833,1.39605,0.79216,1.06009,1.6909,1.09422,1.37544,1.34749,1.72283,0.0535248,1.00645,1.01945,0.920573,0.584094,1.86623,1.54968,1.05221,1.90097,0.653585,0.792449,0.60078,2.88312,0.116883,1.10984,1.67096,0.219196,0.312932,3.3067,1.53718,0.843192,1.77633,1.99118,0.232489,0,0.218016,1.24232,0.539662,0,0,0,0,0,0.913081,1.08692,0.426152,2.59937,1.27174,2.43879,2.57295,1.50945,1.70108,0.50904,0.971429,1.15155,1.84845,0.670097,2.61115,0.71875,1.59818,0.783828,1.00572,0.764417,3.70266,1.19981,0.945384,0.802597,1.00155,0.259486,1.94785,1.43499,0.553525,0.860677,0.139323,0.807792,0.192208,1.08316,1.28794,0.628906,0,1.17186,2.97159,0.856553,0,0.647594,0.453704,1.00143,1.47787,1.40451,1.83071,1.13209,1.00391,0.865298,2.79085,0.392026,0.451823,2.2213,1.96631,1.7472,2.13795,0.610661,1.7285,1.13626,0,1.21809,1.51143,0.417425,0.853056,0.153247,1.36175,1.46128,1.02372,0,0.531943,0.762062,2.77501,1.76216,0.168831,0.0820312,1.00402,0.91395,1.86632,2.04892,1.08477,0,0.705497,0.294503,0.725131,0.274869,0.0510471,5.60475,5.68041,1.85829,1.8055,0.068152,2.64661,0.500823,1.84436,1.8317,0.108355,0,1.51993,0.480071,0.161206,1.51067,0.328125,0.236364,0.966782,2.41506,0.381791,2.00125,3.15226,1.09714,1.66602,0.594415,3.4505,3.03842,0.269883,0.730117,0.307404,1.6926,0,0.0641361,0.935864,2.19886,0.892885,0.908257,0.0809399,1.77898,0.140078,0,0.336375,1.23939,2.22606,1.54497,3.14427,1.50893,0,0,0.455497,2.40961,0.13489,1.7427,2.42313,1.74093,1.09323,0.206266,0.793734,0,1.29667,0.703326,0,1.53105,2.46895,0.447197,0.552803,0.710733,0.289267,2.02041,1.27071,0.708877,0.746583,2.1006,1.64304,0.509778,0,0,0,1.37533,1.62467,0,1.77554,2.74815,0.476317,0.884565,0.115434,0,0.887013,0.112987,0.430799,1.5692,0,0.1875,0.8125,1.3776,1.6224,0.638853,1.36115,0.420026,0.579974,1.341,1.28352,0.375489,0.230469,1.07943,1.6901,1.05755,2.5961,0.346354,0.662321,0.337679,0.672751,1.00522,0.322034,1.3724,0.904948,1.18169,1.70252,1.45252,0.385919,0.298177,1.3345,1.30188,0.700452,1.36499,0,1.63962,0.844127,0.516255,0.910506,0.0894942,0.0209424,0.979058,0.777344,1.13694,0.0857143,2.55986,0.440136,1.40256,2.86011,2.4115,0.704735,0.749366,2.20793,1.58209,0.342129,1.93671,1.20652,0.596354,0,0.281617,1.58166,0.785027,2.22653,0.670709,1.45445,2.28964,1.60345,0.10691,0.555844,2.01692,2.89843,1.44656,0.0822454,0.91395,1.39407,1.62454,0.549216,2.20764,2.24436,1.37118,2.15193,0.543122,0,0.936446,0.0635538,2.1026,1.88568,0.0117188,0.884817,1.05813,1.10927,2.55376,1.95693,4.13411,1.30298,0.554688,0.445312,0,0,0.461538,0.538462,1.18314,2.44837,1.70046,1.66803,0.125163,1.00539,1.60791,1.26154,0.951948,0.696947,1.57615,2.16387,1.87373,2.39578,0.341558,0.132986,0.867014,0.876143,1.12386,0,0,1.05174,1.62618,0.322078,0.673177,0.326823,0,0,2.34429,1.23273,1.42298,0,0,1.89683,0.103171,0,0.334204,1.70749,1.37246,1.57537,0.264377,0.746094,0.923177,2.93214,2.09881,1.77444,0.271429,1.49774,1.02126,0.777871,2.21812,0.697043,1.78796,0,0.979248,0.0207523,0,0,0,0.484334,1.49751,0.0181582,0,0.768831,0.599658,0.63151,0.377285,1.00683,1.43157,1.96658,0.217731,1.8438,2.88099,1.27521,0,0.590613,0.409387,0.816406,0.986191,1.03772,2.47871,1.31022,1.2705,0.10026,0.648825,0.787039,1.4782,1.3641,2.12228,2.35382,0.245739,0.934896,0.899955,0.16515,0.51369,1.43683,0.0494792,0.526727,1.03479,0.438482,0.0589005,1.79676,0.144343,0,0.61911,2.94098,0.439915,0.575718,0.424282,0,1.64369,0.35631,0,0.603651,3.08238,0.313973,1.27015,2.71053,1.64693,0.38798,1.75798,0.22644,0,0.803665,0.196335,2.40162,1.26504,0.407552,2.83638,1.0894,0,0.0599739,1.8634,1.74582,1.25938,1.92146,0.149973,1.65381,0.346185,0.0285344,0.971466,0.975284,1.05474,1.96736,0.0337866,0.968831,0,0,2.66358,1.9058,1.39426,1.1716,1.01841,0.948049,2.13885,1.75946,0,0,0,0.139869,2.22579,0.634338,0.321149,1.67885,1.1708,0.8292,0.227865,0.816291,0.955844,0,0,0.0479896,0.95201,0.867187,1.44945,1.68337,0,0,2.01394,0.986064,0.925685,1.00531,0.105421,0.963589,0,2.1993,0.856474,0.944228,0.629389,1.37061,0,0.111834,3.20587,1.13467,2.88356,0.729082,0.934981,0.348958,0.651042,0.0169271,1.00393,1.13758,1.909,0.932555,0,0,0.157168,2.23085,1.00521,1.07674,0.628856,1.10377,1.7974,0.495437,0.504563,0.676152,1.42411,0.89974,0,0.981942,2.77364,3.68713,1.13281,2.19673,1.01165,2.2161,0.46224,0.53776,0.579103,1.4209,0,0,0,0.626632,0.373368,0,0.195312,1.29029,0.807289,1.70711,0.0883117,0.911688,0.615531,1.38447,1.82577,1.17423,0,1.39869,1.85522,0.746094,0.557292,1.07443,1.16545,2.33825,0.864583,0.167539,1.83246,0.202094,1.79791,0,0.639323,0.886577,2.05451,2.41959,0.549193,2.29289,1.15792,0.848761,0.151239,0,1.22153,2.14175,0.884101,0.752618,0,0.244473,2.03477,0.832304,0.888457,0,0,0.11284,1.30383,1.00445,0.578879,1.78881,3.28607,1.68684,1.38638,1.30242,0.971498,0.577982,0.282185,0.717815,0.078637,0.921363,0.480366,0.519634,0.124514,0.93546,1.45835,0.481675,0.162516,2.4272,1.41028,0,0.312987,0.799138,0.887875,0.131169,1.48401,1.17909,0.533002,1.23783,0.766065,1.24455,0.424282,0,0,0.824268,2.17573,0,0.349805,0.650195,0.846354,0.153646,0,0.856771,0.143229,0,0.810209,0.653749,0.681308,1.28254,2.56672,1.67984,2.3074,0.0182292,0.887435,0.112565,1.92879,3.03012,1.04109,1.43723,2.50904,2.29971,2.12258,0.787086,2.3105,2.11296,3.03666,3.29084,1.93446,2.87476,1.24641,0.197293,0.840467,0.517346,1.56381,0.918848,2.33907,1.75598,0.904948,0,0,0,0,0.167315,0.832685,0,0,0.84375,0.15625,0,0.0403646,1.20571,0.753927,1.81735,0.18265,0.284404,0.896586,1.42634,1.39267,0,1.01643,3.38658,0.804025,0.792969,0,0,0,0.182879,0.817121,0,0,0,0.829573,3.00559,1.16483,0.478431,0.521569,0,0.204456,1.32801,0.47014,0.997392,0.298177,0.701823,0.564875,0.614578,1.00284,0.817708,0.541076,3.01289,0.446034,0.821149,0.38458,1.64715,1.98915,0.157963,0,0,0,0,0,0,0,0,0.878647,1.71096,0.41039,0,0,0,0,0,0.607282,0.392718,1.18533,0.814669,0.600262,1.01662,1.2784,0.104712,0,0.338567,1.66143,0.209635,1.00391,0.786458,0,0.639792,0.864771,0.495437,0.24349,1.11458,1.65668,1.63934,0.345904,0,1.34901,0.650985,1.1103,1.44439,0.445312,0,0.429446,1.87654,0.69401,0,0.867427,2.8022,1.33038,0,0,0.344198,0.876717,2.21202,0.567062,0,0.368146,1.33927,1.641,0.651586,0,0.312827,1.16634,0.520833,0,0,0,0.132372,1.29341,0.727561,0.846658,0,0,0.450521,0.549479,0.460235,1.64102,1.62401,0.27474,0,0,0,0,1.32501,1.67499,0.438642,0.561358,0.259403,0.740597,0,0.53125,0.72945,1.13248,0.606815,0.791938,0.208062,0,0,1.12827,0.871728,0,0,0,0.811443,0.188557,1.38632,0.613677,0,0.59085,0.40915,0,0,0.831169,1.12348,1.04535,1.28668,0.713318,0,0,1.34289,0.657106,0,0,0,1.41678,1.52463,0.808266,0.250328,0.963303,0.756749,1.00391,0.276042,0,0,0.832241,0.167759,0,0,0.874181,0.892746,0.233073,0,0.782552,0.217448,0.791395,0.504325,0.70428,0.80704,0.19296,1.67648,1.62313,0.700389,0.920779,0.380519,0.698701,0,1.93071,1.06929,0,0,0,0,0,0,0,0,0.970013,0.372058,1.61632,0.354194,1.64971,1.00135,0.0468075,1.30473,0.684825,0.942559,0.98192,1.00391,1.00391,0.0677083,0,0,0.487549,0.512451,0.355177,0.644823,0,0,0,0,0.325974,0.912307,1.00422,0.757497,0,0.0572409,3.04679,0.895967,0,0,0.279948,1.25216,0.539598,1.14342,0.784876,0.0847458,1.25118,0.664073,0.10026,0.89974,0,0,0.333333,0.666667,0,0,0.409091,1.94768,0.643229,0,0.371094,0.628906,0.104167,1.24343,1.3921,1.2603,0,0,0,0.544271,1.45573,0,0.855832,0.144168,0,0.230469,1.20108,0.568448,1.08541,0.914591,0,0,0,0,0,0.481771,0.518229,0,0,0.516971,0.483029,0.584984,1.78207,0.632944,0,0,0,0,0,0,0.14941,0.85059,0,0,0,0,0,0,0,0.475943,1.77832,0.74574,0,0,0.309493,0.690507,0,0,0,0,0.385214,1.26062,0.812282,0.541885,0,0,0,0,0.485677,0.514323,0.392208,0.982792,2.51874,1.10626,0,0,0.713168,0.286832,0,0,0.851175,0.148825,0,0.558018,0.707261,0.73472,0,0,0.710733,0.567189,1.1713,1.28997,0.260813,1.54692,0.453084,0,0,0,0,0,0.825916,0.174084,0.846859,0.153141,0.866317,0.133683,0.838794,0.478501,0.682705,0,0.6875,0.3125,0,0,0,0,0,0,0.424675,1.30579,0.269531,0,0.927469,1.07253,0,0,0,0.769531,0.230469,0,0,0,0,0,0.131062,0.868938,0,0.771429,1.42385,0.804718,0,0.64974,0.35026,0,0,0,0,0,0.410923,1.26918,0.319896,0,0.420026,0.579974,0,0.714286,1.28571,0,0.753959,1.64002,0.606021,0,0.530882,2.30635,1.60838,0.554391,0.585069,1.41493,0,0.132812,0.867188,0,0,0,0,0,0,0.475943,1.31703,1.00495,0.202086,0,0,0,0,0.0483029,0.951697,0.21224,2.16734,1.45766,0.16276,0,0.51039,1.81475,0.674862,0,0.614883,0.385118,0.778796,0.221204,0.528571,1.00199,0.469441,0,0,0,0.856021,1.29561,2.00982,2.01745,1.82109,0.713168,0.286832,0.330729,0.669271,0,0.990838,1.54005,1.46912,0.212516,1.28099,0.548433,1.0118,0.946265,0,0,0,0.0602094,0.939791,0,0,0.84485,0.15515,0,0,0,0,0,0,0.230668,0.769332,0,0.773161,1.22684,0,0,0,0,0,0.358073,1.13997,0.501956,0,0,0,0.518807,0.823264,0.657929,0,0,0,0,0,0,0,0,0,0,0,0,0,1.05441,0.945594,0,0,0,0,0,0,0,0,0,0.59555,0.40445,0,0.712975,0.503171,1.64658,1.13728,0,0,0,0,0,0.259791,1.44034,1.04759,1.09107,0.161206,0,0,0,0,0.319426,1.2331,1.52646,1.67101,0.25,0,0.55642,0.44358,0.657106,1.12573,0.217165,0,0,0,0,0,0,0,0,0,0,0,0,0.568093,0.431907,0,0,0,0.464002,1.536,0,0,0,0,0,0,0.423927,0.576073,0,0,0.854545,0.145455,0,0,0,0,0,0,0,0,0,0,0,0.873698,0.716445,0.409857,0,0.498034,1.37365,1.12832,1.80874,0.191265,0,0,0.927083,0.609375,1.39974,0.0638021,0,0.625164,1.85421,0.52063,0,0.928571,0.0714286,0,0,0.605982,0.394018,0,0,0.750983,0.249017,0,0,0,0.633508,0.366492,0.134115,1.49657,1.00425,0.365059,0.865183,1.06572,0.0691004,1.14589,1.58675,1.00951,0.257853,0,0,0.984334,0.0156658,0,0,1,0.0169492,0.983051,0,0.0104167,1.61945,0.37013,0,0.985583,1.08482,1.03707,0.892529,0,0,0,0,0,0.0415584,1.17068,0.78776,0,0.453509,1.54649,0,0,0,0.0719895,0.92801,0.091623,0.908377,0.317169,0.682831,0,0.360677,1.28997,0.349351,0.83485,0.16515,0.189791,0.810209,0,0,0.402344,0.89139,1.45366,1.2526,0.419271,0.580729,0,0,0,0,0,0,1.04869,1.34245,0.608866,0,0,0.136541,0.863459,0,1.09463,0.90537,0.148244,0.851755,0.951823,0.0481771,0.958387,0.0416125,0,0,0.535854,0.464146,0,0,0.511111,0.488889,0,1,0.00651042,1.1805,0.812987,0,0.686122,0.313878,0.575718,0.424282,0,0.93709,0.758847,0.304063,0,0.572917,0.705367,2.72041,0.00131062,0,0,0,0,0,0,0.0976562,1.00377,1.5296,0.36897,0,0,0,0,0.961421,1.03858,1.42253,0.577465,0.208388,0.791612,0.6897,0.3103,0.710765,0.289235,0.708333,0.291667,0,0,0,0,0,0,0,0,1.85511,1.14489,0,0.891786,0.108214,0,0.786458,0.213542,0,0,0,0,0.815104,1.00497,1.23457,0.945349,2.68713,1.04439,0.815813,2.99344,2.31844,4.04464,2.09616,0.867188,2.18216,2.30956,2.39237,3.60558,1.53506,1.10991,1.46319,5.28186,2.95667,5.84708,5.96039,3.75885,4.74076,8.70026,7.90517,12.7201,14.2923,20.5845,25.8025,26.5063,27.9107,31.977,34.6221,34.1644,42.4761,40.5124,41.6616,37.7501,33.7644,38.0699,30.4056,25.905,22.9638,17.6289,14.3032,15.9219,7.70963,2.10577,1.27233,4.27198,1.37508,0.706266,0.308094,0.691906,0.755236,1.01519,0.229572,0,0,0,0,0,0.503906,0.496094,0.479221,0.520779,0,0,0.891361,1.79216,0.499007,0.817471,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.239583,0.760417,0,0,0,0,0.621094,0.378906,0,0,1.08969,0.910308,0,0,0,0.657552,0.342448,0,0.570871,1.23847,0.190661,0,1.81451,1.18549,0,0,0,0,0,0,0,0.389323,0.610677,0,0,0,0,0.775457,0.224543,0.824675,0.175325,0,0,0,0,0,0,0,0,0,0,0,0,0,0.500652,0.499348,0,0,0,0,0,0,0,0.540365,0.459635,0,0,0,0.845655,0.154345,0,0,0,0.195282,0.804718,0,0.22644,0.77356,0,0,0.854734,0.145266,0.289646,1.58585,0.124509,0,0,0,0,0,0,0.861219,0.138781,0.863813,0.136187,0,0,0,0,0.985677,0.0143229,0,0,0,0,0,0,0.757497,0.242503,0,0,0,0,0,0,0,0,0,0,0,0,0,0.254259,0.74574,0,0.815584,1.43435,0.750069,0,0,0,0.847458,0.152542,0,0,0,0.897001,0.102999,0,0.882812,1.01758,0.0996068,0,0,0,0,0.169271,0.830729,0,0,0.184896,0.815104,0,0.947917,0.0520833,0,0.960887,0.0391134,0,0,0.587467,0.412533,0,0,0,0,0,0.914174,0.0858257,0.922078,0.0779221,0,0,0.928479,0.152251,0.919271,0,0,0,0,0,0,0.311198,0.688802,0,0,0,0,0,1.38031,0.734424,1.3217,0.563565,0.946265,0.0537353,0,0,0.942931,0.0570687,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.43099,0.56901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.322917,0.677083,0,0.0792208,0.920779,0,0,0,0,0,0.561198,0.438802,0.56901,0.43099,0,0,0,0,0.206536,1.78179,0.0116732,0.120779,0.879221,0.611979,0.81901,0.56901,0,0,0,0,0.285528,0.714472,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.395288,0.604712,0,0,0.187013,0.812987,0,0.730469,0.269531,0,0,0,0,0.666232,0.333768,0,0,0,0,0,0.0078637,0.992136,0,0,0,0,0,0.733073,0.298096,0.968831,0,0,0,0.0350649,0.964935,0,0,0,0.183246,0.816754,0,0,0,0,0.815104,0.184896,0,0.287013,0.712987,0,0,0,0,0.301299,0.698701,0,0,0,0,0,0.0275229,0.972477,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0234375,0.976562,0.03125,0.981788,0.986962,0,0,0,0.342071,1.35819,0.689855,0.609883,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0743155,0.925685,0,0,0,0,0,0,0,0,0,0,0.240885,0.759115,0,0.980494,1.01951,0,0,0,0,0,0.891361,0.108639,0,0,0,0,0,0,0,0,0,0.532468,0.467532,0,0.238281,0.761719,0.353403,0.646597,0,0,0,0.554545,0.445455,0,0,0,0.166448,0.833552,0,0,0.375,0.625,0.230366,0.769634,0.328553,0.671447,0.33724,1.22035,0.442408,0,0,0.325033,0.674967,0,0,0.434896,1.82469,0.740416,0,0,0,0,0,0,0,0,0,0,0,0,0.724183,0.275817,0,0,0.654096,0.345904,0,0,0,0,0,0,0,0,0,0,0,0.684005,0.315995,0,0,0,0,0.550196,0.449804,0,0,0.568448,0.431551,0,0,0,0,0.197147,0.802853,0,0,0.729519,0.270481,0.647135,0.352865,0,0,0,0.746424,0.253576,0,0,0.8125,0.1875,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.463242,1.53676,0,0,0,0,0,0,0.238961,0.761039,0,0.00651042,1.30419,1.36549,1.3238,0,0,0,0,0,0,0,0,0.89974,0.10026,0,0,0.796854,0.203145,0,0,0,0,0,0,0,0,0.96224,0.775637,0.262123,0,0,0,0,0,0,0,0,0.0013089,0.998691,1.12533,0.874674,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.102865,0.897135,0,0,0,0,0,0,0,0,0,0,0,0.298314,0.701686,0,0,0.128906,0.871094,0,0.391874,0.608126,0,2.08726,0.912738,0,0,0,0,0.175553,0.824447,0,0,0,0,0,0,0,0,0,0,0.597641,0.402359,0,0,0,0,0.325974,0.674026,0,0,0.260417,1.07857,0.661017,0,0,0,0,0,0,0,0,0,0,0.82199,1.00916,0.168848,0,0,0.785059,0.214941,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.421875,0.578125,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.420366,0.579634,0,0,0.329843,1.19099,0.479167,0,0,0,0,0.267532,0.732468,0,0,0,0,0.420708,0.579292,0,0,0,0,0,0,0.534031,0.465969,0,0,0,0,0,0,0,0,0,0,0,0,0.0143229,0.985677,0,0,0.0338542,0.966146,0,0,0,0,0,0,0,0,0,0,0,0,0.842726,0.157274,0,0,0,0,0,0,0,0,0,0,0.963303,0.0366972,0,0.174479,0.825521,0,0,0,0,0.422627,0.577373,0,0,0,0,0,0,0,0,0.251302,0.748698,0,0,0,0.197903,0.802097,0,0.875163,0.124837,0,0,0,0,0.28534,0.71466,0,0,0,0,0,0,0,0,0,0,0,0.457405,0.96537,0.577225,0.397135,0.602865,0,0,0.480996,0.519004,0,0,0,0.529489,0.470511,0,0,0,0,0,0.473958,0.526042,0,0,0,0.498695,1.22214,0.631642,0.64752,0,0,0,0,0.39295,0.60705,0,0,0.807268,1.19273,0,0,0,0.603896,0.396104,0,0,0,0,0,0.498039,0.501961,0.361147,0.638853,0,0,0,0,0,0,0,0,0,1.06081,0.939194,0.597911,0.402089,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.82399,0.17601,0.557717,0.772558,0.669725,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.584955,0.415045,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.43537,0.564627,0,0,0.134289,0.865711,0,0,0,0.105469,0.894531,0,0.186441,1.48934,1.32422,0,0,0,0,0,0,0.246415,0.753585,0,0,0,0,0,0,0,0,0.0838794,0.916121,0,0,0,0,0,0.632468,0.367532,0,0.634241,0.365759,0,0.970052,0.0299479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.401565,0.598435,0,0,0,0,0,0,0,0,0,0,0,0,0.470052,1.19966,0.330287,0,0,0,0,0,0,0.688889,0.311111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.714656,0.285344,0,0,0,0,0,0,0.0455729,0.954427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.210663,0.789337,0,0,0,0,0,0,0,0,0.749351,0.250649,0,0,0,0,0.915254,0.0847458,0,0,0,0.209635,1.66061,0.129751,0,0,0.271782,0.728218,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0716146,0.928385,0,0,0,0,0,0,0.789883,0.210117,0,0,0,0,0,0.373698,0.626302,0.153846,0.846154,0,0,0,0,0,0,0.829427,0.592591,0.577982,0,0.390909,0.609091,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.503906,0.496094,0,0,0,0,0.840731,0.159269,0.361257,0.638743,0,0,0,0,0,0,0,0,0.920366,0.100468,0.979167,0,0,0.953064,0.0469361,0,0,0,0,0,0,0,0,0,0,0,0.861039,0.623336,0.515625,0,0,0,0,0,0,0,0.733333,0.266667,0,0,0,0,0,0.218873,0.781127,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.77474,0.22526,0,0,0,0,0,0,0,0,0,0,1.03434,0.965663,0,0,0.636364,0.363636,0,0,0,0,0,0.183486,0.816514,0,0,0,0,0,0,0.719528,0.280472,0,0,0,0,0,0,0,0,0,0.928571,0.0714286,0,0.398427,0.601573,0.46224,0.53776,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0.0377604,0.96224,0,0,0,0.663613,0.336387,0,0.00391134,0.996089,0,0,0.784416,0.215584,0,0,0,0.795839,0.204161,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.484928,0.515072,0,0,0,0,0,0,0.0445026,0.955497,0.0641361,0.935864,0,0,0,0,0,0,0,0,0,0,0.264323,0.735677,0.897269,0.102731,0,0,0,0,0,0,0.303385,0.696615,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.53087,0.469125,0,0,0,0.165138,0.834862,0,1.06314,0.986212,1.95065,0,0,0,0,0,0,0,0,0.0583658,0.941634,0,0,0.357798,0.642202,0,0,0,0,0,0,0,0,0,0,0,0.074026,0.925974,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.665793,0.334207,0,0,0,0,0,0,0,0,0.652344,0.347656,0.660156,0.339844,0,0.826999,0.173001,0,0,0,0,0,0,0.828758,0.171242,0,1.18865,0.811347,0,0,0,0,0.00655308,0.993447,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.914062,0.0859375,0.450521,0.549479,0,0.57199,0.42801,0,0,0,0.344456,1.65554,0,0,0,0,0,0,0.871261,0.128739,0.719895,0.280105,0,0.568989,1.43101,0,0,0,0,0.572917,0.427083,0,0,0,0,0,0,0,0,0,0,0.96224,0.0377604,0,0.954188,0.0458115,0,0,0,1,0,0,0,0,0,0.187013,0.812987,0,0,0,0,0,0,0.411995,0.813266,0.77474,0,0,0,0,0,0,0,0,0,0,0,0.277851,0.722149,0,0,0,0,0,0,0.0838794,1.74815,0.167969,0,0,0,0,0,0,0,0,0,0.226978,0.773022,0,0,0,0,0.232166,0.767834,0,0,0,0,0,0,0,0,0,0,0.245136,0.754864,0,0,0,0,0,0,0.48886,0.51114,0,0,0,0,0,0,0,0.903545,1.09645,0,0,0,0,0,0,0,0.905636,0.0943644,0,0,0,0,0,0,0,0,0,0,0,0,0,0.284047,0.715953,0.862385,1.01048,0.12713,0.289235,0.710765,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.906327,1.09367,0.287025,0.712975,0,0,0,0,0,0,0,0,0,0,0.318182,0.681818,0,0,0,0,0,0.582031,0.417969,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.368831,0.631169,0,0.561198,0.438802,0,0,0,0.812744,0.187256,0,0,0,0,0,0,0,0,0,0.829427,0.909476,0.261097,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.197644,0.802356,0,0,0,0,0.936198,0.0638021,0,0.292267,0.707733,0,0,0,0,0.364583,0.635417,0,0.473822,0.526178,0,0,0,0.0234681,0.976532,0,0,0,0,0,0,0,0,0.0416667,0.958333,0,0,0,0,0,0,0,0,0,0,0.169492,0.830508,0,0.525424,0.474576,0,0.110677,1.81789,2.07143,0,0.981771,0.0182292,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.205729,0.794271,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.21232,1.01048,0.777195,0.243455,0.756545,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.920469,0.0795306,0.537662,0.462338,0,0,0.542153,0.457847,0.213542,1.57264,0.21382,0,0,0.984334,0.0156658,0,0,0,0,0,0,0,0,0,0,0,0,0.863696,0.136304,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.183486,0.816514,0,0.126467,0.873533,0,0.144909,0.855091,0,0,0,0,0,0,0.36541,0.63459,0,0,0,0,0,0,0,0,0.688802,0.311198,0,0,0,0,0,0,0,0,0.77474,0.22526,0,0,0,0,0,0,0,0,0,0,0,0.416449,0.583551,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.828534,0.171466,0,0,0,0.878272,0.121728,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.572172,1.12523,0.302597,0,0.153141,0.846859,0.71875,0.28125,0,0,0,0,0,0,0,0,0,0,0.289646,0.710354,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.657143,0.548855,0.794003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.750649,0.249351,0,0,0,0,0,0,0,0,0,0,0,0,0.0169271,0.983073,0,0,0,0,0,0,0,0.0625,0.9375,0,0,0,0,0,0,0,0.340731,0.659269,0,0,0,0,0,0.461538,0.538462,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.232073,0.767927,0,0,0,0,0,0,0,0,0.863459,0.136541,0,0,0,0,0,0.540365,0.459635,0,0,0,0.419397,0.580603,0,0,0.458716,0.541284,0.675781,1.23319,0.0910273,0,0,0,0,0,0,0,0,0.422425,0.577575,0,0,0,0,0,0,0,0,0,0,0,0,0.490885,0.509115,0,0,0.976593,0.023407,0,0,0,0,0,0.992208,0.00779221,0,0,0,0,0,0,0,0,0,0.0130378,0.986962,0,0,0,0,0,0,0,0,0,0,0.946615,0.0533854,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.745431,0.254569,0,0,0.09375,1.90625,0,0,0,0,0.114434,0.885566,2.79688,0.203125,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.38961,1.61039,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.990909,0.00909091,0,0,0,0,0,0,0,4,0],
			"yScaleFactor":1.0514
		}
]
};
spec_chart_chart1.setData(data_chart1);
window.addEventListener('resize',function(){spec_chart_chart1.handleResize();});
spec_chart_chart1.setLogY();
spec_chart_chart1.setShowLegend(true);
var reference_lines_chart1 = [{color:'#6666ff',parent:'Ba133',age:'0.00 us',detector:'Ortec IDM Portal',particleSf:{'gamma':0.000140255,'xray':0.000140255},lines:[{e:30.27,h:2.42e-06,particle:'xray',decay:'xray',el:'barium'},{e:30.625,h:0.0239,particle:'xray',decay:'xray',el:'barium'},{e:30.973,h:0.0499,particle:'xray',decay:'xray',el:'barium'},{e:34.92,h:0.0158,particle:'xray',decay:'xray',el:'barium'},{e:34.987,h:0.031,particle:'xray',decay:'xray',el:'barium'},{e:35.252,h:0.00035,particle:'xray',decay:'xray',el:'barium'},{e:35.818,h:0.0116,particle:'xray',decay:'xray',el:'barium'},{e:35.907,h:0.00243,particle:'xray',decay:'xray',el:'barium'},{e:53.1625,h:0.0415,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:79.6139,h:0.0755,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:80.9971,h:0.994,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:160.613,h:0.0212,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:223.234,h:0.0119,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:276.4,h:0.15,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:302.853,h:0.341,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:356.017,h:1,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'},{e:383.848,h:0.134,particle:'gamma',decay:'Ba133 to Cs133 via Electron Capture'}]}];;
spec_chart_chart1.setShowPeaks(1,false);
spec_chart_chart1.setShowPeaks(2,false);
</script>
<div style="margin-top: 10px; display: inline-block;"><label>
Y Scale:
<select onchange="onyscalechange(this,spec_chart_chart1)" >
<option value="lin" >Linear</option>
<option value="log" selected>Log</option>
<option value="sqrt">Sqrt</option>
</select></label>

<label><input type="checkbox" onchange="ongridxchange(this,spec_chart_chart1)" >Grid X</label>
<label><input type="checkbox" onchange="ongridychange(this,spec_chart_chart1)" >Grid Y</label>

<label>
Data to display:
<select onchange="ondatachange(this,spec_chart_chart1,data_chart1)">
<option value="none">none</option>
<option value="data" selected>Foreground</option></select></label>

<br /><label><input type="checkbox" onchange="showForegroundPeaks(this,spec_chart_chart1)" checked>Draw foreground peaks</label>
<label><input type="checkbox" onchange="alert('Peak drawing not implemented yet');">Draw background peaks</label>
<label><input type="checkbox" onchange="alert('Peak drawing not implemented yet');">Draw secondary peaks</label>
<label><input type="checkbox" onchange="showTitle(this,spec_chart_chart1)" checked>Show Title</label>

<br /><label><input id="legendoption" type="checkbox" onchange="setShowLegend(this,spec_chart_chart1);" checked>Draw Legend</label>
<label><input type="checkbox" onchange="setCompactXAxis(this,spec_chart_chart1);" >Compact x-axis</label>
<label><input type="checkbox" onchange="setShowMouseStats(this,spec_chart_chart1);" checked>Mouse Position stats</label>
<label><input type="checkbox" onchange="setShowAnimation(this,spec_chart_chart1)">Show zoom animation with duration: <input type="number" size=3 value="200" min="0" id="animation-duration" oninput="setAnimationDuration(this.value,spec_chart_chart1);"><label>ms</label></label>

<br /> <label><input type="checkbox" onchange="setShowUserLabels(this,spec_chart_chart1);" >Show User Labels</label>
<label><input type="checkbox" onchange="setShowPeakLabels(this,spec_chart_chart1);" >Show Peak Labels</label>
<label><input type="checkbox" onchange="setShowNuclideNames(this,spec_chart_chart1);" >Show Nuclide Names</label>
<label><input type="checkbox" onchange="setShowNuclideEnergies(this,spec_chart_chart1);" >Show Nuclide Energies</label>


<br />
<label><input type="checkbox" onchange="setAdjustYAxisPadding(this,spec_chart_chart1);" checked>Adjust for y-labels</label>
<label><input type="checkbox" onchange="setWheelScrollYAxis(this,spec_chart_chart1);" checked>Scroll over y-axis zooms-y</label>

<br />
<label><input type="checkbox" onchange="setComptonEdge(this,spec_chart_chart1);" >Show compton edge</label>
<label><input type="checkbox" onchange="setComptonPeaks(this,spec_chart_chart1);" >Show compton peak energy with angle: <input type="number" size=5 placeholder="180" value="180" max="180" min="0" id="angle-text" oninput="setComptonPeakAngle(this.value,spec_chart_chart1);"><label>degrees</label></label>
<label><input type="checkbox" onchange="setEscapePeaks(this,spec_chart_chart1);" >Show escape peak energies</label>
<label><input type="checkbox" onchange="setSumPeaks(this,spec_chart_chart1);" >Show sum peak energies</label>

<br />
<label><input type="checkbox" onchange="setBackgroundSubtract(this,spec_chart_chart1)" >Background subtract</label>
<label><input id="scaleroption" type="checkbox" onchange="setSpectrumScaleFactorWidget(this,spec_chart_chart1)">Enable scale background and secondary</label>
<label><input type="checkbox" onchange="setShowXAxisSliderChart(this,spec_chart_chart1);">Show x-axis slider chart</label>
<label><input type="checkbox" onchange="setXRangeArrows(this,spec_chart_chart1)" checked>Show x-axis range continuse arrows</label>

<br />
<label>Choose Spectrum to Scale: <select id="current-sf-title" onchange="setDropDownSpectrumScaleFactor(this,spec_chart_chart1)">
<option value="None">none</option></select></label>
<label>Current Scale Factor: <input type="number" min="0" size="4" id="current-sf" oninput="setSpectrumScaleFactor(this,spec_chart_chart1);"></label>
<label>Max Scale Factor: <input id="max-sf" type="number" min="0.1" id="bg-msf" oninput="setMaxScaleFactor(this,spec_chart_chart1);"></label>

</div><div class="referenceGammaSelectDiv"><span>Reference Gammas: </span><br />
<select id="referenceGammaSelectchart1" multiple class="referenceGammaSelect"  onchange="onrefgammachange(this,spec_chart_chart1,reference_lines_chart1)">
<option value="Ba133" selected>Ba133</option>
</select>
</div>
<script>onrefgammachange(document.getElementById('referenceGammaSelectchart1'),spec_chart_chart1,reference_lines_chart1);</script>
<script type="text/javascript">if (currentsftitle = document.getElementById('current-sf-title')) {var titles = spec_chart_chart1.getSpectrumTitles();currentsftitle.options.length = titles.length;titles.forEach(function(title,i) {if (i == 0) currentsftitle.options[i] = new Option('None', '', true, false);else currentsftitle.options[i] = new Option(title, title, false, false);   });}</script></body>
</html>
